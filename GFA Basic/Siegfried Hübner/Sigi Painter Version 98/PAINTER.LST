' lÑuft nur in GFA Basic 2.0
' GFA 3.0 lÑd die LST Datei nicht ein
' Fehler beim laden der .LST Datei Abbruch
' ************* Sigipainter **************
' *       1998 by Siegfried HÅbner       *
' ****************************************
'          Sigipainter Version 98
' ****************************************
' FREEWARE    22.01.2022   frei kopierbar
' ****************************************
' Freeware frei kopierbar
' Meine Adresse Siegfried HÅbner
'               St,-Gundekar-Str, 29 b
'               91560 Heilsbronn
' Email gott.liebt.dich.auch (at) gmail.com
'
' OPTION "B+"    (nur fÅr GFA 2.0 Compiler)
VOID FRE(0)
SHOWM
ON ERROR GOSUB starter
SHOWM
starter:
VOID FRE(0)
CLEAR
GOSUB infob
auto_save=TIMER
oskar=1.0E+15
CLR hall%
k$="SCHUTZ.PRG"
SDPOKE &H4EE,1
CLOSE #1
IF bild1%=FALSE
  bild1%=1
ENDIF
GOSUB zeige_bild
SHOWM
ON ERROR GOSUB fehlerio1
schreibe%=1
ofarbi%=1
oremi%=FALSE
ziehen%=FALSE
zahl%=FALSE
sav%=FALSE
stil%=FALSE
winkel%=FALSE
gros%=10
modus%=3
v%=2
f%=8
mgross%=1
mfarb%=1
mtyp%=1
SLPOKE 31260,16
SLPOKE &H444,FALSE
SLPOKE &H440,2
SLPOKE 1156,465
IF XBIOS(4)<>2
  ALERT 3,"Diese Version lÑuft leider nur|auf einen sw/Monitor. Farbver-|sion ist schon in Entwicklung.|Frag doch mal nach bei mir.... ",1," Klaro ",d%
  END
ENDIF
GOSUB rahmung(1)
ka%=1
fu%=1
c%=1
ccc%=1
graf%=1
SGET g$
SGET l$
SGET z$
SGET bild2$
SGET bild3$
SGET bild4$
SGET bild5$
clip3%=-1
clip4%=-1
clip1%=640
clip2%=400
IF EXIST("START.DAT")=TRUE
  SHOWM
  ON ERROR GOSUB killmi
  OPEN "I",#1,"START.DAT"
  INPUT #1,aa1$
  INPUT #1,aa2$
  INPUT #1,bild1%
  INPUT #1,s_modus_1%
  INPUT #1,bezier1$
  INPUT #1,bezier_punkte
  INPUT #1,facher$
  INPUT #1,oskar
  INPUT #1,hall%
  INPUT #1,lauf%
  INPUT #1,xkord%
  INPUT #1,ykord%
  INPUT #1,k$
  INPUT #1,gitarre%
  INPUT #1,rad2%
  INPUT #1,rad3%
  INPUT #1,schreibe%
  INPUT #1,ofarbi%
  INPUT #1,oremi%
  INPUT #1,ziehen%
  INPUT #1,zahl%
  INPUT #1,sav%
  INPUT #1,stil%
  INPUT #1,winkel%
  INPUT #1,gros%
  INPUT #1,modus%
  INPUT #1,v%
  INPUT #1,f%
  INPUT #1,mgross%
  INPUT #1,mfarb%
  INPUT #1,mtyp%
  INPUT #1,c%
  INPUT #1,ka%
  INPUT #1,fu%
  INPUT #1,ccc%
  INPUT #1,graf%
  INPUT #1,grk
  INPUT #1,form
  INPUT #1,bh
  INPUT #1,kj
  INPUT #1,anfang
  INPUT #1,schluss
  INPUT #1,musteri
  INPUT #1,kuligunde
  INPUT #1,aposition%
  INPUT #1,eposition%
  INPUT #1,s_bereich_x%
  INPUT #1,s_bereich_y%
  INPUT #1,z_linie_g%
  INPUT #1,zitter1%
  INPUT #1,zitter2%
  INPUT #1,xrast%
  INPUT #1,yrast%
  INPUT #1,laufi%
  INPUT #1,erlauf%
  INPUT #1,ursus1
  INPUT #1,ursus2
  INPUT #1,ti$
  INPUT #1,da$
  INPUT #1,zacken%
  INPUT #1,zacken1%
  INPUT #1,hintergrund%
  INPUT #1,ver_mod%
  INPUT #1,clip1%
  INPUT #1,clip2%
  INPUT #1,clip3%
  INPUT #1,clip4%
  IF hintergrund%=2
    SETCOLOR 0,0
  ELSE
    SETCOLOR 0,1
  ENDIF
  SETTIME ti$,da$
  GOSUB rahmung(c%-3)
  CLOSE #1
ENDIF
IF ursus1=0 AND ursus2=0
  ursus2=200
  ursus1=320
ENDIF
IF lauf%=0
  lauf%=1
ENDIF
IF grk=FALSE
  grk=1
ENDIF
IF EXIST("\BACKUP.DOO")=TRUE
  GOSUB merge_bild
  BLOAD "\BACKUP.DOO",XBIOS(2)
  GOSUB zeige_bild
ENDIF
IF EXIST("\ARBEIT.DOO")=TRUE
  GOSUB merge_bild
  BLOAD "\ARBEIT.DOO",XBIOS(2)
  GOSUB zeige_bild
ENDIF
IF EXIST("\UPDATE.DOO")=TRUE
  GOSUB merge_bild
  BLOAD "\UPDATE.DOO",XBIOS(2)
  GOSUB zeige_bild
ENDIF
IF EXIST("\RETTEN.DOO")=TRUE
  GOSUB merge_bild
  BLOAD "\RETTEN.DOO",XBIOS(2)
  GOSUB zeige_bild
ENDIF
CHDRIVE lauf%
GOSUB himmel1
PROCEDURE auswerten1
  REPEAT
  UNTIL MOUSEK=0
  ON ERROR GOSUB fehlerio1
  SDPOKE &H4EE,1
  MENU KILL
  MENU OFF
  LOCAL d%,ld1$
  ld1$=menue1$(MENU(FALSE))
  IF NOT ld1$=" Schliese Datei "
    IF sav%=0 AND schreibe%=FALSE
      @clipping_aus
      GOSUB merge_bild
      CLS
      GOSUB zeige_bild
      IF schreibe%=FALSE
        CLOSE #1
        GOSUB kind
        DEFTEXT 1,FALSE,3,19
        GRAPHMODE 2
        TEXT 163,45,">>> Bild Namen vergeben <<<"
        PRINT AT(20,24);CHR$(27)+"p";" Bitte hier den Namen des Bildes eingeben.";CHR$(27)+"q"
        DEFFILL 1,2,FALSE
        PBOX 150,360,489,390
        CLR f$
        GOSUB datei_erfragen("*.*")
        IF f$=""
          f$="GRAFIK.LST"
        ENDIF
        GOSUB merge_bild
      ENDIF
      GOSUB clipping_an
    ENDIF
  ENDIF
  GOSUB grund
  IF c%=1
    GOSUB rahmung(1)
  ENDIF
  GOSUB auto1
  SHOWM
  zahl%=FALSE
  IF ld1$=" Undo "
    SWAP l$,g$
    SPUT l$
  ENDIF
  IF ld1$=" X-Kreis "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF fu%=1
          IF s_modus_1%=0
            CIRCLE a%,b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=1
            CIRCLE a%,b%,ABS(a%-x%)
            CIRCLE a%,399-b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=2
            CIRCLE a%,b%,ABS(a%-x%)
            CIRCLE 639-a%,b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=3
            CIRCLE a%,b%,ABS(a%-x%)
            CIRCLE 639-a%,b%,ABS(a%-x%)
            CIRCLE a%,399-b%,ABS(a%-x%)
            CIRCLE 639-a%,399-b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=4
            CIRCLE a%,b%,ABS(a%-x%)
            CIRCLE 639-a%,399-b%,ABS(a%-x%)
          ENDIF
        ELSE
          GRAPHMODE graf%
          IF s_modus_1%=0
            PCIRCLE a%,b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=1
            PCIRCLE a%,b%,ABS(a%-x%)
            PCIRCLE a%,399-b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=2
            PCIRCLE a%,b%,ABS(a%-x%)
            PCIRCLE 639-a%,b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=3
            PCIRCLE a%,b%,ABS(a%-x%)
            PCIRCLE 639-a%,b%,ABS(a%-x%)
            PCIRCLE a%,399-b%,ABS(a%-x%)
            PCIRCLE 639-a%,399-b%,ABS(a%-x%)
          ENDIF
          IF s_modus_1%=4
            PCIRCLE a%,b%,ABS(a%-x%)
            PCIRCLE 639-a%,399-b%,ABS(a%-x%)
          ENDIF
        ENDIF
      WEND
      WHILE MOUSEK=1
        IF s_modus_1%=0
          CIRCLE a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=1
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=2
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=3
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=4
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
      WEND
    UNTIL MOUSEK=2
  ENDIF
  IF ld1$=" Fadenkreuz"
    HIDEM
    s:
    GOSUB zeige_bild
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      DRAW x%,FALSE TO x%,400
      DRAW FALSE,y% TO 640,y%
      PAUSE 3
      VSYNC
      IF x%<>MOUSEX OR y%<>MOUSEY
        GOSUB merge_bild
      ENDIF
      IF MOUSEK=2
        GOTO weiterio
      ENDIF
    UNTIL MOUSEK=1
    IF schreibe%=FALSE
      @saven
      IF oremi%=FALSE AND zahl%=FALSE
        PRINT #1,"' ********** Fadenkreuz **********"
      ENDIF
      IF zahl%=FALSE
        GOSUB tasche
        PRINT #1,"Draw val(";CHR$(34);"&H";CHR$(34);"+x$),FALSE TO val(";CHR$(34);"&H";CHR$(34);"+x$),400"
        PRINT #1,"Draw FALSE,val(";CHR$(34);"&H";CHR$(34);"+y$) to 640,val(";CHR$(34);"&H";CHR$(34);"+y$)"
        GOSUB bums
      ENDIF
      PRINT #1,HEX$(x%);",";HEX$(y%);
      GOSUB fot
    ENDIF
    GOTO s
    weiterio:
    GOSUB eimer
  ENDIF
  IF ld1$=" Update  Bild "
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      HIDEM
      BSAVE "\UPDATE.DOO",XBIOS(2),32000
    ENDIF
  ENDIF
  IF ld1$=" X-Ellips "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF fu%=1
          IF s_modus_1%=0
            ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=1
            ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=2
            ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=3
            ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=4
            ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
        ELSE
          IF s_modus_1%=0
            PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=1
            PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=2
            PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=3
            PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
          IF s_modus_1%=4
            PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            PELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ENDIF
        ENDIF
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF s_modus_1%=0
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=1
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=2
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=3
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=4
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
      WEND
    UNTIL MOUSEK=2
  ENDIF
  IF ld1$=" Save    Bild "
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      CLOSE #1
      SPUT l$
      GRAPHMODE 1
      COLOR 1
      ALERT FALSE,"--------- Save Bild ---------",1,"Doodle|Anderes|ZurÅck",formatspeich%
      IF formatspeich%=2
        PRINT AT(29,1);"Bild speichern  Bild Nr ";bild1%
        PRINT CHR$(27)+"p";
        PRINT AT(11,2);" ";STRING$(21,45);" Bild  speichern ";STRING$(20,45);" "
        PRINT CHR$(27)+"q"
        DEFFILL 1,2,FALSE
        PBOX 80,30,559,387
        DEFFILL 1,FALSE,FALSE
        PBOX 87,37,553,381
        BOX 86,36,554,382
        BOX 88,38,552,380
        BOX 90,40,550,378
        BOX 92,42,548,376
        BOX 93,43,547,375
        DRAW 93,64 TO 547,64
        DRAW 93,65 TO 547,65
        DRAW 93,67 TO 547,67
        DRAW 93,69 TO 547,69
        DRAW 93,70 TO 547,70
        DEFTEXT 1,4,8,6
        TEXT 105,55,"Zeichenprogramm    Format    Zeichenprogramm    Format"
        DRAW 317,43 TO 317,65
        DRAW 318,43 TO 318,65
        DRAW 320,43 TO 320,65
        DRAW 322,43 TO 322,65
        DRAW 323,43 TO 323,65
        DRAW 317,70 TO 317,375
        DRAW 318,70 TO 318,375
        DRAW 320,70 TO 320,375
        DRAW 322,70 TO 322,375
        DRAW 323,70 TO 323,375
        DEFTEXT 1,FALSE,8,6
        TEXT 105,90,"Constructive Paint  ???"
        TEXT 105,115,"Little Painter      LTP"
        TEXT 105,140,"The ArtiST          ART"
        TEXT 105,165,"Binary IMAGE Format BIF"
        TEXT 105,190,"Irgendwas           ???"
        REPEAT
          IF MOUSEX>93 AND MOUSEX<315 AND MOUSEK=1
            ' ***** Constructive Paint *****
            IF MOUSEY>70 AND MOUSEY<100
              GOSUB intro_save_bild
              GOSUB datei_erfragen("*.*")
              IF f$<>"" AND NOT f$=" "
                GOSUB merge_bild
                HIDEM
                BSAVE f$,XBIOS(2),32000
                GOSUB zeige_bild
              ENDIF
              GOTO xmes
            ENDIF
            ' ****** Little Painter *****
            IF MOUSEY>100 AND MOUSEY<125
              GOSUB intro_save_bild
              GOSUB datei_erfragen("*.LTP")
              IF EXIST(f$)=TRUE
                ALERT 3,"Bild mit diesem Namen|schon vorhanden.|Soll altes Bild|Åberschrieben werden.",2,"Ja|Nein",d%
              ENDIF
              IF d%=2
                GOTO kneifzange
              ENDIF
              IF d%=1 OR f$<>""
                GOSUB merge_bild
                HIDEM
                @sv_cprsd(f$)
                GOSUB zeige_bild
              ENDIF
              GOTO xmes
            ENDIF
            ' ***** The Artist *****
            IF MOUSEY>125 AND MOUSEY<150
              GOSUB intro_save_bild
              GOSUB datei_erfragen("*.ART")
              IF f$<>"" AND NOT f$=" "
                GOSUB merge_bild
                HIDEM
                BSAVE f$,XBIOS(2),32000
                GOSUB zeige_bild
              ENDIF
              GOTO xmes
            ENDIF
            ' ***** Binary IMAGE Format  (BIF) *****
            IF MOUSEY>150 AND MOUSEY<175
              GOSUB intro_save_bild
              GOSUB datei_erfragen("*.BIF")
              IF f$<>"" AND NOT f$=" "
                GOSUB merge_bild
                HIDEM
                BSAVE f$,XBIOS(2),32000
                GOSUB zeige_bild
              ENDIF
              GOTO xmes
            ENDIF
            IF MOUSEY>175 AND MOUSEY<200
              GOSUB intro_save_bild
              GOSUB datei_erfragen("*.*")
              IF f$<>"" AND NOT f$=" "
                GOSUB merge_bild
                HIDEM
                BSAVE f$,XBIOS(2),32000
                GOSUB zeige_bild
              ENDIF
              GOTO xmes
            ENDIF
          ENDIF
        UNTIL MOUSEK=2
        xmes:
      ENDIF
      GOSUB was1
    ENDIF
    IF formatspeich%=1
      GOSUB intro_save_bild
      GOSUB datei_erfragen("*.DOO")
      IF EXIST(f$)=TRUE
        ALERT 3,"Bild mit diesem Namen|schon vorhanden.|Soll altes Bild|Åberschrieben werden.",2,"Ja|Nein",d%
      ENDIF
      IF d%=2
        GOTO kneifzange
      ENDIF
      IF d%=1 OR f$<>""
        GOSUB merge_bild
        HIDEM
        BSAVE f$,XBIOS(2),32000
        GOSUB zeige_bild
      ENDIF
      GOSUB merge_bild
      GOSUB grund
    ENDIF
    GOSUB was1
  ENDIF
  IF ld1$=" Save    Block "
    CLR block$
    GOSUB hals
    PRINT AT(29,1);"Block speichern  Block Nr ";bild1%
    PRINT CHR$(27)+"p";
    PRINT AT(11,2);" ";STRING$(20,45);" Block  speichern ";STRING$(21,45)
    PRINT CHR$(27)+"q"
    DEFFILL 1,2,FALSE
    PBOX 80,30,559,387
    DEFFILL 1,FALSE,FALSE
    PBOX 87,37,553,381
    BOX 86,36,554,382
    BOX 88,38,552,380
    BOX 90,40,550,378
    BOX 92,42,548,376
    BOX 93,43,547,375
    DRAW 93,64 TO 547,64
    DRAW 93,65 TO 547,65
    DRAW 93,67 TO 547,67
    DRAW 93,69 TO 547,69
    DRAW 93,70 TO 547,70
    DEFTEXT 1,4,8,6
    TEXT 105,55,"Zeichenprogramm    Format    Zeichenprogramm    Format"
    DRAW 317,43 TO 317,65
    DRAW 318,43 TO 318,65
    DRAW 320,43 TO 320,65
    DRAW 322,43 TO 322,65
    DRAW 323,43 TO 323,65
    DRAW 317,70 TO 317,375
    DRAW 318,70 TO 318,375
    DRAW 320,70 TO 320,375
    DRAW 322,70 TO 322,375
    DRAW 323,70 TO 323,375
    DEFTEXT 1,FALSE,8,6
    TEXT 105,90,"Block Format        BLO"
    TEXT 105,115,"HjB Paint           BLK"
    TEXT 105,140,"Tiny Draw           BLK"
    REPEAT
      IF MOUSEX>93 AND MOUSEX<315 AND MOUSEK=1
        IF MOUSEY>70 AND MOUSEY<100 AND MOUSEK=1
          ' *** Block Format ***
          GOSUB intro_save_block
          GOSUB datei_erfragen("*.BLO")
          IF f$<>"" AND NOT f$=" "
            v_schon%=0
            IF EXIST(f$)
              ALERT 0,"Block mit diesen|Namen schon vorhanden|soll ich Block|Åberschreiben ?",2," JA |NEIN",v_schon%
            ENDIF
            IF v_schon%<>2
              OPEN "O",#1,f$
              PRINT #1,MKI$(LEN(block$));block$
              CLOSE #1
            ENDIF
          ENDIF
          GOTO hildegard7
        ENDIF
        IF MOUSEY>100 AND MOUSEY<125 AND MOUSEK=1
          ' *** HjB Paint
          GOSUB kupfer
          GOTO hildegard7
        ENDIF
        IF MOUSEY>125 AND MOUSEY<150 AND MOUSEK=1
          ' *** Tiny Draw ***
          GOSUB kupfer
          GOTO hildegard7
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    hildegard7:
    GOSUB was1
  ENDIF
  IF ld1$=" Lade    Bild "
    ALERT 3,"Welches Bild mîchten|Sie den bitteschîn laden?",1,"Doodle|Anderes|ZurÅck",d%
    IF d%=3
      GOTO fox27
    ENDIF
    GOSUB hals
    IF d%=1
      GOSUB intro_lade_bild
      GOSUB datei_erfragen("*.DOO")
      IF EXIST(f$)=0
        ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
        GOTO fox27
      ENDIF
      GOSUB radio5(f$)
    ELSE
      GOSUB hans
      TEXT 105,90,"Andromeda           PIC"
      TEXT 105,115,"Columbia            CLI"
      TEXT 105,140,"Degas               PI3"
      TEXT 105,165,"Degas               PI2"
      TEXT 105,190,"GFA Painter         PI3"
      TEXT 105,215,"Grafiker            PIC"
      TEXT 105,240,"Graf Pro            PRO"
      TEXT 105,265,"Hjb Paint           PIC"
      TEXT 105,290,"Little Painter      LTP"
      TEXT 105,315,"Masterpaint         PIC"
      TEXT 105,340,"Mini Painter        PIC"
      TEXT 105,365,"Monostar            ART"
      TEXT 338,90,"Paintlux            DOO"
      TEXT 338,115,"Paintworks          SC2"
      TEXT 338,140,"Porky Paint         PRO"
      TEXT 338,165,"Power Paint         PAI"
      TEXT 338,190,"Profi Painter       PIC"
      TEXT 338,215,"Public Painter      DOO"
      TEXT 338,240,"Screen Format       PIC"
      TEXT 338,265,"Struktur Painter    PIC"
      TEXT 338,290,"Tiny Draw V2.20     PIC"
      TEXT 338,315,"Tristar Plus V2.10  BD "
      TEXT 338,340,"Vic Soft Painter    PIC"
      TEXT 338,365,"Weiter              ???"
      REPEAT
        IF MOUSEX>93 AND MOUSEX<315 AND MOUSEK=1
          ' ***** Andromeda *****
          IF MOUSEY>70 AND MOUSEY<100
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Columbia ***
          IF MOUSEY>100 AND MOUSEY<125
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.CLI")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
          ' *** Degas ***
          IF MOUSEY>125 AND MOUSEY<150
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PI3")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)-34
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Degas ***
          IF MOUSEY>150 AND MOUSEY<175
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PI2")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            GOSUB bild_konverter_2
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** GFA Painter ***
          IF MOUSEY>175 AND MOUSEY<200
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PI3")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)-34
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Grafiker ***
          IF MOUSEY>200 AND MOUSEY<225
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PIC")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)+5*640
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Graf Pro ***
          IF MOUSEY>225 AND MOUSEY<250
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PRO")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
          ' *** HjB Paint ***
          IF MOUSEY>250 AND MOUSEY<275
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Little Painter ***
          IF MOUSEY>275 AND MOUSEY<300
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.LTP")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            ALERT 0,"Wie wollen Sie das          |Bild Laden   ?",1,"Normal|Mischen|ZurÅck",mischen%
            IF mischen%=1
              CLS
            ENDIF
            IF mischen%=3
              GOTO fox27
            ENDIF
            @ld_cprsd(f$)
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Masterpaint ***
          IF MOUSEY>300 AND MOUSEY<325
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PIC")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)-34
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Mini Painter ***
          IF MOUSEY>325 AND MOUSEY<350
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Monostar ***
          IF MOUSEY>350 AND MOUSEY<375
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.ART")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
        ENDIF
        IF MOUSEX>323 AND MOUSEX<545 AND MOUSEK=1
          ' *** Paintlux ***
          IF MOUSEY>70 AND MOUSEY<100
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.DOO")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
          ' *** Paintworks ***
          IF MOUSEY>100 AND MOUSEY<125
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.SC2")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)-128
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Porky Paint ***
          IF MOUSEY>125 AND MOUSEY<150
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PRO")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
          ' *** Power Paint ***
          IF MOUSEY>150 AND MOUSEY<175
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PAI")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            IF f$<>"" AND NOT f$=" "
              ALERT FALSE," ØØØØ Power - Paint ÆÆÆÆ |       Bilder laden   ",2,"DIN A4|DIN A5|DIN A3",pr%
              IF pr%=3
                ALERT FALSE," ØØØØ Power - Paint ÆÆÆÆ |       Bilder laden   ",2,"Links | Rechts",a3%
                IF a3%=1
                  GOTO links
                ENDIF
                IF a3%=2
                  GOTO rechts
                ENDIF
              ENDIF
              IF pr%=2
                GOSUB radio5(f$)
                GOTO zzz
              ENDIF
              links:
              ALERT FALSE," ØØØØ Power - Paint ÆÆÆÆ |       Bilder laden | Links  ",2,"Oben|Unten",pr%
              IF pr%=1
                GOSUB radio5(f$)
                GOTO zzz
              ENDIF
              IF pr%=2
                IF f$<>"" AND NOT f$=" "
                  GOSUB merge_bild
                  OPEN "I",#1,f$
                  SEEK #1,32000
                  l$=INPUT$(32000,#1)
                  SPUT l$
                  CLOSE #1
                  GOSUB zeige_bild
                  GOTO zzz
                ENDIF
              ENDIF
              rechts:
              ALERT FALSE," ØØØØ Power - Paint ÆÆÆÆ |       Bilder laden | Rechts  ",2,"Oben|Unten",pr%
              IF pr%=1
                IF f$<>"" AND NOT f$=" "
                  GOSUB merge_bild
                  OPEN "I",#1,f$
                  SEEK #1,64000
                  l$=INPUT$(32000,#1)
                  SPUT l$
                  CLOSE #1
                  GOSUB zeige_bild
                  GOTO zzz
                ENDIF
              ENDIF
              IF pr%=2
                IF f$<>"" AND NOT f$=" "
                  GOSUB merge_bild
                  OPEN "I",#1,f$
                  SEEK #1,96000
                  l$=INPUT$(32000,#1)
                  CLOSE #1
                  GOSUB zeige_bild
                  GOTO zzz
                ENDIF
              ENDIF
              zzz:
            ENDIF
            GOTO fox27
          ENDIF
          ' *** Profi Painter ***
          IF MOUSEY>175 AND MOUSEY<200
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.PIC")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            ALERT FALSE," ØØØØ Profi - Painter ÆÆÆÆ |       Bilder laden   ",3,"Teil 1|Teil 2|ZurÅck",pr%
            IF pr%=1
              GOSUB merge_bild
              BLOAD f$,XBIOS(2)-34
              GOSUB zeige_bild
            ENDIF
            IF pr%=2
              GOSUB merge_bild
              OPEN "I",#1,f$
              SEEK #1,32034
              l$=INPUT$(32000,#1)
              SPUT l$
              CLOSE #1
              GOSUB zeige_bild
              GOTO fox27
            ENDIF
            GOTO fox27
          ENDIF
          ' *** Public Painter ***
          IF MOUSEY>200 AND MOUSEY<225
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.DOO")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB radio5(f$)
            GOTO fox27
          ENDIF
          ' *** Struktur Painter ***
          IF MOUSEY>225 AND MOUSEY<250
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Screen Format ***
          IF MOUSEY>250 AND MOUSEY<275
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Tiny Draw ***
          IF MOUSEY>275 AND MOUSEY<300
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' *** Tristar ***
          IF MOUSEY>300 AND MOUSEY<325
            GOSUB intro_lade_bild
            GOSUB datei_erfragen("*.BD")
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO fox27
            ENDIF
            GOSUB merge_bild
            BLOAD f$,XBIOS(2)-6
            GOSUB zeige_bild
            GOTO fox27
          ENDIF
          ' *** Vic Soft Painter ***
          IF MOUSEY>325 AND MOUSEY<350
            GOSUB hans1
            GOTO fox27
          ENDIF
          ' >>>>>>>>>>>>>>>>> MenÅ 2 <<<<<<<<<
          IF MOUSEY>350 AND MOUSEY<375
            GOSUB hans
            TEXT 105,90,"Constructive Paint  ???"
            TEXT 105,115,"The ArtiST          ART"
            TEXT 105,140,"Stad                PAC"
            TEXT 105,165,"DIN A4              PIC"
            TEXT 105,190,"Screen              PIC"
            TEXT 105,215,"The Paint V2.0      PIC"
            TEXT 105,240,"Malen 10            PIC"
            TEXT 105,265,"Bitmap              IMG"
            TEXT 105,290,"Binary IMAGE Format BIF"
            TEXT 105,315,"Irgendwas           ???"
            REPEAT
              IF MOUSEX>93 AND MOUSEX<315 AND MOUSEK=1
                ' *** Constructive Paint ***
                IF MOUSEY>70 AND MOUSEY<100
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.*")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOTO fox27
                ENDIF
                ' *** The ArtiST ***
                IF MOUSEY>100 AND MOUSEY<125
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.ART")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOTO fox27
                ENDIF
                ' *** Stad ***
                IF MOUSEY>125 AND MOUSEY<150
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.PAC")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB lade_stad
                  GOTO fox27
                ENDIF
                ' *** DIN A4 PIC ***
                IF MOUSEY>150 AND MOUSEY<175
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.PIC")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  ALERT FALSE," ØØØØ DIN A 4 (PIC)  ÆÆÆÆ |       Bilder laden   ",2,"Oben|Unten",pr%
                  IF pr%=1
                    GOSUB radio5(f$)
                    GOTO zzz9
                  ENDIF
                  IF pr%=2
                    IF f$<>"" AND NOT f$=" "
                      GOSUB merge_bild
                      OPEN "I",#1,f$
                      SEEK #1,32000
                      l$=INPUT$(32000,#1)
                      SPUT l$
                      CLOSE #1
                      GOSUB zeige_bild
                      GOTO zzz9
                    ENDIF
                  ENDIF
                  zzz9:
                  GOTO fox27
                ENDIF
                ' *** SCREEN PIC ***
                IF MOUSEY>175 AND MOUSEY<200
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.PIC")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOTO fox27
                ENDIF
                ' *** The Paint V2.0 ***
                IF MOUSEY>200 AND MOUSEY<225
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.PIC")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB merge_bild
                  BLOAD f$,XBIOS(2)-34
                  GOSUB zeige_bild
                  GOTO fox27
                ENDIF
                ' *** Malen 10 ***
                IF MOUSEY>225 AND MOUSEY<250
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.PIC")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOTO fox27
                ENDIF
                ' *** Bitmap.IMG ***
                IF MOUSEY>250 AND MOUSEY<275
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.IMG")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  PRINT AT(23,10);"Bitte Warten IMG Bild wird entpackt."
                  PRINT AT(22,11);"Dank an Marc Saul fÅr IMG Laderoutine"
                  GOSUB lade_img
                  GOSUB zeige_bild
                  GOTO fox27
                ENDIF
                ' *** Binary IMAGE Format (BIF) ***
                IF MOUSEY>275 AND MOUSEY<300
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.BIF")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOSUB zeige_bild
                  GOTO fox27
                ENDIF
                ' *** Irgendwas ***
                IF MOUSEY>300 AND MOUSEY<325
                  GOSUB intro_lade_bild
                  GOSUB datei_erfragen("*.*")
                  IF EXIST(f$)=0
                    ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                    GOTO fox27
                  ENDIF
                  GOSUB radio5(f$)
                  GOTO fox27
                ENDIF
              ENDIF
            UNTIL MOUSEK=2
            GOTO fox27
          ENDIF
        ENDIF
      UNTIL MOUSEK=2
    ENDIF
    ' **** Unbekannt ****
    fox27:
    GOSUB was1
  ENDIF
  IF ld1$=" Lade    Block"
    GOSUB hals
    PRINT AT(29,1);"Block einladen  Bild Nr ";bild1%
    PRINT CHR$(27)+"p";
    PRINT AT(11,2);" ";STRING$(22,45);" Block  laden ";STRING$(22,45);" "
    PRINT CHR$(27)+"q"
    DEFFILL 1,2,FALSE
    PBOX 80,30,559,387
    DEFFILL 1,FALSE,FALSE
    PBOX 87,37,553,381
    BOX 86,36,554,382
    BOX 88,38,552,380
    BOX 90,40,550,378
    BOX 92,42,548,376
    BOX 93,43,547,375
    DRAW 93,64 TO 547,64
    DRAW 93,65 TO 547,65
    DRAW 93,67 TO 547,67
    DRAW 93,69 TO 547,69
    DRAW 93,70 TO 547,70
    DEFTEXT 1,4,8,6
    TEXT 105,55,"Zeichenprogramm    Format    Zeichenprogramm    Format"
    DRAW 317,43 TO 317,65
    DRAW 318,43 TO 318,65
    DRAW 320,43 TO 320,65
    DRAW 322,43 TO 322,65
    DRAW 323,43 TO 323,65
    DRAW 317,70 TO 317,375
    DRAW 318,70 TO 318,375
    DRAW 320,70 TO 320,375
    DRAW 322,70 TO 322,375
    DRAW 323,70 TO 323,375
    DEFTEXT 1,FALSE,8,6
    TEXT 105,90,"Block Format        BLO"
    TEXT 105,115,"Columbia            BLK"
    TEXT 105,140,"Degas               BL3"
    TEXT 105,165,"GFA - Format        BLK"
    TEXT 105,190,"GFA Painter         BLK"
    TEXT 105,215,"Hjb Paint           BLK"
    TEXT 105,240,"Malen_10            BLK"
    TEXT 105,265,"Mini Painter        BLK"
    TEXT 105,290,"Monostar            OBJ"
    TEXT 105,315,"Stad                PUF"
    TEXT 105,340,"Tini Draw V2.20     BLK"
    TEXT 105,365,"Tristar Plus        SH3"
    TEXT 338,90,"Star Designer Demo  BLK"
    TEXT 338,115,"Porky Paint         BLK"
    TEXT 338,140,"Simple Draw V3.4    BL3"
    REPEAT
      IF MOUSEX>93 AND MOUSEX<315 AND MOUSEK=1
        ' *** Block Format ***
        IF MOUSEY>70 AND MOUSEY<100
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.BLO")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO fox28
          ENDIF
          GOSUB merge_bild
          HIDEM
          OPEN "I",#1,f$
          block$=INPUT$(CVI(INPUT$(2,#1)),#1)
          CLOSE #1
          GOSUB kopieren
          GOSUB zeige_bild
          GOTO fox28
        ENDIF
        ' *** Columbia ***
        IF MOUSEY>100 AND MOUSEY<125
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.BLK")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO fox28
          ENDIF
          IF f$<>"" AND NOT f$=" "
            OPEN "I",#1,f$
            GOSUB merge_bild
            INPUT #1,blx%,bly%,de%
            a%=1
            REPEAT
              INPUT #1,a
              block$=block$+CHR$(a)
              INC a%
            UNTIL a%=de%+1
            CLOSE #1
            DO
              MOUSE mousex,mousey,mousek
              PUT MOUSEX+blx%,MOUSEY+bly%,block$,6
              DO
                EXIT IF MOUSEK>0
                IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
                  GOSUB merge_bild
                  PUT MOUSEX+blx%,MOUSEY+bly%,block$,6
                ENDIF
              LOOP
              EXIT IF MOUSEK>0
            LOOP
            IF MOUSEK=1
              PUT MOUSEX+blx%,MOUSEY+bly%,block$,modus%
            ENDIF
            IF MOUSEK=2
              GOSUB merge_bild
            ENDIF
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
        ' *** Degas ***
        IF MOUSEY>125 AND MOUSEY<150
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.BL3")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO fox28
          ENDIF
          GOSUB merge_bild
          RESTORE lp
          IF f$<>"" AND NOT f$=" "
            OPEN "i",#1,f$
            block$=INPUT$(LOF(#1),#1)
            block%=VARPTR(block$)
            CLOSE
            GOSUB merge_bild
            IF LEFT$(block$,4)="FORM" THEN
              breit%=DPEEK(block%+20)-1
              hoch_%=DPEEK(block%+22)-1
              aufl_%=PEEK(block%+28)
              pixel$=RIGHT$(block$,LEN(block$)-62)
            ELSE
              CLR aufl_%
            ENDIF
            block$=MKI$(breit%)+MKI$(hoch_%)+MKI$(1)+pixel$
            REPEAT
              PUT MOUSEX,MOUSEY,block$,6
              VSYNC
              GOSUB merge_bild
            UNTIL MOUSEK=1
            PUT MOUSEX,MOUSEY,block$,modus%
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
        ' *** GFA Format ***
        IF MOUSEY>150 AND MOUSEY<175
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** GFA Painter ***
        IF MOUSEY>175 AND MOUSEY<200
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** Malen 10 ***
        IF MOUSEY>200 AND MOUSEY<225
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** HjB Paint ***
        IF MOUSEY>225 AND MOUSEY<250
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** Mini Painter ***
        IF MOUSEY>250 AND MOUSEY<275
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.BLK")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO fox28
          ENDIF
          GOSUB merge_bild
          HIDEM
          IF f$<>"" AND NOT f$=" "
            OPEN "I",#1,f$
            INPUT #1,laenge
            block$=INPUT$(laenge,#1)
            CLOSE #1
            DO
              REPEAT
                x=MOUSEX
                y=MOUSEY
                PUT x,y,block$,6
                REPEAT
                UNTIL x<>MOUSEX OR y<>MOUSEY OR MOUSEK<>FALSE
                PUT x,y,block$,6
              UNTIL MOUSEK<>FALSE
              EXIT IF MOUSEK=1
              PUT x,y,block$,6
            LOOP
            PUT x,y,block$,modus%
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
        ' *** Monostar ***
        IF MOUSEY>275 AND MOUSEY<300
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.OBJ")
          HIDEM
          GOSUB merge_bild
          SGET l$
          IF EXIST(f$)
            OPEN "i",#1,f$
            block$=INPUT$(LOF(#1),#1)
            CLOSE #1
            GOSUB merge_bild
            @kopieren
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
        ' *** Stad Format ***
        IF MOUSEY>300 AND MOUSEY<325
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.PUF")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO fox28
          ENDIF
          GOSUB merge_bild
          IF f$<>"" AND NOT f$=" "
            OPEN "I",#1,f$
            block$=INPUT$(LOF(#1),#1)
            block%=VARPTR(block$)
            CLOSE
            GOSUB merge_bild
            breit%=DPEEK(block%+2)
            hoch_%=DPEEK(block%)
            pixel$=RIGHT$(block$,LEN(block$)-4)
            block$=MKI$(breit%)+MKI$(hoch_%)+MKI$(1)+pixel$
            REPEAT
              PUT MOUSEX,MOUSEY,block$,6
              VSYNC
              GOSUB merge_bild
            UNTIL MOUSEK=1
            PUT MOUSEX,MOUSEY,block$,modus%
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
        ' *** Tiny Draw ***
        IF MOUSEY>325 AND MOUSEY<350
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** Tristar Plus ***
        IF MOUSEY>350 AND MOUSEY<375
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.SH3")
          HIDEM
          GOSUB merge_bild
          SGET l$
          IF EXIST(f$)
            OPEN "i",#1,f$
            block$=INPUT$(LOF(#1),#1)
            CLOSE #1
            GOSUB merge_bild
            @kopieren
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
      ENDIF
      IF MOUSEX>323 AND MOUSEX<545 AND MOUSEK=1
        ' *** Star Designer ***
        IF MOUSEY>70 AND MOUSEY<100
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** Porky Paint ***
        IF MOUSEY>100 AND MOUSEY<125
          GOSUB radio3
          GOTO fox28
        ENDIF
        ' *** Simple Draw V3.4 ***
        IF MOUSEY>125 AND MOUSEY<150
          GOSUB intro_lade_block
          GOSUB datei_erfragen("*.BL3")
          HIDEM
          GOSUB merge_bild
          SGET l$
          IF EXIST(f$)
            OPEN "i",#1,f$
            block$=INPUT$(LOF(#1),#1)
            CLOSE #1
            GOSUB merge_bild
            @kopieren
            GOSUB zeige_bild
          ENDIF
          GOTO fox28
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    SPUT l$
    RESTORE
    fox28:
    GOSUB was1
  ENDIF
  IF ld1$=" Restart "
    ALERT 3,"Wollen Sie wirklich einen|Restart durchfÅhren   ?|Programm wird dadurch in|Anfangszustand versetzt.",2,"Ja|Nein",d%
    IF d%=1
      RUN
    ENDIF
  ENDIF
  IF ld1$=" Optimierer "
    GOSUB clipping_aus
    IF c%=FALSE
      ' ********** Rahmung ein **********
      GOSUB rahmung(c%+1)
      c%=FALSE
    ENDIF
    DEFMOUSE 3
    SPUT l$
    DEFFILL 1,2,4
    PBOX TRUE,TRUE,640,400
    DEFTEXT 1,2,3,32
    TEXT 8,27," >>>>>>>>>> Code Optimierer <<<<<<<<<< "
    PRINT AT(2,3);CHR$(27)+"p";" -- (c) 1998 by Siegfried HÅbner, St.-Gundekar-Str. 29 b, 91560 Heilsbronn -- ";CHR$(27)+"q"
    DEFTEXT 1,FALSE,3,10
    TEXT 408,80,"^^ Rem Zeilen ^^"
    GRAPHMODE 2
    DEFFILL 1,2,3
    PBOX 400,60,630,200
    GRAPHMODE 1
    PBOX 400,90,630,200
    DEFFILL 1,2,3
    PBOX 420,110,500,180
    PBOX 530,110,610,180
    DEFTEXT 1,16,2,32
    IF oremi%=FALSE
      TEXT 434,155,"Ein"
    ELSE
      TEXT 545,155,"Aus"
    ENDIF
    PBOX 150,60,380,200
    PBOX 150,90,380,200
    DEFTEXT 1,FALSE,3,10
    TEXT 152,80," Farb Optimierer "
    GRAPHMODE 2
    DEFFILL 1,2,3
    PBOX 170,110,260,180
    GRAPHMODE 1
    PBOX 280,110,360,180
    DEFFILL 1,2,3
    DEFTEXT 1,16,2,32
    IF ofarbi%=FALSE
      TEXT 190,155,"Ein"
    ELSE
      TEXT 295,155,"Aus"
    ENDIF
    GRAPHMODE 1
    DEFTEXT 1,16,2,32
    TEXT 165,240,"ZurÅck = Rechte Maustaste"
    GRAPHMODE 2
    DEFFILL 1,2,3
    PBOX 148,205,630,250
    ' ********** Listing Generator **********
    DEFTEXT 2,2,3,20
    TEXT 18,80,110,"Listing"
    TEXT 12,100,128,"Generator"
    GRAPHMODE 2
    PBOX 10,60,140,110
    GRAPHMODE 1
    PBOX 10,110,140,250
    DEFFILL 1,2,7
    PBOX 20,120,70,240
    PBOX 80,120,130,240
    DEFTEXT 1,2,3,32
    IF schreibe%=FALSE
      TEXT 22,190,"Ein"
    ELSE
      CLOSE #1
      TEXT 82,190,"Aus"
    ENDIF
    REPEAT
      IF MOUSEK=1
        IF MOUSEY>120 AND MOUSEY<240
          IF MOUSEX>19 AND MOUSEX<69
            GRAPHMODE 1
            DEFFILL 1,2,FALSE
            PBOX 80,120,130,240
            DEFFILL 1,2,4
            PBOX 20,120,70,240
            DEFTEXT 1,2,3,32
            TEXT 22,190,"Ein"
            schreibe%=FALSE
          ENDIF
          IF MOUSEX>89 AND MOUSEX<129
            GRAPHMODE 1
            DEFFILL 1,2,FALSE
            PBOX 20,120,70,240
            DEFFILL 1,2,4
            PBOX 80,120,130,240
            DEFTEXT 1,2,3,32
            TEXT 82,190,"Aus"
            schreibe%=1
          ENDIF
        ENDIF
        IF MOUSEY>110 AND MOUSEY<180
          IF MOUSEX>170 AND MOUSEX<260
            GRAPHMODE 2
            DEFFILL 1,2,4
            PBOX 170,110,260,180
            DEFFILL 1,2,3
            GRAPHMODE 1
            PBOX 280,110,360,180
            DEFTEXT 1,16,2,32
            TEXT 190,155,"Ein"
            ofarbi%=FALSE
          ENDIF
          IF MOUSEX>280 AND MOUSEX<360
            GRAPHMODE 2
            DEFFILL 1,2,4
            PBOX 280,110,360,180
            DEFFILL 1,2,3
            GRAPHMODE 1
            PBOX 170,110,260,180
            DEFTEXT 1,16,2,32
            TEXT 295,155,"Aus"
            ofarbi%=1
          ENDIF
          IF MOUSEX>420 AND MOUSEX<500
            GRAPHMODE 2
            DEFFILL 1,2,4
            PBOX 420,110,500,180
            DEFFILL 1,2,3
            GRAPHMODE 1
            PBOX 530,110,610,180
            DEFTEXT 1,16,2,32
            TEXT 434,155,"Ein"
            oremi%=FALSE
          ENDIF
          IF MOUSEX>530 AND MOUSEX<610
            GRAPHMODE 2
            DEFFILL 1,2,4
            PBOX 530,110,610,180
            DEFFILL 1,2,3
            GRAPHMODE 1
            PBOX 420,110,500,180
            DEFTEXT 1,16,2,32
            TEXT 545,155,"Aus"
            oremi%=1
          ENDIF
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    GOSUB merge_bild
    GOSUB was1
  ENDIF
  IF ld1$=" Markerarten "
    GOSUB clipping_aus
    GRAPHMODE 1
    DIM s(0),f(0)
    s(i)=170
    f(i)=200
    SPUT l$
    HIDEM
    DEFFILL 1,2,3
    PBOX 10,10,630,390
    DEFFILL 1,2,4
    DEFTEXT 1,FALSE,3,32
    TEXT 17,45," >>>>>>> Marker Einstellungen <<<<<<< "
    DEFFILL FALSE,2,5
    mfarb%=1
    mtyp%=2
    mgross%=100
    DEFLINE 1,FALSE,2,2
    PBOX 358,61,625,375
    PRINT AT(46,5);CHR$(27)+"p";" - F = Markerfarbe einstellen -- ";CHR$(27)+"q"
    PRINT AT(56,6);"Farbe "
    PRINT AT(70,6);mfarb%
    PRINT AT(46,8);CHR$(27)+"p";" - T = Markertyp einstellen ---- ";CHR$(27)+"q"
    PRINT AT(56,9);"Typ   "
    PRINT AT(70,9);mtyp%
    PRINT AT(46,11);CHR$(27)+"p";" - G =  Markergrîûe einstellen - ";CHR$(27)+"q"
    PRINT AT(56,12);"Grîûe "
    PRINT AT(70,12);mgross%
    PRINT AT(46,14);CHR$(27)+"p";" - Was wollen Sie Ñndern ? ----- ";CHR$(27)+"q"
    PRINT AT(46,16);"Anfangsbuchstaben bitte eingeben"
    PRINT AT(47,18);"F = Farbe         (0...1)"
    PRINT AT(47,19);"T = Typ           (0...7)"
    PRINT AT(47,20);"G = Grîûe    (0,20,40,60,80,100)"
    PRINT AT(47,21);"N = ZurÅck       zum Programm"
    PRINT AT(47,22);"                 oder Mausklick"
    GOSUB polen
    REPEAT
      PRINT AT(47,23);CHR$(27)+"p";" Ihre Eingabe ";CHR$(27)+"q";" ";
      eingabe$=INKEY$
      eingabe$=UPPER$(eingabe$)
      ' ******* Farbe *********
      IF eingabe$="F"
        PRINT AT(70,6);
        FORM INPUT 4,mfarb$
        mfarb%=VAL(mfarb$)
        GOSUB polen
      ENDIF
      ' ***** Typ *************
      IF eingabe$="T"
        PRINT AT(70,9);
        FORM INPUT 2,mtyp$
        mtyp%=VAL(mtyp$)
        GOSUB polen
      ENDIF
      ' ***** Grîûe **************
      IF eingabe$="G"
        PRINT AT(70,12);
        FORM INPUT 3,mgross$
        mgross%=VAL(mgross$)
        GOSUB polen
      ENDIF
    UNTIL eingabe$="N" OR MOUSEK
    GOSUB merge_bild
    IF schreibe%=FALSE
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Einstellung des Markers *****"
      ENDIF
      PRINT #1,"DEFMARK ";mfarb%;",";mtyp%;",";mgross%
    ENDIF
    log=1
    ERASE s()
    ERASE f()
    GOSUB was1
  ENDIF
  IF ld1$=" Laufwerk "
    ' ******* Ermittle Laufwerk *******
    erlaufer=BIOS(&HA)
    erlauf%=LEN(BIN$(erlaufer))
    laufn:
    CHDRIVE lauf%
    ALERT 1,"Welches Laufwerk wÅnschen Sie?| |       Laufwerk "+CHR$(lauf%+64)+" ",2,"Grîûer|OK|Kleiner",d%
    IF d%=1
      INC lauf%
      IF lauf%=>erlauf%
        lauf%=erlauf%
      ENDIF
      IF lauf%>15
        lauf%=1
      ENDIF
      GOTO laufn
    ENDIF
    IF d%=3
      IF lauf%=1
        lauf%=2
      ENDIF
      DEC lauf%
      GOTO laufn
    ELSE
      CHDRIVE lauf%
    ENDIF
  ENDIF
  IF ld1$=" Marker "
    DIM s(0),f(0)
    ALERT FALSE,"Wollen Sie einzelne Marker  |setzen, oder wollen Sie mit|den Markern zeichnen ?",1,"Setzen|Zeichnen",ad%
    IF ccc%=1
      IF ad%=2
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
          WEND
          GOSUB sonne
          IF ofarbi%=FALSE
            IF POINT(MOUSEX,MOUSEY)=FALSE
              GOSUB frau
            ENDIF
          ELSE
            GOSUB frau
          ENDIF
        UNTIL MOUSEK=2
      ELSE
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
            GOSUB sonne
          WEND
          IF ofarbi%=FALSE
            IF POINT(MOUSEX,MOUSEY)=FALSE
              GOSUB frau
            ENDIF
          ELSE
            GOSUB frau
          ENDIF
        UNTIL MOUSEK=2
      ENDIF
    ELSE
      IF ad%=2
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
          WEND
          GOSUB sonne
          IF ofarbi%=FALSE
            IF POINT(MOUSEX,MOUSEY)=1
              GOSUB frau
            ENDIF
          ELSE
            GOSUB frau
          ENDIF
        UNTIL MOUSEK=2
      ELSE
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
            GOSUB sonne
          WEND
          IF ofrabi=FALSE
            IF POINT(MOUSEX,MOUSEY)=1
              GOSUB frau
            ENDIF
          ELSE
            GOSUB frau
          ENDIF
        UNTIL MOUSEK=2
      ENDIF
    ENDIF
    IF ofarbi%=1
      IF ad%=2
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
          WEND
          GOSUB sonne
          GOSUB frau
        UNTIL MOUSEK=2
      ELSE
        REPEAT
          WHILE MOUSEK<>1
            IF MOUSEK=2
              GOTO samuray
            ENDIF
            GOSUB sonne
          WEND
          GOSUB frau
        UNTIL MOUSEK=2
      ENDIF
    ENDIF
    samuray:
    IF zahl%>FALSE AND schreibe%=FALSE
      PRINT #1,"0,0"
    ENDIF
    ERASE f()
    ERASE s()
  ENDIF
  IF ld1$=" Linienarten "
    SPUT l$
    GOSUB clipping_aus
    GRAPHMODE 1
    COLOR 1
    stil%=FALSE
    winkel%=FALSE
    gros%=10
    HIDEM
    DEFFILL 1,2,3
    PBOX 10,10,630,390
    DEFFILL 1,2,4
    DEFTEXT 1,FALSE,3,32
    TEXT 17,45," >>>>>>>> Line Einstellungen <<<<<<<< "
    DEFFILL FALSE,2,5
    DEFLINE 1,FALSE,FALSE,FALSE
    kj=1
    bh=1
    anfang=2
    schluss=2
    PBOX 358,61,625,375
    PRINT AT(46,5);CHR$(27)+"p";" - S = Linestil einstellen ----- ";CHR$(27)+"q"
    PRINT AT(56,6);"Stil "
    PRINT AT(70,6);kj
    PRINT AT(46,7);CHR$(27)+"p";" - B = Linebreite einstellen --- ";CHR$(27)+"q"
    PRINT AT(56,8);"Breite "
    PRINT AT(70,8);bh
    PRINT AT(46,9);CHR$(27)+"p";" - A =  Anfangsform einstellen - ";CHR$(27)+"q"
    PRINT AT(56,10);"Anfangsform "
    PRINT AT(70,10);anfang
    PRINT AT(46,11);CHR$(27)+"p";" - E = Endform einstellen ------ ";CHR$(27)+"q"
    PRINT AT(56,12);"Endform "
    PRINT AT(70,12);schluss
    PRINT AT(46,13);CHR$(27)+"p";" - Was wollen Sie Ñndern ? ----- ";CHR$(27)+"q"
    PRINT AT(46,15);"Anfangsbuchstaben bitte eingeben"
    PRINT AT(47,17);"S = Stil  1..6 oder -1..-65535"
    PRINT AT(47,18);"B = Breite       (0..39)"
    PRINT AT(47,19);"A = Anfangsform  (0...2)"
    PRINT AT(47,20);"E = Endform      (0...2)"
    PRINT AT(47,21);"N = ZurÅck       zum Programm"
    PRINT AT(47,22);"                 oder Mausklick"
    GOSUB mami
    REPEAT
      PRINT AT(47,23);CHR$(27)+"p";" Ihre Eingabe ";CHR$(27)+"q";" ";
      eingabe$=INKEY$
      eingabe$=UPPER$(eingabe$)
      ' ******* Stil *********
      IF eingabe$="S"
        bh=1
        anfang=2
        schluss=2
        PRINT AT(70,8);SPACE$(7)
        PRINT AT(70,8);bh
        PRINT AT(70,10);SPACE$(7)
        PRINT AT(70,10);anfang
        PRINT AT(70,12);SPACE$(7)
        PRINT AT(70,12);schluss
        PRINT AT(70,6);SPACE$(7)
        PRINT AT(70,6);
        FORM INPUT 6,kj$
        kj=VAL(kj$)
        IF kj>7
          kj=7
        ENDIF
        GOSUB mami
      ENDIF
      ' ***** Breite *************
      IF eingabe$="B"
        kj=1
        PRINT AT(70,6);SPACE$(7)
        PRINT AT(70,6);kj
        PRINT AT(70,8);SPACE$(7)
        PRINT AT(70,8);
        FORM INPUT 2,bh$
        bh=VAL(bh$)
        GOSUB mami
      ENDIF
      ' ***** Anfangsform **************
      IF eingabe$="A"
        kj=1
        PRINT AT(70,6);SPACE$(7)
        PRINT AT(70,6);kj
        PRINT AT(70,10);SPACE$(7)
        PRINT AT(70,10);
        FORM INPUT 3,anfang$
        anfang=VAL(anfang$)
        GOSUB mami
      ENDIF
      ' ***** Endform **************
      IF eingabe$="E"
        kj=1
        PRINT AT(70,6);SPACE$(7)
        PRINT AT(70,6);kj
        PRINT AT(70,12);SPACE$(7)
        PRINT AT(70,12);
        FORM INPUT 3,schluss$
        schluss=VAL(schluss$)
        GOSUB mami
      ENDIF
    UNTIL eingabe$="N" OR MOUSEK
    GOSUB merge_bild
    IF schreibe%=FALSE
      @saven
      IF oremi%=FALSE
        PRINT #1,"'********** Einstellungen der Line **********"
      ENDIF
      PRINT #1,"DEFLINE ";kj;",";bh;",";anfang;",";schluss;""
    ENDIF
    GOSUB was1
  ENDIF
  IF ld1$=" Bild Neustart "
    ALERT 3,"Wollen Sie das Bild|nochmal ablaufen lassen ?|(Basic Befehl =  Run )",2,"Ja|ZurÅck",d%
    IF d%=1
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Bild vom Anfang zeichnen *****"
      ENDIF
      PRINT #1,"RUN"
    ENDIF
  ENDIF
  IF ld1$=" E-Schleife"
    ALERT 3,"Wollen Sie eine Endlos-|Schleife einfÅgen ?|Basic Befehl Do/Loop",2,"Ja|ZurÅck",d%
    IF d%=1
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Endlos - Schleife *****"
      ENDIF
      PRINT #1,"DO"
      PRINT #1,"LOOP"
    ENDIF
  ENDIF
  IF ld1$=" Text "
    HIDEM
    REPEAT
      SLPOKE 1156,465
      DEFTEXT 1,stil%,winkel%,gros%
      b$=""
      GRAPHMODE 3
      REPEAT
        x%=MOUSEX
        y%=MOUSEY
        TEXT x%,y%,ziehen%,b$+"|"
        REPEAT
          a$=INKEY$
        UNTIL x%<>MOUSEX OR y%<>MOUSEY OR MOUSEK<>0 OR a$<>""
        TEXT x%,y%,b$+"|"
        x%=MOUSEX
        y%=MOUSEY
        a$=LEFT$(a$)
        IF a$=CHR$(13)
          GOTO starttext
        ENDIF
        IF a$=CHR$(27)
          b$=""
          GOTO marktext
        ENDIF
        IF a$=CHR$(8) OR a$=CHR$(127) THEN
          IF LEN(b$)>0
            b$=LEFT$(b$,LEN(b$)-1)
          ENDIF
        ELSE
          b$=b$+a$
        ENDIF
        marktext:
      UNTIL MOUSEK=1
      starttext:
      GRAPHMODE graf%
      TEXT x%,y%,b$
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        TEXT x%,y%,ziehen%,b$
        DEFMOUSE 3
        IF schreibe%=FALSE
          @saven
          IF oremi%=FALSE
            PRINT #1,"'*********** Schreibe Text *************"
          ENDIF
          PRINT #1,"TEXT ";x%;",";y%;",";ziehen%;",";CHR$(34);b$;CHR$(34)
        ENDIF
        GOTO sende
      ENDIF
    UNTIL MOUSEK=2
    sende:
    CLR b$
    SHOWM
  ENDIF
  IF ld1$=" Bild - Konverter "
    GOSUB hals
    IF EXIST(k$)=TRUE
      ALERT 3,"Bitte eine andere Disk|einlegen diese ist|geschÅtzt.",1," Klaro ",d%
      GOTO hut1
    ENDIF
    sav%=FALSE
    ALERT 3,"Wollen Sie wirklich ein Bild|in GFA-Basic (LST) Code Kon-|vertieren ??????????????.Ich  |brauche dafÅr ca 16 Minuten.",1,"Aktuell|Laden|ZurÅck",d%
    IF NOT d%=3
      IF d%=1
        GOSUB radio2
      ENDIF
      IF d%=2
        CLOSE #1
        CLS
        GOSUB murmel
        DEFTEXT 1,FALSE,3,30
        GRAPHMODE 2
        TEXT 175,45,">>> Bild laden <<<"
        PRINT AT(20,24);CHR$(27)+"p";" ---- Zu ladendes Bild hier eingeben ---- ";CHR$(27)+"q"
        DEFFILL 1,2,FALSE
        PBOX 150,360,489,390
        CLR f$
        GOSUB datei_erfragen("*.DOO")
        GOSUB merge_bild
        IF f$<>""
          GOSUB merge_bild
          BLOAD f$,XBIOS(2)
          GOSUB zeige_bild
        ENDIF
        GOSUB radio2
      ENDIF
    ENDIF
    hut1:
    GOSUB was1
  ENDIF
  IF ld1$=" Input "
    DEFMOUSE FALSE
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        CLR a$
        x%=MOUSEX
        y%=MOUSEY
        IF schreibe%=FALSE
          @saven
          IF zahl%=FALSE AND oremi%=FALSE
            PRINT #1,"' *************** Text schreiben ***************"
          ENDIF
        ENDIF
        IF y%<20 OR x%<10
          GOTO wwq
        ENDIF
        PRINT AT(x%/7.8,y%/16);a$;
        HIDEM
        INPUT "",a$
        SHOWM
        IF MOUSEK=2
          GOSUB merge_bild
          GOTO wwq
        ENDIF
        IF schreibe%=FALSE
          @saven
          PRINT #1,"PRINT AT(";x%;"/7.8,";y%;"/16)";CHR$(34);a$;CHR$(34)
        ENDIF
        INC zahl%
      ENDIF
    UNTIL MOUSEK=2
    wwq:
  ENDIF
  IF ld1$=" Datum + Zeit"
    GOSUB hals
    HIDEM
    pui:
    DEFFILL 1,2,5
    PBOX 10,10,630,380
    DEFFILL FALSE,FALSE,FALSE
    PRBOX 150,80,500,300
    DEFTEXT 1,2,3,32
    TEXT 17,50," ~~~~~ Uhrzeit +  Datum stellen ~~~~~ "
    PRINT AT(22,7);"Aktuelles Datum ";DATE$
    REPEAT
      PRINT AT(22,8);"Wollen Sie das Datum Ñndern (J/N) ";
      aw1$=INKEY$
      aw1$=UPPER$(aw1$)
      IF aw1$="N"
        GOTO 30030
      ENDIF
    UNTIL aw1$="J"
    PRINT AT(22,9);"Bitte neues Datum eingeben ";
    FORM INPUT 10,da$
    30030:
    PRINT AT(22,11);"Aktuelle Zeit ";TIME$
    REPEAT
      PRINT AT(22,12);"Wollen Sie die Zeit Ñndern (J/N) ";
      aw1$=INKEY$
      aw1$=UPPER$(aw1$)
      IF aw1$="N"
        GOTO 30100
      ENDIF
    UNTIL aw1$="J"
    PRINT AT(22,13);"Bitte neue Zeit eingeben ";
    FORM INPUT 8,ti$
    30100:
    SETTIME ti$,da$
    PRINT AT(22,15);"Neues Datum ";DATE$
    PRINT AT(22,16);"Neue Zeit   ";TIME$
    REPEAT
      PRINT AT(22,18);"Alle Eingaben richtig (J/N) ";
      r$=INKEY$
      r$=UPPER$(r$)
      IF r$="N"
        GOTO pui
      ENDIF
    UNTIL r$="J"
    GOSUB was1
  ENDIF
  IF ld1$=" K-Spiegel "
    lachmuskel:
    ERASE ok$()
    x%=0
    GOSUB welt
    ALERT FALSE,"~~~~~~~~ Klapp Spiegel ~~~~~~~~",3,"Runter|Spezial|ZurÅck",k_gag%
    IF k_gag%=1
      REPEAT
        GET FALSE,x%,639,x%,ok$(x%)
        PUT FALSE,x%,ok$(399-x%),modus%
        INC x%
      UNTIL x%=400
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ***** K-Spiegel Runter *****"
        ENDIF
        GOSUB was
        PRINT #1,"GET FALSE,X%,639,X%,OK$(X%)"
        PRINT #1,"PUT FALSE,X%,OK$(399-X%),";modus%
        PRINT #1,"INC X%"
        PRINT #1,"UNTIL X%=400"
      ENDIF
    ENDIF
    x%=0
    IF k_gag%=2
      ALERT FALSE,"~~~ Spezial Klapp Spiegel ~~~|   Ru = Zufalls - Klapp runder",3,"Ru-Zufall|ZurÅck",schleimi%
      IF schleimi%=1
        lachs_compi=INT(RND*399)+1
        REPEAT
          GET FALSE,x%,639,x%,ok$(x%)
          PUT FALSE,x%,ok$(lachs_compi-x%),modus%
          INC x%
        UNTIL x%=lachs_compi
        IF schreibe%=FALSE
          @saven
          IF oremi%=FALSE
            PRINT #1,"' ***** Zufalls K-Spiegel runter *****"
          ENDIF
          GOSUB was
          PRINT #1,"GET FALSE,X%,639,X%,OK$(X%)"
          PRINT #1,"PUT FALSE,X%,OK$(";lachs_compi;"-X%),";modus%
          PRINT #1,"INC X%"
          PRINT #1,"UNTIL X%=";lachs_compi
        ENDIF
      ENDIF
      ALERT 3,"Nocheinmal ?",2,"Ja|ZurÅck",d%
      IF d%=1
        GOTO lachmuskel
      ENDIF
    ENDIF
    x%=0
    ERASE ok$()
  ENDIF
  IF ld1$=" Knicken "
    rasen_was:
    ERASE ok$()
    x%=0
    GOSUB welt
    ALERT FALSE,"~~~~~~~~~~ Knicken ~~~~~~~~~~ ",3,"Auf - Ab|Spezial|ZurÅck",gag%
    IF gag%=1
      REPEAT
        GET FALSE,x%,639,x%,ok$(x%)
        INC x%
      UNTIL x%=400
      x%=0
      REPEAT
        PUT FALSE,x%,ok$(399-x%),modus%
        INC x%
      UNTIL x%=400
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ***** Knicke Bildschirm  Runter *****"
        ENDIF
        GOSUB was
        PRINT #1,"GET FALSE,X%,639,X%,OK$(X%)"
        PRINT #1,"INC X%"
        PRINT #1,"UNTIL X%=400"
        PRINT #1,"X%=0"
        PRINT #1,"REPEAT"
        PRINT #1,"PUT FALSE,X%,OK$(399-X%),";modus%
        PRINT #1,"INC X%"
        PRINT #1,"UNTIL X%=400"
      ENDIF
    ENDIF
    IF gag%=2
      ALERT FALSE," ~~~~~~ Spezial Knick ~~~~~~| Auf - Ab  = Zufalls - Knick  | Li  - Re  = Zufalls - Knick ",3,"Auf - Ab|ZurÅck",gambler%
      IF gambler%=1
        lachs_compi=INT(RND*399)+1
        REPEAT
          GET FALSE,x%,639,x%,ok$(x%)
          INC x%
        UNTIL x%=lachs_compi
        x%=0
        REPEAT
          PUT FALSE,x%,ok$(lachs_compi-x%),modus%
          INC x%
        UNTIL x%=lachs_compi
        IF schreibe%=FALSE
          @saven
          IF oremi%=FALSE
            PRINT #1,"' ***** Zufalls Knicken runter *****"
          ENDIF
          GOSUB was
          PRINT #1,"GET FALSE,X%,639,X%,OK$(X%)"
          PRINT #1,"INC X%"
          PRINT #1,"UNTIL X%=";lachs_compi
          PRINT #1,"X%=0"
          PRINT #1,"REPEAT"
          PRINT #1,"PUT FALSE,X%,OK$(399-X%),";modus%
          PRINT #1,"INC X%"
          PRINT #1,"UNTIL X%=";lachs_compi
        ENDIF
      ENDIF
      IF NOT gag%=3 OR gambler%=3
        ALERT 3,"Nocheinmal ?",2,"Ja|ZurÅck",d%
        IF d%=1
          GOTO rasen_was
        ENDIF
      ENDIF
    ENDIF
    ERASE ok$()
  ENDIF
  IF ld1$=" Grafikmodus "
    GOSUB hals
    OPENW 0
    DEFFILL ,1,1
    PBOX 210,110,434,262
    DEFFILL ,2,4
    PBOX 200,100,424,252
    DEFFILL ,1,1
    PBOX 244,116,384,204
    PBOX 244,218,304,240
    PBOX 324,218,384,240
    DEFFILL ,0,0
    PBOX 240,112,380,132
    PBOX 240,134,380,154
    PBOX 240,156,380,176
    PBOX 240,178,380,198
    PBOX 240,214,300,236
    PBOX 320,214,380,236
    BOX 241,215,299,235
    BOX 321,215,379,235
    DEFTEXT 1,4,900,13
    GRAPHMODE 1
    DEFTEXT 1,4,0,13
    TEXT 250,129,"öberschreiben"
    TEXT 250,151,"    Mischen  "
    TEXT 250,173,"  VerknÅpfen "
    TEXT 250,195,"    Invers   "
    DEFTEXT 1,0,0,13
    TEXT 247,231,"  Ok "
    TEXT 335,231,"UNDO"
    GET 241,110+graf%*22,379,128+graf%*22,dummy$
    PUT 241,110+graf%*22,dummy$,12
    dummy%=graf%
    DO
      REPEAT
        MOUSE x%,y%,k%
        IF INKEY$=CHR$(13)
          GOTO lrtq1
        ENDIF
      UNTIL k%
      IF x%>240 AND x%<390 AND y%>112 AND y%<198 AND graf%<>1+INT((y%-112)/22)
        GET 241,110+graf%*22,379,128+graf%*22,dummy$
        PUT 241,110+graf%*22,dummy$,12
        graf%=1+INT((y%-112)/22)
        GET 241,110+graf%*22,379,128+graf%*22,dummy$
        PUT 241,110+graf%*22,dummy$,12
      ENDIF
      IF x%>320 AND x%<380 AND y%>214 AND y%<236
        graf%=dummy%
        x%=260
      ENDIF
      EXIT IF x%>240 AND x%<300 AND y%>214 AND y%<236 OR MOUSEK=2
    LOOP
    lrtq1:
    CLOSEW 0
    GRAPHMODE graf%
    IF schreibe%=FALSE
      @saven
      IF oremi%=FALSE
        PRINT #1,"'********** Grafikmodus **********"
      ENDIF
      PRINT #1,"GRAPHMODE ";graf%
    ENDIF
    GOSUB clipping_an
    GRAPHMODE graf%
    GOSUB merge_bild
  ENDIF
  IF ld1$=" Kantenform "
    ALERT 3,"Kantenform|Quadrat,Rechteck",1,"Eckig|Rund",ka%
  ENDIF
  IF ld1$=" Rahmung "
    ALERT 3,"Sollen Kreise Rechtecke |Quadrate Ellipsen M-Kreis|und I-Line umrandet werden ?",3,"Nein|Ja|ZurÅck",c%
    IF NOT c%=3
      DEC c%
      GOSUB rahmung(c%)
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          IF c%=1
            PRINT #1,"' ********** Rahmung ein **********"
          ELSE
            PRINT #1," '********** Rahmung aus **********"
          ENDIF
        ENDIF
        PRINT #1,"DPOKE Intin,";c%
        PRINT #1,"VDISYS 104"
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" Q-Spiegel "
    GOSUB origin_an
    IF schreibe%=1
      k%=399
      ff%=639
      ALERT 3,"Spiegel        quer ?    ",1,"Quer|Extra|Extra 1",d%
      DEFMOUSE 5
      REPEAT
        x%=MOUSEX
        y%=MOUSEY
        IF MOUSEK=1
          HIDEM
          DRAW x%,y% TO b%+xkord%,a%+ykord%
          IF d%=2
            DRAW x%,y% TO ff%-b%+xkord%,k%-a%+ykord%
          ENDIF
          IF d%=3
            GRAPHMODE 3
            DRAW x%,y% TO b%,a% TO ff%-b%+xkord%,k%-a%+ykord%
          ELSE
            DRAW ff%-x%,k%-y% TO ff%-b%+xkord%,k%-a%+ykord%
          ENDIF
        ELSE
          SHOWM
        ENDIF
        b%=x%
        a%=y%
      UNTIL MOUSEK=2
    ENDIF
    IF schreibe%=FALSE
      k%=399
      ff%=639
      ALERT 3,"Spiegel        quer ?    ",3,"Quer|Extra|ZurÅck",d%
      IF NOT d%=3
        IF graf%=4
          GRAPHMODE 1
        ENDIF
        DEFMOUSE 5
        REPEAT
          x%=MOUSEX
          y%=MOUSEY
          IF MOUSEK=1
            HIDEM
            IF ofarbi%=FALSE
              ' ***** Farbe schwarz *****
              IF d%=2
                IF ccc%=1
                  IF POINT(MOUSEX,MOUSEY)=FALSE
                    GOSUB laster
                  ENDIF
                ELSE
                  ' ***** Farbe weiû *****
                  IF POINT(MOUSEX,MOUSEY)=1
                    GOSUB laster
                  ENDIF
                ENDIF
              ELSE
                ' ***** Farbe schwarz *****
                IF ccc%=1
                  IF POINT(MOUSEX,MOUSEY)=FALSE
                    GOSUB luck
                  ENDIF
                ELSE
                  ' ***** Farbe weiû *****
                  IF POINT(MOUSEX,MOUSEY)=1
                    GOSUB luck
                  ENDIF
                ENDIF
              ENDIF
            ENDIF
            IF ofarbi%=1
              IF d%=2
                GOSUB laster
              ENDIF
              IF d%=1
                GOSUB luck
              ENDIF
            ENDIF
          ELSE
            SHOWM
          ENDIF
          b%=x%
          a%=y%
        UNTIL MOUSEK=2
        GOSUB henne
      ENDIF
    ENDIF
    GOSUB origin_aus
  ENDIF
  IF ld1$=" 4-Spiegel "
    GOSUB origin_an
    k%=399
    ff%=639
    IF graf%=4
      GRAPHMODE 1
    ENDIF
    ALERT 3,"Spiegel             ?    ",3,"Horizon|Diagon|Alle",das%
    DEFMOUSE 5
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        HIDEM
        ' ***** Farbe schwarz *****
        IF ofarbi%=FALSE
          IF das%=3
            IF ccc%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB dach
              ENDIF
            ELSE
              ' ***** Farbe Weiû *****
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB dach
              ENDIF
            ENDIF
          ENDIF
          ' ***** Farbe Schwarz *****
          IF das%=1
            IF ccc%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB fliege
              ENDIF
            ELSE
              ' ***** Farbe Weiû *****
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB fliege
              ENDIF
            ENDIF
          ENDIF
          ' ***** Farbe Schwarz *****
          IF das%=2
            IF ccc%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB schuh
              ENDIF
            ELSE
              ' ***** Farbe Weiû *****
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB schuh
              ENDIF
            ENDIF
          ENDIF
        ELSE
          HIDEM
        ENDIF
        IF ofarbi%=1
          IF das%=3
            GOSUB dach
          ENDIF
          IF das%=1
            GOSUB fliege
          ENDIF
          IF das%=2
            GOSUB schuh
          ENDIF
        ENDIF
      ELSE
        SHOWM
      ENDIF
      b%=x%
      a%=y%
    UNTIL MOUSEK=2
    GOSUB origin_aus
    IF das%=3
      IF zahl%>FALSE AND schreibe%=FALSE
        PRINT #1,"*,*,*,*"
      ENDIF
    ELSE
      GOSUB henne
    ENDIF
  ENDIF
  IF ld1$=" Grîûe M-Kreis "
    GOSUB hals
    grk=FALSE
    IF ccc%=FALSE
      COLOR 1
    ENDIF
    REPEAT
      IF MOUSEK=1
        REPEAT
        UNTIL MOUSEK<>1
        INC grk
        CIRCLE 320,200,grk
        IF grk=150
          grk=FALSE
          CLS
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    GOSUB was1
  ENDIF
  IF ld1$=" M-Kreis "
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        HIDEM
        ' ***** Farbe schwarz *****
        IF ofarbi%=FALSE
          IF ccc%=1
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB buch
              ENDIF
            ELSE
              ' ***** Kreis ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB benzin
              ENDIF
            ENDIF
          ELSE
            ' ***** Farbe weiû *****
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB buch
              ENDIF
            ELSE
              ' ***** Kreis ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB benzin
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          IF fu%=1
            GOSUB buch
          ELSE
            GOSUB benzin
          ENDIF
        ENDIF
      ENDIF
      SHOWM
    UNTIL MOUSEK=2
    GOSUB eimer
  ENDIF
  IF ld1$=" Copyright "
    GOSUB infol
  ENDIF
  IF ld1$=" G-Rays "
    REPEAT
      SHOWM
      a%=MOUSEX
      b%=MOUSEY
      WHILE MOUSEK=1
        HIDEM
        x%=MOUSEX
        y%=MOUSEY
        ' ********* Farbe schwarz *********
        IF ofarbi%=FALSE
          IF ccc%=1
            IF POINT(MOUSEX,MOUSEY)=FALSE
              GOSUB lasso
            ENDIF
          ENDIF
          IF ccc%=0
            ' ********* Farbe weiss ***********
            IF POINT(MOUSEX,MOUSEY)=1
              GOSUB lasso
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          GOSUB lasso
        ENDIF
      WEND
    UNTIL MOUSEK=2
    GOSUB henne
  ENDIF
  IF ld1$=" Zeichenfarbe "
    ALERT FALSE,"Zeichenfarbe              ?",3,"Weiû|Schwarz|ZurÅck",ccc%
    IF NOT ccc%=3
      DEC ccc%
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' *************** ZEICHENFARBE ***************"
        ENDIF
        PRINT #1,"COLOR ";ccc%
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" Disk - Inhalt"
    SPUT l$
    CLS
    HIDEM
    FILES
    PRINT
    PRINT "   ---> Bitte eine Maustaste drÅcken"
    REPEAT
    UNTIL MOUSEK
    GOSUB merge_bild
  ENDIF
  IF ld1$=" Drucke Bild"
    GOSUB drucken
  ENDIF
  IF ld1$=" Lîsche Datei "
    ALERT 3,"Wollen sie wirklich eine Datei|oder ein Bild von der Diskette|lîschen. ?????????????????????",2,"Ja|ZurÅck",d%
    GOSUB hals
    IF d%=1
      eohan:
      GOSUB kind
      DEFTEXT 1,FALSE,3,30
      GRAPHMODE 2
      TEXT 160,45,">>> Lîsche Datei <<<"
      PRINT AT(21,24);CHR$(27)+"p";" Gelîschte Datei oder Bild ist dann weg.";CHR$(27)+"q"
      DEFFILL 1,2,FALSE
      PBOX 150,360,489,390
      GOSUB datei_erfragen("*.*")
      IF EXIST(k$)=TRUE
        ALERT 3,"Was soll den das ?|Zeichenprogramm lÑût sich|nicht lîschen.",1," Klaro ",d%
        GOTO hut
      ENDIF
      IF f$>"" AND RIGHT$(f$)<>"\" AND EXIST(f$)
        KILL f$
        GOTO eohan
      ENDIF
    ENDIF
    hut:
    GOSUB was1
  ENDIF
  IF ld1$=" Ordner anlegen "
    ALERT 3,"Wollen sie wirklich|einen neuen  Ordner| auf der Diskette |    anlegen ??? ",2,"Ja|ZurÅck",d%
    GOSUB hals
    IF d%=1
      GOSUB kind
      DEFTEXT 1,FALSE,3,23
      GRAPHMODE 2
      TEXT 165,45,">>> Ordner anlegen <<<"
      PRINT AT(20,24);CHR$(27)+"p";"Sie kînnen sich einen neuen Ordner anlegen";CHR$(27)+"q"
      DEFFILL 1,2,FALSE
      PBOX 150,360,489,390
      GOSUB datei_erfragen("*.*")
      IF f$<>""
        MKDIR f$
      ENDIF
    ENDIF
    GOSUB was1
  ENDIF
  IF ld1$=" Freier Speicher "
    ALERT 3,"Freier Speicherplatz      ?   ",3,"Diskette|Computer|ZurÅck",e%
    IF e%=2
      ALERT 3,"Der freie Ram-Speicher|des Computers betrÑgt | |  "+STR$(FRE(FALSE))+"   Bytes",1,"ZurÅck",d%
    ENDIF
    IF e%=1
      ALERT 3,"Der freie Speicherplatz|der Diskette betrÑgt | |   "+STR$(DFREE(FALSE))+" Bytes ",1,"ZurÅck",d%
    ENDIF
  ENDIF
  IF ld1$=" Hintergrundfarbe "
    ALERT FALSE,"Welche Hintergrundfarbe ?",1,"Weiû|Schwarz|Invers",hintergrund%
    IF hintergrund%=1
      SETCOLOR FALSE,1
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ********** Bild - Hintergrundfarbe weiû **********"
        ENDIF
        PRINT #1,"SETCOLOR FALSE,1"
      ENDIF
    ENDIF
    IF hintergrund%=3
      GRAPHMODE 3
      y%=0
      REPEAT
        DRAW FALSE,y% TO 639,y%
        INC y%
      UNTIL y%=400
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ***** Inventriere Bild *****"
        ENDIF
        PRINT #1,"GRAPHMODE 3"
        PRINT #1,"Y%=0"
        PRINT #1,"REPEAT"
        PRINT #1,"DRAW FALSE,Y% TO 639,Y%"
        PRINT #1,"INC Y%"
        PRINT #1,"UNTIL Y%=400"
        PRINT #1,"GRAPHMODE";graph
      ENDIF
    ENDIF
    IF hintergrund%=2
      SETCOLOR FALSE,FALSE
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ********** Bild - Hintergrundfarbe schwarz **********"
        ENDIF
        PRINT #1,"SETCOLOR FALSE,FALSE"
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" FÅllfarbe "
    DIM p%(8),s%(5),d%(5),fm%(15,15),fh%(15,15),hl1%(15)
    GOSUB clipping_aus
    IF c%=FALSE
      ' ********** Rahmung ein **********
      GOSUB rahmung(c%+1)
      c%=FALSE
    ENDIF
    DEFMOUSE 3
    SPUT l$
    GRAPHMODE 1
    DEFFILL 1,2,3
    PBOX TRUE,TRUE,640,400
    DEFFILL FALSE,2,1
    PRBOX 10,10,630,390
    DEFTEXT 1,2,3,25
    TEXT 20,40,">>>>>>>> FÅllmuster Controller <<<<<<<<"
    a=FALSE
    GOSUB bravo(60,614,100)
    a=10
    GOSUB bravo(110,614,150)
    a=20
    GOSUB bravo(160,266,200)
    a=FALSE
    FOR x=266 TO 600 STEP 60
      INC a
      DEFFILL 1,3,a
      PBOX x,160,614,200
    NEXT x
    a=6
    FOR x=1 TO 325 STEP 60
      INC a
      DEFFILL 1,3,a
      PBOX 25+x,210,326,250
    NEXT x
    a=FALSE
    FOR x=326 TO 385 STEP 60
      INC a
      DEFFILL 1,4,a
      PBOX x,210,385,250
    NEXT x
    a=FALSE
    FOR x=385 TO 500 STEP 60
      DEFFILL 2,FALSE,FALSE
      PBOX x,210,385,250
    NEXT x
    DEFFILL FALSE,1,2
    BOX 565,160,615,200
    DEFTEXT 1,2,3,11
    TEXT 465,233,"Zum Editor"
    BOX 460,210,615,250
    DEFTEXT 1,12,3,22
    TEXT 12,280,"Zur Zeit ist folgendes FÅllmuster eingestellt"
    GOSUB wasser
    REPEAT
      IF MOUSEK=1
        IF MOUSEY>60 AND MOUSEY<100
          IF MOUSEX>25 AND MOUSEX<85
            GOSUB roth(1)
          ENDIF
          IF MOUSEX>85 AND MOUSEX<145
            GOSUB roth(2)
          ENDIF
          IF MOUSEX>145 AND MOUSEX<205
            GOSUB roth(3)
          ENDIF
          IF MOUSEX>205 AND MOUSEX<265
            GOSUB roth(4)
          ENDIF
          IF MOUSEX>265 AND MOUSEX<325
            GOSUB roth(5)
          ENDIF
          IF MOUSEX>325 AND MOUSEX<385
            GOSUB roth(6)
          ENDIF
          IF MOUSEX>385 AND MOUSEX<445
            GOSUB roth(7)
          ENDIF
          IF MOUSEX>445 AND MOUSEX<505
            GOSUB roth(8)
          ENDIF
          IF MOUSEX>505 AND MOUSEX<565
            GOSUB roth(9)
          ENDIF
          IF MOUSEX>565 AND MOUSEX<625
            GOSUB roth(10)
          ENDIF
        ENDIF
        ' ************ Dekade 2 **********
        IF MOUSEY>110 AND MOUSEY<150
          IF MOUSEX>25 AND MOUSEX<85
            GOSUB roth(11)
          ENDIF
          IF MOUSEX>85 AND MOUSEX<145
            GOSUB roth(12)
          ENDIF
          IF MOUSEX>145 AND MOUSEX<205
            GOSUB roth(13)
          ENDIF
          IF MOUSEX>205 AND MOUSEX<265
            GOSUB roth(14)
          ENDIF
          IF MOUSEX>265 AND MOUSEX<325
            GOSUB roth(15)
          ENDIF
          IF MOUSEX>325 AND MOUSEX<385
            GOSUB roth(16)
          ENDIF
          IF MOUSEX>385 AND MOUSEX<445
            GOSUB roth(17)
          ENDIF
          IF MOUSEX>445 AND MOUSEX<505
            GOSUB roth(18)
          ENDIF
          IF MOUSEX>505 AND MOUSEX<565
            GOSUB roth(19)
          ENDIF
          IF MOUSEX>565 AND MOUSEX<625
            GOSUB roth(20)
          ENDIF
        ENDIF
        ' *********** Dekade 3 ************
        IF MOUSEY>160 AND MOUSEY<200
          IF MOUSEX>25 AND MOUSEX<85
            GOSUB roth(21)
          ENDIF
          IF MOUSEX>85 AND MOUSEX<145
            GOSUB roth(22)
          ENDIF
          IF MOUSEX>145 AND MOUSEX<205
            GOSUB roth(23)
          ENDIF
          IF MOUSEX>205 AND MOUSEX<265
            GOSUB roth(24)
          ENDIF
          IF MOUSEX>265 AND MOUSEX<325
            GOSUB milch(1)
          ENDIF
          IF MOUSEX>325 AND MOUSEX<385
            GOSUB milch(2)
          ENDIF
          IF MOUSEX>385 AND MOUSEX<445
            GOSUB milch(3)
          ENDIF
          IF MOUSEX>445 AND MOUSEX<505
            GOSUB milch(4)
          ENDIF
          IF MOUSEX>505 AND MOUSEX<565
            GOSUB milch(5)
          ENDIF
          IF MOUSEX>565 AND MOUSEX<625
            GOSUB milch(6)
          ENDIF
        ENDIF
        ' ***** Dekade 4 ************
        IF MOUSEY>210 AND MOUSEY<270
          IF MOUSEX>25 AND MOUSEX<85
            GOSUB milch(7)
          ENDIF
          IF MOUSEX>85 AND MOUSEX<145
            GOSUB milch(8)
          ENDIF
          IF MOUSEX>145 AND MOUSEX<205
            GOSUB milch(9)
          ENDIF
          IF MOUSEX>205 AND MOUSEX<265
            GOSUB milch(10)
          ENDIF
          IF MOUSEX>265 AND MOUSEX<325
            GOSUB milch(11)
          ENDIF
          IF MOUSEX>325 AND MOUSEX<385
            v%=4
            f%=FALSE
            GOSUB wasser
          ENDIF
          IF MOUSEX>385 AND MOUSEX<445
            v%=FALSE
            f%=FALSE
            GOSUB wasser
            DEFFILL 1,v%,f%
            PBOX 40,300,600,380
          ENDIF
          ' ***** Zum Editor *****
          IF MOUSEX>460 AND MOUSEX<615
            PBOX -1,-1,16,16
            FOR y%=0 TO 15
              FOR x%=0 TO 15
                fm%(y%,x%)=POINT(x%,y%)
              NEXT x%
            NEXT y%
            ja%=0
            CLS
            DEFTEXT 1,0,6,6
            @i_gp(XBIOS(3),XBIOS(3))
            GRAPHMODE 1
            DEFFILL 1,2,2
            PBOX -1,27,640,45
            TEXT 319-LEN(" Mustereditor ")*4,42," Mustereditor "
            DEFFILL 1,0,0
            PBOX 47,47,603,373
            PBOX 48,48,602,372
            PBOX 50,50,370,370
            IF schreibe%=1
              FOR i%=79 TO 175 STEP 24
                BOX 375,i%,489,i%+16
              NEXT i%
            ENDIF
            IF schreibe%=FALSE
              BOX 375,79,489,95
              FOR i%=151 TO 175 STEP 24
                BOX 375,i%,489,i%+16
              NEXT i%
            ENDIF
            BOX 392,197,407,213
            BOX 377,215,391,228
            BOX 408,215,422,228
            BOX 392,230,407,246
            FOR i%=253 TO 341 STEP 24
              BOX 375,i%,489,i%+16
            NEXT i%
            GRAPHMODE 2
            TEXT 376,93,"lîschen"
            IF schreibe%=1
              TEXT 376,117,"Load"
              TEXT 376,141,"Save"
            ENDIF
            TEXT 376,165,"Invertieren"
            TEXT 376,189,"Bildausschnitt"
            TEXT 380,209,"  "+CHR$(1)
            TEXT 380,225,"   "+CHR$(3)
            TEXT 380,241,"  "
            TEXT 376,267,"X-Spiegeln"
            TEXT 376,291,"Y-Spiegeln"
            TEXT 376,315,"drehen .."
            TEXT 376,339,"Ende"
            GOSUB turbo_weck
            @wrt
            DO
              MOUSE x%,y%,k%
              IF k%=3
                k%=0
              ENDIF
              IF x%>374
                @ueberwachen(375,175,489,191,1)
                IF ja%=1
                  SGET l$
                  IF EXIST("\PAD.PAM")=-1
                    ALERT 1,"FÅllmuster aus|aktuellen Bild oder|aus PAD V2.2|FÅllmusterpalette",1,"Aktuell|PAD V2.2",frage%
                    IF frage%=1
                      GOSUB merge_bild
                      GOTO zoro
                    ENDIF
                    IF frage%=2
                      GOSUB grund
                      CLS
                      y=32
                      FOR x=1 TO 20
                        FOR d=1 TO 6
                          BOX 0+(x*y),0,0,y*d
                        NEXT d
                      NEXT x
                      ERASE muster$()
                      DIM muster$(81)
                      OPEN "I",#1,"\PAD.PAM"
                      FOR i%=1 TO 80
                        muster$(i%)=SPACE$(32)
                        BGET #1,VARPTR(muster$(i%)),32
                      NEXT i%
                      CLOSE #1
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+1)
                        FILL 1+(x*32),1
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+20+1)
                        FILL 1+(x*32),1+32
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+40+1)
                        FILL 1+(x*32),1+(2*32)
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+60+1)
                        FILL 1+(x*32),1+(3*32)
                      NEXT x
                    ENDIF
                    IF frage%=1 OR frage%=2
                      ja%=0
                      MOUSE x%,y%,k%
                      GRAPHMODE 3
                      COLOR 1
                      DEFLINE 1,0,0,0
                      GRAPHMODE 3
                      HIDEM
                      WHILE MOUSEK=FALSE
                        x%=MOUSEX
                        y%=MOUSEY
                        BOX x%+16,y%+16,x%-1,y%-1
                        VSYNC
                        PAUSE 3
                        BOX x%+16,y%+16,x%-1,y%-1
                      WEND
                      BOX x%+16,y%+16,x%-1,y%-1
                      GRAPHMODE 1
                      FOR y%=0 TO 15
                        FOR x%=0 TO 15
                          fm%(x%,y%)=POINT(MOUSEX+x%,MOUSEY+y%)
                        NEXT x%
                      NEXT y%
                      SPUT l$
                      FOR i%=0 TO 15
                        FOR c8%=0 TO 15
                          fh%(i%,c8%)=fm%(i%,c8%)
                        NEXT c8%
                      NEXT i%
                      FOR i%=0 TO 15
                        FOR c8%=0 TO 15
                          fm%(c8%,i%)=fh%(15-i%,c8%)
                        NEXT c8%
                      NEXT i%
                      @wrt
                      GOSUB turbo_weck
                      SHOWM
                    ENDIF
                  ENDIF
                  IF EXIST("\BFLY.FIL")=-1 AND ja%=1
                    SPUT l$
                    ALERT 1,"FÅllmuster aus|aktuellen Bild oder|aus Butterfly Artist|FÅllmusterpalette",1,"Aktuell|Butter",frage%
                    IF frage%=1
                      GOSUB merge_bild
                      GOTO zoro
                    ENDIF
                    IF frage%=2
                      GOSUB grund
                      CLS
                      y=32
                      FOR x=1 TO 20
                        FOR d=1 TO 6
                          BOX 0+(x*y),0,0,y*d
                        NEXT d
                      NEXT x
                      ERASE muster$()
                      DIM muster$(121)
                      OPEN "I",#1,"\BFLY.FIL"
                      FOR i%=1 TO 120
                        muster$(i%)=SPACE$(32)
                        BGET #1,VARPTR(muster$(i%)),32
                      NEXT i%
                      CLOSE #1
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+1)
                        FILL 1+(x*32),1
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+20+1)
                        FILL 1+(x*32),1+32
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+40+1)
                        FILL 1+(x*32),1+(2*32)
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+60+1)
                        FILL 1+(x*32),1+(3*32)
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+80+1)
                        FILL 1+(x*32),1+(4*32)
                      NEXT x
                      FOR x=0 TO 20
                        DEFFILL 1,muster$(x+100+1)
                        FILL 1+(x*32),1+(5*32)
                      NEXT x
                    ENDIF
                    IF frage%=1 OR frage%=2
                      ja%=0
                      MOUSE x%,y%,k%
                      GRAPHMODE 3
                      COLOR 1
                      DEFLINE 1,0,0,0
                      GRAPHMODE 3
                      HIDEM
                      WHILE MOUSEK=FALSE
                        x%=MOUSEX
                        y%=MOUSEY
                        BOX x%+16,y%+16,x%-1,y%-1
                        VSYNC
                        PAUSE 3
                        BOX x%+16,y%+16,x%-1,y%-1
                      WEND
                      BOX x%+16,y%+16,x%-1,y%-1
                      GRAPHMODE 1
                      FOR y%=0 TO 15
                        FOR x%=0 TO 15
                          fm%(x%,y%)=POINT(MOUSEX+x%,MOUSEY+y%)
                        NEXT x%
                      NEXT y%
                      SPUT l$
                      FOR i%=0 TO 15
                        FOR c8%=0 TO 15
                          fh%(i%,c8%)=fm%(i%,c8%)
                        NEXT c8%
                      NEXT i%
                      FOR i%=0 TO 15
                        FOR c8%=0 TO 15
                          fm%(c8%,i%)=fh%(15-i%,c8%)
                        NEXT c8%
                      NEXT i%
                      GOSUB wrt
                      GOSUB turbo_weck
                      SHOWM
                    ENDIF
                  ELSE
                    zoro:
                    IF ja%=1
                      GOSUB merge_bild
                      MOUSE x%,y%,k%
                      GRAPHMODE 3
                      COLOR 1
                      DEFLINE 1,0,0,0
                      GRAPHMODE 3
                      HIDEM
                      WHILE MOUSEK=FALSE
                        x%=MOUSEX
                        y%=MOUSEY
                        BOX x%+16,y%+16,x%-1,y%-1
                        VSYNC
                        PAUSE 3
                        BOX x%+16,y%+16,x%-1,y%-1
                      WEND
                      BOX x%+16,y%+16,x%-1,y%-1
                      IF k%=3
                        GOTO j45
                      ENDIF
                      GRAPHMODE 1
                      FOR y%=0 TO 15
                        FOR x%=0 TO 15
                          fm%(x%,y%)=POINT(MOUSEX+x%,MOUSEY+y%)
                        NEXT x%
                      NEXT y%
                      ja%=1
                      j45:
                      SPUT l$
                      SHOWM
                    ENDIF
                  ENDIF
                ENDIF
                ' ***** Drehen ******
                @ueberwachen(375,301,489,317,1)
                IF ja%=1
                  ja%=0
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fh%(i%,c8%)=fm%(i%,c8%)
                    NEXT c8%
                  NEXT i%
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fm%(c8%,i%)=fh%(15-i%,c8%)
                    NEXT c8%
                  NEXT i%
                  @wrt
                  GOSUB turbo_weck
                ENDIF
                @ueberwachen(375,277,489,293,1)
                IF ja%=1
                  ja%=0
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fh%(i%,c8%)=fm%(i%,c8%)
                    NEXT c8%
                  NEXT i%
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fm%(i%,c8%)=fh%(15-i%,c8%)
                    NEXT c8%
                  NEXT i%
                  @wrt
                  GOSUB turbo_weck
                ENDIF
                @ueberwachen(375,253,489,269,1)
                IF ja%=1
                  ja%=0
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fh%(i%,c8%)=fm%(i%,c8%)
                    NEXT c8%
                  NEXT i%
                  FOR i%=0 TO 15
                    FOR c8%=0 TO 15
                      fm%(i%,c8%)=fh%(i%,15-c8%)
                    NEXT c8%
                  NEXT i%
                  @wrt
                  GOSUB turbo_weck
                ENDIF
                @ueberwachen(392,197,407,213,1)
                IF ja%=1
                  FOR i%=0 TO 15
                    hl1%(i%)=fm%(0,i%)
                  NEXT i%
                  FOR my%=0 TO 14
                    FOR mx%=0 TO 15
                      fm%(my%,mx%)=fm%(my%+1,mx%)
                    NEXT mx%
                  NEXT my%
                  FOR i%=0 TO 15
                    fm%(15,i%)=hl1%(i%)
                  NEXT i%
                  @g_p1(50,70,370,370,50,50,370,350)
                  GRAPHMODE 1
                  FOR i%=0 TO 15
                    IF fm%(15,i%)=1
                      DEFFILL 1,2,4
                    ELSE
                      DEFFILL 1,0,0
                    ENDIF
                    PBOX 350-i%*20,350,370-i%*20,370
                  NEXT i%
                  GOSUB turbo_weck
                ENDIF
                ja%=0
                @ueberwachen(375,325,489,341,1)
                IF ja%=1
                  ja%=0
                  k%=3
                  GOTO ngtm
                ENDIF
                @ueberwachen(408,215,422,228,1)
                IF ja%=1
                  FOR i%=0 TO 15
                    hl1%(i%)=fm%(i%,0)
                  NEXT i%
                  FOR my%=0 TO 14
                    FOR mx%=0 TO 15
                      fm%(mx%,my%)=fm%(mx%,my%+1)
                    NEXT mx%
                  NEXT my%
                  FOR i%=0 TO 15
                    fm%(i%,15)=hl1%(i%)
                  NEXT i%
                  @g_p1(50,50,350,370,70,50,370,370)
                  GRAPHMODE 1
                  FOR i%=0 TO 15
                    IF fm%(i%,15)=1
                      DEFFILL 1,2,4
                    ELSE
                      DEFFILL 1,0,0
                    ENDIF
                    PBOX 50,50+i%*20,70,70+i%*20
                  NEXT i%
                  GOSUB turbo_weck
                ENDIF
                ja%=0
                @ueberwachen(377,215,391,228,1)
                IF ja%=1
                  FOR i%=0 TO 15
                    hl1%(i%)=fm%(i%,15)
                  NEXT i%
                  FOR my%=15 TO 1 STEP -1
                    FOR mx%=0 TO 15
                      fm%(mx%,my%)=fm%(mx%,my%-1)
                    NEXT mx%
                  NEXT my%
                  FOR i%=0 TO 15
                    fm%(i%,0)=hl1%(i%)
                  NEXT i%
                  @g_p1(70,50,370,370,50,50,350,370)
                  GRAPHMODE 1
                  FOR i%=0 TO 15
                    IF fm%(i%,0)=1
                      DEFFILL 1,2,4
                    ELSE
                      DEFFILL 1,0,0
                    ENDIF
                    PBOX 350,50+i%*20,370,70+i%*20
                  NEXT i%
                  GOSUB turbo_weck
                ENDIF
                ja%=0
                @ueberwachen(392,230,407,246,1)
                IF ja%=1
                  FOR i%=0 TO 15
                    hl1%(i%)=fm%(15,i%)
                  NEXT i%
                  FOR my%=15 TO 1 STEP -1
                    FOR mx%=0 TO 15
                      fm%(my%,mx%)=fm%(my%-1,mx%)
                    NEXT mx%
                  NEXT my%
                  FOR i%=0 TO 15
                    fm%(0,i%)=hl1%(i%)
                  NEXT i%
                  @g_p1(50,50,370,350,50,70,370,370)
                  GRAPHMODE 1
                  FOR i%=0 TO 15
                    IF fm%(0,i%)=1
                      DEFFILL 1,2,4
                    ELSE
                      DEFFILL 1,0,0
                    ENDIF
                    PBOX 350-i%*20,50,370-i%*20,70
                  NEXT i%
                  GOSUB turbo_weck
                ENDIF
                ja%=0
                @ueberwachen(375,151,489,167,1)
                IF ja%=1
                  FOR mx%=0 TO 15
                    FOR my%=0 TO 15
                      IF fm%(my%,mx%)=0
                        fm%(my%,mx%)=1
                      ELSE
                        fm%(my%,mx%)=0
                      ENDIF
                    NEXT my%
                  NEXT mx%
                  @wrt
                  GOSUB turbo_weck
                ENDIF
                ja%=0
                IF schreibe%=1
                  @ueberwachen(375,103,489,119,1)
                  IF ja%=1
                    SGET l$
                    GOSUB hals
                    PRINT AT(32,1);"FÅllmuster einladen"
                    PRINT CHR$(27)+"p";
                    PRINT AT(23,2);" --------- FÅllmuster laden ------- "
                    PRINT CHR$(27)+"q"
                    DEFFILL 1,2,FALSE
                    PBOX 176,30,462,388
                    DEFFILL 1,FALSE,FALSE
                    PBOX 187,37,453,381
                    BOX 186,36,454,382
                    BOX 188,38,452,380
                    BOX 190,40,450,378
                    BOX 192,42,448,376
                    BOX 193,43,447,375
                    DRAW 193,64 TO 447,64
                    DRAW 193,65 TO 447,65
                    DRAW 193,67 TO 447,67
                    DRAW 193,69 TO 447,69
                    DRAW 193,70 TO 447,70
                    DEFTEXT 1,4,8,6
                    TEXT 215,56,"Zeichenprogramm    Format"
                    DEFTEXT 1,FALSE,8,6
                    TEXT 215,90,"VIC Soft Painter    PAT"
                    TEXT 215,115,"Tristar Plus Demo   FIL"
                    TEXT 215,140,"Hjb Paint V3.8      FIL"
                    TEXT 215,165,"Colorchrome         FIL"
                    TEXT 215,190,"The Artist          PAT"
                    TEXT 215,215,"Star Designer Demo  FIL"
                    TEXT 215,240,"Special Paint V2.3  PAT"
                    TEXT 215,265,"Butterfly V 1.10    FIL"
                    TEXT 215,290,"Constructive Paint  FLM"
                    REPEAT
                      IF MOUSEX>192 AND MOUSEX<445 AND MOUSEK=1
                        ' *** VIC Soft Painter ***
                        IF MOUSEY>70 AND MOUSEY<100
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.PAT")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          PUT 0,27,ver$
                          IF f$<>""
                            OPEN "I",#1,f$
                            FOR mx%=0 TO 15
                              FOR my%=0 TO 15
                                fm%(my%,mx%)=INP(#1)
                                IF EOF(#1)
                                  mx%=15
                                  my%=15
                                ENDIF
                              NEXT my%
                            NEXT mx%
                            CLOSE
                            @wrt
                            GOSUB turbo_weck
                          ENDIF
                          GOTO fox281
                        ENDIF
                        ' *** Tristar Demo V2.10 ***
                        IF MOUSEY>100 AND MOUSEY<125
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FIL")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          PUT 0,27,ver$
                          IF f$<>""
                            OPEN "I",#1,f$
                            muster$=""
                            i=0
                            WHILE NOT EOF(#1)
                              INPUT #1,w%
                              muster$=muster$+MKI$(w%)
                            WEND
                            CLOSE #1
                            DEFFILL ,muster$
                            PBOX -1,-1,16,16
                            FOR y%=0 TO 15
                              FOR x%=0 TO 15
                                fm%(x%,y%)=POINT(x%,y%)
                              NEXT x%
                            NEXT y%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fh%(i%,c8%)=fm%(i%,c8%)
                              NEXT c8%
                            NEXT i%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fm%(c8%,i%)=fh%(15-i%,c8%)
                              NEXT c8%
                            NEXT i%
                            @wrt
                            GOSUB turbo_weck
                          ENDIF
                          GOTO fox281
                        ENDIF
                        ' *** HjB Paint V3.8  ***
                        IF MOUSEY>125 AND MOUSEY<150
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FIL")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          PUT 0,27,ver$
                          IF f$<>""
                            OPEN "I",#1,f$
                            muster$=""
                            i=0
                            WHILE NOT EOF(#1)
                              INPUT #1,w%
                              muster$=muster$+MKI$(w%)
                            WEND
                            CLOSE #1
                            DEFFILL ,muster$
                            PBOX -1,-1,16,16
                            FOR y%=0 TO 15
                              FOR x%=0 TO 15
                                fm%(x%,y%)=POINT(x%,y%)
                              NEXT x%
                            NEXT y%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fh%(i%,c8%)=fm%(i%,c8%)
                              NEXT c8%
                            NEXT i%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fm%(c8%,i%)=fh%(15-i%,c8%)
                              NEXT c8%
                            NEXT i%
                            @wrt
                            GOSUB turbo_weck
                          ENDIF
                          GOTO fox281
                        ENDIF
                        ' *** Colorchrome V1.0 ***
                        IF MOUSEY>150 AND MOUSEY<175
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FIL")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          PUT 0,27,ver$
                          IF f$<>""
                            OPEN "I",#1,f$
                            muster$=""
                            i=0
                            WHILE NOT EOF(#1)
                              INPUT #1,w%
                              muster$=muster$+MKI$(w%)
                            WEND
                            CLOSE #1
                            DEFFILL ,muster$
                            PBOX -1,-1,16,16
                            FOR y%=0 TO 15
                              FOR x%=0 TO 15
                                fm%(x%,y%)=POINT(x%,y%)
                              NEXT x%
                            NEXT y%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fh%(i%,c8%)=fm%(i%,c8%)
                              NEXT c8%
                            NEXT i%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fm%(c8%,i%)=fh%(15-i%,c8%)
                              NEXT c8%
                            NEXT i%
                            @wrt
                            GOSUB turbo_weck
                          ENDIF
                          GOTO fox281
                        ENDIF
                        ' *** The Artist ***
                        IF MOUSEY>175 AND MOUSEY<200
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.PAT")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          OPEN "i",#1,f$
                          FOR y%=0 TO 15
                            FOR x%=0 TO 15
                              fm%(y%,x%)=1
                              BGET #1,VARPTR(fm%(y%,x%)),4
                            NEXT x%
                          NEXT y%
                          CLOSE #1
                          IF m%=1
                            muster$(pat%)=""
                            FOR x%=0 TO 15
                              word%(x%)=0
                              FOR y%=0 TO 15
                                IF fm%(y%,x%)=1
                                  word%(x%)=word%(x%) OR (2^(15-y%))
                                ENDIF
                              NEXT y%
                              muster$(pat%)=muster$(pat%)+MKI$(word%(x%))
                            NEXT x%
                            muster$=muster$(pat%)
                          ELSE
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fh%(i%,c8%)=fm%(i%,c8%)
                              NEXT c8%
                            NEXT i%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fm%(c8%,i%)=fh%(15-i%,c8%)
                                SWAP fm%(c8%,i%),fh%(15-i%,c8%)
                              NEXT c8%
                            NEXT i%
                            @wrt
                          ENDIF
                          PUT 0,27,ver$
                          GOSUB turbo_weck
                          GOTO fox281
                        ENDIF
                        ' *** Stardesigner Demo ***
                        IF MOUSEY>200 AND MOUSEY<225
                          SPUT l$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FIL")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          OPEN "i",#1,f$
                          flm$=INPUT$(32,#1)
                          CLOSE #1
                          DEFFILL 1,flm$
                          PBOX -1,-1,16,16
                          FOR y%=0 TO 15
                            FOR x%=0 TO 15
                              fm%(y%,x%)=POINT(x%,y%)
                            NEXT x%
                          NEXT y%
                          @wrt
                          GOSUB turbo_weck
                          GOTO fox281
                        ENDIF
                        ' *** Special Paint V2.3 ***
                        IF MOUSEY>225 AND MOUSEY<250
                          SPUT l$
                          GET 0,27,639,45,ver$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.PAT")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          PUT 0,27,ver$
                          IF f$<>""
                            OPEN "I",#1,f$
                            muster$=""
                            i=0
                            WHILE NOT EOF(#1)
                              INPUT #1,w%
                              muster$=muster$+MKI$(w%)
                            WEND
                            CLOSE #1
                            DEFFILL ,muster$
                            PBOX -1,-1,16,16
                            FOR y%=0 TO 15
                              FOR x%=0 TO 15
                                fm%(x%,y%)=POINT(x%,y%)
                              NEXT x%
                            NEXT y%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fh%(i%,c8%)=fm%(i%,c8%)
                              NEXT c8%
                            NEXT i%
                            FOR i%=0 TO 15
                              FOR c8%=0 TO 15
                                fm%(c8%,i%)=fh%(15-i%,c8%)
                              NEXT c8%
                            NEXT i%
                            @wrt
                            GOSUB turbo_weck
                          ENDIF
                          GOTO fox281
                        ENDIF
                        ' *** Butterfly Artists V1.10 ***
                        IF MOUSEY>250 AND MOUSEY<275
                          SPUT l$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FIL")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          OPEN "i",#1,f$
                          flm$=INPUT$(32,#1)
                          CLOSE #1
                          DEFFILL 1,flm$
                          PBOX -1,-1,16,16
                          FOR y%=0 TO 15
                            FOR x%=0 TO 15
                              fm%(y%,x%)=POINT(x%,y%)
                            NEXT x%
                          NEXT y%
                          @wrt
                          GOSUB turbo_weck
                          GOTO fox281
                        ENDIF
                        ' *** Constructive Paint V1.02 ***
                        IF MOUSEY>275 AND MOUSEY<300
                          SPUT l$
                          @umrandung(1)
                          GRAPHMODE 1
                          DEFFILL 1,2,2
                          PBOX -1,27,640,45
                          TEXT 319-LEN(" Muster laden ")*4,42," Muster laden "
                          GOSUB datei_erfragen("*.FLM")
                          IF EXIST(f$)=0
                            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
                            GOTO fox281
                          ENDIF
                          OPEN "i",#1,f$
                          flm$=INPUT$(32,#1)
                          CLOSE #1
                          DEFFILL 1,flm$
                          PBOX -1,-1,16,16
                          FOR y%=0 TO 15
                            FOR x%=0 TO 15
                              fm%(y%,x%)=POINT(x%,y%)
                            NEXT x%
                          NEXT y%
                          @wrt
                          GOSUB turbo_weck
                          GOTO fox281
                        ENDIF
                      ENDIF
                    UNTIL MOUSEK=2
                    SPUT l$
                    fox281:
                  ENDIF
                ENDIF
                ja%=0
                IF schreibe%=1
                  @ueberwachen(375,127,489,143,1)
                ENDIF
                IF ja%=1
                  IF schreibe%=1
                    GET 0,27,639,45,ver$
                    @umrandung(1)
                    GRAPHMODE 1
                    DEFFILL 1,2,2
                    PBOX -1,27,640,45
                    TEXT 319-LEN(" Muster speichern ")*4,42," Muster speichern "
                    GOSUB datei_erfragen("*.PAT")
                    PUT 0,27,ver$
                    IF f$<>""
                      OPEN "O",#1,f$
                      FOR mx%=0 TO 15
                        FOR my%=0 TO 15
                          OUT #1,fm%(my%,mx%)
                        NEXT my%
                      NEXT mx%
                      CLOSE
                    ENDIF
                  ENDIF
                ENDIF
                ja%=0
                @ueberwachen(375,79,489,95,1)
                IF ja%=1
                  DEFFILL 1,0,0
                  GRAPHMODE 1
                  PBOX 50,50,370,370
                  ARRAYFILL fm%(),0
                  fm%(15,15)=0
                  FOR i%=50 TO 370 STEP 20
                    DRAW 50,i% TO 370,i%
                    DRAW i%,50 TO i%,370
                  NEXT i%
                  GOSUB turbo_weck
                ENDIF
                ja%=0
              ENDIF
              IF x%>50 AND x%<370 AND y%>50 AND y%<370
                mx%=x%-50
                my%=y%-50
                mx%=INT(mx%/20)
                my%=INT(my%/20)
                IF k%=1 AND fm%(my%,15-mx%)=0
                  DEFFILL 1,2,4
                  GRAPHMODE 1
                  PBOX mx%*20+50,my%*20+50,mx%*20+70,my%*20+70
                  fm%(my%,15-mx%)=1
                  GOSUB turbo_weck
                ENDIF
                IF k%=2 AND fm%(my%,15-mx%)=1
                  DEFFILL 1,0,0
                  GRAPHMODE 1
                  PBOX mx%*20+50,my%*20+50,mx%*20+70,my%*20+70
                  fm%(my%,15-mx%)=0
                  GOSUB turbo_weck
                ENDIF
                ngtm:
              ENDIF
              EXIT IF k%=3
            LOOP
            IF schreibe%=0
              @saven
              INC hall%
              IF oremi%=FALSE
                PRINT #1,"' ***** FÅllmuster *****"
              ENDIF
              PRINT #1,"ERASE muster";hall%;"$()"
              PRINT #1,"FOR I=1 TO 16"
              PRINT #1,"READ muster"
              PRINT #1,"muster";hall%;"$=muster";hall%;"$+mki$(muster)"
              PRINT #1,"NEXT I"
              PRINT #1,"DEFFILL 1,muster";hall%;"$"
              FOR mx%=0 TO 15
                PRINT #1,"DATA &X";
                FOR my%=15 DOWNTO 0
                  PRINT #1,fm%(mx%,my%);
                  IF my%=0
                    PRINT #1
                  ENDIF
                NEXT my%
              NEXT mx%
            ENDIF
            GRAPHMODE graf%
            @defm
            GOSUB turbo_weck
            hammel=1
            v%=4
            f%=FALSE
            GOTO murmel_5
          ENDIF
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    murmel_5:
    GOSUB merge_bild
    IF c%=FALSE
      GOSUB rahmung(c%)
    ENDIF
    IF schreibe%=FALSE AND hammel=FALSE
      @saven
      IF oremi%=FALSE
        PRINT #1,"' *************** FÅllfarbe ***************"
      ENDIF
      PRINT #1,"DEFFILL 1,";v%;",";f%
    ENDIF
    hammel=FALSE
    GOSUB clipping_an
    ERASE p%()
    ERASE s%()
    ERASE d%()
    ERASE fm%()
    ERASE fh%()
    ERASE hl1%()
  ENDIF
  IF ld1$=" FÅlle aus "
    ALERT 3,"FÅlle|Quadrat,Rechteck|Kreis,Ellipse|I-Line,M-Kreis",1,"leer|voll",fu%
  ENDIF
  IF ld1$=" Lîsche Bild "
    ALERT 3,"Wollen Sie das Bild|wirklich lîschen  ?",2,"Ja|ZurÅck",d%
    IF d%=1
      CLS
      IF schreibe%=FALSE
        @saven
        IF oremi%=FALSE
          PRINT #1,"' ********** Bild lîschen **********"
        ENDIF
        PRINT #1,"CLS"
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" Draw "
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        HIDEM
        IF ofarbi%=FALSE
          IF POINT(MOUSEX,MOUSEY)=1 AND ccc%=0
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            GOSUB sdraw
          ENDIF
          IF POINT(MOUSEX,MOUSEY)=FALSE AND ccc%=1
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            GOSUB sdraw
          ENDIF
        ENDIF
        IF ofarbi%=1
          IF s_modus_1%=0
            DRAW x%,y% TO b%+xkord%,a%+ykord%
          ENDIF
          IF s_modus_1%=1
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            DRAW 639-x%,y% TO 639-b%+xkord%,a%+ykord%
          ENDIF
          IF s_modus_1%=3
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            DRAW 639-x%,y% TO 639-b%+xkord%,a%+ykord%
            DRAW x%,399-y% TO b%+xkord%,399-a%+ykord%
            DRAW 639-x%,399-y% TO 639-b%+xkord%,399-a%+ykord%
          ENDIF
          IF s_modus_1%=4
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            DRAW 639-x%,399-y% TO 639-b%+xkord%,399-a%+ykord%
          ENDIF
          IF s_modus_1%=2
            DRAW x%,y% TO b%+xkord%,a%+ykord%
            DRAW x%,399-y% TO b%+xkord%,399-a%+ykord%
          ENDIF
          GOSUB sdraw
        ENDIF
      ELSE
        SHOWM
      ENDIF
      b%=x%
      a%=y%
    UNTIL MOUSEK=2
    GOSUB henne
  ENDIF
  IF ld1$=" Effekt "
    ALERT 3,"Welchen Effekt wÅnschen Sie ?",3,"Horizontal|Vertikal|ZurÅck",ef%
    IF NOT ef%=3
      REPEAT
        x%=MOUSEX
        y%=MOUSEY
        IF MOUSEK=1
          ' ***** Farbe schwarz *****
          IF ofarbi%=FALSE
            IF ef%=1
              IF ccc%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  GOSUB busch
                ENDIF
              ELSE
                ' ***** Farbe weiû *****
                IF POINT(MOUSEX,MOUSEY)=1
                  GOSUB busch
                ENDIF
              ENDIF
            ENDIF
            ' ***** Farbe schwarz *****
            IF ef%=2
              IF ccc%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  DRAW x%,FALSE TO x%,399
                  @vline
                ENDIF
              ELSE
                ' ***** Farbe weiû *****
                IF POINT(MOUSEX,MOUSEY)=1
                  DRAW x%,FALSE TO x%,399
                  @vline
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          IF ofarbi%=1
            IF ef%=1
              GOSUB busch
            ELSE
              DRAW x%,FALSE TO x%,399
              @vline
            ENDIF
          ENDIF
        ENDIF
      UNTIL MOUSEK=2
      IF zahl%>FALSE AND schreibe%=FALSE
        PRINT #1,"*"
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" FÅlle "
    REPEAT
      IF MOUSEK=1
        DEFMOUSE 5
        IF MOUSEK=1
          x%=MOUSEX
          y%=MOUSEY
          DEFFILL 1,v%,f%
          IF ofarbi%=FALSE
            IF ccc%=FALSE
              IF POINT(MOUSEX,MOUSEY)=1
                GOSUB western
              ENDIF
            ELSE
              IF POINT(MOUSEX,MOUSEY)=FALSE
                GOSUB western
              ENDIF
            ENDIF
          ELSE
            GOSUB western
          ENDIF
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF ld1$=" Ellipse "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF s_modus_1%=0
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=1
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=2
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=3
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=4
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        PAUSE 5
        VSYNC
        IF s_modus_1%=0
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=1
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=2
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=3
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
        IF s_modus_1%=4
          ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
          ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
        ENDIF
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        ' ***** Farbe schwarz *****
        IF ofarbi%=FALSE
          IF ccc%=1
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
                GOSUB sellipse
              ENDIF
            ELSE
              ' ***** Ellipse ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=FALSE
                PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
                GOSUB spellipse
              ENDIF
            ENDIF
          ELSE
            ' ***** Farbe weiû *****
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=1
                ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
                GOSUB sellipse
              ENDIF
            ELSE
              ' ***** Ellipse ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=1
                PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
                GOSUB spellipse
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          IF fu%=1
            IF s_modus_1%=0
              ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=1
              ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=2
              ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=3
              ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=4
              ELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              ELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            GOSUB sellipse
          ELSE
            ' ***** Ellipse ausgefÅllt *****
            IF s_modus_1%=0
              PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=1
              PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=2
              PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=3
              PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE 639-a%,b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE a%,399-b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            IF s_modus_1%=4
              PELLIPSE a%,b%,ABS(a%-x%),ABS(b%-y%)
              PELLIPSE 639-a%,399-b%,ABS(a%-x%),ABS(b%-y%)
            ENDIF
            GOSUB spellipse
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
    IF zahl%>FALSE AND schreibe%=FALSE
      PRINT #1,"0,0,0,0"
    ENDIF
    SHOWM
  ENDIF
  IF ld1$=" Linie "
    REPEAT
      GOSUB hilfs_maus
      VSYNC
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        HIDEM
        IF s_modus_1%=0
          DRAW x%,y% TO a%+xkord%,b%+ykord%
        ENDIF
        IF s_modus_1%=1
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
        ENDIF
        IF s_modus_1%=2
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
        ENDIF
        IF s_modus_1%=3
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
          DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
          DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
        ENDIF
        IF s_modus_1%=4
          DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
          DRAW x%,y% TO a%+xkord%,b%+ykord%
        ENDIF
        VSYNC
        PAUSE 5
        IF s_modus_1%=0
          DRAW x%,y% TO a%+xkord%,b%+ykord%
        ENDIF
        IF s_modus_1%=1
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
        ENDIF
        IF s_modus_1%=2
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
        ENDIF
        IF s_modus_1%=3
          DRAW x%,y% TO a%+xkord%,b%+ykord%
          DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
          DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
          DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
        ENDIF
        IF s_modus_1%=4
          DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
          DRAW x%,y% TO a%+xkord%,b%+ykord%
        ENDIF
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        ' ********** Farbe schwarz **********
        IF ofarbi%=FALSE
          IF ccc%=1
            IF POINT(MOUSEX,MOUSEY)=FALSE
              DRAW x%,y% TO a%,b%
              GOSUB sline
            ENDIF
          ENDIF
          IF ccc%=0
            ' ********** Farbe weiû **********
            IF POINT(MOUSEX,MOUSEY)=1
              DRAW x%,y% TO a%,b%
              GOSUB sline
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          IF s_modus_1%=0
            DRAW x%,y% TO a%+xkord%,b%+ykord%
          ENDIF
          IF s_modus_1%=1
            DRAW x%,y% TO a%+xkord%,b%+ykord%
            DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
          ENDIF
          IF s_modus_1%=2
            DRAW x%,y% TO a%+xkord%,b%+ykord%
            DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
          ENDIF
          IF s_modus_1%=3
            DRAW x%,y% TO a%+xkord%,b%+ykord%
            DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
            DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
            DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
          ENDIF
          IF s_modus_1%=4
            DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
            DRAW x%,y% TO a%+xkord%,b%+ykord%
          ENDIF
          GOSUB sline
        ENDIF
      WEND
    UNTIL MOUSEK=2
    GOSUB henne
    SHOWM
  ENDIF
  IF ld1$=" Rechteck "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF s_modus_1%=0
          BOX a%,b%,x%,y%
        ENDIF
        IF s_modus_1%=1
          BOX a%,b%,x%,y%
          BOX a%,399-b%,x%,399-y%
        ENDIF
        IF s_modus_1%=2
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
        ENDIF
        IF s_modus_1%=3
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
          BOX a%,399-b%,x%,399-y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        IF s_modus_1%=4
          BOX a%,b%,x%,y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        VSYNC
        PAUSE 3
        IF s_modus_1%=0
          BOX a%,b%,x%,y%
        ENDIF
        IF s_modus_1%=1
          BOX a%,b%,x%,y%
          BOX a%,399-b%,x%,399-y%
        ENDIF
        IF s_modus_1%=2
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
        ENDIF
        IF s_modus_1%=3
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
          BOX a%,399-b%,x%,399-y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        IF s_modus_1%=4
          BOX a%,b%,x%,y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
      WEND
      xxx%=1
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF ofarbi%=FALSE
          ' ***** Farbe schwarz *****
          IF ccc%=1
            IF fu%=1
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  GOSUB regen
                ENDIF
              ELSE
                ' ***** Ecken rund *****
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  RBOX a%,b%,x%,y%
                  GOSUB rsquadrat
                ENDIF
              ENDIF
            ELSE
              ' ***** Rechteck ausgefÅllt *****
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  PBOX a%,b%,x%,y%
                  GOSUB sfquadrat
                ENDIF
              ELSE
                ' ***** Rechteck ausgefÅllt und Ecken rund *****
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  PRBOX a%,b%,x%,y%
                  GOSUB sprbox
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          ' ***** Farbe weiû *****
          IF ccc%=FALSE
            IF fu%=1
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=1
                  GOSUB regen
                ENDIF
              ELSE
                ' ***** Ecken rund *****
                IF POINT(MOUSEX,MOUSEY)=1
                  RBOX a%,b%,x%,y%
                  GOSUB rsquadrat
                ENDIF
              ENDIF
            ELSE
              ' ***** Rechteck ausgefÅllt *****
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=1
                  PBOX a%,b%,x%,y%
                  GOSUB sfquadrat
                ENDIF
              ELSE
                ' ***** Rechteck ausgefÅllt und Ecken rund *****
                IF POINT(MOUSEX,MOUSEY)=1
                  PRBOX a%,b%,x%,y%
                  GOSUB sprbox
                ENDIF
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          ' ***** Farbe schwarz *****
          IF fu%=1
            IF ka%=1
              GOSUB regen
            ELSE
              ' ***** Ecken rund *****
              IF s_modus_1%=0
                RBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                RBOX a%,b%,x%,y%
                RBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                RBOX a%,b%,x%,y%
                RBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                RBOX a%,b%,x%,y%
                RBOX 639-a%,b%,639-x%,y%
                RBOX a%,399-b%,x%,399-y%
                RBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                RBOX a%,b%,x%,y%
                RBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB rsquadrat
            ENDIF
          ENDIF
          ' ***** Rechteck ausgefÅllt *****
          IF fu%=2
            IF ka%=1
              IF s_modus_1%=0
                PBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                PBOX a%,b%,x%,y%
                PBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                PBOX a%,b%,x%,y%
                PBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                PBOX a%,b%,x%,y%
                PBOX 639-a%,b%,639-x%,y%
                PBOX a%,399-b%,x%,399-y%
                PBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                PBOX a%,b%,x%,y%
                PBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB sfquadrat
              ' ***** Rechteck ausgefÅllt und Ecken rund *****
            ELSE
              IF s_modus_1%=0
                PRBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                PRBOX a%,b%,x%,y%
                PRBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,b%,639-x%,y%
                PRBOX a%,399-b%,x%,399-y%
                PRBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB sprbox
            ENDIF
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
    GOSUB henne
    SHOWM
  ENDIF
  IF ld1$=" Kommentar "
    HIDEM
    ALERT 3,"Wollen Sie einen Kommentar|      einfÅgen ????? | entspricht Basic Befehl |---------- Rem ----------",2,"Ja|ZurÅck",d%
    IF d%=1
      SPUT l$
      PRINT AT(15,5);CHR$(27)+"p";" --- Text fÅr Rem Zeilen bitte eingeben --- ";CHR$(27)+"q"
      PRINT AT(15,7);
      FORM INPUT 200,a$
      GOSUB merge_bild
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Kommentar *****"
      ENDIF
      PRINT #1,"'";a$
    ENDIF
  ENDIF
  IF ld1$=" Maus an/aus "
    ALERT FALSE,"Was soll ich machen ?|Maus ein oder Maus ausschalten",3,"Ein|Aus|ZurÅck",mau%
    IF NOT mau%=3
      @saven
      IF mau%=1
        IF oremi%=FALSE
          PRINT #1,"' ***** Maus anschalten *****"
        ENDIF
        PRINT #1,"SHOWM"
      ELSE
        IF oremi%=FALSE
          PRINT #1,"' ***** Maus ausschalten *****"
        ENDIF
        PRINT #1,"HIDEM"
      ENDIF
    ENDIF
  ENDIF
  IF ld1$=" Quadrat "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF ABS(a%-x%)>ABS(b%-y%)
          y%=b%-(ABS(a%-x%)*SGN(b%-y%))
        ELSE
          x%=a%-(ABS(b%-y%)*SGN(a%-x%))
        ENDIF
        IF s_modus_1%=0
          BOX a%,b%,x%,y%
        ENDIF
        IF s_modus_1%=1
          BOX a%,b%,x%,y%
          BOX a%,399-b%,x%,399-y%
        ENDIF
        IF s_modus_1%=2
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
        ENDIF
        IF s_modus_1%=3
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
          BOX a%,399-b%,x%,399-y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        IF s_modus_1%=4
          BOX a%,b%,x%,y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        VSYNC
        PAUSE 3
        IF s_modus_1%=0
          BOX a%,b%,x%,y%
        ENDIF
        IF s_modus_1%=1
          BOX a%,b%,x%,y%
          BOX a%,399-b%,x%,399-y%
        ENDIF
        IF s_modus_1%=2
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
        ENDIF
        IF s_modus_1%=3
          BOX a%,b%,x%,y%
          BOX 639-a%,b%,639-x%,y%
          BOX a%,399-b%,x%,399-y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
        IF s_modus_1%=4
          BOX a%,b%,x%,y%
          BOX 639-a%,399-b%,639-x%,399-y%
        ENDIF
      WEND
      xxx%=2
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF ofarbi%=FALSE
          ' ***** Farbe schwarz *****
          IF ccc%=1
            IF fu%=1
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  GOSUB regen
                ENDIF
              ELSE
                ' ***** Ecken Rund *****
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  RBOX a%,b%,x%,y%
                  GOSUB rsquadrat
                ENDIF
              ENDIF
            ELSE
              ' ********* Quadrat ausgefÅllt *****
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  PBOX a%,b%,x%,y%
                  GOSUB sfquadrat
                ENDIF
              ELSE
                ' ***** Ecken Rund *****
                IF POINT(MOUSEX,MOUSEY)=FALSE
                  PRBOX a%,b%,x%,y%
                  GOSUB sprbox
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          ' ***** Farbe weiû *****
          IF ccc%=FALSE
            IF fu%=1
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=1
                  GOSUB regen
                ENDIF
              ELSE
                ' ***** Ecken Rund *****
                IF POINT(MOUSEX,MOUSEY)=1
                  RBOX a%,b%,x%,y%
                  GOSUB rsquadrat
                ENDIF
              ENDIF
            ELSE
              ' ********* Quadrat ausgefÅllt *****
              IF ka%=1
                IF POINT(MOUSEX,MOUSEY)=1
                  PBOX a%,b%,x%,y%
                  GOSUB sfquadrat
                ENDIF
              ELSE
                ' ***** Quadrat ausgefÅllt und Ecken rund *****
                IF POINT(MOUSEX,MOUSEY)=1
                  PRBOX a%,b%,x%,y%
                  GOSUB sprbox
                ENDIF
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          ' ***** Farbe schwarz *****
          IF fu%=1
            IF ka%=1
              GOSUB regen
            ELSE
              ' ***** Ecken Rund *****
              IF s_modus_1%=0
                RBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                RBOX a%,b%,x%,y%
                RBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                RBOX a%,b%,x%,y%
                RBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                RBOX a%,b%,x%,y%
                RBOX 639-a%,b%,639-x%,y%
                RBOX a%,399-b%,x%,399-y%
                RBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                RBOX a%,b%,x%,y%
                RBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB rsquadrat
            ENDIF
          ENDIF
          ' ********* Quadrat ausgefÅllt *****
          IF fu%=2
            IF ka%=1
              IF s_modus_1%=0
                PBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                PBOX a%,b%,x%,y%
                PBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                PBOX a%,b%,x%,y%
                PBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                PBOX a%,b%,x%,y%
                PBOX 639-a%,b%,639-x%,y%
                PBOX a%,399-b%,x%,399-y%
                PBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                PBOX a%,b%,x%,y%
                PBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB sfquadrat
            ELSE
              ' ***** Ecken Rund *****
              IF s_modus_1%=0
                PRBOX a%,b%,x%,y%
              ENDIF
              IF s_modus_1%=1
                PRBOX a%,b%,x%,y%
                PRBOX a%,399-b%,x%,399-y%
              ENDIF
              IF s_modus_1%=2
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,b%,639-x%,y%
              ENDIF
              IF s_modus_1%=3
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,b%,639-x%,y%
                PRBOX a%,399-b%,x%,399-y%
                PRBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              IF s_modus_1%=4
                PRBOX a%,b%,x%,y%
                PRBOX 639-a%,399-b%,639-x%,399-y%
              ENDIF
              GOSUB sprbox
            ENDIF
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
    GOSUB henne
    SHOWM
  ENDIF
  IF ld1$=" Mausform "
    ko:
    IF form=FALSE
      LET form$="Pfeil"
    ENDIF
    IF form=1
      LET form$="Text Klammer"
    ENDIF
    IF form=2
      LET form$="Biene"
    ENDIF
    IF form=3
      LET form$="Hand mit Zeigefinger"
    ENDIF
    IF form=4
      LET form$="offene Hand"
    ENDIF
    IF form=5
      LET form$="Fadenkreuz fein"
    ENDIF
    IF form=6
      LET form$="Fadenkreuz grob"
    ENDIF
    IF form=7
      LET form$="doppeltes Fadenkreuz"
    ENDIF
    ALERT 3,"Welche Mausform wÅnschen Sie ?| |Nr.       "+STR$(form)+"|Mausform  "+form$,3," + | - |>> OK <<",d%
    IF d%=1
      IF form=7
        LET form=TRUE
      ENDIF
      INC form
      GOTO ko
    ENDIF
    IF d%=2
      IF form=FALSE
        LET form=1
      ENDIF
      DEC form
      GOTO ko
    ENDIF
    IF d%=3
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Mausform ";form$;" *****"
      ENDIF
      PRINT #1,"DEFMOUSE ";form
    ENDIF
  ENDIF
  IF ld1$=" Pause "
    no:
    ALERT 3,"Wieviel Pause soll der|Computer machen ?| |  "+STR$(paua)+"   Sekunden",3," + | - |>> OK <<",d%
    IF d%=1
      INC paua
      GOTO no
    ENDIF
    IF d%=2
      IF paua=<FALSE
        paua=1
      ENDIF
      DEC paua
      GOTO no
    ENDIF
    IF d%=3
      @saven
      IF oremi%=FALSE
        PRINT #1,"' ***** Pause *****"
      ENDIF
      PRINT #1,"PAUSE ";paua*50
    ENDIF
  ENDIF
  IF ld1$=" I-Line "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF x%>a% AND y%>b%
          r1%=FALSE
          r2%=900
        ELSE
          r1%=2700
          r2%=3600
        ENDIF
        IF x%<a% AND y%>b%
          r1%=900
          r2%=1800
        ENDIF
        IF x%<a% AND y%<b%
          r1%=1800
          r2%=2700
        ENDIF
        IF s_modus_1%=0
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=1
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=2
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=3
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=4
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        PAUSE 5
        VSYNC
        IF s_modus_1%=0
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=1
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=2
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=3
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
        IF s_modus_1%=4
          ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
          ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
        ENDIF
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF ofarbi%=FALSE
          ' ********** Farbe schwarz **********
          IF ccc%=1
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
                GOSUB siline
              ENDIF
            ELSE
              IF POINT(MOUSEX,MOUSEY)=FALSE
                PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
                GOSUB silinef
              ENDIF
            ENDIF
          ELSE
            ' ********** Farbe weiû **********
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=1
                ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
                GOSUB siline
              ENDIF
            ELSE
              IF POINT(MOUSEX,MOUSEY)=1
                PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
                GOSUB silinef
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          ' ********** Farbe schwarz **********
          IF fu%=1
            IF s_modus_1%=0
              ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=1
              ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=2
              ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=3
              ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=4
              ELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              ELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            GOSUB siline
          ELSE
            IF s_modus_1%=0
              PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=1
              PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=2
              PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=3
              PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE 639-a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            IF s_modus_1%=4
              PELLIPSE a%,y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
              PELLIPSE 639-a%,399-y%,ABS(a%-x%),ABS(b%-y%),r1%,r2%
            ENDIF
            GOSUB silinef
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
    IF zahl%>FALSE AND schreibe%=FALSE
      PRINT #1,"0,0,0,0,0,0"
    ENDIF
    SHOWM
  ENDIF
  IF ld1$=" Kreis "
    REPEAT
      GOSUB hilfs_maus
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        IF s_modus_1%=0
          CIRCLE a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=1
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=2
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=3
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=4
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
        PAUSE 5
        VSYNC
        IF s_modus_1%=0
          CIRCLE a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=1
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=2
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=3
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,b%,ABS(a%-x%)
          CIRCLE a%,399-b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
        IF s_modus_1%=4
          CIRCLE a%,b%,ABS(a%-x%)
          CIRCLE 639-a%,399-b%,ABS(a%-x%)
        ENDIF
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF ofarbi%=FALSE
          ' ****** Farbe schwarz ******
          IF ccc%=1
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=FALSE
                CIRCLE a%,b%,ABS(a%-x%)
                GOSUB skreis
              ENDIF
            ELSE
              ' ***** Kreis ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=FALSE
                PCIRCLE a%,b%,ABS(a%-x%)
                GOSUB spkreis
              ENDIF
            ENDIF
          ELSE
            ' ****** Farbe weiû ******
            IF fu%=1
              IF POINT(MOUSEX,MOUSEY)=1
                CIRCLE a%,b%,ABS(a%-x%)
                GOSUB skreis
              ENDIF
            ELSE
              ' ***** Kreis ausgefÅllt *****
              IF POINT(MOUSEX,MOUSEY)=1
                PCIRCLE a%,b%,ABS(a%-x%)
                GOSUB spkreis
              ENDIF
            ENDIF
          ENDIF
        ENDIF
        IF ofarbi%=1
          ' ****** Farbe schwarz ******
          IF fu%=1
            IF s_modus_1%=0
              CIRCLE a%,b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=1
              CIRCLE a%,b%,ABS(a%-x%)
              CIRCLE a%,399-b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=2
              CIRCLE a%,b%,ABS(a%-x%)
              CIRCLE 639-a%,b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=3
              CIRCLE a%,b%,ABS(a%-x%)
              CIRCLE 639-a%,b%,ABS(a%-x%)
              CIRCLE a%,399-b%,ABS(a%-x%)
              CIRCLE 639-a%,399-b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=4
              CIRCLE a%,b%,ABS(a%-x%)
              CIRCLE 639-a%,399-b%,ABS(a%-x%)
            ENDIF
            GOSUB skreis
          ELSE
            ' ***** Kreis ausgefÅllt *****
            IF s_modus_1%=0
              PCIRCLE a%,b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=1
              PCIRCLE a%,b%,ABS(a%-x%)
              PCIRCLE a%,399-b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=2
              PCIRCLE a%,b%,ABS(a%-x%)
              PCIRCLE 639-a%,b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=3
              PCIRCLE a%,b%,ABS(a%-x%)
              PCIRCLE 639-a%,b%,ABS(a%-x%)
              PCIRCLE a%,399-b%,ABS(a%-x%)
              PCIRCLE 639-a%,399-b%,ABS(a%-x%)
            ENDIF
            IF s_modus_1%=4
              PCIRCLE a%,b%,ABS(a%-x%)
              PCIRCLE 639-a%,399-b%,ABS(a%-x%)
            ENDIF
            GOSUB spkreis
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
    IF zahl%>FALSE AND schreibe%=FALSE
      PRINT #1,"0,0,0"
    ENDIF
    SHOWM
  ENDIF
  IF ld1$=" Punkt "
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      WHILE MOUSEK=1
        HIDEM
        IF ofarbi%=FALSE
          IF POINT(MOUSEX,MOUSEY)=1 AND ccc%=0
            DRAW x%,y%
            GOSUB spunkt
          ENDIF
          IF POINT(MOUSEX,MOUSEY)=FALSE AND ccc%=1
            DRAW x%,y%
            GOSUB spunkt
          ENDIF
        ENDIF
        IF ofarbi%=1
          IF s_modus_1%=0
            DRAW x%,y% TO x%+xkord%,y%+ykord%
          ENDIF
          IF s_modus_1%=1
            DRAW x%,y% TO x%+xkord%,y%+ykord%
            DRAW x%,399-y% TO x%+xkord%,399-y%+ykord%
          ENDIF
          IF s_modus_1%=2
            DRAW x%,y% TO x%+xkord%,y%+ykord%
            DRAW 639-x%,y% TO 639-x%+xkord%,y%+ykord%
          ENDIF
          IF s_modus_1%=3
            DRAW x%,y% TO x%+xkord%,y%+ykord%
            DRAW 639-x%,y% TO 639-x%+xkord%,y%+ykord%
            DRAW x%,399-y% TO x%+xkord%,399-y%+ykord%
            DRAW 639-x%,399-y% TO 639-x%+xkord%,399-y%+ykord%
          ENDIF
          IF s_modus_1%=4
            DRAW 639-x%,399-y% TO 639-x%+xkord%,399-y%+ykord%
            DRAW x%,y% TO x%+xkord%,y%+ykord%
          ENDIF
          GOSUB spunkt
        ENDIF
      WEND
      SHOWM
    UNTIL MOUSEK=2
    GOSUB eimer
  ENDIF
  IF ld1$=" Schliese Datei "
    CLOSE #1
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      HIDEM
      BSAVE "BACKUP.DOO",XBIOS(2),32000
      CLS
      ld1$=""
      sav%=0
    ENDIF
  ENDIF
  IF ld1$=" MenÅ 2 "
    GOSUB himmel2
  ENDIF
  IF ld1$=" MenÅ 3 "
    GOSUB himmel3
  ENDIF
  IF ld1$=" MenÅ 4"
    GOSUB himmel4
  ENDIF
  IF ld1$=" Ende "
    REM    GOSUB infob
    GOSUB tta
  ENDIF
  IF ld1$=" Textarten "
    GOSUB clipping_aus
    SPUT l$
    GRAPHMODE 1
    o_marta_hari:
    stil%=FALSE
    winkel%=FALSE
    gros%=10
    ziehen%=FALSE
    HIDEM
    DEFFILL 1,2,3
    PBOX 10,10,630,390
    DEFFILL 1,2,4
    DEFTEXT 1,FALSE,3,32
    TEXT 17,45," >>>>>>>> Text Einstellungen <<<<<<<< "
    DEFFILL FALSE,2,5
    GOSUB kirche
    PBOX 358,61,625,375
    PRINT AT(46,5);CHR$(27)+"p";" ---- Textwinkel einstellen ---- ";CHR$(27)+"q"
    PRINT AT(56,6);"Winkel "
    PRINT AT(65,6);winkel%
    PRINT AT(46,7);CHR$(27)+"p";" ----- Textgrîûe einstellen ---- ";CHR$(27)+"q"
    PRINT AT(56,8);"Grîûe "
    PRINT AT(65,8);gros%
    PRINT AT(46,9);CHR$(27)+"p";" ----- Textstil einstellen ----- ";CHR$(27)+"q"
    PRINT AT(56,10);"Stil "
    PRINT AT(65,10);stil%
    PRINT AT(46,11);CHR$(27)+"p";" ----- Text ziehen/stauchen ---- ";CHR$(27)+"q"
    PRINT AT(56,12);"Ziehen "
    PRINT AT(65,12);ziehen%
    PRINT AT(46,13);CHR$(27)+"p";" --- Was wollen Sie Ñndern ? --- ";CHR$(27)+"q"
    PRINT AT(47,14);"Anfangsbuchstaben bitte eingeben"
    PRINT AT(47,16);"W = Winkel (0,900,1800,2700)"
    PRINT AT(47,17);"S = Stil             (0..32)"
    PRINT AT(47,18);"G = Grîûe            (0..26)"
    PRINT AT(47,19);"Z = Ziehen/Stauchen (0.....)"
    PRINT AT(47,20);"E = Erneuere diesen Bildschirm"
    PRINT AT(47,21);"N = Nichts (ZurÅck zum Programm)"
    PRINT AT(47,22);"                  oder Mausklick"
    REPEAT
      PRINT AT(47,23);CHR$(27)+"p";" Ihre Eingabe ";CHR$(27)+"q";" ";
      eingabe$=INKEY$
      eingabe$=UPPER$(eingabe$)
      IF eingabe$="E"
        GOTO o_marta_hari
      ENDIF
      ' ******* Winkel *********
      IF eingabe$="W"
        PRINT AT(65,6);SPACE$(7)
        PRINT AT(65,6);
        FORM INPUT 4,winkel$
        winkel%=VAL(winkel$)
        IF winkel%>3000
          winkel%=2700
        ENDIF
        GOSUB kirche
      ENDIF
      ' ***** Grîûe *************
      IF eingabe$="G"
        PRINT AT(65,8);SPACE$(7)
        PRINT AT(65,8);
        FORM INPUT 2,gros$
        gros%=VAL(gros$)
        GOSUB kirche
      ENDIF
      ' ***** Stil **************
      IF eingabe$="S"
        PRINT AT(65,10);SPACE$(7)
        PRINT AT(65,10);
        FORM INPUT 3,stil$
        stil%=VAL(stil$)
        GOSUB kirche
      ENDIF
      ' ***** Ziehen/Stauchen ******
      IF eingabe$="Z"
        PRINT AT(65,12);SPACE$(7)
        PRINT AT(65,12);
        FORM INPUT 3,ziehen$
        ziehen%=VAL(ziehen$)
        GOSUB kirche
      ENDIF
    UNTIL eingabe$="N" OR MOUSEK
    GOSUB merge_bild
    IF schreibe%=FALSE
      @saven
      IF oremi%=FALSE
        PRINT #1,"'********** Einstellungen des Textes **********"
      ENDIF
      PRINT #1,"DEFTEXT 1,";stil%;",";winkel%;",";gros%
    ENDIF
    GOSUB was1
  ENDIF
  IF ld1$=" Scroll "
    ALERT 3,"Bildschirm scrollen     ?",3,"---->|<----|ZurÅck",d%
    IF d%=3
      GOTO famili
    ENDIF
    REPEAT
      WHILE MOUSEK=1
        IF d%=1
          IF oremi%=FALSE AND zahl%=FALSE AND schreibe%=FALSE
            @saven
            PRINT #1,"' ********** Bildschirm verschieben ------> **********"
          ENDIF
          BMOVE XBIOS(3),XBIOS(3)+1,32000
          IF schreibe%=FALSE
            @saven
            PRINT #1,"BMOVE Xbios(3),Xbios(3)+1,32000"
          ENDIF
          zahl%=1
          WHILE MOUSEK=1
          WEND
        ENDIF
        IF d%=2
          IF oremi%=FALSE AND zahl%=FALSE AND schreibe%=FALSE
            @saven
            PRINT #1,"' ********** Bildschirm verschieben <------ **********"
          ENDIF
          BMOVE XBIOS(3)+1,XBIOS(3),32000
          IF schreibe%=FALSE
            @saven
            PRINT #1,"BMOVE Xbios(3)+1,Xbios(3),32000"
          ENDIF
          WHILE MOUSEK=1
          WEND
          zahl%=1
        ENDIF
      WEND
    UNTIL MOUSEK=2
    famili:
  ENDIF
  DEFMOUSE 3
  g$=z$
  GOSUB zeige_bild
  MENU menue1$()
  ON MENU  GOSUB auswerten1
  ON MENU KEY GOSUB tastatur
RETURN
PROCEDURE lade_img
  LOCAL a%,auspack$,d%,d$,w%,h%,s$,ass_in%,fehler%,z%,xb%,n%
  f$=f$+CHR$(0)
  auspack$=""
  RESTORE auspack1
  DO
    READ a%
    EXIT IF a%<0
    auspack$=auspack$+MKI$(a%)
  LOOP
  VOID FRE(0)
  VOID GEMDOS(78,L:VARPTR(f$),1+2+4+16+32)
  laenge%=LPEEK(GEMDOS(47)+26)
  d$=SPACE$(laenge%)
  BLOAD f$,VARPTR(d$)
  d%=VARPTR(d$)
  w%=DPEEK(d%+12)
  h%=DPEEK(d%+14)
  IF RIGHT$(f$,5)=".IMG"+CHR$(0) AND DPEEK(d%+2)=8 AND DPEEK(d%+4)=1 AND DPEEK(d%+6)=2 AND w%<=640 AND h%<=400
    s$=SPACE$(32000)
    s%=VARPTR(s$)
    ass_in%=VARPTR(auspack$)
    VOID C:ass_in%(2,L:s%,L:d%,w%,h%)
    IF fehler%=0
      z%=XBIOS(2)
      xb%=(w%+7) DIV 8
      FOR n%=0 TO h%-1
        BMOVE s%,z%,xb%
        ADD s%,xb%
        ADD z%,80
      NEXT n%
    ENDIF
  ENDIF
  auspack1:
  ' MCODE A:\IMG_LES.INL
  DATA 18663,32766,19439,60,12317,9309,9821,13341
  DATA 13853,21312,26368,192,12331,2,3136,8
  DATA 26112,174,11819,12,46663,25090,13831,18503
  DATA 24135,58959,18411,16,15362,24134,58958,40518
  DATA 17479,27392,140,21315,30720,10314,14854,39495
  DATA 24660,28672,4123,26154,4123,26128,4123,20992
  DATA 26222,19012,26218,6171,21316,24806,5147,57674
  DATA 5147,12802,18497,12802,53312,39488,24832,592
  DATA 24612,27166,576,127,26132,28672,4123,39488
  DATA 8267,8778,24832,618,9289,9800,24584,29439
  DATA 24792,29184,24788,19013,26280,8268,8778,53959
  DATA 24590,28672,12294,24832,584,53959,21315,27402
  DATA 20940,65520,9289,20939,65408,28672,24576,376
  DATA 28673,24576,370,10826,14338,24132,58956,16890
  DATA 408,9432,9432,9432,13506,13507,24576,336
  DATA 8267,17395,16384,19011,26416,15420,254,48195
  DATA 25858,15363,14854,21318,45120,24584,9800,12292
  DATA 24832,598,22221,65526,40005,26382,38470,21062
  DATA 16922,16922,5372,255,5318,14852,21317,21061
  DATA 10315,28673,24594,28672,4123,26464,20992,26368
  DATA 164,21248,45099,1,22477,65516,26112,232
  DATA 8267,57688,4120,12800,18497,12800,28672,12293
  DATA 24832,290,11336,21569,57929,25602,21326,3137
  DATA 2,28606,39489,39489,18497,24832,208,18497
  DATA 16922,12348,255,45632,27138,12289,5312,5355
  DATA 65535,5331,37440,26344,9806,24722,11275,21382
  DATA 40076,26392,19013,26384,18963,26264,3141,1
  DATA 26374,18987,1,26252,24832,146,8267,28672
  DATA 12293,29184,24832,190,21057,12289,13372,127
  DATA 45634,27138,13313,5314,37442,26356,9800,39488
  DATA 24576,65356,11275,21382,40076,26396,19013,26390
  DATA 21312,45075,26112,65358,3141,1,26376,45099
  DATA 1,26112,65344,24900,8267,28672,12293,29439
  DATA 24946,21057,12289,13372,127,45634,27138,13313
  DATA 66,128,5314,578,127,37442,26348,9800
  DATA 39488,24576,65274,11275,40076,26370,24854,20939
  DATA 65200,8202,37005,19679,32766,20085,11275,40076
  DATA 21318,26402,8778,8268,15932,255,48710,28418
  DATA 15878,4860,128,4807,28672,4103,24832,146
  DATA 40007,26340,9289,20085,1,8,1,2
  DATA 372,372,9224,2050,0,26380,57753,45592
  DATA 26164,20936,4,24624,58520,576,16383,45120
  DATA 24578,45720,22216,65532,26372,22920,28927,53376
  DATA 25610,18497,45656,26372,21896,28927,19072,27144
  DATA 57753,45592,26370,21384,8712,37506,20085,9226
  DATA 2050,0,26378,57753,5313,20936,4,24606
  DATA 58520,576,16383,24578,9409,20936,65532,58264
  DATA 25604,18497,13505,19072,27140,57753,5313,20085
  DATA 18663,32574,12808,13321,577,1,578,1
  DATA 45890,26172,19009,26374,4824,21312,26436,33020
  DATA 48,24588,19672,31998,18641,31998,17385,48
  DATA 20936,65522,18496,18624,58520,24578,8920,20936
  DATA 65532,58248,25602,13016,19072,27158,4824,24594
  DATA 24578,4824,20936,65532,18496,21312,25860,18496
  DATA 24816,19679,31998,20085,45832,26176,21312,26428
  DATA 12808,13321,577,1,578,1,45890,26162
  DATA 19009,26376,45832,26148,21312,26400,58520,576
  DATA 16383,45120,24578,45960,22216
  DATA -1
RETURN
PROCEDURE saven
  baby:
  IF sav%=FALSE
    IF EXIST(k$)=TRUE
      ALERT 3,"Bitte legen Sie eine Leere|Formatierte Disk in Laufwerk A|zum Abspeichern der Bilder ein.|Bitte Schreibschutz entfernen.",1," Klaro ",d%
      GOTO baby
    ENDIF
    OPEN "O",#1,f$
    IF f$<>""
      PRINT #1,"' -----------------------------------------------"
      PRINT #1,"' ------- Sigi - Painter       Version 98  ------"
      PRINT #1,"' -----------------------------------------------"
      PRINT #1,"' --- Sourcecode in GFA-Basic (LST) Format    ---"
      PRINT #1,"' -----------------------------------------------"
      PRINT #1,"' -------- (c) 1998 by  Siegfried HÅbner --------"
      PRINT #1,"' -----------------------------------------------"
      PRINT #1,"CLS"
      PRINT #1,"RESTORE"
      IF oremi%=FALSE
        PRINT #1," '********** Grundeinstellungen **********"
      ENDIF
      PRINT #1,"HIDEM"
      PRINT #1,"COLOR";ccc%
      PRINT #1,"GRAPHMODE";graf%
      PRINT #1,"DEFFILL 1,";v%;",";f%
      PRINT #1,"DEFTEXT 1,";stil%;",";winkel%;",";gros%
      PRINT #1,"DEFLINE ";kj;",";bh;",";anfang;",";schluss
      IF hintergrund%=0
        PRINT #1,"SETCOLOR 0,1"
      ENDIF
      IF hintergrund%=1
        PRINT #1,"SETCOLOR 0,1"
      ENDIF
      IF hintergrund%=2
        PRINT #1,"SETCOLOR 0,0"
      ENDIF
      PRINT #1,"DPOKE INTIN,";c%
      PRINT #1,"VDISYS 104"
      sav%=1
    ENDIF
  ENDIF
RETURN
PROCEDURE spunkt
  IF schreibe%=FALSE
    GOSUB porsche
    PRINT #1,HEX$(x%);",";HEX$(y%);
    GOSUB lord
  ENDIF
RETURN
PROCEDURE yspunkt
  IF schreibe%=FALSE
    GOSUB porsche
    PRINT #1,HEX$(x%-1);",";HEX$(y%);
    GOSUB lord
  ENDIF
RETURN
PROCEDURE sdraw
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Draw zeichnen ***************"
      ENDIF
      GOSUB amiga
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(b%+xkord%);",";HEX$(a%+ykord%);
    GOSUB ford
  ENDIF
RETURN
PROCEDURE sline
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** Line zeichnen ***************"
      ENDIF
      GOSUB amiga
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
  ENDIF
RETURN
PROCEDURE skreis
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** Kreis zeichnen ***************"
      ENDIF
      GOSUB essen
      PRINT #1,"CIRCLE A%,B%,ABS(A%-X%)"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";b%;",";x%;
    GOSUB mops
  ENDIF
RETURN
PROCEDURE spkreis
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** Kreis ausgefÅllt ***************"
      ENDIF
      GOSUB essen
      PRINT #1,"PCIRCLE A%,B%,ABS(A%-X%)"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";b%;",";x%;
    GOSUB mops
  ENDIF
RETURN
PROCEDURE spellipse
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** Ellipse ausgefÅllt zeichnen ***************"
      ENDIF
      GOSUB lkw
      PRINT #1,"PELLIPSE A%,B%,X%,Y%"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";b%;",";ABS(a%-x%);",";ABS(b%-y%);
    GOSUB ford
  ENDIF
RETURN
PROCEDURE sellipse
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** Ellipse leer zeichnen ***************"
      ENDIF
      GOSUB lkw
      PRINT #1,"ELLIPSE A%,B%,X%,Y%"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";b%;",";ABS(a%-x%);",";ABS(b%-y%);
    GOSUB ford
  ENDIF
RETURN
PROCEDURE sfquadrat
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        IF xxx%=2
          PRINT #1,"' *************** Quadrat ausgefÅllt zeichnen ***************"
        ENDIF
        IF xxx%=1
          PRINT #1,"' ************** Rechteck ausgefÅllt zeichnen ***************"
        ENDIF
      ENDIF
      GOSUB teller
      PRINT #1,"PBOX val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),val(";CHR$(34);"&H";CHR$(34);"+A$),val(";CHR$(34);"&H";CHR$(34);"+B$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
    xxx%=FALSE
  ENDIF
RETURN
PROCEDURE rsquadrat
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        IF xxx%=2
          PRINT #1,"' ********** Quadrat leer (Ecken rund) zeichnen ***********"
        ENDIF
        IF xxx%=1
          PRINT #1,"' ********** Rechteck leer (Ecken rund) zeichnen **********"
        ENDIF
      ENDIF
      GOSUB teller
      PRINT #1,"RBOX val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),val(";CHR$(34);"&H";CHR$(34);"+A$),val(";CHR$(34);"&H";CHR$(34);"+B$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
    xxx%=FALSE
  ENDIF
RETURN
PROCEDURE sprbox
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        IF xxx%=2
          PRINT #1,"' ***** Quadrat ausgefÅllt mit (runden Ecken) zeichen *****"
        ENDIF
        IF xxx%=1
          PRINT #1,"' **** Rechteck ausgefÅllt mit (runden Ecken) zeichnen ****"
        ENDIF
      ENDIF
      GOSUB teller
      PRINT #1,"PRBOX val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),val(";CHR$(34);"&H";CHR$(34);"+A$),val(";CHR$(34);"&H";CHR$(34);"+B$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
    xxx%=FALSE
  ENDIF
RETURN
PROCEDURE vline
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' **** Effekt vertikal zeichnen ****"
      ENDIF
      GOSUB post
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+Y$),FALSE TO val(";CHR$(34);"&H";CHR$(34);"+Y$),399"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);
    IF NOT zahl%=50
      PRINT #1,",";
    ENDIF
    INC zahl%
    IF zahl%=51
      GOSUB iris
    ENDIF
  ENDIF
RETURN
PROCEDURE siline
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** I-Line zeichnen ***************"
      ENDIF
      GOSUB spiel
      PRINT #1,"ELLIPSE A%,Y%,Abs(A%-X%),Abs(B%-Y%),R1%,R2%"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";y%;",";x%;",";b%;",";r1%;",";r2%;
    GOSUB marta
  ENDIF
RETURN
PROCEDURE silinef
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** I-Line ausgefÅllt zeichnen ***************"
      ENDIF
      GOSUB spiel
      PRINT #1,"PELLIPSE A%,Y%,Abs(A%-X%),Abs(B%-Y%),R1%,R2%"
      GOSUB bums
    ENDIF
    PRINT #1,a%;",";y%;",";x%;",";b%;",";r1%;",";r2%;
    GOSUB marta
  ENDIF
RETURN
PROCEDURE hilfs_maus
  SHOWM
  REPEAT
  UNTIL MOUSEK
  GRAPHMODE 3
  a%=MOUSEX
  b%=MOUSEY
  REPEAT
  UNTIL MOUSEK<>1
  HIDEM
RETURN
PROCEDURE fehlerio1
  SHOWM
  GOSUB monitor
  RESUME starter
  RESUME NEXT
RETURN
PROCEDURE fehlerio2
  SHOWM
  GOSUB monitor
  RESUME starter_2
  RESUME NEXT
RETURN
PROCEDURE fehlerio3
  SHOWM
  GOSUB monitor
  RESUME starter_3
  RESUME NEXT
RETURN
PROCEDURE fehlerio4
  SHOWM
  GOSUB monitor
  RESUME starter_4
  RESUME NEXT
RETURN
PROCEDURE fehlerio_tast
  SHOWM
  GOSUB monitor
  RESTORE tastatur_f
  RESUME NEXT
RETURN
PROCEDURE infol
  GOSUB clipping_aus
  SPUT l$
  CLS
  zahl%=FALSE
  GRAPHMODE 1
  DEFLINE 1,FALSE,2,2
  COLOR 1
  DEFFILL 1,2,8
  PBOX 110,10,530,390
  DEFFILL 1,2,3
  PBOX 120,20,520,380
  DEFFILL 1,2,4
  PBOX 130,30,510,370
  DEFFILL 1,2,5
  PBOX 140,40,500,360
  BOX 150,50,490,350
  HIDEM
  r=24
  m=24
  DEFFILL 1,2,1
  PRBOX 160,60,480,340
  DEFFILL 1,2,2
  PRBOX 200,100,440,300
  DEFTEXT 1,16,20,20
  TEXT 210,90,225,"Sigi - Painter"
  PRINT AT(28,21);CHR$(27)+"p";" Bitte eine Taste drÅcken  ";CHR$(27)+"q"
  DEFTEXT 1,FALSE,3,10
  c1$="    Siegfried HÅbner        "
  c2$="    St.-Gundekar-Str. 29 b  "
  c3$="    91560 Heilsbronn        "
  c4$="         FREEWARE           "
  c5$="   kann kopiert verÑndert   "
  c6$="    und erweitert werden    "
  c7$="geschrieben in GFA Basic 2.0"
  PRINT AT(27,9);c1$
  PRINT AT(27,10);c2$
  PRINT AT(27,11);c3$
  DRAW 200,185 TO 440,185
  PRINT AT(27,13);"Letzte Bearbeitung 22.01.2022"
  DRAW 200,215 TO 440,215
  PRINT AT(27,15);c4$
  PRINT AT(27,16);c5$
  PRINT AT(27,17);c6$
  PRINT AT(27,18);c7$
  TEXT 210,120,220," ~~~ Version  98 ~~~ "
  DEFTEXT 1,0,1,4
  PRINT AT(27,3);"Version 98 vom 1 Oktober 1998"
  REPEAT
  UNTIL MOUSEK OR INKEY$=>CHR$(FALSE)
  GOSUB was1
RETURN
PROCEDURE intro_lade_bild
  GOSUB kind
  DEFTEXT 1,FALSE,3,32
  GRAPHMODE 2
  TEXT 170,45,">>>> Lade Bild <<<<"
  PRINT AT(21,24);CHR$(27)+"p"+" -- Zu ladendes Bild hier auswÑhlen. -- ";CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 150,360,489,390
RETURN
PROCEDURE intro_lade_block
  GOSUB kind
  DEFTEXT 1,FALSE,3,32
  GRAPHMODE 2
  TEXT 180,45,">>> Lade Block <<<"
  PRINT AT(21,24);CHR$(27)+"p";" - Zu ladenden Block hier auswÑhlen.  - ";CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 150,360,489,390
RETURN
PROCEDURE intro_save_bild
  GOSUB kind
  DEFTEXT 1,FALSE,3,32
  GRAPHMODE 2
  TEXT 180,45,">>> Save Bild <<<"
  PRINT AT(21,24);CHR$(27)+"p";" - Zu speicherndes Bild hier eingeben.- ";CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 150,360,489,390
RETURN
PROCEDURE lord
  IF NOT zahl%=30
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=31
    GOSUB iris
  ENDIF
RETURN
PROCEDURE ford
  IF NOT zahl%=14
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=15
    GOSUB iris
  ENDIF
RETURN
PROCEDURE kurt
  IF NOT zahl%=9
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=10
    GOSUB iris
  ENDIF
RETURN
PROCEDURE mops
  IF NOT zahl%=18
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=19
    GOSUB iris
  ENDIF
RETURN
PROCEDURE fot
  IF NOT zahl%=28
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=29
    GOSUB iris
  ENDIF
RETURN
PROCEDURE marta
  IF NOT zahl%=7
    PRINT #1,",";
  ENDIF
  INC zahl%
  IF zahl%=8
    GOSUB iris
  ENDIF
RETURN
PROCEDURE iris
  PRINT #1
  PRINT #1,"DATA ";
  zahl%=1
RETURN
PROCEDURE eimer
  IF zahl%>FALSE AND schreibe%=FALSE
    PRINT #1,"*,*"
  ENDIF
RETURN
PROCEDURE frosch
  PRINT AT(1,14);"Im Laufwerk K sind ";DFREE(11);" frei."
  PRINT AT(1,15);"Im Laufwerk L sind ";DFREE(12);" frei."
  PRINT AT(1,16);"Im Laufwerk M sind ";DFREE(13);" frei."
RETURN
PROCEDURE bach
  GOSUB hamster
  PRINT AT(1,9);"Im Laufwerk F sind ";DFREE(6);" frei."
  PRINT AT(1,10);"Im Laufwerk G sind ";DFREE(7);" frei."
  PRINT AT(1,11);"Im Laufwerk H sind ";DFREE(8);" frei."
  PRINT AT(1,12);"Im Laufwerk I sind ";DFREE(9);" frei."
  PRINT AT(1,13);"Im Laufwerk J sind ";DFREE(10);" frei."
RETURN
PROCEDURE hamster
  PRINT AT(1,6);"Im Laufwerk C sind ";DFREE(3);" frei."
  PRINT AT(1,7);"Im Laufwerk D sind ";DFREE(4);" frei."
  PRINT AT(1,8);"Im Laufwerk E sind ";DFREE(5);" frei."
RETURN
PROCEDURE schnecke
  GOSUB bach
  GOSUB frosch
RETURN
PROCEDURE roth(ro1%)
  v%=2
  f%=ro1%
  GOSUB wasser
RETURN
PROCEDURE milch(mi%)
  v%=3
  f%=mi%
  GOSUB wasser
RETURN
PROCEDURE wasser
  DEFFILL 1,v%,f%
  PBOX 40,300,600,380
RETURN
PROCEDURE sonne
  MOUSE mousex,mousey,mousek
  VSYNC
  s(i)=MOUSEX
  f(i)=MOUSEY
RETURN
PROCEDURE kind
  SPUT l$
  CLS
  GOSUB murmel
RETURN
PROCEDURE murmel
  BOX 157,15,482,52
  BOX 159,17,480,50
  DEFFILL 1,2,2
  PBOX 160,18,479,49
RETURN
PROCEDURE western
  DPOKE PTSIN,x%
  DPOKE PTSIN+2,y%
  DPOKE CONTRL+2,1
  DPOKE CONTRL+6,1
  VDISYS 103
  IF schreibe%=FALSE
    @saven
    IF oremi%=FALSE
      PRINT #1,"' ********** FÅlle FlÑche aus **********"
    ENDIF
    PRINT #1,"FILL ";x%;",";y%
  ENDIF
RETURN
PROCEDURE frau
  DEFMARK mfarb%,mtyp%,mgross%
  POLYMARK 1,s(),f()
  IF schreibe%=FALSE
    @saven
    IF oremi%=FALSE AND zahl%=FALSE
      PRINT #1,"' ********** Marker setzen *********"
    ENDIF
    IF uz=FALSE
      PRINT #1,"Erase s()"
      PRINT #1,"Erase f()"
      PRINT #1,"Dim s(1),f(1)"
      uz=1
    ENDIF
    IF log=FALSE
      PRINT #1,"DEFMARK ";mfarb%;",";mtyp%;",";mgross%
      log=1
    ENDIF
    IF zahl%=FALSE
      PRINT #1,"DO"
      PRINT #1,"READ x,y"
      PRINT #1,"EXIT IF X=FALSE and y=FALSE"
      PRINT #1,"s(i)=x"
      PRINT #1,"f(i)=y"
      PRINT #1,"POLYMARK 1,s(),f()"
      GOSUB bums
    ENDIF
    PRINT #1,s(i);",";f(i);
    IF NOT zahl%=20
      PRINT #1,",";
    ENDIF
    INC zahl%
    IF zahl%=21
      GOSUB iris
    ENDIF
  ENDIF
RETURN
PROCEDURE dach
  DRAW ff%-x%,k%-y% TO ff%-b%+xkord%,k%-a%+ykord%
  DRAW x%,k%-y% TO b%+xkord%,k%-a%+ykord%
  DRAW x%,y% TO b%+xkord%,a%+ykord%
  DRAW ff%-x%,y% TO ff%-b%+xkord%,a%+ykord%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Spiegel alle Richtungen zeichnen ***************"
      ENDIF
      PRINT #1,"DO"
      PRINT #1,"READ X$,Y$,B$,A$"
      PRINT #1,"EXIT IF X$=";CHR$(34);"*";CHR$(34);"AND Y$=";CHR$(34);"*";CHR$(34);"AND A$=";CHR$(34);"*";CHR$(34);"AND B$=";CHR$(34);"*";CHR$(34);""
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+b$),val(";CHR$(34);"&H";CHR$(34);"+a$)"
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),399-val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+b$),399-val(";CHR$(34);"&H";CHR$(34);"+a$)"
      PRINT #1,"DRAW 639-val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639-val(";CHR$(34);"&H";CHR$(34);"+b$),val(";CHR$(34);"&H";CHR$(34);"+a$)"
      PRINT #1,"DRAW 639-val(";CHR$(34);"&H";CHR$(34);"+X$),399-val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639-val(";CHR$(34);"&H";CHR$(34);"+b$),399-val(";CHR$(34);"&H";CHR$(34);"+a$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(b%+xkord%);",";HEX$(a%+ykord%);
    GOSUB kurt
  ENDIF
RETURN
PROCEDURE luck
  DRAW x%,y% TO b%+xkord%,a%+ykord%
  DRAW ff%-x%,k%-y% TO ff%-b%+xkord%,k%-a%+ykord%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Spiegeln quer zeichnen ***************"
      ENDIF
      GOSUB teller
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+B$),val(";CHR$(34);"&H";CHR$(34);"+A$)"
      PRINT #1,"DRAW 639-val(";CHR$(34);"&H";CHR$(34);"+X$),399-val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639-val(";CHR$(34);"&H";CHR$(34);"+B$),399-val(";CHR$(34);"&H";CHR$(34);"+A$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%+ykord%);",";HEX$(b%+xkord%);
    GOSUB kurt
  ENDIF
RETURN
PROCEDURE fliege
  DRAW x%,y% TO b%+xkord%,a%+ykord%
  DRAW x%,k%-y% TO b%+xkord%,k%-a%+ykord%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Spiegeln horizontal zeichnen ***************"
      ENDIF
      GOSUB teller
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+B$),val(";CHR$(34);"&H";CHR$(34);"+A$)"
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),399-val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+B$),399-val(";CHR$(34);"&H";CHR$(34);"+A$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%+ykord%);",";HEX$(b%+xkord%);
    GOSUB kurt
  ENDIF
RETURN
PROCEDURE schuh
  DRAW x%,y% TO b%+xkord%,a%+ykord%
  DRAW ff%-x%,y% TO ff%-b%+xkord%,a%+ykord%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Spiegel vertikal zeichnen ***************"
      ENDIF
      GOSUB teller
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+B$),val(";CHR$(34);"&H";CHR$(34);"+A$)"
      PRINT #1,"DRAW 639-val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639-val(";CHR$(34);"&H";CHR$(34);"+B$),val(";CHR$(34);"&H";CHR$(34);"+A$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%+ykord%);",";HEX$(b%+xkord%);
    GOSUB kurt
  ENDIF
RETURN
PROCEDURE porsche
  @saven
  IF zahl%=FALSE
    IF oremi%=FALSE
      PRINT #1," ' *************** Punkte zeichnen ***************"
    ENDIF
    GOSUB tasche
    PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$)"
    GOSUB bums
  ENDIF
RETURN
PROCEDURE amiga
  GOSUB teller
  PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO val(";CHR$(34);"&H";CHR$(34);"+A$),val(";CHR$(34);"&H";CHR$(34);"+B$)"
  GOSUB bums
RETURN
PROCEDURE essen
  PRINT #1,"DO"
  PRINT #1,"READ a%,b%,x%"
  PRINT #1,"EXIT IF A%=FALSE AND B%=FALSE AND X%=FALSE"
RETURN
PROCEDURE tasche
  PRINT #1,"DO"
  PRINT #1,"READ X$,Y$"
  PRINT #1,"EXIT IF X$=";CHR$(34);"*";CHR$(34);"AND Y$=";CHR$(34);"*";CHR$(34);""
RETURN
PROCEDURE lkw
  PRINT #1,"DO"
  PRINT #1,"READ A%,B%,X%,Y%"
  PRINT #1,"EXIT IF A%=FALSE AND B%=FALSE AND X%=FALSE AND Y%=FALSE"
RETURN
PROCEDURE teller
  PRINT #1,"DO"
  PRINT #1,"READ X$,Y$,A$,B$"
  PRINT #1,"EXIT IF X$=";CHR$(34);"*";CHR$(34);"AND Y$=";CHR$(34);"*";CHR$(34);"AND A$=";CHR$(34);"*";CHR$(34);"AND B$=";CHR$(34);"*";CHR$(34);""
RETURN
PROCEDURE post
  PRINT #1,"DO"
  PRINT #1,"READ y$"
  PRINT #1,"EXIT if y$=";CHR$(34);"*";CHR$(34)
RETURN
PROCEDURE spiel
  PRINT #1,"DO"
  PRINT #1,"READ A%,Y%,X%,B%,R1%,R2%"
  PRINT #1,"EXIT IF A%=FALSE AND Y%=FALSE AND X%=FALSE AND B%=FALSE AND R1%=FALSE AND R2%=FALSE"
RETURN
PROCEDURE bums
  PRINT #1,"LOOP"
  PRINT #1,"DATA ";
RETURN
PROCEDURE regen
  IF s_modus_1%=0
    BOX a%,b%,x%,y%
  ENDIF
  IF s_modus_1%=1
    BOX a%,b%,x%,y%
    BOX a%,399-b%,x%,399-y%
  ENDIF
  IF s_modus_1%=2
    BOX a%,b%,x%,y%
    BOX 639-a%,b%,639-x%,y%
  ENDIF
  IF s_modus_1%=3
    BOX a%,b%,x%,y%
    BOX 639-a%,b%,639-x%,y%
    BOX a%,399-b%,x%,399-y%
    BOX 639-a%,399-b%,639-x%,399-y%
  ENDIF
  IF s_modus_1%=4
    BOX a%,b%,x%,y%
    BOX 639-a%,399-b%,639-x%,399-y%
  ENDIF
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        IF xxx%=2
          PRINT #1,"' *************** Quadrat leer zeichnen ***************"
        ENDIF
        IF xxx%=1
          PRINT #1,"' ************** Rechteck leer zeichnen ***************"
        ENDIF
      ENDIF
      GOSUB teller
      PRINT #1,"BOX val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),val(";CHR$(34);"&H";CHR$(34);"+A$),val(";CHR$(34);"&H";CHR$(34);"+B$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
    xxx%=FALSE
  ENDIF
RETURN
PROCEDURE busch
  DRAW FALSE,y% TO 639,y%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' **** Effekt horizontal zeichnen ****"
      ENDIF
      GOSUB post
      PRINT #1,"DRAW FALSE,val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639,val(";CHR$(34);"&H";CHR$(34);"+Y$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(y%);
    GOSUB lord
  ENDIF
RETURN
PROCEDURE laster
  DRAW x%,y% TO ff%-b%+xkord%,k%-a%+ykord%
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** Spiegeln Extra zeichnen ***************"
      ENDIF
      GOSUB teller
      PRINT #1,"DRAW val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$) TO 639-val(";CHR$(34);"&H";CHR$(34);"+A$),399-val(";CHR$(34);"&H";CHR$(34);"+B$)"
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(b%+xkord%);",";HEX$(a%+ykord%);
    GOSUB kurt
  ENDIF
RETURN
PROCEDURE buch
  IF s_modus_1%=0
    CIRCLE x%,y%,grk
  ENDIF
  IF s_modus_1%=1
    CIRCLE x%,y%,grk
    CIRCLE x%,399-y%,grk
  ENDIF
  IF s_modus_1%=2
    CIRCLE x%,y%,grk
    CIRCLE 639-x%,y%,grk
  ENDIF
  IF s_modus_1%=3
    CIRCLE x%,y%,grk
    CIRCLE 639-x%,y%,grk
    CIRCLE x%,399-y%,grk
    CIRCLE 639-x%,399-y%,grk
  ENDIF
  IF s_modus_1%=4
    CIRCLE x%,y%,grk
    CIRCLE 639-x%,399-y%,grk
  ENDIF
  PAUSE 5
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** M-Kreis zeichnen ***************"
      ENDIF
      GOSUB tasche
      PRINT #1,"CIRCLE val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),";grk
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);
    GOSUB fot
  ENDIF
RETURN
PROCEDURE benzin
  IF s_modus_1%=0
    PCIRCLE x%,y%,grk
  ENDIF
  IF s_modus_1%=1
    PCIRCLE x%,y%,grk
    PCIRCLE x%,399-y%,grk
  ENDIF
  IF s_modus_1%=2
    PCIRCLE x%,y%,grk
    PCIRCLE 639-x%,y%,grk
  ENDIF
  IF s_modus_1%=3
    PCIRCLE x%,y%,grk
    PCIRCLE 639-x%,y%,grk
    PCIRCLE x%,399-y%,grk
    PCIRCLE 639-x%,399-y%,grk
  ENDIF
  IF s_modus_1%=4
    PCIRCLE x%,y%,grk
    PCIRCLE 639-x%,399-y%,grk
  ENDIF
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1," ' *************** M-Kreis ausgefÅllt zeichnen ***************"
      ENDIF
      GOSUB tasche
      PRINT #1,"PCIRCLE val(";CHR$(34);"&H";CHR$(34);"+X$),val(";CHR$(34);"&H";CHR$(34);"+Y$),";grk
      GOSUB bums
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);
    GOSUB fot
  ENDIF
RETURN
PROCEDURE lasso
  IF s_modus_1%=0
    DRAW x%,y% TO a%+xkord%,b%+ykord%
  ENDIF
  IF s_modus_1%=1
    DRAW x%,y% TO a%+xkord%,b%+ykord%
    DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
  ENDIF
  IF s_modus_1%=2
    DRAW x%,y% TO a%+xkord%,b%+ykord%
    DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
  ENDIF
  IF s_modus_1%=3
    DRAW x%,y% TO a%+xkord%,b%+ykord%
    DRAW 639-x%,y% TO 639-a%+xkord%,b%+ykord%
    DRAW x%,399-y% TO a%+xkord%,399-b%+ykord%
    DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
  ENDIF
  IF s_modus_1%=4
    DRAW 639-x%,399-y% TO 639-a%+xkord%,399-b%+ykord%
    DRAW x%,y% TO a%+xkord%,b%+ykord%
  ENDIF
  IF schreibe%=FALSE
    @saven
    IF zahl%=FALSE
      IF oremi%=FALSE
        PRINT #1,"' *************** G-Rays zeichnen ***************"
      ENDIF
      GOSUB amiga
    ENDIF
    PRINT #1,HEX$(x%);",";HEX$(y%);",";HEX$(a%);",";HEX$(b%);
    GOSUB ford
  ENDIF
RETURN
PROCEDURE henne
  IF zahl%>FALSE AND schreibe%=FALSE
    PRINT #1,"*,*,*,*"
  ENDIF
RETURN
PROCEDURE drucken
  ALERT 3,"Drucker Hardcopy ?",2,"Ja|ZurÅck",d%
  asf:
  IF d%=1
    IF GEMDOS(17)=NOT TRUE
      ALERT 3,"Bitte Drucker einschalten !",1,"OK|ZurÅck",kkh%
      IF kkh%=2
        GOTO lki
      ENDIF
      GOTO asf
    ENDIF
  ELSE
    GOTO lki
  ENDIF
  ALERT 3,"Wieviele Punkte sollen pro|Zeile gedruckt werden",2,"1280|960|ZurÅck",druck%
  IF druck%=1
    VOID XBIOS(33,FALSE)
    HIDEM
    HARDCOPY
  ENDIF
  IF druck%=2
    VOID XBIOS(33,4)
    HIDEM
    HARDCOPY
  ENDIF
  lki:
RETURN
PROCEDURE kirche
  PRBOX 20,61,350,375
  DEFTEXT 1,stil%,winkel%,gros%
  TEXT 100,200,ziehen%,"Hallo"
RETURN
PROCEDURE mami
  PRBOX 20,61,350,375
  DEFLINE kj,bh,anfang,schluss
  DRAW 50,200 TO 300,200
RETURN
PROCEDURE polen
  PRBOX 20,61,350,375
  DEFMARK mfarb%,mtyp%,mgross%
  POLYMARK 1,s(),f()
RETURN
PROCEDURE bravo(br1,br2,br3)
  FOR x=1 TO 550 STEP 60
    INC a
    DEFFILL 1,2,a
    PBOX 25+x,br1,br2,br3
  NEXT x
RETURN
oo1:
DATA    , Copyright ,------------------------------,1,2,3,4,5,6,""
DATA   Disk  , Lade    Bild , Lade    Block
DATA ------------------, Save    Bild , Save    Block ,------------------
DATA  Update  Bild ,------------------
DATA  Datum + Zeit
DATA  Lîsche Datei , Ordner anlegen , Laufwerk , Disk - Inhalt
DATA  Freier Speicher , Bild - Konverter ,------------------, Ende ,""
DATA  Arbeit , Draw , Punkt , Linie ," G-Rays "
DATA  I-Line , Quadrat , Rechteck , Kreis ," Ellipse "
DATA ---------------, FÅlle ,""
DATA   Extra  ," M-Kreis "
DATA  X-Kreis , X-Ellips , Scroll ," 4-Spiegel "
DATA  Q-Spiegel , K-Spiegel , Knicken , Effekt , Fadenkreuz
DATA  Marker , Input , Text ,------------, Undo ,""
DATA Einstellen, FÅllfarbe , Textarten , Linienarten , Markerarten , Hintergrundfarbe , Zeichenfarbe , Kantenform ," Rahmung "
DATA  FÅlle aus , Grafikmodus , Grîûe M-Kreis , Drucke Bild
DATA ------------------, Lîsche Bild ,""
DATA   Listing , Optimierer , Pause , Mausform , Maus an/aus , E-Schleife
DATA  Bild Neustart , Kommentar ,-----------------, Schliese Datei ,""
DATA  Sonstiges , MenÅ 2 , MenÅ 3 , MenÅ 4,---------------," Restart "
lp:
DATA 8,7,1,0,1,32767,32767,25027,25027,24579,24579,31055,30735,31055
DATA 24579,24579,25027,25027,32767,32767,0,32767,16513,16513,16385,0
DATA 16385,16385,16385,28807,16385,16385,16385,16385,16513,16513,32767,0
PROCEDURE auswerten2
  REPEAT
  UNTIL MOUSEK=0
  starter_2:
  ON ERROR GOSUB fehlerio2
  SDPOKE &H4EE,1
  MENU KILL
  MENU OFF
  LOCAL d3%,ld2$
  ld2$=menue1$(MENU(FALSE))
  GOSUB auto1
  SHOWM
  IF ld2$=" Modus 2b "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);" Modus 2b - Einstellung "
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);"-- fÅr MenÅ Arbeit 2b --"
    PRINT AT(29,11);"Doppelring    (J/N)"
    PRINT AT(44,12);
    FORM INPUT 3,video$
    PRINT AT(29,14);"Mehrfach Modus(J/N)"
    PRINT AT(44,15);
    FORM INPUT 3,tv$
    GOSUB was1
  ENDIF
  IF ld2$=" Radierer "
    GOSUB radierer
  ENDIF
  IF ld2$=" Linie    2 "
    krank%=1
    IF tv$="J"
      GOSUB flimm_frei
    ELSE
      GOSUB flimm_frei_2
    ENDIF
  ENDIF
  IF ld2$=" Rechteck 2 "
    krank%=2
    IF tv$="J"
      GOSUB flimm_frei
    ELSE
      GOSUB flimm_frei_2
    ENDIF
  ENDIF
  IF ld2$=" Quadrat  2 "
    krank%=3
    IF tv$="J"
      GOSUB flimm_frei
    ELSE
      GOSUB flimm_frei_2
    ENDIF
  ENDIF
  IF ld2$=" Kreis    2 "
    krank%=4
    IF tv$="J"
      GOSUB flimm_frei
    ELSE
      GOSUB flimm_frei_2
    ENDIF
  ENDIF
  IF ld2$=" Ellipse  2 "
    krank%=5
    IF tv$="J"
      GOSUB flimm_frei
    ELSE
      GOSUB flimm_frei_2
    ENDIF
  ENDIF
  IF ld2$=" K - Linie "
    GOSUB k_linie
  ENDIF
  IF ld2$=" Lade Programm "
    GOSUB clipping_aus
    IF FRE(FALSE)>200000
      GOSUB kind
      DEFTEXT 1,FALSE,3,19
      GRAPHMODE 2
      TEXT 163,45,"> Lade irgendein Programm <"
      PRINT AT(21,24);CHR$(27)+"p";" Programm muû kleiner als 100 KB sein.  ";CHR$(27)+"q"
      DEFFILL 1,2,FALSE
      PBOX 150,360,489,390
      GOSUB datei_erfragen("*.PRG")
      IF f$<>""
        RESERVE FRE(FALSE)-200000
        EXEC FALSE,f$+".PRG","",""
        RESERVE FRE(FALSE)+200000
      ENDIF
      GOSUB merge_bild
    ELSE
      ALERT 0,"Speicher reicht|fÅr diese Funktion|nicht aus",1,"Sorry",d%
    ENDIF
    GOSUB clipping_an
  ENDIF
  IF ld2$=" Copyright "
    GOSUB infol
  ENDIF
  IF ld2$=" V - Modus "
    ALERT 3,"Verschiebe Modus                        ",3,"Normal|Schatten|ZurÅck",d%
    IF d%=1
      ver_mod%=3
    ENDIF
    IF d%=2
      ver_mod%=6
    ENDIF
  ENDIF
  IF ld2$=" Zeichenlupen "
    s_lupe_1%=3
    GOSUB hals
    OPENW 0
    DEFFILL ,1,1
    PBOX 210,110,434,262
    DEFFILL ,2,4
    PBOX 200,100,424,252
    DEFFILL ,1,1
    PBOX 244,116,384,204
    PBOX 244,218,304,240
    PBOX 324,218,384,240
    DEFFILL ,0,0
    PBOX 240,112,380,132
    PBOX 240,134,380,154
    PBOX 240,156,380,176
    PBOX 240,178,380,198
    PBOX 240,214,300,236
    PBOX 320,214,380,236
    BOX 241,215,299,235
    BOX 321,215,379,235
    DEFTEXT 1,4,900,13
    GRAPHMODE 1
    DEFTEXT 1,4,0,13
    TEXT 250,129,"   Lupe 1    "
    TEXT 250,151,"   Lupe 2    "
    TEXT 250,173,"   Lupe 3    "
    TEXT 250,195,"   Lupe 4    "
    DEFTEXT 1,0,0,13
    TEXT 247,231,"  Ok "
    TEXT 335,231," Aus"
    GET 241,110+s_lupe_1%*22,379,128+s_lupe_1%*22,dummy$
    PUT 241,110+s_lupe_1%*22,dummy$,12
    dummy%=s_lupe_1%
    DO
      REPEAT
        MOUSE x%,y%,k%
        IF INKEY$=CHR$(13)
          GOTO lrtq12
        ENDIF
      UNTIL k%
      IF x%>240 AND x%<390 AND y%>112 AND y%<198 AND s_lupe_1%<>1+INT((y%-112)/22)
        GET 241,110+s_lupe_1%*22,379,128+s_lupe_1%*22,dummy$
        PUT 241,110+s_lupe_1%*22,dummy$,12
        s_lupe_1%=1+INT((y%-112)/22)
        GET 241,110+s_lupe_1%*22,379,128+s_lupe_1%*22,dummy$
        PUT 241,110+s_lupe_1%*22,dummy$,12
      ENDIF
      IF x%>320 AND x%<380 AND y%>214 AND y%<236
        s_lupe_1%=0
        x%=260
      ENDIF
      EXIT IF x%>240 AND x%<300 AND y%>214 AND y%<236 OR MOUSEK=2
    LOOP
    lrtq12:
    CLOSEW 0
    GOSUB clipping_an
    GOSUB merge_bild
    ' ****** Lupenabfrage *******
    ' ******* Lupe 1 ******
    IF s_lupe_1%=1
      GOSUB clipping_aus
      GOSUB hals
      GOSUB merge_bild
      ALERT 0,"-------- Lupe --------",3,"Links|Rechts|ZurÅck",dd%
      IF dd%<3
        IF dd%=1
          GET 319,0,639,399,bild1$
          GET 0,0,319,399,bild2$
          CLS
          PUT 0,0,bild2$
        ENDIF
        IF dd%=2
          GET 319,0,639,399,bild2$
          GET 0,0,319,399,bild1$
          CLS
          PUT 0,0,bild2$
        ENDIF
        HIDEM
        GRAPHMODE 3
        DRAW 319,0 TO 319,400
        x%=MOUSEX
        y%=MOUSEY
        REPEAT
        UNTIL MOUSEK<>1
        WHILE MOUSEK=FALSE
          x%=MOUSEX
          y%=MOUSEY
          IF x%=>272
            x%=272
          ENDIF
          BOX x%,y%,x%+39,y%+47
          VSYNC
          PAUSE 3
          BOX x%,y%,x%+39,y%+47
        WEND
        SHOWM
        GRAPHMODE 1
        lupe$=""
        RESTORE lup_dat
        DO
          READ lupi%
          EXIT IF lupi%<0
          lupe$=lupe$+MKI$(lupi%)
        LOOP
        VOID FRE(0)
        lup_dat:
        DATA 8303,4,12335,8,12847,10,8815,12
        DATA 3137,50,25172,3136,80,25166,45564,255
        DATA 65535,25158,46076,255,65535,25150,9289,13824
        DATA 15384,31247,32256,56390,25602,32383,4935,80
        DATA 4935,160,4935,240,4935,320,4935,400
        DATA 4935,480,4807,21315,22477,65498,26322,17386
        DATA 640,20937,65480,28672,20085,28927,20085
        DATA -1
        DRAW 319,0 TO 319,400
        DRAW 319,383 TO 640,383
        DEFTEXT 1,0,3,14
        TEXT 330,398," --------- Zeichen Lupe ---------- "
        REPEAT
          GET x%,y%,x%+47,y%+47,amor$
          lupe%=VARPTR(lupe$)
          VOID C:lupe%(L:VARPTR(amor$)+6,40,47,L:XBIOS(3)+40)
          REPEAT
            MOUSE lupi%,bun%,c7%
            IF bun%=>380
              bun%=380
            ENDIF
          UNTIL c7%
          IF MOUSEK=1
            HIDEM
            COLOR 1
            DRAW x%+(lupi%-320)/8,y%+(bun%/8)
            WHILE MOUSEK=1
              SHOWM
            WEND
          ENDIF
          IF MOUSEK=2
            HIDEM
            COLOR 0
            DRAW x%+(lupi%-320)/8,y%+(bun%/8)
            WHILE MOUSEK=2
              SHOWM
            WEND
          ENDIF
        UNTIL MOUSEK=3
        IF dd%=1
          PUT 319,0,bild1$
        ENDIF
        IF dd%=2
          PUT 320,0,bild1$
          GET 320,0,639,399,bild2$
          GET 0,0,319,399,bild1$
          PUT 320,-1,bild1$
          PUT 0,-1,bild2$
        ENDIF
      ENDIF
    ENDIF
    ' ***** Zeichenlupe 2 *****
    IF s_lupe_1%=2
      GOSUB clipping_aus
      REPEAT
        @glass(62,32,8)
      UNTIL MOUSEK=2
    ENDIF
    ' ***** Zeichenlupe 3 *****
    IF s_lupe_1%=3
      GOSUB clipping_aus
      GOSUB lupe_3
    ENDIF
    ' ***** Zeichenlupe 4 *****
    IF s_lupe_1%=4
      GOSUB clipping_aus
      GOSUB lupe_4
    ENDIF
    GOSUB grund
    GOSUB clipping_an
  ENDIF
  IF ld2$=" Pyramide "
    REPEAT
      MOUSE x1%,y1%,mousek
    UNTIL MOUSEK=1
    WHILE MOUSEK=1
      BOX x1%,y1%,MOUSEX,y1%
    WEND
    a=MOUSEX-x1%
    REPEAT
      MOUSE mousex,mousey,mousek
      IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
        GOSUB merge_bild
        GOSUB zeichne_pyramide
      ENDIF
    UNTIL MOUSEK
    GOSUB merge_bild
    IF MOUSEK=1
      GOSUB zeichne_pyramide
    ENDIF
  ENDIF
  IF ld2$=" Boot Texter "
    GOSUB boot_texter
  ENDIF
  IF ld2$=" Torte "
    REPEAT
      MOUSE vv%,gg%,mousek
    UNTIL MOUSEK=1 OR MOUSEK=2
    WHILE MOUSEK=1 OR MOUSEK=2
      HIDEM
      GOSUB merge_bild
      IF fu%=2
        PCIRCLE vv%,gg%,ABS(MOUSEX-vv%)
      ENDIF
      IF fu%=1
        CIRCLE vv%,gg%,ABS(MOUSEX-vv%)
      ENDIF
    WEND
    xr=ABS(MOUSEX-vv%)
    REPEAT
      IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
        IF MOUSEX<>vv%
          hh=ATN((gg%-MOUSEY)/(MOUSEX-vv%))
        ENDIF
        IF MOUSEX<vv%
          ADD hh,PI
        ENDIF
        IF MOUSEX>vv% AND MOUSEY>gg%
          ADD hh,2*PI
        ENDIF
        IF musteri=FALSE
          GOSUB merge_bild
        ENDIF
        DRAW vv%,gg% TO vv%+xr*COS(yy),gg%-xr*SIN(yy)
        DRAW vv%,gg% TO vv%+xr*COS(hh),gg%-xr*SIN(hh)
        IF fu%=1
          CIRCLE vv%,gg%,xr,yy*3600/(2*PI),hh*3600/(2*PI)
        ENDIF
        IF fu%=2
          PCIRCLE vv%,gg%,xr,yy*3600/(2*PI),hh*3600/(2*PI)
        ENDIF
      ENDIF
    UNTIL MOUSEK
    IF MOUSEK=2
      GOSUB merge_bild
    ENDIF
  ENDIF
  IF ld2$=" Lîschen "
    GOSUB clipping_aus
    ALERT 3,"Block Lîschen        ?",2," Ja |ZurÅck",d%
    IF d%=1
      h=1
      modus%=0
      GOSUB alles_klar
    ENDIF
    GOSUB clipping_an
  ENDIF
  IF ld2$=" H - Spiegeln "
    GOSUB clipping_aus
    ALERT 3,"Block horizontal Spiegeln   ? ",3,"Verdrehe|Spiegel|ZurÅck",d%
    IF d%<3
      h=1
      IF d%=1
        modus%=3
      ENDIF
      IF d%=2
        modus%=6
      ENDIF
      GOSUB alles_klar
    ENDIF
    GOSUB clipping_an
  ENDIF
  IF ld2$=" H - Invers "
    GOSUB clipping_aus
    ALERT 3,"Block Inventrieren        ",3,"Verdrehe|Spiegel|Normal",d%
    h=1
    IF d%=1
      modus%=12
    ENDIF
    IF d%=2
      modus%=9
    ENDIF
    IF d%=3
      modus%=10
    ENDIF
    GOSUB alles_klar
    GOSUB clipping_an
  ENDIF
  IF ld2$=" V - Spiegeln "
    GOSUB clipping_aus
    ALERT 3,"Block vertikal Spiegeln ",3,"Verdrehe|Spiegel|ZurÅck",d%
    IF d%<3
      h=1
      IF d%=1
        modus%=3
      ENDIF
      IF d%=2
        modus%=6
      ENDIF
      GOSUB alles_klar
    ENDIF
    GOSUB clipping_an
  ENDIF
  IF ld2$=" V - Invers "
    GOSUB clipping_aus
    ALERT 3,"Block vertikal Inventrieren  ",3,"Verdrehe|Spiegel|Normal",d%
    h=1
    IF d%=1
      modus%=12
    ENDIF
    IF d%=2
      modus%=9
    ENDIF
    IF d%=3
      modus%=10
    ENDIF
    GOSUB alles_klar
    GOSUB clipping_an
  ENDIF
  IF ld2$=" Lasso "
    GOSUB lasso_2
  ENDIF
  IF ld2$=" Kopieren "
    GOSUB clipping_aus
    ALERT 3,"Block kopieren       ?",3,"Kopieren|Zeichnen|ZurÅck",d%
    IF d%=1
      kuligunde=1
    ENDIF
    IF d%=2
      kuligunde=2
    ENDIF
    IF d%<3
      DIM bild%(32255/4)
      GRAPHMODE 3
      GOSUB hilfs_maus
      VSYNC
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        BOX a%,b%,x%,y%
        VSYNC
        PAUSE 3
        BOX a%,b%,x%,y%
      WEND
      WHILE MOUSEK=1
      WEND
      GET a%,b%,x%,y%,d$
      a%=XBIOS(3)
      b%=(VARPTR(bild%(0))+255) AND &HFFFF00
      REPEAT
        SWAP a%,b%
        VOID XBIOS(5,L:a%,L:b%,-1)
        GOSUB merge_bild
        MOUSE x%,y%,k%
        PUT x%,y%,d$,modus%
        IF k%=1
          GOSUB zeige_bild
        ENDIF
      UNTIL k%=kuligunde
      a%=MAX(a%,b%)
      VOID XBIOS(5,L:a%,L:a%,-1)
    ENDIF
    GOSUB was1
    ERASE bild%()
  ENDIF
  IF ld2$=" Block Modus "
    ALERT 3,"Block Modus ?       |1 = öberschreiben|2 = Transparent",1," öber | Trans ",d%
    IF d%=1
      modus%=3
    ENDIF
    IF d%=2
      modus%=6
    ENDIF
  ENDIF
  IF ld2$=" Vieleck 2 "
    GOSUB poly
  ENDIF
  IF ld2$=" Vieleck "
    anz%=0
    DIM poly_x%(50),poly_y%(50)
    DEFMARK mfarb%,mtyp%,mgross%
    REPEAT
      MOUSE mousex,mousey,mousek
      WHILE MOUSEK=1
        REPEAT
        UNTIL MOUSEK=0
        IF anz%=51 THEN
          GOTO sau
        ENDIF
        poly_x%(anz%)=MOUSEX
        poly_y%(anz%)=MOUSEY
        POLYMARK anz%,poly_x%(),poly_y%()
        INC anz%
      WEND
    UNTIL MOUSEK>1
    IF MOUSEK=2
      sau:
      IF fu%=2
        POLYFILL anz%,poly_x%(),poly_y%()
      ELSE
        POLYLINE anz%,poly_x%(),poly_y%()
      ENDIF
    ENDIF
    IF MOUSEK=3
      GOSUB merge_bild
      GOSUB zeige_bild
    ENDIF
    ERASE poly_x%()
    ERASE poly_y%()
  ENDIF
  IF ld2$=" G - Box "
    REPEAT
      x1%=MOUSEX
      y1%=MOUSEY
    UNTIL MOUSEK=1
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      GOSUB merge_bild
      IF MOUSEK=1 AND q%=0
        HIDEM
        x1%=x%
        y1%=y%
        q%=1
      ENDIF
      IF MOUSEK=1
        BOX x1%,y1%,x%,y%
      ENDIF
    UNTIL MOUSEK=0 AND q%=1
    x2%=x%
    y2%=y%
    xm%=(x1%-x%)/2
    ym%=(y1%-y%)/2
    r%=SQR(ym%*ym%+xm%*xm%)
    GOSUB g_box_1
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
        IF musteri=0
          GOSUB merge_bild
        ENDIF
        GOSUB g_box_1
      ENDIF
    UNTIL MOUSEK>0
  ENDIF
  IF ld2$=" Effekt Modus "
    ALERT 0,"Effekt Modus ?|bei G - Box und Torte",1,"Aus|Ein",muster_l
    IF muster_l=1
      musteri=FALSE
    ELSE
      musteri=1
    ENDIF
  ENDIF
  IF ld2$=" Z - Begrenzer "
    ALERT 3,"Clipping ?               |Begrenzt ZeichenflÑche|z.b. bei Fill oder Draw Befehl",1,"Aus|Ein|Ein+Box",clip%
    IF clip%>1
      REPEAT
      UNTIL MOUSEK
      GRAPHMODE 3
      clip1%=MOUSEX
      clip2%=MOUSEY
      clip3%=clip1%
      clip4%=clip2%
      REPEAT
      UNTIL MOUSEK<>1
      HIDEM
      WHILE MOUSEK=FALSE
        clip1%=MOUSEX
        clip2%=MOUSEY
        BOX clip3%,clip4%,clip1%,clip2%
        VSYNC
        PAUSE 3
        BOX clip3%,clip4%,clip1%,clip2%
      WEND
      WHILE MOUSEK=1
        GRAPHMODE graf%
        IF clip%=3
          BOX clip3%,clip4%,clip1%,clip2%
        ENDIF
        GOSUB clipping_an
      WEND
    ENDIF
    IF clip%=1
      clip3%=-1
      clip4%=-1
      clip1%=640
      clip2%=400
      GOSUB clipping_an
    ENDIF
  ENDIF
  IF ld2$=" K-Ausschnitt "
    GOSUB merge_bild
    i1%=aposition%
    i2%=eposition%
    IF i1%=FALSE AND i2%=FALSE
      i1%=0
      i2%=1800
    ENDIF
    REPEAT
      REPEAT
        MOUSE x1%,y1%,mousek
      UNTIL MOUSEK=1
      WHILE MOUSEK=1
      WEND
    UNTIL MOUSEK=0
    REPEAT
      IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
        HIDEM
        GOSUB merge_bild
        z%=MOUSEX-x1%
        IF fu%=2
          PCIRCLE x1%,y1%,z%,i1%,i2%
        ENDIF
        IF fu%=1
          CIRCLE x1%,y1%,z%,i1%,i2%
        ENDIF
      ENDIF
    UNTIL MOUSEK
    GOSUB merge_bild
    IF MOUSEK=1
      IF fu%=2
        PCIRCLE x1%,y1%,z%,i1%,i2%
      ENDIF
      IF fu%=1
        CIRCLE x1%,y1%,z%,i1%,i2%
      ENDIF
    ENDIF
  ENDIF
  IF ld2$=" E-Ausschnitt "
    GOSUB merge_bild
    i1%=aposition%
    i2%=eposition%
    IF i1%=FALSE AND i2%=FALSE
      i1%=0
      i2%=1800
    ENDIF
    REPEAT
      REPEAT
        MOUSE x1%,y1%,mousek
      UNTIL MOUSEK=1
      WHILE MOUSEK=1
      WEND
    UNTIL MOUSEK=0
    REPEAT
      IF MOUSEX<>MOUSEX OR MOUSEY<>MOUSEY
        HIDEM
        GOSUB merge_bild
        z%=MOUSEX-x1%
        t%=MOUSEY-y1%
        IF fu%=2
          PELLIPSE x1%,y1%,z%,t%,i1%,i2%
        ENDIF
        IF fu%=1
          ELLIPSE x1%,y1%,z%,t%,i1%,i2%
        ENDIF
      ENDIF
    UNTIL MOUSEK
    GOSUB merge_bild
    IF MOUSEK=1
      IF fu%=2
        PELLIPSE x1%,y1%,z%,t%,i1%,i2%
      ENDIF
      IF fu%=1
        ELLIPSE x1%,y1%,z%,t%,i1%,i2%
      ENDIF
    ENDIF
  ENDIF
  IF ld2$=" SprÅhdose 1 "
    IF s_bereich_x%=FALSE OR s_bereich_y%=FALSE
      s_bereich_x%=30
      s_bereich_y%=30
    ENDIF
    REPEAT
      SHOWM
      WHILE MOUSEK=1
        HIDEM
        w%=RANDOM(s_bereich_x%)
        e%=RANDOM(s_bereich_y%)
        DRAW MOUSEX+w%,MOUSEY+e%
      WEND
    UNTIL MOUSEK=2
  ENDIF
  IF ld2$=" SprÅhdose 2 "
    GOSUB spruhdose_2
  ENDIF
  IF ld2$=" SprÅhbereich 1 "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);" Ausschnitt - Bestimmung "
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);" --- fÅr SprÅhdose 1 --- "
    PRINT AT(29,11);"X - Positon   (0 - 640) "
    PRINT AT(44,12);
    FORM INPUT 3,s_bereich_x$
    s_bereich_x%=VAL(s_bereich_x$)
    PRINT AT(29,14);"Y - Position  (0 - 400) "
    PRINT AT(44,15);
    FORM INPUT 3,s_bereich_y$
    s_bereich_y%=VAL(s_bereich_y$)
    GOSUB was1
  ENDIF
  IF ld2$=" Z - Kreis "
    IF z_linie_g%=FALSE
      z_linie_g%=10
    ENDIF
    REPEAT
      SHOWM
      WHILE MOUSEK=1
        HIDEM
        x5%=INT((MOUSEX-300)/z_linie_g%)*z_linie_g%+300
        y5%=INT((MOUSEY-100)/z_linie_g%)
        y6%=y5%*z_linie_g%+100
        x%=x5%
        y%=y6%
        IF ka%=1
          IF fu%=2
            IF s_modus_1%=0
              PCIRCLE x%,y%,z_linie_g%
            ENDIF
            IF s_modus_1%=1
              PCIRCLE x%,y%,z_linie_g%
              PCIRCLE x%,399-y%,z_linie_g%
            ENDIF
            IF s_modus_1%=2
              PCIRCLE x%,y%,z_linie_g%
              PCIRCLE 639-x%,y%,z_linie_g%
            ENDIF
            IF s_modus_1%=3
              PCIRCLE x%,y%,z_linie_g%
              PCIRCLE 639-x%,y%,z_linie_g%
              PCIRCLE x%,399-y%,z_linie_g%
              PCIRCLE 639-x%,399-y%,z_linie_g%
            ENDIF
            IF s_modus_1%=4
              PCIRCLE x%,y%,z_linie_g%
              PCIRCLE 639-x%,399-y%,z_linie_g%
            ENDIF
          ENDIF
          IF fu%=1
            IF s_modus_1%=0
              CIRCLE x%,y%,z_linie_g%
            ENDIF
            IF s_modus_1%=1
              CIRCLE x%,y%,z_linie_g%
              CIRCLE x%,399-y%,z_linie_g%
            ENDIF
            IF s_modus_1%=2
              CIRCLE x%,y%,z_linie_g%
              CIRCLE 639-x%,y%,z_linie_g%
            ENDIF
            IF s_modus_1%=3
              CIRCLE x%,y%,z_linie_g%
              CIRCLE 639-x%,y%,z_linie_g%
              CIRCLE x%,399-y%,z_linie_g%
              CIRCLE 639-x%,399-y%,z_linie_g%
            ENDIF
            IF s_modus_1%=4
              CIRCLE x%,y%,z_linie_g%
              CIRCLE 639-x%,399-y%,z_linie_g%
            ENDIF
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
  ENDIF
  IF ld2$=" Verschieben 1 "
    GOSUB hals
    DEFFILL 1,2,FALSE
    PBOX 176,30,463,347
    DEFFILL 1,FALSE,FALSE
    PBOX 187,37,453,341
    BOX 186,36,454,342
    BOX 188,38,452,340
    BOX 190,40,450,338
    BOX 192,42,448,336
    BOX 193,43,447,335
    DRAW 193,64 TO 447,64
    DRAW 193,65 TO 447,65
    DRAW 193,67 TO 447,67
    DRAW 193,69 TO 447,69
    DRAW 193,70 TO 447,70
    DEFTEXT 1,4,8,6
    TEXT 215,56,"--- Bild Verschieben 1 ---"
    DEFTEXT 1,FALSE,8,6
    TEXT 205,90,"ab_maus_nach_oben       "
    TEXT 205,115,"vor_maus_nach_unten     "
    TEXT 205,140,"ab_maus_nach_links      "
    TEXT 205,165,"ab_maus_nach_rechts     "
    TEXT 205,190,"bis_maus_schrÑg_rechts  "
    TEXT 205,215,"bis_maus_schrÑg_links   "
    TEXT 205,240,"verzerren_ab_maus_links_oben"
    TEXT 205,265,"verzerren_ab_maus_rechts_oben"
    TEXT 205,290,"verschmieren_ab_maus_oben    "
    TEXT 205,315,"verschmieren_bis_maus_rechts "
    REPEAT
      IF MOUSEX>192 AND MOUSEX<445 AND MOUSEK=1
        IF MOUSEY>70 AND MOUSEY<100
          verschieben=1
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>100 AND MOUSEY<125
          verschieben=2
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>125 AND MOUSEY<150
          verschieben=3
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>150 AND MOUSEY<175
          verschieben=4
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>175 AND MOUSEY<200
          verschieben=5
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>200 AND MOUSEY<225
          verschieben=6
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>225 AND MOUSEY<250
          verschieben=7
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>250 AND MOUSEY<275
          verschieben=8
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>275 AND MOUSEY<300
          verschieben=9
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
        IF MOUSEY>300 AND MOUSEY<325
          verschieben=10
          GOSUB verschieben_2
          GOTO ende_3
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    verschieben=11
    GOSUB verschieben_2
    ende_3:
    GOSUB grund
  ENDIF
  IF ld2$=" Verschieben 2 "
    GOSUB hals
    DEFFILL 1,2,FALSE
    PBOX 176,30,463,297
    DEFFILL 1,FALSE,FALSE
    PBOX 187,37,453,291
    BOX 186,36,454,292
    BOX 188,38,452,290
    BOX 190,40,450,288
    BOX 192,42,448,286
    BOX 193,43,447,285
    DRAW 193,64 TO 447,64
    DRAW 193,65 TO 447,65
    DRAW 193,67 TO 447,67
    DRAW 193,69 TO 447,69
    DRAW 193,70 TO 447,70
    DEFTEXT 1,4,8,6
    TEXT 215,56,"--- Bild Verschieben 1 ---"
    DEFTEXT 1,FALSE,8,6
    TEXT 260,90,"nach unten   1       "
    TEXT 260,115,"nach oben    1        "
    TEXT 260,140,"nach rechts  1        "
    TEXT 260,165,"nach links   1        "
    TEXT 260,190,"nach unten   2        "
    TEXT 260,215,"nach oben    2        "
    TEXT 260,240,"nach rechts  2        "
    TEXT 260,265,"nach links   2        "
    REPEAT
      IF MOUSEX>192 AND MOUSEX<445 AND MOUSEK=1
        IF MOUSEY>70 AND MOUSEY<100
          verschieben_2=1
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>100 AND MOUSEY<125
          verschieben_2=2
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>125 AND MOUSEY<150
          verschieben_2=3
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>150 AND MOUSEY<175
          verschieben_2=4
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>175 AND MOUSEY<200
          verschieben_2=5
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>200 AND MOUSEY<225
          verschieben_2=6
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>225 AND MOUSEY<250
          verschieben_2=7
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
        IF MOUSEY>250 AND MOUSEY<275
          verschieben_2=8
          GOSUB verschieben_4
          GOTO ende_4
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    ende_4:
    verschieben_2=9
    GOSUB verschieben_4
    GOSUB grund
  ENDIF
  IF ld2$=" Ausschnitt "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);" Ausschnitt - Bestimmung "
    PRINT CHR$(27)+"q";
    PRINT AT(29,9);"fÅr E- und K-Ausschnitt"
    PRINT AT(29,11);"Anfangspositin  0-3600";
    PRINT AT(45,12);
    FORM INPUT 4,aposition$
    aposition%=VAL(aposition$)
    PRINT AT(29,14);"Endposition     0-3600";
    PRINT AT(45,15);
    FORM INPUT 4,eposition$
    eposition%=VAL(eposition$)
    GOSUB was1
  ENDIF
  IF ld2$=" Z - Box "
    IF z_linie_g%=FALSE
      z_linie_g%=10
    ENDIF
    REPEAT
      SHOWM
      WHILE MOUSEK=1
        HIDEM
        x1%=INT((MOUSEX-300)/z_linie_g%)*z_linie_g%+300
        yz%=INT((MOUSEY-100)/z_linie_g%)
        y1%=yz%*z_linie_g%+100
        a%=x1%
        b%=y1%
        x%=x1%+z_linie_g%
        y%=y1%+z_linie_g%
        IF ka%=1
          IF fu%=2
            IF s_modus_1%=0
              PBOX a%,b%,x%,y%
            ENDIF
            IF s_modus_1%=1
              PBOX a%,b%,x%,y%
              PBOX a%,399-b%,x%,399-y%
            ENDIF
            IF s_modus_1%=2
              PBOX a%,b%,x%,y%
              PBOX 639-a%,b%,639-x%,y%
            ENDIF
            IF s_modus_1%=3
              PBOX a%,b%,x%,y%
              PBOX 639-a%,b%,639-x%,y%
              PBOX a%,399-b%,x%,399-y%
              PBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
            IF s_modus_1%=4
              PBOX a%,b%,x%,y%
              PBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
          ENDIF
          IF fu%=1
            IF s_modus_1%=0
              BOX a%,b%,x%,y%
            ENDIF
            IF s_modus_1%=1
              BOX a%,b%,x%,y%
              BOX a%,399-b%,x%,399-y%
            ENDIF
            IF s_modus_1%=2
              BOX a%,b%,x%,y%
              BOX 639-a%,b%,639-x%,y%
            ENDIF
            IF s_modus_1%=3
              BOX a%,b%,x%,y%
              BOX 639-a%,b%,639-x%,y%
              BOX a%,399-b%,x%,399-y%
              BOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
            IF s_modus_1%=4
              BOX a%,b%,x%,y%
              BOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
          ENDIF
        ENDIF
        IF ka%=2
          IF fu%=2
            IF s_modus_1%=0
              PRBOX a%,b%,x%,y%
            ENDIF
            IF s_modus_1%=1
              PRBOX a%,b%,x%,y%
              PRBOX a%,399-b%,x%,399-y%
            ENDIF
            IF s_modus_1%=2
              PRBOX a%,b%,x%,y%
              PRBOX 639-a%,b%,639-x%,y%
            ENDIF
            IF s_modus_1%=3
              PRBOX a%,b%,x%,y%
              PRBOX 639-a%,b%,639-x%,y%
              PRBOX a%,399-b%,x%,399-y%
              PRBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
            IF s_modus_1%=4
              PRBOX a%,b%,x%,y%
              PRBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
          ENDIF
          IF fu%=1
            IF s_modus_1%=0
              RBOX a%,b%,x%,y%
            ENDIF
            IF s_modus_1%=1
              RBOX a%,b%,x%,y%
              RBOX a%,399-b%,x%,399-y%
            ENDIF
            IF s_modus_1%=2
              RBOX a%,b%,x%,y%
              RBOX 639-a%,b%,639-x%,y%
            ENDIF
            IF s_modus_1%=3
              RBOX a%,b%,x%,y%
              RBOX 639-a%,b%,639-x%,y%
              RBOX a%,399-b%,x%,399-y%
              RBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
            IF s_modus_1%=4
              RBOX a%,b%,x%,y%
              RBOX 639-a%,399-b%,639-x%,399-y%
            ENDIF
          ENDIF
        ENDIF
      WEND
    UNTIL MOUSEK=2
  ENDIF
  IF ld2$=" Z - Modus "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);"        Z - Modus        "
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);"- fÅr Z - Box + Z Kreis -"
    PRINT AT(29,11);"Grîûe  (1-99)"
    PRINT AT(44,11);
    FORM INPUT 2,z_linie_g$
    z_linie_g%=VAL(z_linie_g$)
    GOSUB was1
  ENDIF
  IF ld2$=" V - Ursprung "
    ALERT 3,"Origin ?|Ursprungsverschiebung ",1,"Aus|Ein|Ein+Plot",d%
    IF d%=1
      ursus1=320
      ursus2=200
    ENDIF
    IF d%=2
      REPEAT
        ursus1=MOUSEX
        ursus2=MOUSEY
      UNTIL MOUSEK=1
    ENDIF
    IF d%=3
      REPEAT
        ursus1=MOUSEX
        ursus2=MOUSEY
      UNTIL MOUSEK=1
      DRAW ursus1,ursus2
    ENDIF
    GOSUB origin_aus
  ENDIF
  IF ld2$=" Disk Format "
    GOSUB clipping_aus
    ON ERROR GOSUB fehlerio2
    GOSUB hals
    ALERT 3,"--- Disketten Formatierer --- |    Wollen Sie diese Disk|       formatieren ?",2," Format | ZurÅck",d%
    IF d%=2
      GOTO no_format
    ENDIF
    DEFTEXT 1,2,3,20
    TEXT 190,130,"Disketten Formatieren"
    BOX 180,100,459,259
    BOX 182,102,457,257
    BOX 183,103,456,256
    DRAW 180,140 TO 456,140
    DRAW 180,142 TO 456,142
    DRAW 180,143 TO 456,143
    PRINT AT(30,11);"Laufwerk "
    PRINT AT(49,11);"A"
    PRINT AT(30,13);"Format "
    PRINT AT(49,13);"1"
    PRINT AT(30,15);"Formatiere Track "
    PRINT AT(48,15);
    PRINT USING "##",i
    CHDRIVE 1
    laufwerk=0
    seiten=0
    GOSUB formatieren(laufwerk,seiten)
    no_format:
    CHDRIVE lauf%
    GOSUB was1
  ENDIF
  IF ld2$=" MenÅ 1    "
    GOSUB himmel1
  ENDIF
  IF ld2$=" MenÅ 3 "
    GOSUB himmel3
  ENDIF
  IF ld2$=" MenÅ 4 "
    GOSUB himmel4
  ENDIF
  DEFMOUSE 3
  g$=z$
  GOSUB zeige_bild
  MENU menue1$()
  ON MENU  GOSUB auswerten2
  ON MENU KEY GOSUB tastatur
RETURN
PROCEDURE lupe_4
  LOCAL select!,edit$,ttx%,tty%,mou%
  vv55:
  FOR i%=80 TO 560 STEP 80
    GRAPHMODE 3
    DRAW i%,0 TO i%,399
    GRAPHMODE 1
    DRAW i%+1,0 TO i%+1,399
    PAUSE 2
  NEXT i%
  FOR j%=50 TO 350 STEP 50
    GRAPHMODE 3
    DRAW 0,j% TO 639,j%
    GRAPHMODE 1
    DRAW 0,j%+1 TO 639,j%+1
    PAUSE 2
  NEXT j%
  GRAPHMODE 1
  ALERT 1,"|Bitte gewÅnschten Auschnitt|       auswÑhlen!",1,"  Ok  |ZurÅck",a.lert%
  IF a.lert%=2
    GOTO e.xit_bildedit
  ENDIF
  DEFMOUSE 3
  REPEAT
    MOUSE x%,y%,k%
  UNTIL k%
  DEFMOUSE 0
  x%=INT(x%/80)
  y%=INT(y%/50)
  ttx%=x%
  tty%=y%
  CLS
  GOSUB merge_bild
  GET x%*80,y%*50,x%*80+79,y%*50+49,edit$
  CLS
  DEFFILL ,2,4
  PBOX -1,30,640,325
  DEFFILL ,1,1
  PBOX -1,326,640,399
  PBOX 24,49,426,301
  DEFFILL ,0,0
  PBOX 14,39,416,291
  DRAW 0,16 TO 639,16
  DEFTEXT 1,4,0,6
  TEXT 15,12,"Sigi-Painter  Zeichenlupe Nr 4"
  @line.draw
  DEFFILL ,1,1
  PBOX 437,164,518,217
  DEFFILL ,0,0
  PBOX 432,161,513,212
  DEFTEXT 1,4,0,6
  @plotting
  PBOX 437,44,518,156
  DEFFILL ,0,0
  PBOX 432,39,513,151
  BOX 433,40,512,150
  DEFTEXT 1,4,0,13
  TEXT 450,56,"MENö:"
  DRAW 434,59 TO 512,59
  DEFTEXT 1,0,0,13
  TEXT 442,77,"Lîschen"
  TEXT 442,94,"Neu"
  TEXT 442,111,"Revers"
  TEXT 442,128,"OK "
  TEXT 442,145,"Abbruch"
  DO
    REPEAT
      MOUSE x%,y%,k%
      IF x%>433 AND x%<511 AND y%>59 AND y%<149
        IF mou%=0
          DEFMOUSE 3
          mou%=3
        ENDIF
      ELSE
        IF mou%=3
          DEFMOUSE 0
          CLR mou%
        ENDIF
      ENDIF
      IF k%
        IF x%>433 AND y%>63 AND x%<511 AND y%<80
          ALERT 1,"|Editor wirklich lîschen ??",1,"  Ja  | Nein ",a.lert%
          IF a.lert%=1
            DEFFILL ,0,0
            PBOX 15,40,415,290
            PBOX 432,161,513,212
            @line.draw
          ENDIF
        ENDIF
        IF x%>433 AND y%>63+17 AND x%<511 AND y%<63-1+2*17
          ALERT 2,"|Aktueller Ausschnitt - UNDO ?",1,"  Ja  | Nein ",a.lert%
          IF a.lert%=1
            DEFFILL ,0,0
            PBOX 14,39,416,291
            @line.draw
            @plotting
          ENDIF
        ENDIF
        IF x%>433 AND y%>63+2*17 AND x%<511 AND y%<63-1+3*17
          GET 15,40,415,290,dummy$
          PUT 15,40,dummy$,12
          @line.draw
          GET 433,162,512,211,dummy$
          PUT 433,162,dummy$,12
        ENDIF
        IF x%>433 AND y%>63+3*17 AND x%<511 AND y%<63-1+4*17
          GET 433,162,512,211,edit$
          GOSUB merge_bild
          PUT ttx%*80,tty%*50,edit$
          GOSUB zeige_bild
          GOTO vv55
        ENDIF
        IF x%>433 AND y%>63+4*17 AND x%<511 AND y%<63-1+5*17
          GOTO ggwq
        ENDIF
      ENDIF
    UNTIL k% AND x%>15 AND y%>40 AND x%<415 AND y%<290
    x%=INT((x%-15)/5)
    y%=INT((y%-40)/5)
    DEFFILL ,ABS(k%-2),ABS(k%-2)
    PBOX 15+x%*5,40+y%*5,20+x%*5,45+y%*5
    COLOR ABS(k%-2)
    DRAW 433+x%,162+y%
  LOOP
  e.xit_bildedit:
  COLOR 1
  ggwq:
  GOSUB merge_bild
RETURN
PROCEDURE line.draw
  COLOR 1
  FOR j%=0 TO 50
    DRAW 15,40+j%*5 TO 415,40+j%*5
  NEXT j%
  FOR i%=0 TO 80
    DRAW 15+i%*5,40 TO 15+i%*5,290
  NEXT i%
RETURN
PROCEDURE plotting
  PUT 433,162,edit$
  DEFTEXT 1,4,0,6
  TEXT 433,27,"Bitte warten !"
  DEFFILL ,1,1
  FOR i%=1 TO 80
    FOR j%=1 TO 50
      IF POINT(432+i%,161+j%)=1
        PBOX 10+i%*5,35+j%*5,15+i%*5,40+j%*5
      ENDIF
    NEXT j%
  NEXT i%
  GRAPHMODE 3
  TEXT 433,27,"Bitte warten !"
  GRAPHMODE 1
RETURN
PROCEDURE poly
  GOSUB clipping_aus
  IF DIM?(polx%())=0
    @poly.def(*xb%,*yb%,*anz1%)
    GOSUB merge_bild
    HIDEM
    IF DIM?(polx%())=0
      GOTO eegha
    ENDIF
  ENDIF
  x.a%=xb%
  y.a%=yb%
  DO
    GRAPHMODE 3
    POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
    REPEAT
      MOUSE xx%,yy%,k%
      i$=INKEY$
      IF ASC(i$)=0 AND ASC(RIGHT$(i$))=97
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
      ENDIF
      IF ASC(i$)=19
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
      ENDIF
      IF i$="#"
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
        ERASE polx%()
        ERASE poly%()
        GOTO lamfr
      ENDIF
      EXIT IF MOUSEK=3
      IF x.a%<>xx% OR y.a%<>yy%
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
        x.a%=xx%
        y.a%=yy%
        POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
      ENDIF
    UNTIL k%
    EXIT IF MOUSEK=3
    POLYLINE anz1%,polx%(),poly%() OFFSET xx%-xb%,yy%-yb%
    IF MOUSEK=1
      HIDEM
      GRAPHMODE graf%
      IF fu%=1
        POLYLINE anz1%,polx%(),poly%() OFFSET xx%-xb%,yy%-yb%
      ELSE
        POLYFILL anz1%,polx%(),poly%() OFFSET xx%-xb%,yy%-yb%
      ENDIF
    ENDIF
  LOOP
  GRAPHMODE 3
  POLYLINE anz1%,polx%(),poly%() OFFSET x.a%-xb%,y.a%-yb%
  eegha:
RETURN
PROCEDURE poly.def(a%,b%,c%)
  i.nit.pol:
  LOCAL cnt%,dummy$,x%,y%,xx%,yy%,x.a%,y.a%,dummy%,xaa%,yaa%
  DIM polx%(128),poly%(128)
  SPUT l$
  CLS
  DEFTEXT 1,4,0,13
  TEXT 20,20,"Polygon-Definition - Maximal 128 Punkte - <Delete>=Neu - <Return>=Ok  "
  DEFTEXT 1,0,0,6
  TEXT 20,34,"000 Eckpunkte"
  MOUSE x.a%,y.a%,k%
  REPEAT
    MOUSE x%,y%,k%
    i$=INKEY$
    IF i$=CHR$(13) OR MOUSEK=2
      CLR cnt%
      ERASE polx%()
      ERASE poly%()
      GOTO e.xit.pol
    ENDIF
    IF i$=CHR$(127)
      ERASE polx%()
      ERASE poly%()
      GRAPHMODE 1
      GOTO i.nit.pol
    ENDIF
    IF x.a%<>x% OR y.a%<>y%
      x.a%=x%
      y.a%=y%
    ENDIF
  UNTIL k%=1
  polx%(0)=x%
  poly%(0)=y%
  x.a%=x%
  y.a%=y%
  xaa%=x%
  yaa%=y%
  DEFTEXT ,,,6
  DRAW x%,y%
  TEXT 20,34,"001 Eckpunkt   "
  PAUSE 3
  DO
    GRAPHMODE 3
    REPEAT
      MOUSE xx%,yy%,k%
      i$=INKEY$
      IF i$=CHR$(13) OR MOUSEK=2
        GOTO e.xit.pol
      ENDIF
      IF i$=CHR$(127)
        ERASE polx%()
        ERASE poly%()
        GRAPHMODE 1
        GOTO i.nit.pol
      ENDIF
      IF xx%<>x.a% OR yy%<>y.a%
        GRAPHMODE 3
        DRAW x%,y% TO x.a%,y.a%
        DRAW x%,y% TO xx%,yy%
        x.a%=xx%
        y.a%=yy%
      ELSE
        SHOWM
      ENDIF
    UNTIL k%=1
    GRAPHMODE 1
    DRAW x%,y% TO xx%,yy%
    x%=xx%
    y%=yy%
    REPEAT
    UNTIL MOUSEK=0
    INC cnt%
    dummy$=STR$(cnt%+1)
    dummy$=STRING$(4-LEN(dummy$),"0")+dummy$+" Eckpunkte"
    dummy$=MID$(dummy$,2)
    DEFTEXT ,,,6
    TEXT 20,34,dummy$
    PAUSE 3
    polx%(cnt%)=xx%
    poly%(cnt%)=yy%
    IF cnt%=127
      ALERT 3,"|Hîchstpunktzahl 128 erreicht !",1,"  Ok  ",dummy%
    ENDIF
    EXIT IF dummy%
  LOOP
  e.xit.pol:
  IF DIM?(polx%())
    IF cnt%>0 AND cnt%<127 AND (polx%(cnt%)<>polx%(cnt%-1) OR poly%(cnt%)<>poly%(cnt%-1))
      INC cnt%
      polx%(cnt%)=polx%(cnt%-1)
      poly%(cnt%)=poly%(cnt%-1)
    ENDIF
  ENDIF
  *a%=xaa%
  *b%=yaa%
  *c%=cnt%
  SHOWM
RETURN
PROCEDURE zeichne_pyramide
  HIDEM
  DRAW x1%,y1% TO x1%+a,y1%
  DRAW x1%,y1% TO x1%+(a/2),y1%-(a/2)
  DRAW x1%+(a/2),y1%-(a/2) TO x1%+(a/2)+a,y1%-(a/2)
  DRAW x1%+a,y1% TO x1%+a+(a/2),y1%-(a/2)
  DRAW x1%,y1% TO x1%+(a/2)+(a/4),MOUSEY
  DRAW x1%+a,y1% TO x1%+(a/2)+(a/4),MOUSEY
  DRAW x1%+(a/2),y1%-(a/2) TO x1%+(a/2)+(a/4),MOUSEY
  DRAW x1%+a+(a/2),y1%-(a/2) TO x1%+(a/2)+(a/4),MOUSEY
RETURN
PROCEDURE g_box_1
  IF NOT xm%=0
    a1=ATN(xm%/ym%)
    a2=PI-a1
    a3=PI+a1
    a4=PI*2-a1
    IF x%<>x2%+xm%
      a=ATN(((y2%+ym%)-y%)/(x%-(x2%+xm%)))-a1
    ENDIF
    SUB a1,a
    SUB a2,a
    SUB a3,a
    SUB a4,a
    ex1=x2%+xm%+COS(a1)*r%
    ey1=y2%+ym%+SIN(a1)*r%
    ex2=x2%+xm%+COS(a2)*r%
    ey2=y2%+ym%+SIN(a2)*r%
    ex3=x2%+xm%+COS(a3)*r%
    ey3=y2%+ym%+SIN(a3)*r%
    ex4=x2%+xm%+COS(a4)*r%
    ey4=y2%+ym%+SIN(a4)*r%
    DRAW ex1,ey1 TO ex2,ey2
    DRAW ex2,ey2 TO ex3,ey3
    DRAW ex3,ey3 TO ex4,ey4
    DRAW ex4,ey4 TO ex1,ey1
  ELSE
    GOSUB zeige_bild
  ENDIF
RETURN
PROCEDURE clipping_aus
  DPOKE PTSIN,-1
  DPOKE PTSIN+2,-1
  DPOKE PTSIN+4,640
  DPOKE PTSIN+6,400
  DPOKE INTIN,1
  DPOKE CONTRL+2,2
  DPOKE CONTRL+6,1
  VDISYS 129
RETURN
PROCEDURE clipping_an
  DPOKE PTSIN,clip3%
  DPOKE PTSIN+2,clip4%
  DPOKE PTSIN+4,clip1%
  DPOKE PTSIN+6,clip2%
  DPOKE INTIN,1
  DPOKE CONTRL+2,2
  DPOKE CONTRL+6,1
  VDISYS 129
RETURN
PROCEDURE origin_aus
  DPOKE WINDTAB+64,0
  DPOKE WINDTAB+66,0
RETURN
PROCEDURE origin_an
  DPOKE WINDTAB+64,ursus1-320
  DPOKE WINDTAB+66,ursus2-200
RETURN
PROCEDURE alles_klar
  RESTORE
  DIM smfdb%(5),dmfdb%(5),p%(8)
  GOSUB hilfs_maus
  WHILE MOUSEK=FALSE
    x%=MOUSEX
    y%=MOUSEY
    BOX a%,b%,x%,y%
    VSYNC
    PAUSE 3
    BOX a%,b%,x%,y%
  WEND
  WHILE MOUSEK=1
    GRAPHMODE graf%
  WEND
  GOSUB merge_bild
  GET a%,b%,x%,y%,l$
  IF h=FALSE
    IF DPEEK(s.%+4)>6
      GOSUB nichts_klar_1
      p%(1)=0
      p%(3)=h%
      p%(5)=y1%
      p%(7)=y1%+h%
      p%(8)=modus%
      p%(4)=x1%+b1%
      p%(6)=x1%+b1%
      FOR i%=0 TO b1%
        p%(0)=i%
        p%(2)=i%
        BITBLT smfdb%(),dmfdb%(),p%()
        DEC p%(4)
        DEC p%(6)
      NEXT i%
    ENDIF
  ELSE
    @mirrorput(a%,b%,*l$,modus%)
  ENDIF
  h=FALSE
  modus%=3
  ERASE smfdb%()
  ERASE dmfdb%()
  ERASE p%()
RETURN
PROCEDURE mirrorput(x1%,y1%,s.%,modus%)
  IF DPEEK(s.%+4)>6
    GOSUB nichts_klar_1
    p%(0)=0
    p%(2)=b1%
    p%(4)=x1%
    p%(6)=x1%+b1%
    p%(8)=modus%
    p%(5)=y1%+h%
    p%(7)=y1%+h%
    FOR i%=0 TO h%
      p%(1)=i%
      p%(3)=i%
      BITBLT smfdb%(),dmfdb%(),p%()
      DEC p%(5)
      DEC p%(7)
    NEXT i%
  ENDIF
RETURN
PROCEDURE nichts_klar_1
  a1%=LPEEK(s.%)
  b1%=DPEEK(a1%)
  h%=DPEEK(a1%+2)
  smfdb%(0)=a1%+6
  smfdb%(1)=(b1%+16) AND &HFFF0
  smfdb%(2)=h%+1
  smfdb%(3)=smfdb%(1)/16
  smfdb%(5)=DPEEK(a1%+4)
  dmfdb%(0)=XBIOS(3)
  dmfdb%(1)=640
  dmfdb%(2)=400
  dmfdb%(3)=40
  dmfdb%(5)=1
RETURN
' ************** Compaktiertes Laden und Abspeichern eines Bildes *********
' ----- Routinen von Markus Deheus ---------
PROCEDURE sv_cprsd(f$)
  LOCAL nbase%,oldptr%,nwptr%,count%,zeroes%,last%,lastcount%,least%,wk$
  @least_used
  wk$=SPACE$(32000)
  nbase%=VARPTR(wk$)
  oldptr%=XBIOS(3)
  nwptr%=nbase%
  count%=0
  nwcount%=0
  zeroes%=0
  last%=0
  lastcount%=0
  POKE nwptr%,least%
  INC nwptr%
  REPEAT
    to_read%=PEEK(oldptr%)
    IF to_read%<>0
      IF to_read%=PEEK(oldptr%+1) AND to_read%=PEEK(oldptr%+2)
        last%=to_read%
        POKE nwptr%,least%
        INC nwptr%
        POKE nwptr%,to_read%
        INC oldptr%
        INC nwptr%
        lastcount%=1
        REPEAT
          INC count%
          INC lastcount%
          INC oldptr%
        UNTIL PEEK(oldptr%)<>last% OR lastcount%=255 OR count%=32000
        POKE nwptr%,lastcount%
        INC nwptr%
        ADD nwcount%,3
      ELSE
        IF to_read%<>least%
          POKE nwptr%,to_read%
          INC nwptr%
          INC nwcount%
          INC count%
          INC oldptr%
        ELSE
          POKE nwptr%,least%
          INC nwptr%
          POKE nwptr%,least%
          INC nwptr%
          POKE nwptr%,1
          INC nwptr%
          INC count%
          ADD nwcount%,2
          INC oldptr%
        ENDIF
      ENDIF
    ELSE
      zeroes%=0
      REPEAT
        INC zeroes%
        INC oldptr%
        INC count%
      UNTIL PEEK(oldptr%)<>0 OR zeroes%=255 OR count%=32000
      POKE nwptr%,0
      INC nwptr%
      POKE nwptr%,zeroes%
      INC nwptr%
      ADD nwcount%,2
    ENDIF
  UNTIL count%>=32000 OR nwcount%>31998
  IF nwcount%>31998
    ALERT 3,"Komprimierung dieses Bildes|nicht mîglich.",1,"OK",d%
  ELSE
    HIDEM
    BSAVE f$,nbase%,nwcount%+1
    SHOWM
  ENDIF
RETURN
PROCEDURE least_used
  LOCAL ad%,i%
  DIM lu%(255)
  ad%=XBIOS(3)
  FOR i%=0 TO 255
    lu%(i%)=0
  NEXT i%
  FOR i%=1 TO 32000
    INC lu%(PEEK(ad%))
    INC ad%
  NEXT i%
  least%=73
  FOR i%=1 TO 255
    IF lu%(i%)<lu%(least%)
      least%=i%
    ENDIF
  NEXT i%
  ERASE lu%()
RETURN
PROCEDURE ld_cprsd(f$)
  LOCAL count%,nbase%,oldptr%,nwptr%,nwcount%,zeroes%,esc%,con%,rep%,i%,wk$
  wk$=SPACE$(32000)
  nbase%=VARPTR(wk$)
  BLOAD f$,nbase%
  oldptr%=nbase%
  nwptr%=XBIOS(3)
  count%=0
  nwcount%=0
  zeroes%=0
  esc%=PEEK(oldptr%)
  INC oldptr%
  REPEAT
    IF PEEK(oldptr%)<>0 AND PEEK(oldptr%)<>esc%
      POKE nwptr%,PEEK(oldptr%)
      INC nwptr%
      INC count%
      INC oldptr%
    ELSE
      IF PEEK(oldptr%)
        INC oldptr%
        con%=PEEK(oldptr%)
        INC oldptr%
        rep%=PEEK(oldptr%)
        INC oldptr%
        FOR i%=1 TO rep%
          POKE nwptr%,con%
          INC nwptr%
        NEXT i%
        ADD count%,rep%
      ELSE
        INC oldptr%
        ADD count%,PEEK(oldptr%)
        ADD nwptr%,PEEK(oldptr%)
        INC oldptr%
      ENDIF
    ENDIF
  UNTIL count%>=32000
RETURN
' *********** Luppenroutine von Markus Deheus *******
PROCEDURE glass(w%,h%,m%)
  LOCAL mx%,my%,mk%
  GRAPHMODE 3
  REPEAT
    HIDEM
    MOUSE mx%,my%,mk%
    BOX mx%,my%,mx%+w%-1,my%+h%-1
    REPEAT
    UNTIL MOUSEX<>mx% OR MOUSEY<>my% OR MOUSEK
    BOX mx%,my%,mx%+w%-1,my%+h%-1
  UNTIL mk%
  SHOWM
  IF mk%=1
    GOSUB zeige_bild
    GRAPHMODE 1
    GET mx%,my%,mx%+w%-1,my%+h%-1,part$
    @magnify(w%,h%,m%)
    GOSUB merge_bild
    PUT mx%,my%,part$
  ENDIF
  COLOR ccc%
  GRAPHMODE graf%
RETURN
PROCEDURE magnify(w%,h%,m%)
  LOCAL sx%,sy%,by%,mw%,px%,mgx%,mgx2%,mgy%,mgy2%,mx%,my%,k$,i%,j%,rx%,ry%
  DEFFILL 1,1
  COLOR 1
  CLS
  sx%=6
  sy%=6
  BOX 220,30,470,100
  BOX 218,28,472,102
  BOX 217,27,473,103
  PRINT AT(30,3);"Vielem Dank an Markus Deheus "
  PRINT AT(30,4);"fÅr diese super Lupenroutine "
  PRINT AT(30,5);"und die Little Painer Bild "
  PRINT AT(30,6);"Kompakierroutine "
  PRINT AT(64,10);" Lupen-Bedienung"
  PRINT AT(64,11);" ---------------"
  PRINT AT(64,12);"  - Maustaste - "
  PRINT AT(64,13);"Links = zeichnen"
  PRINT AT(64,14);"Rechts = lîschen"
  PRINT AT(64,15);"Taste = zum Bild"
  PRINT AT(64,16);"-----------------"
  PRINT AT(64,17);"Sind Sie im Bild "
  PRINT AT(64,18);"Dann Abbruch der "
  PRINT AT(64,19);"   Lupe durch    "
  PRINT AT(64,20);"   drÅcken der   "
  PRINT AT(64,21);"rechten Maustaste"
  BOX sx%-2,sy%-2,sx%+w%+1,sy%+h%+1
  PUT 6,6,part$
  by%=399-m%*h%
  mw%=m%*w%
  DRAW 0,by% TO mw%,by%
  DRAW mw%,by% TO mw%,399
  py%=i%+sy%
  mgy%=by%+1
  mgy2%=mgy%+m%-1
  DEC w%
  DEC h%
  DEFFILL 1,1
  FOR i%=0 TO h%
    px%=sx%
    mgx%=0
    mgx2%=m%-1
    FOR j%=0 TO w%
      IF POINT(px%,py%)
        PBOX mgx%,mgy%,mgx2%,mgy2%
      ENDIF
      ADD mgx%,m%
      ADD mgx2%,m%
      INC px%
    NEXT j%
    ADD mgy%,m%
    ADD mgy2%,m%
    INC py%
  NEXT i%
  DO
    k$=INKEY$
    EXIT IF k$=" "
    MOUSE mx%,my%,mousek
    IF MOUSEK
      rx%=mx% DIV m%
      ry%=(my%-by%) DIV m%
      IF rx%<=w% AND ry%<=h% AND ry%>=0
        IF MOUSEK=1
          DEFFILL 1,1
          sau=1
          COLOR 1
        ELSE
          DEFFILL 0,0
          sau=0
          COLOR 0
        ENDIF
        PBOX m%*rx%,by%+m%*ry%+1,m%*rx%+m%-1,by%+m%*ry%+m%
        DRAW sx%+rx%,sy%+ry%
      ENDIF
    ENDIF
  LOOP
  GET sx%,sy%,sx%+w%,sy%+h%,part$
RETURN
PROCEDURE boot_texter
  start:
  LOCAL l,e%,lo%,eee%,d%
  HIDEM
  CLS
  a$=SPACE$(512)
  VOID XBIOS(8,L:VARPTR(a$),L:0,0,1,0,0,1)
  PRINT CHR$(27)+"p";
  PRINT AT(1,3);" ";STRING$(30,45);" Lese  Bootsektor ";STRING$(30,45);" "
  PRINT CHR$(27)+"q";
  PRINT AT(1,4);a$
  IF ASC(a$)=&H60
    ALERT 3,"----------- Alarm -----------|Diskette infiziert Virus oder |     Bootsektor Programm| Soll ich Bootsektor lîschen",2,"Lîchen|ZurÅck",lo%
    IF lo%=1
      MID$(a$,1)=STRING$(6,0)
      MID$(a$,59)=STRING$(512,&HE5)
      VOID XBIOS(18,L:VARPTR(a$),L:-1,-1,0)
      e%=XBIOS(9,L:VARPTR(a$),L:0,0,1,0,0,1)
      GOTO licht
    ENDIF
    IF lo%=2
      GOTO licht
    ENDIF
  ELSE
    ALERT 0,"Wollen Sie den |  Bootsektor| Text  Ñndern",2,"Ja|Nein",eee%
    IF eee%=1
      PRINT CHR$(27)+"p";
      PRINT AT(1,10);" ";STRING$(28,45);" Gebe Neuen Text ein ";STRING$(29,45);" "
      PRINT CHR$(27)+"q";
      PRINT AT(1,13);
      VOID XBIOS(8,L:VARPTR(a$),L:0,0,1,0,0,1)
      PRINT AT(1,11);a$
      PRINT AT(1,13);
      FORM INPUT 255,b$
      MID$(a$,202)=b$
      VOID XBIOS(18,L:VARPTR(a$),L:-1,-1,0)
      PRINT AT(1,11);a$
      e%=XBIOS(9,L:VARPTR(a$),L:0,0,1,0,0,1)
      VOID XBIOS(8,L:VARPTR(a$),L:0,0,1,0,0,1)
      PRINT AT(1,4);a$
    ENDIF
    IF eee%=2
      GOTO licht
    ENDIF
  ENDIF
  licht:
  SHOWM
  ALERT 0,"Noch eine Disk",1,"Ja|Nein",d%
  IF d%=1
    GOTO start
  ENDIF
  emil:
  GOSUB merge_bild
RETURN
PROCEDURE verschieben_2
  GOSUB merge_bild
  REPEAT
  UNTIL MOUSEK=0
  IF ver_mod%=0
    ver_mod%=3
  ENDIF
  IF verschieben=1
    ' ************ Ab Maus Nach Oben ***********
    REPEAT
      IF MOUSEK=1
        GET 0,1,MOUSEX,MOUSEY,ver$
        PUT 0,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=2
    ' *********** Nach Unten ***********
    REPEAT
      IF MOUSEK=1
        GET 0,0,MOUSEX,MOUSEY,ver$
        PUT 0,1,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=3
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 1,0,MOUSEX,MOUSEY,ver$
        PUT 0,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=4
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 0,0,MOUSEX,MOUSEY,ver$
        PUT 1,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=5
    ' ********* Nach Rechts Unten ************
    REPEAT
      IF MOUSEK=1
        GET 0,1,MOUSEX,MOUSEY,ver$
        PUT 1,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=6
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 1,0,MOUSEX,MOUSEY,ver$
        PUT 0,1,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=7
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 1,1,MOUSEX,MOUSEY,ver$
        PUT 0,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=8
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 1,1,MOUSEX,MOUSEY,ver$
        PUT 1,0,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=9
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET MOUSEX,0,MOUSEX,MOUSEY,ver$
        PUT MOUSEX,1,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben=10
    ' ********* Nach Links Unten ************
    REPEAT
      IF MOUSEK=1
        GET 0,MOUSEY,MOUSEX,MOUSEY,ver$
        PUT 1,MOUSEY,ver$,ver_mod%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
RETURN
PROCEDURE verschieben_4
  GOSUB merge_bild
  REPEAT
  UNTIL MOUSEK=0
  IF ver_mod%=0
    ver_mod%=3
  ENDIF
  IF verschieben_2=1
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 0,y%,639,399,ver$
        PUT 0,y%+1,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,y% TO 639,y%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=2
    ' ************ Scroll nach oben *********
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 0,y%+1,639,399,ver$
        PUT 0,y%,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,399 TO 639,399
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=3
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET x%,0,639,399,ver$
        PUT x%+1,0,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW x%,0 TO x%,399
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=4
    ' ************** Scroll nach links *************
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 1,0,x%,399,ver$
        PUT 0,0,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW x%,0 TO x%,399
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=5
    ' *************** Scroll nach unten **************
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 0,0,639,y%-1,ver$
        PUT 0,1,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,0 TO 639,0
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=6
    ' ************ Scroll nach oben *********
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 0,y%+1,639,399,ver$
        PUT 0,y%,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,y% TO 639,y%
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=7
    ' ***** Scroll nach rechts *******
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 0,0,x%-1,399,ver$
        PUT 1,0,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,0 TO 0,399
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF verschieben_2=8
    ' ************** Scroll nach links *************
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        GET 1,0,x%-1,399,ver$
        PUT 0,0,ver$,ver_mod%
        COLOR 0
        DEFLINE 1,0,0,0
        DRAW 0,0 TO 639,0
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  GOSUB zeige_bild
RETURN
PROCEDURE formatieren(laufwerk,seiten)
  CLR i,j,fehler,puffer$
  LOCAL i,j,fehler,puffer$
  puffer$=STRING$(&H2000," ")
  FOR i=0 TO 79
    PRINT AT(48,15);
    PRINT USING "##",i
    FOR j=0 TO seiten
      fehler=XBIOS(10,L:VARPTR(puffer$),L:0,W:laufwerk,W:9,W:i,W:j,W:1,L:&H87654321,W:0)
      EXIT IF fehler<>0
    NEXT j
    EXIT IF fehler<>0
  NEXT i
  IF fehler<>0
    ALERT 0,"Formatier - Fehler|   aufgetreten",1,"Schade",d%
  ENDIF
  IF fehler=0
    VOID XBIOS(18,L:VARPTR(puffer$),L:&H1000000,W:seiten+2,W:0)
    fehler=XBIOS(9,L:VARPTR(puffer$),L:0,W:laufwerk,W:1,W:0,W:0,W:1)
  ENDIF
RETURN
oo2:
DATA    , Copyright ,------------------------------,1,2,3,4,5,6,""
DATA  Arbeit 2 , Pyramide , Torte , G - Box , Vieleck , Vieleck 2 , K - Linie ,---------------, Z - Box , Z - Kreis ,---------------," Zeichenlupen "
DATA ---------------, E-Ausschnitt , K-Ausschnitt ,---------------
DATA  Verschieben 1 , Verschieben 2 ,---------------, SprÅhdose 1 , SprÅhdose 2 ,""
DATA Arbeit 2b, Linie    2 , Rechteck 2 , Quadrat  2 , Kreis    2 , Ellipse  2 ,--------------
DATA  Radierer ,""
DATA   Block   , V - Spiegeln , H - Spiegeln ,-----------------
DATA  V - Invers , H - Invers ,-----------------, Kopieren ," Lasso "
DATA -----------------, Lîschen ,""
DATA Einstellen , Effekt Modus , Block Modus , V - Modus , Z - Modus , Z - Begrenzer ," V - Ursprung "
DATA  Ausschnitt , SprÅhbereich 1 , Modus 2b ,""
DATA    Disk 1    , Boot Texter , Disk Format ,-----------------, Lade Programm ,""
DATA Sonstiges , MenÅ 1    , MenÅ 3 , MenÅ 4 ,""
PROCEDURE auswerten3
  REPEAT
  UNTIL MOUSEK=0
  starter_3:
  ON ERROR GOSUB fehlerio3
  SDPOKE &H4EE,1
  MENU KILL
  MENU OFF
  LOCAL d4%,ld3$
  ld3$=menue1$(MENU(FALSE))
  GOSUB merge_bild
  GOSUB auto1
  IF ld3$="   Joystick "
    RESTORE x
    GOSUB merge_bild
    HIDEM
    x%=100
    y%=100
    LET sprite$=MKI$(FALSE)+MKI$(FALSE)+MKI$(FALSE)
    LET sprite$=sprite$+MKI$(FALSE)+MKI$(1)
    x:
    FOR i%=1 TO 16
      READ vorn$,hinten$
      vorn=VAL(vorn$)
      hinten=VAL(hinten$)
      LET sprite$=sprite$+MKI$(hinten)+MKI$(vorn)
    NEXT i%
    DATA 64512,512,64512,512,61440,3584,63488,1536,56320,8960,52736,12672,1792,63616,768,3200
    DATA 0,1920,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    joy_base=XBIOS(3)+32000
    DPOKE joy_base,&H23C8
    LPOKE joy_base+2,joy_base+8
    DPOKE joy_base+6,&H4E75
    LPOKE XBIOS(34)+24,joy_base
    REPEAT
      LPOKE joy_base+8,FALSE
      OUT 4,&H16
      REPEAT
      UNTIL LPEEK(joy_base+8)<>FALSE
      joy=PEEK(LPEEK(joy_base+8)+1)
      IF (joy AND 1) AND (y%>FALSE) THEN
        DEC y%
      ENDIF
      IF (joy AND 2) AND (y%<399)
        INC y%
      ENDIF
      IF (joy AND 4) AND (x%>FALSE)
        DEC x%
      ENDIF
      IF (joy AND 8) AND (x%<639)
        INC x%
      ENDIF
      VSYNC
      SPRITE sprite$,x%,y%
      VSYNC
      IF MOUSEK=2
        IF ofarbi%=FALSE
          IF ccc%=FALSE
            IF POINT(MOUSEX,MOUSEY)=1
              DRAW x%,y%-1
              GOSUB yspunkt
            ENDIF
          ELSE
            IF POINT(MOUSEX,MOUSEY)=FALSE
              DRAW x%,y%-1
              GOSUB yspunkt
            ENDIF
          ENDIF
        ELSE
          DRAW x%,y%-1
          GOSUB yspunkt
        ENDIF
      ENDIF
    UNTIL MOUSEK=1
    SPRITE sprite$
    GOSUB eimer
    GOSUB zeige_bild
    RESTORE x
    SHOWM
  ENDIF
  IF ld3$=" Vektor Schrift "
    GOSUB clipping_aus
    GOSUB vektor_schrift
    GOSUB clipping_an
  ENDIF
  IF ld3$=" PC Konverter "
    ALERT 0,"Soll ich erst mal   |Begrenzungslinie ziehen",1,"JA|Konvert|ZurÅck",d%
    IF d%=1
      DRAW 0,200 TO 640,200
    ENDIF
    IF d%=3
      GOTO maulwurf
    ENDIF
    IF d%=2
      OPEN "O",#1,"\DATA.LST"
      FOR x=0 TO 640
        FOR y=0 TO 200
          IF POINT(x,y)=1
            PRINT #1;x;",";y;",";
            COLOR 0
            DRAW x,y
          ELSE
            COLOR 1
            DRAW x,y
          ENDIF
        NEXT y
      NEXT x
      CLOSE #1
    ENDIF
    maulwurf:
  ENDIF
  IF ld3$=" Save Start Info "
    OPEN "O",#1,"START.DAT"
    PRINT #1,"(c) 1998 by Siegfried HÅbner "
    PRINT #1,"Voreinstellungs Datei fÅr Programm Sigi Painter 98"
    PRINT #1,bild1%
    PRINT #1,s_modus_1%
    PRINT #1,bezier1$
    PRINT #1,bezier_punkte
    PRINT #1,facher$
    PRINT #1,oskar
    PRINT #1,hall%
    PRINT #1,lauf%
    PRINT #1,xkord%
    PRINT #1,ykord%
    PRINT #1,k$
    ALERT 3,"Listing Modus",2,"Ein|Aus",schreibe%
    DEC schreibe%
    ALERT 3,"Ramdisk Sicherungsprogramm",2,"Ein|Aus",gitarre%
    DEC gitarre%
    PRINT #1,gitarre%
    ALERT 3,"Radiergummi Form abspeichern",2,"Ja|Nein",rad2%
    IF rad2%=2
      rad2%=0
    ENDIF
    IF rad3%=0
      rad3%=1
    ENDIF
    PRINT #1,rad2%
    PRINT #1,rad3%
    PRINT #1,schreibe%
    PRINT #1,ofarbi%
    PRINT #1,oremi%
    PRINT #1,ziehen%
    PRINT #1,zahl%
    PRINT #1,sav%
    PRINT #1,stil%
    PRINT #1,winkel%
    PRINT #1,gros%
    PRINT #1,modus%
    PRINT #1,v%
    PRINT #1,f%
    PRINT #1,mgross%
    PRINT #1,mfarb%
    PRINT #1,mtyp%
    PRINT #1,c%
    PRINT #1,ka%
    PRINT #1,fu%
    PRINT #1,ccc%
    PRINT #1,graf%
    PRINT #1,grk
    PRINT #1,form
    PRINT #1,bh
    PRINT #1,kj
    PRINT #1,anfang
    PRINT #1,schluss
    PRINT #1,musteri
    PRINT #1,kuligunde
    PRINT #1,aposition%
    PRINT #1,eposition%
    PRINT #1,s_bereich_x%
    PRINT #1,s_bereich_y%
    PRINT #1,z_linie_g%
    PRINT #1,zitter1%
    PRINT #1,zitter2%
    PRINT #1,xrast%
    PRINT #1,yrast%
    PRINT #1,laufi%
    PRINT #1,erlauf%
    PRINT #1,ursus1
    PRINT #1,ursus2
    PRINT #1,ti$
    PRINT #1,da$
    PRINT #1,zacken%
    PRINT #1,zacken1%
    PRINT #1,hintergrund%
    PRINT #1,ver_mod%
    PRINT #1,clip1%
    PRINT #1,clip2%
    PRINT #1,clip3%
    PRINT #1,clip4%
    CLOSE #1
    IF schreibe%=FALSE
      GOSUB himmel1
    ENDIF
  ENDIF
  IF ld3$=" Mausform "
    ko1:
    IF form=FALSE
      LET form$="Pfeil"
    ENDIF
    IF form=1
      LET form$="Text Klammer"
    ENDIF
    IF form=2
      LET form$="Biene"
    ENDIF
    IF form=3
      LET form$="Hand mit Zeigefinger"
    ENDIF
    IF form=4
      LET form$="offene Hand"
    ENDIF
    IF form=5
      LET form$="Fadenkreuz fein"
    ENDIF
    IF form=6
      LET form$="Fadenkreuz grob"
    ENDIF
    IF form=7
      LET form$="doppeltes Fadenkreuz"
    ENDIF
    ALERT 3,"Welche Mausform wÅnschen Sie ?| |Nr.       "+STR$(form)+"|Mausform  "+form$,3," + | - |>> OK <<",d%
    IF d%=1
      IF form=7
        LET form=TRUE
      ENDIF
      INC form
      GOTO ko1
    ENDIF
    IF d%=2
      IF form=FALSE
        LET form=1
      ENDIF
      DEC form
      GOTO ko1
    ENDIF
  ENDIF
  IF ld3$=" Copyright "
    GOSUB infol
  ENDIF
  IF ld3$=" MÑusli "
    DEFMOUSE form
    REPEAT
      IF MOUSEK=1
        REPEAT
        UNTIL MOUSEK=0
        LPOKE 10222,1
      ENDIF
    UNTIL MOUSEK=2
  ENDIF
  IF ld3$=" Zittern "
    HIDEM
    IF zitter2%=0 OR zitter1%=0
      zitter2%=1
      zitter1%=1
    ENDIF
    xzitter%=XBIOS(2)
    yzitter%=xzitter%
    ADD yzitter%,32000-zitter1%
    REPEAT
      POKE xzitter%,PEEK(xzitter%+zitter1%)
      ADD xzitter%,zitter2%
    UNTIL yzitter%<xzitter%
  ENDIF
  IF ld3$=" Zitter Modus "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);"      Zitter Modus       "
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);"-- fÅr Zitter Funktion --"
    PRINT AT(29,11);"Bereich     (0 - 32000) "
    PRINT AT(29,12);zitter1%
    PRINT AT(46,12);
    FORM INPUT 5,zitter1$
    zitter1%=VAL(zitter1$)
    PRINT AT(29,14);"Zittern     (0 - 32000) "
    PRINT AT(29,15);zitter2%
    PRINT AT(46,15);
    FORM INPUT 5,zitter2$
    zitter2%=VAL(zitter2$)
    GOSUB was1
  ENDIF
  IF ld3$=" Rastern "
    GOSUB clipping_aus
    IF xrast%=0 AND yrast%=0
      yrast%=1
    ENDIF
    ALERT 3,"Wie wollen Sie Rastern ?",1,"Normal|Invers",d%
    HIDEM
    DIM f4%(1)
    PUT FALSE,FALSE,boxbild$
    GOSUB hilfs_maus
    WHILE MOUSEK=FALSE
      x%=MOUSEX
      y%=MOUSEY
      BOX a%,b%,x%,y%
      VSYNC
      PAUSE 3
      BOX a%,b%,x%,y%
    WEND
    WHILE MOUSEK=1
      GET a%,b%,x%,y%,box$
      GRAPHMODE graf%
    WEND
    FOR y1%=b% TO y% STEP yrast%+1
      FOR x1%=a% TO x% STEP xrast%+1
        FOR b1%=y1% TO y1%+yrast%
          FOR a1%=x1% TO x1%+xrast%
            g%=POINT(a1%,b1%)
            INC f4%(g%)
          NEXT a1%
        NEXT b1%
        IF d%=1
          m%=MAX(f4%(0),f4%(1))
        ENDIF
        IF d%=2
          m%=MIN(f4%(0),f4%(1))
        ENDIF
        FOR v4%=0 TO 1
          IF f4%(v4%)=m%
            COLOR v4%
            FOR l%=y1% TO y1%+yrast%
              FOR k%=x1% TO x1%+xrast%
                DRAW k%,l%
              NEXT k%
            NEXT l%
          ENDIF
        NEXT v4%
        FOR o%=0 TO 1
          f4%(o%)=0
        NEXT o%
      NEXT x1%
    NEXT y1%
    COLOR ccc%
    GRAPHMODE graf%
    ERASE f4%()
  ENDIF
  IF ld3$=" Raster Modus "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(28,8);"      Raster Modus       "
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);"-- fÅr Raster Funktion --"
    PRINT AT(29,11);"X Koordinate   (0 - 640)"
    PRINT AT(29,12);xrast%
    PRINT AT(49,12);
    FORM INPUT 3,xrast$
    xrast%=VAL(xrast$)
    PRINT AT(29,14);"Y Koordinate   (0 - 400)"
    PRINT AT(29,15);yrast%
    PRINT AT(49,15);
    FORM INPUT 3,yrast$
    yrast%=VAL(yrast$)
    GOSUB was1
  ENDIF
  IF ld3$=" Auto - Save "
    GOSUB clipping_aus
    GOSUB grund1
    PRINT AT(27,8);" Automatische Bildsicherung"
    PRINT CHR$(27)+"q";
    PRINT AT(28,9);"-- Eingabe in Minuten --"
    PRINT AT(29,11);"Minuten ca:            "
    PRINT AT(44,11);
    FORM INPUT 3,oskar$
    oskar=VAL(oskar$)
    oskar=oskar*60
    IF oskar=0
      oskar=1.0E+18
    ENDIF
    GOSUB was1
  ENDIF
  IF ld3$=" MenÅ 1     "
    GOSUB himmel1
  ENDIF
  IF ld3$=" MenÅ 2 "
    GOSUB himmel2
  ENDIF
  IF ld3$=" MenÅ 4 "
    GOSUB himmel4
  ENDIF
  DEFMOUSE 3
  g$=z$
  GOSUB zeige_bild
  MENU menue1$()
  ON MENU  GOSUB auswerten3
  ON MENU KEY GOSUB tastatur
RETURN
PROCEDURE killmi
  SHOWM
  ALERT 3," - Fehler in der START.DAT - |      Datei aufgetreten.|     Ich fange Fehler ab.",1,"Okay",d%
  KILL "START.DAT"
  RUN
RETURN
'
' ***** Mit Blitter TOS
'
oo3b:
DATA    , Copyright ,------------------------------,1,2,3,4,5,6,""
DATA  Arbeit 3 , Zittern , Rastern , Vektor Schrift ,-------------------, PC Konverter ,""
DATA Einstellen , Zitter Modus , Raster Modus , Auto - Save , Save Start Info ,""
DATA    Extra 3 ,   Joystick ,""
DATA   Sonstiges , MenÅ 1     , MenÅ 2 , MenÅ 4 ,""
'
' ***** Mit meinem TOS
'
oo3:
DATA    , Copyright ,------------------------------,1,2,3,4,5,6,""
DATA  Arbeit 3 , Zittern , Rastern , MÑusli , Vektor Schrift ,----------------, PC Konverter ,""
DATA Einstellen , Zitter Modus , Raster Modus , Mausform , Auto - Save , Save Start Info ,""
DATA    Extra 3 ,   Joystick ,""
DATA  Sonstiges , MenÅ 1     , MenÅ 2 , MenÅ 4 ,""
PROCEDURE grund
  GOSUB rahmung(c%)
  COLOR ccc%
  GRAPHMODE graf%
  DEFFILL 1,v%,f%
  DEFTEXT 1,stil%,winkel%,gros%
  DEFLINE kj,bh,anfang,schluss
RETURN
PROCEDURE grund1
  GOSUB hals
  RBOX 200,100,430,280
  RBOX 202,102,428,278
  RBOX 203,103,427,277
  PRINT CHR$(27)+"p";
RETURN
PROCEDURE monitor
  SHOWM
  GOSUB merge_bild
  IF NOT ERR=-13
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      HIDEM
      BSAVE "RETTEN.DOO",XBIOS(2),32000
      SHOWM
    ENDIF
  ENDIF
  IF ERR=-1
    ALERT 3,"Allgemeiner Fehler| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-2
    ALERT 3,"* Drive Not Ready|ZeitÅberschreitung| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-3
    ALERT 3,"Unbekannter Befehl | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-4
    ALERT 3,"* CRC Fehler|Disk-PrÅfsumme falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-5
    ALERT 3,"Bad Request|UngÅltiger Befehl| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-6
    ALERT 3,"* Seek Error|Spur nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-7
    ALERT 3,"* Unknown Media|Falscher Bootsektor| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-8
    ALERT 3,"* Sektor nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-9
    ALERT 3,"* Kein Papier| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-10
    ALERT 3,"* Schreibfehler| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-11
    ALERT 3,"* Lesefehler | |Ich famge Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-13
    ALERT 3,"* Diskette SchreibgeschÅtzt| |    Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-14
    ALERT 3,"* Diskette wurde gewechselt| |    Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-15
    ALERT 3,"* Unbekanntes GerÑt | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-16
    ALERT 3,"* Bad Sektor (Verify)| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-17
    ALERT 3,"* Andere Diskette einlegen| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-32
    ALERT 3,"* UngÅltige Funktionsnummer| |   Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-33
    ALERT 3,"* Datei nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-34
    ALERT 3,"* Pfadname nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-35
    ALERT 3,"* Zuviele Dateien offen| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-36
    ALERT 3,"* Zugriff nicht mîglich| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-37
    ALERT 3,"* UngÅltiges Handle| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-39
    ALERT 3,"* Speicher voll |Versuche Bild zu Retten|Abspeichern unter Retten.DOO",1,"Ende",d%
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      HIDEM
      BSAVE "RETTEN.DOO",XBIOS(2),32000
      SHOWM
    ENDIF
    END
  ENDIF
  IF ERR=-40
    ALERT 3,"* UngÅltige Speicher-|  blockadresse| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=46
    ALERT 3,"* UngÅltige Laufwerks-|  bezeichnung| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-49
    ALERT 3,"* Keine weiteren Dateien| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-64
    ALERT 3,"* GEMDOS Bereichsfehler|SEEK falsch?| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-65
    ALERT 3,"* Interner GEMDOS Fehler| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-66
    ALERT 3,"* Kein BinÑrprogrammfile| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=-67
    ALERT 3,"* Speicherblockfehler | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=0
    ALERT 3,"Division durch Null| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=1
    ALERT 3,"öberlauf| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=2
    ALERT 3,"Zahl nicht Integer|-2147483648 .. 2147483647| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=3
    ALERT 3," Zahl nicht Byte| 0 .. 255| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=4
    ALERT 3," Zahl nicht Wort| 0 .. 65535| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=5
    ALERT 3,"Quadratwurzel nur fÅr|positive Zahlen| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=6
    ALERT 3,"Logarithmen nur fÅr|Zahlen grîûer Null| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=7
    ALERT 3,"Unbekannter Fehler| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=8
    ALERT 3,"* Speicher voll |Versuche Bild zu Retten|Abspeichern unter Retten.DOO",1,"Ende",d%
    IF DFREE(0)<33000
      ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
    ELSE
      HIDEM
      BSAVE "RETTEN.DOO",XBIOS(2),32000
      SHOWM
    ENDIF
    END
  ENDIF
  IF ERR=9
    ALERT 3,"Funktion oder Befehl|noch nicht mîglich| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=10
    ALERT 3,"String zu lang|max. 32767 Zeichen| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=11
    ALERT 3,"Kein Sigi Painter|V5.5 Programm| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=12
    ALERT 3,"Programm zu lang|Speicher voll| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=13
    ALERT 3,"Kein Sigi-Painter Programm|File zu kurz| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=14
    ALERT 3,"Feld zweimal dimensioniert| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=15
    ALERT 3,"Feld nicht dimensioniert| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=16
    ALERT 3,"Feld Index zu groû| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=17
    ALERT 3,"Dim Index zu groû| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=18
    ALERT 3,"Falsche Anzahl Indizes| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=19
    ALERT 3,"Procedure nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=20
    ALERT 3,"Label nicht gefunden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=21
    ALERT 3,"Bei OPEN nur erlaubt:|'I'nput 'O'utput 'R'andom|'A'ppend 'U'pdate|Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=22
    ALERT 3,"File schon geîffnet| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=23
    ALERT 3,"File # falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=24
    ALERT 3,"File nicht geîffnet| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=25
    ALERT 3,"Falsche Eingabe, keine Zahl | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=26
    ALERT 3,"Fileende erreicht | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=27
    ALERT 3,"Zu viele Punkte fÅr|Polyline/Polyfill|maximal 128|Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=28
    ALERT 3,"Feld muû eindimensional sein| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=29
    ALERT 3,"Anzahl Punkte grîûer als Feld| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=30
    ALERT 3,"Kein ASC II File| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=31
    ALERT 3,"Zeile zu lang| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=32
    ALERT 3,"Syntax nicht korrekt| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=33
    ALERT 3,"Marke nicht definiert| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=34
    ALERT 3,"Zu wenig Data| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=35
    ALERT 3,"Data nicht numerisch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=36
    ALERT 3,"Syntaxfehler in Data|""""paarweise verwenden| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=37
    ALERT 3,"Diskette voll| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=38
    ALERT 3,"Befehl im Direktmodus|nicht mîglich| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=39
    ALERT 3,"Programmfehler|Kein Gosub mîglich| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=40
    ALERT 3,"Clear nicht mîglich|in For-Next-Schleifen oder|Proceduren|Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=41
    ALERT 3,"Cont nicht mîglich| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=42
    ALERT 3,"Zuwenig Parameter| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=43
    ALERT 3,"Ausdruck zu komplex| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=44
    ALERT 3,"Funktion nicht definiert| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=45
    ALERT 3,"Zuviele Parameter| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=46
    ALERT 3,"Parameter falsch|muû Zahl sein| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=47
    ALERT 3,"Parameter falsch|muû String sein| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=48
    ALERT 3,"Open""R"" SatzlÑnge falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=49
    ALERT 3,"Zu viele ""R"" Files (max. 10) | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=50
    ALERT 3,"Kein ""R""-File| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=51
    ALERT 3,"Nur ein Field zu einem|Open ""R"" mîglich | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=52
    ALERT 3,"Fields grîûer als SatzlÑnge| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=53
    ALERT 3,"Zu viele Fields (max.19)| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=54
    ALERT 3,"GET/PUT Field-String|LÑnge falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=55
    ALERT 3,"GET/PUT Satznummer falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=60
    ALERT 3,"Sprite-StringlÑnge falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=61
    ALERT 3,"Fehler bei RESERVE| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=62
    ALERT 3,"Fehlerhaftes MenÅ| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=63
    ALERT 3,"Fehlerhaftes Reserve| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=64
    ALERT 3,"Fehlerhafter Pointer| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=90
    ALERT 3,"Fehler bei Local| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=91
    ALERT 3,"Fehler bei For| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=92
    ALERT 3,"Resume (Next) nicht mîglich|Fatal, For oder Local | |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=100
    ALERT 3," - Sigi Painter Version 98 -|(c) 1998 by Siegfried HÅbner|St.-Gundekar-Str. 29 b, 91560 Heilsbronn",1,"Gelesen",d%
  ENDIF
  IF ERR=102
    ALERT 3,"2 Bomben Bus -  Error|PEEK oder POKE falsch| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=103
    ALERT 3,"3 Bomben - Adress Error|Ungerade Wort Adresse| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=104
    ALERT 3,"4 Bomben - Illegal Instruktion|AusfÅhrung eines ungÅltigen|68000-Maschinenbefehls|Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=105
    ALERT 3,"5 Bomben|Division durch Null in|68000 Maschinensprache ",1,"OK",d%
  ENDIF
  IF ERR=106
    ALERT 3,"6 Bomben CHK-Exeption|durch CHK-Befehl| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=107
    ALERT 3,"7 Bomben TRAPV-Exeption|durch TRAPV-Befehl| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=108
    ALERT 3,"Privilege Violation|durch AusfÅhrung eines|priviligierten Befehls|Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
  IF ERR=109
    ALERT 3,"9 Bomben Trace Exeption|68000-Trace-Interrupt| |Ich fange Fehler ab",1,"Gelesen",d%
  ENDIF
RETURN
PROCEDURE ueberwachen(x1%,y1%,x2%,y2%,hdl)
  IF k%=0 AND x%>x1% AND x%<x2% AND y%>y1% AND y%<y2%
    DEFFILL 1,1,1
    GRAPHMODE 3
    DRAW x1%,y1%
    PBOX x1%,y1%,x2%,y2%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL k%=1 OR x%<x1% OR x%>x2% OR y%<y1% OR y%>y2%
    IF x%>x1% AND x%<x2% AND y%>y1% AND y%<y2%
      ja%=hdl
    ELSE
      ja%=0
    ENDIF
    PBOX x1%,y1%,x2%,y2%
    DRAW x1%,y1%
    REPEAT
    UNTIL MOUSEK=0
  ENDIF
RETURN
PROCEDURE datei_erfragen(srch$)
  FILESELECT CHR$(65+GEMDOS(25))+":\"+srch$,"",f$
RETURN
PROCEDURE ber
  muster$=""
  i%=0
  FOR y%=0 TO 15
    w%=0
    FOR x%=0 TO 15
      IF fm%(y%,x%)=1
        w%=w%+2^x%
        INC i%
      ENDIF
    NEXT x%
    muster$=muster$+MKI$(w%)
  NEXT y%
RETURN
PROCEDURE wrt
  DEFFILL 1,0,0
  GRAPHMODE 1
  PBOX 50,50,370,370
  FOR i%=50 TO 370 STEP 20
    DRAW 50,i% TO 370,i%
    DRAW i%,50 TO i%,370
  NEXT i%
  DEFFILL 1,2,4
  @umrandung(0)
  FOR my%=0 TO 15
    FOR mx%=0 TO 15
      IF fm%(my%,15-mx%)=1
        PBOX mx%*20+51,my%*20+51,mx%*20+69,my%*20+69
      ENDIF
    NEXT mx%
  NEXT my%
  @umrandung(1)
  DEFFILL 1,1,1
RETURN
PROCEDURE defm
  DPOKE CONTRL,112
  DPOKE CONTRL+2,0
  DPOKE CONTRL+6,16
  FOR y%=0 TO 15
    w%=0
    FOR x%=0 TO 15
      IF fm%(y%,x%)=1
        w%=w%+2^x%
      ENDIF
    NEXT x%
    DPOKE INTIN+2*y%,w%
  NEXT y%
  VDISYS (112)
RETURN
PROCEDURE i_gp(ad1,ad2)
  s%(0)=ad1
  s%(1)=640
  s%(2)=400
  s%(3)=s%(1)/16
  s%(4)=0
  s%(5)=1
  d%(0)=ad2
  d%(1)=640
  d%(2)=400
  d%(3)=d%(1)/16
  d%(4)=0
  d%(5)=1
  p%(8)=3
RETURN
PROCEDURE g_p1(x1%,y1%,x2%,y2%,x3%,y3%,x4%,y4%)
  p%(0)=x1%
  p%(1)=y1%
  p%(2)=x2%
  p%(3)=y2%
  p%(4)=x3%
  p%(5)=y3%
  p%(6)=x4%
  p%(7)=y4%
  BITBLT s%(),d%(),p%()
RETURN
PROCEDURE umrandung(umrandung%)
  DPOKE CONTRL,104
  DPOKE CONTRL+2,0
  DPOKE CONTRL+6,1
  GOSUB rahmung(umrandung%)
RETURN
PROCEDURE turbo_weck
  GRAPHMODE 1
  @ber
  DEFFILL 1,muster$
  @umrandung(0)
  PBOX 495,63,587,357
  @umrandung(1)
RETURN
PROCEDURE radio
  REPEAT
    ON ERROR GOSUB fehlerio1
    ON MENU
    IF schreibe%=1
      MENU 77,2
      MENU 78,2
      MENU 79,2
      MENU 80,2
      MENU 81,2
      MENU 82,2
      MENU 84,2
    ENDIF
    IF schreibe%=FALSE
      MENU 11,2
      MENU 12,2
      MENU 14,2
      MENU 15,2
      MENU 17,2
      MENU 18,2
      MENU 19,2
      MENU 20,2
      MENU 21,2
      MENU 22,2
      MENU 23,2
      MENU 24,2
      MENU 25,2
      MENU 44,2
      MENU 45,2
      MENU 58,2
      MENU 86,2
      MENU 87,2
      MENU 87,2
      MENU 88,2
      MENU 89,2
      MENU 90,2
      MENU 91,2
    ENDIF
  UNTIL void
RETURN
PROCEDURE radio2
  LOCAL x%,y%,flasche%,wert%,d%
  CLS
  GOSUB murmel
  DEFTEXT 1,FALSE,3,30
  GRAPHMODE 2
  TEXT 160,45,">> Bild speichern <<"
  PRINT AT(20,24);CHR$(27)+"p";"Sie kînnen sich derweil einen Kaffe kochen.";CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 150,360,495,390
  f$=f$
  GOSUB datei_erfragen("*.LST")
  GOSUB merge_bild
  IF f$<>""
    zahl1=TIMER
    GOSUB merge_bild
    @saven
    x%=FALSE
    y%=FALSE
    flasche%=FALSE
    wert%=FALSE
    PRINT #1,"DO"
    PRINT #1,"READ Y$"
    PRINT #1,"EXIT IF Y$=";CHR$(34);"#";CHR$(34)
    PRINT #1,"DO"
    PRINT #1,"READ X$"
    PRINT #1,"EXIT IF X$=";CHR$(34);"*";CHR$(34)
    PRINT #1,"LPOKE val(";CHR$(34);"&H";CHR$(34);"+X$)+XBIOS(2),VAL(";CHR$(34);"&H";CHR$(34);"+Y$)"
    PRINT #1,"LOOP"
    PRINT #1,"LOOP"
    HIDEM
    wert%=XBIOS(2)
    x%=wert%
    flasche%=wert%
    ADD flasche%,32000
    d%=FALSE
    REPEAT
      sd:
      INC y%
      y%=LPEEK(x%)
      IF y%=FALSE
        ADD x%,4
      ENDIF
      IF x%=flasche%
        PRINT #1,"Data #"
        GOTO was_solls
      ENDIF
      IF y%=FALSE
        GOTO sd
      ENDIF
      REPEAT
        ' ********** Farbe schwarz **********
        IF LPEEK(x%)=y%
          IF d%=FALSE
            PRINT #1,"DATA ";HEX$(y%);",";
            d%=1
          ENDIF
          PRINT #1,HEX$(x%-XBIOS(2));
          LPOKE x%,FALSE
          IF NOT d%=48
            PRINT #1,",";
          ENDIF
          INC d%
          IF d%=49
            PRINT #1
            PRINT #1,"DATA ";
            d%=1
          ENDIF
        ENDIF
        ADD x%,4
      UNTIL x%=flasche%
      IF d%=49
        PRINT #1
        PRINT #1,"*"
      ELSE
        PRINT #1,"*"
      ENDIF
      ADD l%,4
      x%=wert%+l%
      d%=FALSE
    UNTIL MOUSEK=2
    was_solls:
    CLOSE #1
    CLS
    PRINT AT(28,5);"Edlich bin ich fertig"
    PRINT AT(29,6);"wurde ja auch Zeit."
    PRINT AT(21,8);"Es wurden ";(TIMER-zahl1)/200;" Sekunden benîtigt.";CHR$(7)
    PRINT AT(20,10);CHR$(27)+"p";" ----- Bitte eine Taste drÅcken -----";CHR$(27)+"q";
    REPEAT
    UNTIL MOUSEK OR INKEY$=>CHR$(FALSE)
  ENDIF
RETURN
PROCEDURE radio5(f$)
  IF f$<>"" AND NOT f$=" "
    GOSUB merge_bild
    BLOAD f$,XBIOS(2)
    GOSUB zeige_bild
  ENDIF
RETURN
' *** Lade STAD PAC Bild
PROCEDURE lade_stad
  LOCAL auspack$,auspack,a%
  auspack$=""
  RESTORE auspack
  DO
    READ a%
    EXIT IF a%<0
    auspack$=auspack$+MKI$(a%)
  LOOP
  VOID FRE(0)
  IF f$<>""
    OPEN "I",#1,f$
    sorc$=SPACE$(LOF(#1))
    BGET #1,VARPTR(sorc$),LOF(#1)
    CLOSE #1
    VOID FRE(0)
    IF LPEEK(VARPTR(sorc$))<>&H704D3835 AND LPEEK(VARPTR(sorc$))<>&H704D3836
      ALERT 0,"KEIN STAD-BILD",1,"Schade",d%
    ELSE
      auspack%=VARPTR(auspack$)
      VOID C:auspack%(L:XBIOS(3),L:VARPTR(sorc$))
      GOSUB zeige_bild
    ENDIF
  ENDIF
  auspack:
  ' MCODE AUSPACK
  DATA 10351,4,9327,8,9804,3218,28749,14390
  DATA 26112,108,22666,6170,16966,7194,6682,9276
  DATA 0,32000,13884,400,16967,4122,45060,26112
  DATA 10,4614,7706,24576,30,45061,26368,10
  DATA 5760,16967,24576,18,4634,26112,8,18962
  DATA 26368,40,7706,5761,21314,27392,30,55292
  DATA 0,80,21315,26112,12,13884,400,9804
  DATA 21131,10315,20943,65504,24750,16960,20085,3226
  DATA 28749,14389,26112,72,6170,16966,7194,6682
  DATA 9276,0,32000,16967,4122,45060,26112,10
  DATA 4614,7706,24576,28,45061,26368,10,5824
  DATA 21314,27590,24800,4634,26112,6,18962,26554
  DATA 7706,5825,21314,27570,20943,65528,24776,12348
  DATA 1,24744
  DATA -1
RETURN
PROCEDURE auto1
  DEFMOUSE 5
  GOSUB merge_bild
  IF INT((TIMER-auto_save)/200)=>oskar
    ALERT 3,"----- Auto Save ------|Bild Abspeichern unter|  Bildname  ZEIT.DOO ",2,"Ja|Nein",d%
    IF d%=1
      IF DFREE(0)<33000
        ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
      ELSE
        HIDEM
        BSAVE "ZEIT.DOO",XBIOS(2),32000
        SHOWM
      ENDIF
      auto_save=TIMER
    ENDIF
  ENDIF
RETURN
PROCEDURE was
  PRINT #1,"ERASE OK$()"
  PRINT #1,"DIM OK$(640)"
  PRINT #1,"X%=0"
  PRINT #1,"REPEAT"
RETURN
PROCEDURE was1
  GOSUB grund
  GOSUB clipping_an
  GOSUB merge_bild
  GOSUB zeige_bild
RETURN
PROCEDURE hals
  DEFLINE 0,0,0,0
  COLOR 1
  SHOWM
  SPUT l$
  GOSUB clipping_aus
  CLS
  GRAPHMODE 1
  DEFMOUSE 3
RETURN
PROCEDURE welt
  DIM ok$(399)
  x%=0
RETURN
PROCEDURE himmel1
  CLR d%
  MENU KILL
  ERASE menue1$()
  DIM menue1$(92)
  RESTORE oo1
  DEFMOUSE 3
  REPEAT
    READ menue1$(d%)
    INC d%
  UNTIL d%=92
  MENU menue1$()
  ON MENU  GOSUB auswerten1
  ON MENU KEY GOSUB tastatur
  GOSUB radio
RETURN
PROCEDURE tastatur
  ON ERROR GOSUB fehlerio_tast
  tastatur_f:
  GOSUB grund
  taste=MENU(14) DIV 256
  '  PRINT taste
  '  STOP
  IF taste=1               !ESC = Lupe 3
    GOSUB clipping_aus
    SHOWM
    GOSUB lupe_3
    HIDEM
    GOSUB clipping_an
  ENDIF
  IF taste=2               !Taste 1 = Grafikmodus 1
    graf%=1
  ENDIF
  IF taste=3               !Taste 2 = Grafikmodus 2
    graf%=2
  ENDIF
  IF taste=4               !Taste 3 = Grafikmodus 3
    graf%=3
  ENDIF
  IF taste=5               !Taste 4 = Grafikmodus 4
    graf%=4
  ENDIF
  IF taste=57             !Leertaste Monitor aus/an
    VSYNC
    SPOKE &HFF820A,PEEK(&HFF820A) OR 1
    REPEAT
    UNTIL MOUSEK>0 OR INKEY$=>CHR$(0)
    SPOKE &HFF820A,PEEK(&HFF820A) AND NOT 1
  ENDIF
  IF taste=59             !Bildschirm 1  F1
    bild1%=1
    GOSUB merge_bild
  ENDIF
  IF taste=60             !Bildschirm 2  F2
    bild1%=2
    GOSUB merge_bild
  ENDIF
  IF taste=61             !Bildschirm 3  F3
    bild1%=3
    GOSUB merge_bild
  ENDIF
  IF taste=62             !Bildschirm 4  F4
    bild1%=4
    GOSUB merge_bild
  ENDIF
  IF taste=63             !Bildschirm 5  F5
    bild1%=5
    GOSUB merge_bild
  ENDIF
  IF taste=68             !Ende          F10
    GOSUB infob
    GOSUB tta
  ENDIF
  IF taste=106              !MenÅ 4       Zahlenfeld 4
    GOSUB himmel4
  ENDIF
  IF taste=109              !MenÅ 1       Zahlenfeld 1
    GOSUB himmel1
  ENDIF
  IF taste=110              !MenÅ 2       Zahlenfeld 2
    GOSUB himmel2
  ENDIF
  IF taste=111              !MenÅ 3       Zahlenfeld 3
    GOSUB himmel3
  ENDIF
  IF taste=112              !Zeichenfarbe weiû
    ccc%=0
  ENDIF
  IF taste=113              !Zeichenfarbe schwarz
    ccc%=1
  ENDIF
  IF taste=116          !Control Pfeil nach rechts
    HIDEM
    GOSUB merge_bild
    GET 0,0,639-10,399,sc1$
    GET 639-10,0,639,399,sc2$
    PUT 0,0,sc2$
    PUT 1+10,0,sc1$
    GOSUB zeige_bild
  ENDIF
  IF taste=115          !Control Pfeil nach links
    HIDEM
    GOSUB merge_bild
    GET 0,0,10,399,sc2$
    GET 1+10,0,639,399,sc1$
    PUT 0,0,sc1$
    PUT 639-10,0,sc2$
    GOSUB zeige_bild
  ENDIF
  IF taste=32              !D Taste = Draw
    GOSUB merge_bild
    REPEAT
      x%=MOUSEX
      y%=MOUSEY
      IF MOUSEK=1
        HIDEM
        DRAW x%,y% TO b%+xkord%,a%+ykord%
      ELSE
        SHOWM
      ENDIF
      b%=x%
      a%=y%
    UNTIL MOUSEK=2
    GOSUB zeige_bild
  ENDIF
  IF taste=38                 !L = Linie
    GOSUB merge_bild
    REPEAT
      GOSUB hilfs_maus
      VSYNC
      WHILE MOUSEK=FALSE
        x%=MOUSEX
        y%=MOUSEY
        HIDEM
        DRAW x%,y% TO a%+xkord%,b%+ykord%
        VSYNC
        PAUSE 5
        DRAW x%,y% TO a%+xkord%,b%+ykord%
      WEND
      WHILE MOUSEK=1
        GRAPHMODE 1
        DRAW x%,y% TO a%+xkord%,b%+ykord%
      WEND
    UNTIL MOUSEK=2
    GOSUB zeige_bild
    SHOWM
  ENDIF
  IF taste=71               !CLR/Home
    ALERT 3,"Wollen Sie das Bild|wirklich lîschen  ?",2,"Ja|ZurÅck",d%
    IF d%=1
      GOSUB merge_bild
      CLS
      GOSUB zeige_bild
    ENDIF
  ENDIF
  ' ***** Bild Positionieren
  IF taste=72           !Pfeil oben
    HIDEM
    GOSUB merge_bild
    GET 0,0,639,1,sc2$
    GET 0,1+1,639,399,sc1$
    PUT 0,0,sc1$
    PUT 0,399-1,sc2$
    GOSUB zeige_bild
  ENDIF
  IF taste=80           !Pfeil unten
    HIDEM
    GOSUB merge_bild
    GET 0,0,639,399-1,sc1$
    GET 0,399-1,639,399,sc2$
    PUT 0,0,sc2$
    PUT 0,1+1,sc1$
    GOSUB zeige_bild
  ENDIF
  IF taste=77           !Pfeil rechts
    HIDEM
    GOSUB merge_bild
    GET 0,0,639-1,399,sc1$
    GET 639-1,0,639,399,sc2$
    PUT 0,0,sc2$
    PUT 1+1,0,sc1$
    GOSUB zeige_bild
  ENDIF
  IF taste=75           !Pfeil links
    HIDEM
    GOSUB merge_bild
    GET 0,0,1,399,sc2$
    GET 1+1,0,639,399,sc1$
    PUT 0,0,sc1$
    PUT 639-1,0,sc2$
    GOSUB zeige_bild
  ENDIF
  IF taste=97               !Undo Taste
    GOSUB auto1
    SWAP l$,g$
    SPUT l$
    g$=z$
    GOSUB zeige_bild
  ENDIF
  IF taste=98               !Help
    ALERT 3," --- Bild oder Block --- |     - speichern  ?|     - ausdrucken ?|     - einladen   ?",1,"Saven|Drucken|Laden",alti%
    SDPOKE &H4EE,1
    IF alti%=1
      ALERT 3," Bild Abspeichern ? | Block abspeichern ? ",3," Bild | Block |ZurÅck",lad
      ' **** Doodle ****
      IF lad=1
        CLOSE #1
        GOSUB datei_erfragen("*.DOO")
        IF EXIST(f$)=TRUE
          ALERT 3,"Bild mit diesem Namen|schon vorhanden.|Soll altes Bild|Åberschrieben werden.",2,"Ja|Nein",d%
        ENDIF
        IF d%=2
          GOTO hildegard9
        ENDIF
        IF d%=1 OR f$<>""
          IF oremi%=FALSE AND schreibe%=FALSE
            @saven
            PRINT #1,"'**********  Bild laden **********"
          ENDIF
          IF schreibe%=FALSE
            @saven
            PRINT #1,"BLOAD ";CHR$(34);f$;CHR$(34);",XBIOS(2)"
          ENDIF
          HIDEM
          IF DFREE(0)<33000
            ALERT 3,"Diskette ist voll|Bitte Leere Diskette|einlegen",1,"ZurÅck",d%
          ELSE
            BSAVE f$+".DOO",XBIOS(2),32000
          ENDIF
        ENDIF
      ENDIF
      ' **** Block speichern ****
      IF lad=2
        CLOSE #1
        ALERT FALSE,"Bitte markieren Sie mit|der Maus den Bereich den|Sie speichern mîchten.",1,"  OK  ",d%
        PUT FALSE,FALSE,boxbild$,modus%
        GOSUB hilfs_maus
        WHILE MOUSEK=FALSE
          x%=MOUSEX
          y%=MOUSEY
          BOX a%,b%,x%,y%
          VSYNC
          PAUSE 3
          BOX a%,b%,x%,y%
        WEND
        WHILE MOUSEK=1
          GRAPHMODE graf%
          GET a%,b%,x%,y%,box$
          GOSUB datei_erfragen("*.BLO")
          IF EXIST(f$)=TRUE
            ALERT 3,"Bild mit diesem Namen|schon vorhanden.|Soll altes Bild|Åberschrieben werden.",2,"Ja|Nein",d%
          ENDIF
          IF f$>""
            OPEN "O",#1,f$
            PRINT #1,MKI$(LEN(box$));box$
            CLOSE #1
          ENDIF
        WEND
        IF d%=2
          GOTO hildegard9
        ENDIF
      ENDIF
      hildegard9:
    ENDIF
    IF alti%=2
      GOSUB drucken
    ENDIF
    IF alti%=3
      joki=FALSE
      ALERT 3,"   Bild oder Block  |     einladen ?",3,"Bild|Block|ZurÅck",d%
      IF d%=1
        ALERT 3," --- Bild einladen ---| |  Doodle    ?|  Sonst ein Bild   ?",3,"Doodle|Sonstwas|ZurÅck",jokert%
        IF jokert%=1
          GOSUB datei_erfragen("*.DOO")
          IF EXIST(f$)=0
            ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
            GOTO jkarschloch9
          ENDIF
          GOSUB radio5(f$)
        ENDIF
        IF jokert%=2
          GOSUB datei_erfragen("*.*")
          IF f$<>""
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO jkarschloch9
            ENDIF
            OPEN "I",#1,f$
            lang_was=LOF(#1)
            IF lang_was>33000
              GOTO jkarschloch9
            ENDIF
            IF lang_was=>32000
              deppenhausen=jkarschloch9-32000
              SEEK #1,deppenhausen+1
            ENDIF
            GOSUB radio5(f$)
            joki=1
          ENDIF
        ENDIF
        IF jokert%=3 OR joki=1
          GOTO jkarschloch9
        ENDIF
      ENDIF
      ' ***** Block laden *****
      IF d%=2
        ALERT 3,"   Block Setzen   ?   |   Block Zeichnen ?   ",3,"Setzen|Zeichnen|ZurÅck",d1%
        IF d1%=2
          GOSUB datei_erfragen("*.BLO")
          IF f$<>""
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO jkarschloch9
            ENDIF
            OPEN "I",#1,f$
            block$=INPUT$(CVI(INPUT$(2,#1)),#1)
            CLOSE #1
            REPEAT
              WHILE MOUSEK=FALSE
              WEND
              WHILE MOUSEK=1
                HIDEM
                PUT MOUSEX,MOUSEY,block$,modus%
              WEND
            UNTIL MOUSEK=2
          ENDIF
        ENDIF
        IF d1%=1
          let_mi_bi=FALSE
          GOSUB datei_erfragen("*.BLO")
          IF f$<>""
            IF EXIST(f$)=0
              ALERT 3,"Datei nicht vorhanden",1,"Sorry",d%
              GOTO jkarschloch9
            ENDIF
            OPEN "I",#1,f$
            block$=INPUT$(CVI(INPUT$(2,#1)),#1)
            CLOSE #1
            REPEAT
              WHILE MOUSEK=1
                HIDEM
                PUT MOUSEX,MOUSEY,block$,modus%
                let_mi_bi=1
              WEND
            UNTIL let_mi_bi=1
          ENDIF
        ENDIF
      ENDIF
      jkarschloch9:
    ENDIF
  ENDIF
  x%=MOUSEX
  y%=MOUSEY
  MENU menue1$()
  DEFMOUSE 3
RETURN
PROCEDURE himmel3
  DEFMOUSE 3
  CLR d4%
  MENU KILL
  MENU OFF
  ERASE menue1$()
  IF DPEEK(LPEEK(&H4F2)+2)<>&H100         !anderes TOS
    DIM menue1$(30)
    RESTORE oo3b
    REPEAT
      READ menue1$(d4%)
      INC d4%
    UNTIL d4%=30
  ENDIF
  IF DPEEK(LPEEK(&H4F2)+2)=&H100          !Tos 1.0
    DIM menue1$(32)
    RESTORE oo3
    REPEAT
      READ menue1$(d4%)
      INC d4%
    UNTIL d4%=32
  ENDIF
  MENU menue1$()
  ON MENU  GOSUB auswerten3
  ON MENU KEY GOSUB tastatur
  REPEAT
    ON MENU
  UNTIL void
RETURN
PROCEDURE himmel2
  DEFMOUSE 3
  CLR d3%
  MENU KILL
  MENU OFF
  ERASE menue1$()
  DIM menue1$(74)
  RESTORE oo2
  REPEAT
    READ menue1$(d3%)
    INC d3%
  UNTIL d3%=74
  MENU menue1$()
  ON MENU  GOSUB auswerten2
  ON MENU KEY GOSUB tastatur
  REPEAT
    ON MENU
  UNTIL void
RETURN
PROCEDURE himmel4
  DEFMOUSE 3
  CLR d5%
  MENU KILL
  MENU OFF
  ERASE menue1$()
  DIM menue1$(63)
  RESTORE oo4
  REPEAT
    READ menue1$(d5%)
    INC d5%
  UNTIL d5%=63
  MENU menue1$()
  ON MENU  GOSUB auswerten4
  ON MENU KEY GOSUB tastatur
  REPEAT
    ON MENU
  UNTIL void
RETURN
PROCEDURE vektor_schrift
  LOCAL x,y,h,l$,z$,b,spac$,txt$,bu
  SPUT l$
  CLS
  HIDEM
  DEFFILL 1,2,8
  PRBOX 100,75,540,262
  DEFFILL 1,2,3
  PRBOX 110,105,530,232
  DEFTEXT 1,FALSE,3,16
  TEXT 230,97,"Vektor - Schrift"
  FOR x=7 TO 13
    PRINT AT(16,x+1);SPACE$(50)
  NEXT x
  PRINT AT(16,8);
  PRINT "  Hîhe der Buchstaben   (1-20)       ";
  FORM INPUT 2,h$
  h=VAL(h$)
  PRINT AT(16,10);
  PRINT "  Breite der Buchstaben (1-20)       ";
  FORM INPUT 2,b$
  b=VAL(b$)
  PRINT AT(16,12);
  PRINT "  Spacing               (0-20)       ";
  FORM INPUT 2,spac$
  spac=VAL(spac$)
  CLS
  PRINT "Text              (max 255 Zeichen) "
  FORM INPUT 46,txt$
  SPUT l$
  GOSUB merge_bild
  REPEAT
    SHOWM
    x=MOUSEX
    y=MOUSEY
    IF MOUSEK=1
      FOR bu=1 TO LEN(txt$)
        a$=MID$(txt$,bu,1)
        IF a$=" "
          ADD x,3*b
        ENDIF
        IF a$="A"
          DRAW x,y+6*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+6*h
          DRAW x,y+3*h TO x+4*b,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="B"
          DRAW x,y+6*h TO x,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x,y+3*h
          DRAW x,y+6*h TO x+3*b,y+6*h TO x+4*b,y+5*h TO x+4*b,y+4*h TO x+3*b,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="C"
          DRAW x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h
          ADD x,4*b
        ENDIF
        IF a$="D"
          DRAW x,y+6*h TO x,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="E"
          DRAW x+4*b,y TO x,y TO x,y+6*h TO x+4*b,y+6*h
          DRAW x,y+3*h TO x+3*b,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="F"
          DRAW x+4*b,y TO x,y TO x,y+6*h
          DRAW x,y+3*h TO x+3*b,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="G"
          DRAW x,y+3*h TO x+4*b,y+3*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h
          ADD x,4*b
        ENDIF
        IF a$="H"
          DRAW x,y TO x,y+6*h
          DRAW x+4*b,y TO x+4*b,y+6*h
          DRAW x,y+3*h TO x+4*b,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="I"
          DRAW x,y TO x+2*b,y
          DRAW x,y+6*h TO x+2*b,y+6*h
          DRAW x+b,y TO x+b,y+6*h
          ADD x,2*b
        ENDIF
        IF a$="J"
          DRAW x,y TO x+4*b,y TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+4*h
          ADD x,4*b
        ENDIF
        IF a$="K"
          DRAW x,y TO x,y+6*h
          DRAW x,y+3*h TO x+4*b,y
          DRAW x,y+3*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="L"
          DRAW x,y TO x,y+6*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="M"
          DRAW x,y+6*h TO x,y TO x+2*b,y+3*h TO x+4*b,y TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="N"
          DRAW x,y+6*h TO x,y TO x+4*b,y+6*h TO x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="O"
          DRAW x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          ADD x,4*b
        ENDIF
        IF a$="P"
          DRAW x,y+6*h TO x,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x,y+3*h
          ADD x,4*b
        ENDIF
        IF a$="Q"
          DRAW x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+4*h TO x+2*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          DRAW x+2*b,y+4*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="R"
          DRAW x,y+6*h TO x,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x,y+3*h
          DRAW x+b,y+3*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="S"
          DRAW x,y+5*h TO x+b,y+6*h TO x+3*b,y+6*h TO x+4*b,y+5*h TO x+4*b,y+4*h TO x+3*b,y+3*h TO x+b,y+3*h TO x,y+2*h TO x,y+h TO x+1*b,y+0*h TO x+3*b,y+FALSE*h TO x+4*b,y+1*h
          ADD x,4*b
        ENDIF
        IF a$="T"
          DRAW x,y TO x+4*b,y
          DRAW x+2*b,y TO x+2*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="U"
          DRAW x,y TO x,y+5*h TO x+b,y+6*h TO x+3*b,y+6*h TO x+4*b,y+5*h TO x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="V"
          DRAW x,y TO x,y+3*h TO x+2*b,y+6*h TO x+4*b,y+3*h TO x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="W"
          DRAW x,y TO x,y+3*h TO x+b,y+6*h TO x+2*b,y+3*h TO x+3*b,y+6*h TO x+4*b,y+3*h TO x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="X"
          DRAW x,y TO x+4*b,y+6*h
          DRAW x+4*b,y TO x,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="Y"
          DRAW x,y TO x+2*b,y+3*h TO x+4*b,y
          DRAW x+2*b,y+3*h TO x+2*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="Z"
          DRAW x,y TO x+4*b,y TO x,y+6*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="1"
          DRAW x,y+3*h TO x+3*b,y TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="2"
          DRAW x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x+b,y+3*h TO x,y+4*h TO x,y+6*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="3"
          DRAW x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x+b,y+3*h
          DRAW x+3*b,y+3*h TO x+4*b,y+4*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          ADD x,4*b
        ENDIF
        IF a$="4"
          DRAW x+b,y TO x,y+3*h TO x+4*b,y+3*h
          DRAW x+2*b,y+h TO x+2*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="5"
          DRAW x+4*b,y TO x,y TO x,y+3*h TO x+3*b,y+3*h TO x+4*b,y+4*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          ADD x,4*b
        ENDIF
        IF a$="6"
          DRAW x,y+4*h TO x+b,y+3*h TO x+3*b,y+3*h TO x+4*b,y+4*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h
          ADD x,4*b
        ENDIF
        IF a$="7"
          DRAW x,y TO x+4*b,y TO x+4*b,y+h TO x,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="8"
          DRAW x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+2*h TO x+3*b,y+3*h TO x+b,y+3*h
          DRAW x+3*b,y+3*h TO x+4*b,y+4*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+4*h TO x+b,y+3*h TO x,y+2*h TO x,y+h
          ADD x,4*b
        ENDIF
        IF a$="9"
          DRAW x+4*b,y TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          DRAW x+4*b,y+h TO x+3*b,y TO x+b,y TO x,y+h TO x,y+2*h TO x+b,y+3*h TO x+3*b,y+3*h TO x+4*b,y+2*h
          ADD x,4*b
        ENDIF
        IF a$="0"
          DRAW x,y+5*h TO x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x+4*b,y+h
          ADD x,4*b
        ENDIF
        IF a$="a"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          DRAW x+3*b,y+2*h TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="b"
          DRAW x,y+3*h TO x+b,y+2*h TO x+2*b,y+2*h TO x+3*b,y+3*h TO x+3*b,y+5*h TO x+2*b,y+6*h TO x+b,y+6*h TO x,y+5*h
          DRAW x,y TO x,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="c"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          ADD x,3*b
        ENDIF
        IF a$="d"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          DRAW x+3*b,y TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="e"
          DRAW x,y+4*h TO x+3*b,y+4*h TO x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          ADD x,3*b
        ENDIF
        IF a$="f"
          DRAW x+b,y+6*h TO x+b,y+h TO x+2*b,y TO x+3*b,y
          DRAW x,y+3*h TO x+2*b,y+3*h
          ADD x,3*b
        ENDIF
        IF a$="g"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          DRAW x+3*b,y+2*h TO x+3*b,y+6*h TO x+2*b,y+7*h TO x,y+7*h
          ADD x,3*b
        ENDIF
        IF a$="h"
          DRAW x,y TO x,y+6*h
          DRAW x,y+3*h TO x+b,y+2*h TO x+2*b,y+2*h TO x+3*h,y+3*b TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="i"
          DRAW x,y
          DRAW x,y+2*h TO x,y+6*h
        ENDIF
        IF a$="j"
          DRAW x+3*b,y
          DRAW x+3*b,y+2*h TO x+3*b,y+6*h TO x+2*b,y+7*h TO x+b,y+7*h TO x,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="k"
          DRAW x,y TO x,y+6*h
          DRAW x+3*b,y+2*h TO x,y+4*h TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="l"
          DRAW x,y TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h
          ADD x,2*b
        ENDIF
        IF a$="m"
          DRAW x,y+2*h TO x,y+6*h
          DRAW x,y+3*h TO x+0.5*b,y+2*h TO x+1.5*b,y+2*h TO x+2*b,y+3*h TO x+2*b,y+6*h
          DRAW x+2*b,y+3*h TO x+2.5*b,y+2*h TO x+3.5*h,y+2*h TO x+4*h,y+3*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="n"
          DRAW x,y+2*h TO x,y+6*h
          DRAW x,y+3*h TO x+b,y+2*h TO x+2*b,y+2*h TO x+3*b,y+3*h TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="o"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h TO x+3*b,y+3*h
          ADD x,3*b
        ENDIF
        IF a$="p"
          DRAW x,y+7*h TO x,y+2*h TO x+2*b,y+2*h TO x+3*b,y+3*h TO x+3*b,y+5*h TO x+2*b,y+6*h TO x,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="q"
          DRAW x+3*b,y+7*h TO x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          ADD x,3*b
        ENDIF
        IF a$="r"
          DRAW x,y+2*h TO x,y+6*h
          DRAW x,y+3*h TO x+b,y+2*h TO x+2*b,y+2*h TO x+3*b,y+3*h
          ADD x,3*b
        ENDIF
        IF a$="s"
          DRAW x,y+5.5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5.5*h TO x+3*b,y+4.5*h TO x+2*b,y+4*h TO x+b,y+4*h TO x,y+3.5*h TO x,y+2.5*h TO x+b,y+2*h TO x+2*b,y+2*h TO x+3*b,y+2.5*h
          ADD x,3*b
        ENDIF
        IF a$="t"
          DRAW x+b,y+0.5*h TO x+b,y+5*h TO x+2*b,y+6*h TO x+3*b,y+6*h
          DRAW x,y+3*h TO x+3*b,y+3*h
          ADD x,3*b
        ENDIF
        IF a$="u"
          DRAW x,y+2*h TO x,y+5*h TO x+b,y+6*h TO x+3*b,y+6*h TO x+3*b,y+2*h
          ADD x,3*b
        ENDIF
        IF a$="v"
          DRAW x,y+2*h TO x,y+4*h TO x+1.5*b,y+6*h TO x+3*b,y+4*h TO x+3*b,y+2*h
          ADD x,3*b
        ENDIF
        IF a$="w"
          DRAW x,y+2*h TO x+b,y+6*h TO x+2*b,y+3*h TO x+3*b,y+6*h TO x+4*b,y+2*h
          ADD x,4*b
        ENDIF
        IF a$="x"
          DRAW x,y+2*h TO x+3*b,y+6*h
          DRAW x+3*b,y+2*h TO x,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="y"
          DRAW x+3*b,y+2*h TO x+3*b,y+6*h TO x+2*b,y+7*h TO x,y+7*h
          DRAW x,y+2*h TO x,y+4*h TO x+b,y+5*h TO x+3*b,y+5*h
          ADD x,3*b
        ENDIF
        IF a$="z"
          DRAW x,y+2*h TO x+3*b,y+2*h TO x,y+6*h TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="û"
          DRAW x,y+6*h TO x,y+h TO x+b,y TO x+2*b,y TO x+3*b,y+h TO x+3*b,y+2*h TO x+2*b,y+3*h
          DRAW x+b,y+3*h TO x+3*b,y+3*h TO x+4*b,y+4*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="é"
          DRAW x,y+6*h TO x,y+2*h TO x+b,y+h TO x+3*b,y+h TO x+4*b,y+2*h TO x+4*b,y+6*h
          DRAW x,y+4*h TO x+4*b,y+4*h
          DRAW x,y
          DRAW x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="ô"
          DRAW x,y+2*h TO x+b,y+h TO x+3*b,y+h TO x+4*b,y+2*h TO x+4*b,y+5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5*h TO x,y+2*h
          DRAW x,y
          DRAW x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="ö"
          DRAW x,y+h TO x,y+5*h TO x+b,y+6*h TO x+3*b,y+6*h TO x+4*b,y+5*h TO x+4*b,y+h
          DRAW x,y
          DRAW x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="Ñ"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h
          DRAW x+3*b,y+2*h TO x+3*b,y+6*h
          DRAW x,y
          DRAW x+3*b,y
          ADD x,3*b
        ENDIF
        IF a$="î"
          DRAW x+3*b,y+3*h TO x+2*b,y+2*h TO x+b,y+2*h TO x,y+3*h TO x,y+5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+3*b,y+5*h TO x+3*b,y+3*h
          DRAW x,y
          DRAW x+3*b,y
          ADD x,3*b
        ENDIF
        IF a$="Å"
          DRAW x,y+2*h TO x,y+5*h TO x+b,y+6*h TO x+3*b,y+6*h TO x+3*b,y+2*h
          DRAW x,y
          DRAW x+3*b,y
          ADD x,3*b
        ENDIF
        IF a$="!"
          DRAW x,y TO x,y+5*h
          DRAW x,y+6*h
        ENDIF
        IF a$=CHR$(34)
          DRAW x,y+2*h TO x+b,y
          DRAW x+2*b,y+2*h TO x+3*b,y
          ADD x,3*b
        ENDIF
        IF a$="›"
          DRAW x+4*b,y+0.5*h TO x+3*b,y TO x+b,y TO x,y+0.5*h TO x,y+1.5*h TO x+b,y+2*h TO x+3*b,y+2*h TO x+4*b,y+2.5*h TO x+4*b,y+3.5*h TO x+3*b,y+4*h
          DRAW x+b,y+2*h TO x,y+2.5*h TO x,y+3.5*h TO x+b,y+4*h TO x+3*b,y+4*h TO x+4*b,y+4.5*h TO x+4*b,y+5.5*h TO x+3*b,y+6*h TO x+b,y+6*h TO x,y+5.5*h
          ADD x,4*b
        ENDIF
        IF a$="$"
          DRAW x+4*b,y+1.5*h TO x+3*b,y+h TO x+b,y+h TO x,y+1.5*h TO x,y+2.5*h TO x+b,y+3*h TO x+3*b,y+3*h TO x+4*b,y+3.5*h TO x+4*b,y+4.5*h
          DRAW x+4*b,y+4.5*h TO x+3*b,y+5*h TO x+b,y+5*h TO x,y+4.5*h
          DRAW x+b,y TO x+b,y+6*h
          DRAW x+3*b,y TO x+3*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="%"
          DRAW x+0.5*b,y TO x+1.5*b,y TO x+2*b,y+0.5*h TO x+2*b,y+1.5*h TO x+1.5*b,y+2*h TO x+0.5*b,y+2*h TO x,y+1.5*h TO x,y+0.5*h TO x+0.5*b,y
          DRAW x+2.5*b,y+4*h TO x+3.5*b,y+4*h TO x+4*b,y+4.5*h TO x+4*b,y+5.5*h TO x+3.5*b,y+6*h TO x+2.5*b,y+6*h TO x+2*b,y+5.5*h TO x+2*b,y+4.5*h TO x+2.5*b,y+4*h
          DRAW x,y+6*h TO x+4*b,y
          ADD x,4*b
        ENDIF
        IF a$="&"
          DRAW x+4*b,y+6*h TO x,y+2*h TO x,y+h TO x+b,y TO x+2*b,y TO x+3*b,y+h TO x+3*b,y+2*h TO x,y+5*h TO x,y+5.5*h TO x+b,y+6*h TO x+2*b,y+6*h TO x+4*b,y+4*h
          ADD x,4*b
        ENDIF
        IF a$="/"
          DRAW x,y+6*h TO x+3*b,y
          ADD x,3*b
        ENDIF
        IF a$="("
          DRAW x+b,y TO x,y+2*h TO x,y+4*h TO x+b,y+6*h
          ADD x,b
        ENDIF
        IF a$=")"
          DRAW x,y TO x+b,y+2*h TO x+b,y+4*h TO x,y+6*h
          ADD x,b
        ENDIF
        IF a$="="
          DRAW x,y+2*h TO x+3*b,y+2*h
          DRAW x,y+4*h TO x+3*b,y+4*h
          ADD x,3*b
        ENDIF
        IF a$="?"
          DRAW x,y+h TO x+b,y TO x+3*b,y TO x+4*b,y+h TO x+4*b,y+3*h TO x+2*b,y+4*h TO x+2*b,y+5*h
          DRAW x+2*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="'"
          DRAW x,y TO x,y+2*h
          ADD x,b
        ENDIF
        IF a$="`"
          DRAW x,y TO x+b,y+2*h
          ADD x,b
        ENDIF
        IF a$="^"
          DRAW x,y+2*h TO x+2*b,y TO x+4*b,y+2*h
          ADD x,4*b
        ENDIF
        IF a$="#"
          DRAW x+b,y+h TO x+b,y+5*h
          DRAW x+3*b,y+h TO x+3*b,y+5*h
          DRAW x,y+2*h TO x+4*b,y+2*h
          DRAW x,y+4*h TO x+4*b,y+4*h
          ADD x,4*b
        ENDIF
        IF a$=","
          DRAW x+b,y+4*h TO x+b,y+6*h TO x,y+7*h
          ADD x,b
        ENDIF
        IF a$="."
          DRAW x,y+6*h
        ENDIF
        IF a$=";"
          DRAW x+b,y+4*h TO x+b,y+6*h TO x,y+7*h
          DRAW x+b,y+3*h
          ADD x,b
        ENDIF
        IF a$=":"
          DRAW x,y+h
          DRAW x,y+5*h
        ENDIF
        IF a$="-"
          DRAW x,y+3*h TO x+3*b,y+3*h
          ADD x,3*b
        ENDIF
        IF a$="_"
          DRAW x,y+6*h TO x+4*b,y+6*h
          ADD x,4*b
        ENDIF
        IF a$="+"
          DRAW x,y+3*h TO x+4*b,y+3*h
          DRAW x+2*b,y+h TO x+2*b,y+5*h
          ADD x,4*b
        ENDIF
        IF a$="*"
          DRAW x,y+3*h TO x+4*b,y+3*h
          DRAW x+2*b,y+h TO x+2*b,y+5*h
          DRAW x+0.5*b,y+1.5*h TO x+3.5*b,y+4.5*h
          DRAW x+3.5*b,y+1.5*h TO x+0.5*b,y+4.5*h
          ADD x,4*b
        ENDIF
        IF a$="@"
          DRAW x+2.5*b,y+3.5*h TO x+2.5*b,y+2.5*h TO x+2*b,y+2*h TO x+b,y+2*h TO x+0.5*b,y+2.5*h TO x+0.5*b,y+3.5*h TO x+b,y+4*h TO x+2*b,y+4*h TO x+2.5*b,y+3.5*h TO x+3*b,y+4*h
          DRAW x+3*b,y+4*h TO x+3.5*b,y+4*h TO x+4*b,y+3.5*h TO x+4*b,y+2*h TO x+3*b,y+h TO x+b,y+h TO x,y+2*h TO x,y+4*h TO x+b,y+5*h TO x+3*b,y+5*h TO x+3.5*b,y+4.5*h
          ADD x,4*b
        ENDIF
        IF a$="\"
          DRAW x,y TO x+3*b,y+6*h
          ADD x,3*b
        ENDIF
        IF a$="["
          DRAW x+b,y TO x,y TO x,y+6*h TO x+b,y+6*h
          ADD x,b
        ENDIF
        IF a$="]"
          DRAW x,y TO x+b,y TO x+b,y+6*h TO x,y+6*h
          ADD x,b
        ENDIF
        IF a$="{"
          DRAW x+b,y TO x+0.5*b,y+0.5*h TO x+0.5*b,y+2.5*h TO x,y+3*h TO x+0.5*b,y+3.5*h TO x+0.5*b,y+5.5*h TO x+b,y+6*h
          ADD x,b
        ENDIF
        IF a$="}"
          DRAW x,y TO x+0.5*b,y+0.5*h TO x+0.5*b,y+2.5*h TO x+b,y+3*h TO x+0.5*b,y+3.5*h TO x+0.5*b,y+5.5*h TO x,y+6*h
          ADD x,b
        ENDIF
        IF a$="~"
          DRAW x,y+3.5*h TO x+0.5*b,y+2.5*h TO x+1.5*b,y+2.5*h TO x+2.5*b,y+3.5*h TO x+3.5*b,y+3.5*h TO x+4*b,y+2.5*h
          ADD x,4*b
        ENDIF
        IF a$="|"
          DRAW x,y TO x,y+2.5*h
          DRAW x,y+3.5*h TO x,y+6*h
        ENDIF
        IF a$="<"
          DRAW x+2*b,y+h TO x,y+3*h TO x+2*h,y+5*b
          ADD x,2*b
        ENDIF
        IF a$=">"
          DRAW x,y+h TO x+2*b,y+3*h TO x,y+5*h
          ADD x,2*b
        ENDIF
        ADD x,spac+1
      NEXT bu
    ENDIF
    IF INKEY$>CHR$(FALSE)
      GOSUB merge_bild
      CLR inkey$
    ENDIF
  UNTIL MOUSEK=2
RETURN
PROCEDURE auswerten4
  REPEAT
  UNTIL MOUSEK=0
  starter_4:
  ON ERROR GOSUB fehlerio4
  SDPOKE &H4EE,1
  MENU KILL
  MENU OFF
  LOCAL d5%,ld3$
  ld4$=menue1$(MENU(FALSE))
  GOSUB merge_bild
  GOSUB auto1
  GOSUB grund
  IF ld4$=" Bezier-Kurven "
    GOSUB bezier
  ENDIF
  IF ld4$=" Bezier  Modus "
    GOSUB bezier_modus
  ENDIF
  IF ld4$=" Monitor aus/an "
    VSYNC
    SPOKE &HFF820A,PEEK(&HFF820A) OR 1
    REPEAT
    UNTIL MOUSEK>0 OR INKEY$=>CHR$(0)
    SPOKE &HFF820A,PEEK(&HFF820A) AND NOT 1
  ENDIF
  IF ld4$=" Bild Manipulator "
    GOSUB bild_manipulator
  ENDIF
  IF ld4$=" Spiegel Modus "
    s_modus_1%=1
    GOSUB hals
    OPENW 0
    DEFFILL ,1,1
    PBOX 210,110,434,262
    DEFFILL ,2,4
    PBOX 200,100,424,252
    DEFFILL ,1,1
    PBOX 244,116,384,204
    PBOX 244,218,304,240
    PBOX 324,218,384,240
    DEFFILL ,0,0
    PBOX 240,112,380,132
    PBOX 240,134,380,154
    PBOX 240,156,380,176
    PBOX 240,178,380,198
    PBOX 240,214,300,236
    PBOX 320,214,380,236
    BOX 241,215,299,235
    BOX 321,215,379,235
    DEFTEXT 1,4,900,13
    GRAPHMODE 1
    DEFTEXT 1,4,0,13
    TEXT 250,129,"  Horizontal "
    TEXT 250,151,"   Vertikal  "
    TEXT 250,173,"     Alle    "
    TEXT 250,195,"     Quer    "
    DEFTEXT 1,0,0,13
    TEXT 247,231,"  Ok "
    TEXT 335,231," Aus"
    GET 241,110+s_modus_1%*22,379,128+s_modus_1%*22,dummy$
    PUT 241,110+s_modus_1%*22,dummy$,12
    dummy%=s_modus_1%
    DO
      REPEAT
        MOUSE x%,y%,k%
        IF INKEY$=CHR$(13)
          GOTO lrtq11
        ENDIF
      UNTIL k%
      IF x%>240 AND x%<390 AND y%>112 AND y%<198 AND s_modus_1%<>1+INT((y%-112)/22)
        GET 241,110+s_modus_1%*22,379,128+s_modus_1%*22,dummy$
        PUT 241,110+s_modus_1%*22,dummy$,12
        s_modus_1%=1+INT((y%-112)/22)
        GET 241,110+s_modus_1%*22,379,128+s_modus_1%*22,dummy$
        PUT 241,110+s_modus_1%*22,dummy$,12
      ENDIF
      IF x%>320 AND x%<380 AND y%>214 AND y%<236
        s_modus_1%=0
        x%=260
      ENDIF
      EXIT IF x%>240 AND x%<300 AND y%>214 AND y%<236 OR MOUSEK=2
    LOOP
    lrtq11:
    CLOSEW 0
    GOSUB clipping_an
    GOSUB merge_bild
  ENDIF
  IF ld4$=" Spiegel 2 "
    GOSUB merge_bild
    GOSUB spiegel_2
  ENDIF
  IF ld4$=" KF-Vieleck "
    GOSUB merge_bild
    @lang_vieleck
  ENDIF
  IF ld4$=" SZL-Linie "
    GOSUB merge_bild
    GOSUB lang_linie
  ENDIF
  IF ld4$=" Stern "
    GOSUB merge_bild
    GOSUB lang_stern
  ENDIF
  IF ld4$=" Prisma "
    GOSUB merge_bild
    GOSUB lang_prisma
  ENDIF
  IF ld4$=" Pyramide "
    GOSUB merge_bild
    GOSUB lang_pyramide
  ENDIF
  IF ld4$=" Kreisausschnitt"
    GOSUB merge_bild
    GOSUB lang_kreisausschnitt
  ENDIF
  IF ld4$=" Kreis-Ellips "
    GOSUB merge_bild
    GOSUB lang_kreis_ellips
  ENDIF
  IF ld4$=" 5 Eck "
    GOSUB merge_bild
    GOSUB lang_5_eck
  ENDIF
  IF ld4$=" 3 6 Stern "
    GOSUB merge_bild
    GOSUB lang_sechs_drei_stern
  ENDIF
  IF ld4$=" 3-4 Eck "
    GOSUB merge_bild
    GOSUB lang_3_4_eck
  ENDIF
  IF ld4$=" Copyright "
    GOSUB infol
  ENDIF
  IF ld4$=" MenÅ 1     "
    GOSUB himmel1
  ENDIF
  IF ld4$=" MenÅ 2 "
    GOSUB himmel2
  ENDIF
  IF ld4$=" MenÅ 3 "
    GOSUB himmel3
  ENDIF
  IF ld4$=" Stiftgrîûe "
    CLS
    HIDEM
    PRINT AT(1,1);"X - Koordinate ";
    FORM INPUT 3,xkord$
    xkord%=VAL(xkord$)
    PRINT AT(1,2);"Y - Koordinate ";
    FORM INPUT 3,ykord$
    ykord%=VAL(ykord$)
    GOSUB merge_bild
  ENDIF
  IF ld4$="  Bild Positionieren"
    CLS
    GOSUB hals
    RBOX 210,110,430,290
    RBOX 212,108,432,288
    RBOX 213,107,433,287
    DEFTEXT 1,0,3,8
    TEXT 220,130,"Bild Positionierung"
    BOX 220,135,420,280
    BOX 222,137,418,278
    BOX 223,138,417,277
    DEFTEXT 1,0,3,10
    TEXT 245,170,"nach oben"
    TEXT 245,200,"nach unten"
    TEXT 245,230,"nach links"
    TEXT 245,260,"nach rechts"
    RBOX 220,300,420,350
    RBOX 222,302,418,348
    RBOX 223,303,417,347
    DEFTEXT 1,0,3,8
    TEXT 240,320,"Geschwindigkeit"
    DEFTEXT 1,0,2,10
    TEXT 231,337,"+1"
    BOX 230,325,260,340
    TEXT 270,337,"+10"
    BOX 269,325,310,340
    TEXT 320,337,"-1"
    BOX 319,325,350,340
    BOX 359,325,400,340
    TEXT 360,337,"-10"
    BOX 220,55,420,80
    BOX 222,57,418,78
    BOX 223,58,417,77
    DEFTEXT 1,2,3,8
    TEXT 240,72,"Geschwindigkeit"
    DEFTEXT 1,2,3,20
    TEXT 280,102," "+STR$(tempo)+"              "
    REPEAT
      ' ******** Bild Positionierung *********
      IF MOUSEK=1 AND MOUSEX>223 AND MOUSEX<416
        ' ******* nach oben *******
        WHILE MOUSEY>138 AND MOUSEY<181
          REPEAT
            IF MOUSEK=1
              HIDEM
              GOSUB merge_bild
              GET 0,0,639,tempo,sc2$
              GET 0,1+tempo,639,399,sc1$
              PUT 0,0,sc1$
              PUT 0,399-tempo,sc2$
              GOSUB zeige_bild
            ENDIF
          UNTIL MOUSEK=2
          GOTO raus
        WEND
        ' ***** nach unten *****
        WHILE MOUSEY>181 AND MOUSEY<212
          REPEAT
            IF MOUSEK=1
              HIDEM
              GOSUB merge_bild
              GET 0,0,639,399-tempo,sc1$
              GET 0,399-tempo,639,399,sc2$
              PUT 0,0,sc2$
              PUT 0,1+tempo,sc1$
              GOSUB zeige_bild
            ENDIF
          UNTIL MOUSEK=2
          GOTO raus
        WEND
        ' ***** nach links *****
        WHILE MOUSEY>212 AND MOUSEY<241
          REPEAT
            IF MOUSEK=1
              HIDEM
              GOSUB merge_bild
              GET 0,0,tempo,399,sc2$
              GET 1+tempo,0,639,399,sc1$
              PUT 0,0,sc1$
              PUT 639-tempo,0,sc2$
              GOSUB zeige_bild
            ENDIF
          UNTIL MOUSEK=2
          GOTO raus
        WEND
        ' ***** nach rechts *****
        WHILE MOUSEY>241 AND MOUSEY<276
          REPEAT
            IF MOUSEK=1
              HIDEM
              GOSUB merge_bild
              GET 0,0,639-tempo,399,sc1$
              GET 639-tempo,0,639,399,sc2$
              PUT 0,0,sc2$
              PUT 1+tempo,0,sc1$
              GOSUB zeige_bild
            ENDIF
          UNTIL MOUSEK=2
          GOTO raus
        WEND
      ENDIF
      ' ********* Geschwindigkeit *******
      IF MOUSEK=1 AND MOUSEY>325 AND MOUSEY<340
        ' ***** +1 *****
        IF MOUSEX>230 AND MOUSEX<260
          INC tempo
          TEXT 280,102," "+STR$(tempo)+"              "
        ENDIF
        ' ***** +10 *****
        IF MOUSEX>270 AND MOUSEX<310
          ADD tempo,10
          TEXT 280,102," "+STR$(tempo)+"              "
        ENDIF
        ' ***** -1 *****
        IF MOUSEX>320 AND MOUSEX<350
          DEC tempo
          TEXT 280,102," "+STR$(tempo)+"              "
        ENDIF
        ' ***** -10 *****
        IF MOUSEX>360 AND MOUSEX<400
          SUB tempo,10
          TEXT 280,102," "+STR$(tempo)+"              "
        ENDIF
      ENDIF
    UNTIL MOUSEK=2
    GOSUB was1
    raus:
  ENDIF
  IF ld4$="  Draw 2 "
    REPEAT
      MOUSE x%,y%,k%
      IF k%=1
        HIDEM
        x11%=x%
        y11%=y%
        REPEAT
          DRAW x%,y% TO x%+xkord%,y%+ykord%
          x11%=x%
          y11%=y%
          MOUSE x%,y%,k%
        UNTIL k%=0
      ENDIF
      SHOWM
    UNTIL k%=2
  ENDIF
  IF ld4$=" Spezial 1 "
    REPEAT
      MOUSE x%,y%,k%
      IF k%=1
        HIDEM
        x11%=x%
        y11%=y%
        REPEAT
          DRAW x%,y% TO x11%+xkord%,y11%+ykord%
          y11%=y%
          MOUSE x%,y%,k%
        UNTIL k%=0
      ENDIF
      SHOWM
    UNTIL k%=2
  ENDIF
  IF ld4$=" Spezial 2 "
    REPEAT
      MOUSE x%,y%,k%
      IF k%=1
        HIDEM
        x11%=x%
        y11%=y%
        REPEAT
          DRAW x%,y% TO x11%+xkord%,y11%+ykord%
          x11%=x%
          MOUSE x%,y%,k%
        UNTIL k%=0
      ENDIF
      SHOWM
    UNTIL k%=2
  ENDIF
  IF ld4$="  Zeichen  -  Lupe "
    GOSUB clipping_aus
    GOSUB lupe3
    COLOR 1
    GRAPHMODE 1
    GOSUB clipping_an
  ENDIF
  IF ld4$=" Bild 1 "
    bild1%=1
    GOSUB merge_bild
  ENDIF
  IF ld4$=" Kontrast verstÑrken "
    CLR y%
    REPEAT
      GET -1,y%+1,639,y%+1,nachf$
      PUT y%,0,nachf$,6
      INC y%
    UNTIL y%=399
    GET 0,0,639,399,u$
    CLR x%
    REPEAT
      GET x%+1,0,x%+1,399,nachf$
      PUT x%,0,nachf$,6
      INC x%
    UNTIL x%=639
    PUT 0,0,u$,7
  ENDIF
  IF ld4$=" Bild 2 "
    bild1%=2
    GOSUB merge_bild
  ENDIF
  IF ld4$=" Bild 3 "
    bild1%=3
    GOSUB merge_bild
  ENDIF
  IF ld4$=" Bild 4 "
    bild1%=4
    GOSUB merge_bild
  ENDIF
  IF ld4$=" Bild 5 "
    bild1%=5
    GOSUB merge_bild
  ENDIF
  IF ld4$="   Namen Ñndern "
    GOSUB hals
    DEFFILL 1,2,3
    PBOX -1,-1,640,400
    DEFFILL 0,1,2
    PBOX 10,10,630,390
    eohan1:
    PRINT AT(26,3);"Umzubenennende Datei auswÑhlen"
    GOSUB datei_erfragen("*.*")
    IF f$>"" AND RIGHT$(f$)<>"\" AND EXIST(f$)
      PRINT AT(26,3);"  Dateinamen beliebig Ñndern: "
      adglo:
      FOR i%=LEN(f$) DOWNTO 1
        EXIT IF MID$(f$,i%,1)="\"
      NEXT i%
      dummy$=MID$(f$,i%+1)
      FILESELECT "\*.*",dummy$,s.el$
      IF s.el$>"" AND RIGHT$(s.el$)<>"\"
        IF EXIST(s.el$)
          ALERT 3,"Filename existiert bereits !",1,"Nochmal",dummy%
          GOTO adglo
        ENDIF
        NAME f$ AS s.el$
        GOTO eohan1
      ENDIF
    ENDIF
    GOSUB was1
  ENDIF
  DEFMOUSE 3
  g$=z$
  GOSUB zeige_bild
  MENU menue1$()
  ON MENU  GOSUB auswerten4
  ON MENU KEY GOSUB tastatur
RETURN
PROCEDURE merge_bild
  IF bild1%=1
    SPUT z$
  ENDIF
  IF bild1%=2
    SPUT bild2$
  ENDIF
  IF bild1%=3
    SPUT bild3$
  ENDIF
  IF bild1%=4
    SPUT bild4$
  ENDIF
  IF bild1%=5
    SPUT bild5$
  ENDIF
RETURN
PROCEDURE zeige_bild
  IF bild1%=1
    SGET z$
  ENDIF
  IF bild1%=2
    SGET bild2$
  ENDIF
  IF bild1%=3
    SGET bild3$
  ENDIF
  IF bild1%=4
    SGET bild4$
  ENDIF
  IF bild1%=5
    SGET bild5$
  ENDIF
RETURN
PROCEDURE lupe3
  HIDEM
  LOCAL zoom$,row%,kol%,p%,ok%,ok1%,ca%,ca1%,x%,y%,w1x%,w1y%
  GRAPHMODE 3
  BOX x%,y%,x%+79,y%+39
  REPEAT
    MOUSE x%,y%,k%
    IF x%<>w1x% OR y%<>w1y%
      VSYNC
      PAUSE 1
      BOX w1x%,w1y%,w1x%+79,w1y%+39
      BOX x%,y%,x%+79,y%+39
    ENDIF
    w1x%=x%
    w1y%=y%
  UNTIL k%
  SHOWM
  BOX x%,y%,x%+79,y%+39
  IF k%=1
    GET x%,y%,x%+79,y%+39,zoom$
    GRAPHMODE 1
    CLS
    DEFFILL 1,1,0
    PBOX 0,0,7,7
    GET 0,0,7,7,dot$
    DEFFILL 0,0,1
    PBOX 0,0,7,7
    DEFFILL 1,1,8
    DRAW 0,78 TO 639,78
    PUT 10,10,zoom$
    BOX 106,9,170,27
    BOX 106,32,170,50
    DEFTEXT 1,0,3,6
    TEXT 110,21,"Richtig"
    TEXT 114,43,"Falsch"
    brow%=80
    FOR row%=0 TO 39
      bkol%=1
      FOR kol%=0 TO 79
        IF POINT(10+kol%,10+row%)
          PUT bkol%,brow%,dot$
        ENDIF
        ADD bkol%,8
      NEXT kol%
      ADD brow%,8
    NEXT row%
    CLR ok1%
    CLR ca1%
    REPEAT
      MOUSE x%,y%,k%
      @in_ok
      @in_cancel
      @in_zoom
    UNTIL k%=1 AND (ok%=1 OR ca%=1)
    IF ok%=1
      GET 10,10,89,49,zoom$
    ENDIF
    GOSUB merge_bild
    PUT w1x%,w1y%,zoom$
    REPEAT
    UNTIL MOUSEK=0
  ENDIF
  CLR zoom$,row%,kol%,p%,ok%,ok1%,ca%,ca1%
RETURN
PROCEDURE ok_inv
  IF ok1%=1
    GET 106,9,170,27,inv$
    PUT 106,9,inv$,10
  ENDIF
RETURN
PROCEDURE in_zoom
  CLR fl%
  row%=(y%-78)/8
  kol%=x%/8
  IF k%
    SHOWM
    IF k%=1
      p%=1
    ELSE
      CLR p%
    ENDIF
    REPEAT
      DEFFILL p%,p%,0
      IF MOUSEY>80
        PBOX 1+kol%*8,80+row%*8,8+kol%*8+(xkord%*8),87+row%*8+(ykord%*8)
        COLOR p%
        DRAW 10+kol%,10+row% TO 10+kol%+xkord%,10+row%+ykord%
        REPEAT
          MOUSE x%,y%,k%
          row1%=(y%-78)/8
          kol1%=x%/8
        UNTIL row%<>row1% OR kol%<>kol1% OR k%=0 OR y%<79
        row%=row1%
        kol%=kol1%
      ENDIF
    UNTIL k%=0 OR y%<79
  ENDIF
RETURN
PROCEDURE in_ok
  IF x%>106 AND x%<170 AND y%>9 AND y%<27
    ok%=1
  ELSE
    CLR ok%
  ENDIF
  IF ok%<>ok1%
    @ok_inv
    ok1%=ok%
    @ok_inv
  ENDIF
RETURN
PROCEDURE ca_inv
  IF ca1%=1
    GET 106,32,170,50,inv$
    PUT 106,32,inv$,10
  ENDIF
RETURN
PROCEDURE in_cancel
  IF x%>106 AND x%<170 AND y%>32 AND y%<50
    ca%=1
  ELSE
    CLR ca%
  ENDIF
  IF ca%<>ca1%
    @ca_inv
    ca1%=ca%
    @ca_inv
  ENDIF
RETURN
oo4:
DATA    , Copyright ,------------------------------,1,2,3,4,5,6,""
DATA  Datei ,   Namen Ñndern ,""
DATA  Arbeit  ,  Draw 2 ,-----------------, Spezial 1 , Spezial 2 ,-----------------, 3-4 Eck , 3 6 Stern , 5 Eck , Kreis-Ellips , Kreisausschnitt
DATA  Prisma , Pyramide , Stern , SZL-Linie , KF-Vieleck , Bezier-Kurven ,-----------------, Spiegel 2 ,""
DATA Einstellen , Stiftgrîûe ,------------------, Spiegel Modus ,------------------," Bezier  Modus "
DATA ------------------, Bild Manipulator ,------------------, Monitor aus/an ,""
DATA  Spezial , Kontrast verstÑrken ,-------- Lupe -------,  Zeichen  -  Lupe ,--- Positionieren ---,  Bild Positionieren,""
DATA  Bild , Bild 1 , Bild 2 , Bild 3 , Bild 4 , Bild 5 ,""
DATA  Sonstiges , MenÅ 1     , MenÅ 2 , MenÅ 3 ,""
PROCEDURE rahmung(c%)
  DPOKE INTIN,c%
  VDISYS 104
RETURN
PROCEDURE lang_3_4_eck
  LOCAL z%,x%,y%,ox%,oy%
  ALERT 3,"Was hÑtten Sie den gern ?",3,"Dreieck|Viereck|ZurÅck",z%
  IF z%<3
    DEFMOUSE 5
    ADD z%,2
    REPEAT
      MOUSE x%,y%,k%
    UNTIL MOUSEK=1
    HIDEM
    DIM x%(4),y%(4)
    GRAPHMODE 3
    REPEAT
      MOUSE x%,y%,k%
    UNTIL k%=0
    ARRAYFILL x%(),x%
    ARRAYFILL y%(),y%
    REPEAT
      POLYLINE 2,x%(),y%()
      VSYNC
      PAUSE 3
      REPEAT
        MOUSE x%,y%,k%
      UNTIL x%(1)<>x% OR y%(1)<>y% OR k%
      POLYLINE 2,x%(),y%()
      x%(1)=x%
      y%(1)=y%
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0
    CLR ox%,oy%
    REPEAT
      @set.figur
      REPEAT
        MOUSE x%,y%,k%
      UNTIL x%(2)<>x% OR y%(2)<>y% OR k%
      VSYNC
      PAUSE 3
      @set.figur
      x%(2)=x%
      y%(2)=y%
      IF z%=4
        x%(3)=x%-(x%(1)-x%(0))
        y%(3)=y%-(y%(1)-y%(0))
      ENDIF
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0
    REPEAT
      REPEAT
        @set.figur
        REPEAT
          MOUSE x%,y%,k%
        UNTIL x%<>x%(2)+ox% OR y%<>y%(2)+oy% OR k%
        VSYNC
        PAUSE 3
        @set.figur
        ox%=x%-x%(2)
        oy%=y%-y%(2)
      UNTIL k%
      REPEAT
      UNTIL MOUSEK=0
      IF k%=1
        @set.figur
      ENDIF
    UNTIL k%=2
    ERASE x%()
    ERASE y%()
  ENDIF
  GRAPHMODE graf%
RETURN
PROCEDURE set.figur
  POLYLINE z%+1,x%(),y%() OFFSET ox%,oy%
  IF fu%=2
    POLYFILL z%,x%(),y%() OFFSET ox%,oy%
  ENDIF
RETURN
PROCEDURE lang_sechs_drei_stern
  ALERT 3,"Was soll ich Zeichnen ?",3,"Sechseck|Dreieck|Stern",auswahl%
  DEFMOUSE 5
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  LOCAL mx%,my%,px1%,px2%,py1%,py2%,delta.x%,delta.y%,ba%,ab%,x1%,y1%,setzflag!
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  setz_figur:
  REPEAT
    delta.x%=x1%-mx%
    delta.y%=y1%-my%
    px1%=mx%+delta.x%/2
    py1%=my%+delta.y%/2
    px2%=mx%-delta.x%/2
    py2%=my%-delta.y%/2
    ba%=delta.y%*0.866025
    ab%=delta.x%*0.866025
    @figur
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    VSYNC
    PAUSE 3
    @figur
    IF setzflag!
      mx%=x%-delta.x%
      my%=y%-delta.y%
    ENDIF
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  IF setzflag!=0
    setzflag!=-1
    GOTO setz_figur
    VSYNC
    PAUSE 3
  ENDIF
  IF k%<2
    @figur
    VSYNC
    PAUSE 3
    GOTO setz_figur
  ENDIF
  GRAPHMODE graf%
RETURN
PROCEDURE figur
  IF auswahl%=1
    DRAW x1%,y1% TO px1%+ba%,py1%-ab% TO px2%+ba%,py2%-ab% TO mx%-delta.x%,my%-delta.y% TO px2%-ba%,py2%+ab% TO px1%-ba%,py1%+ab% TO x1%,y1%
  ENDIF
  IF auswahl%>1
    DRAW x1%,y1% TO px2%+ba%,py2%-ab% TO px2%-ba%,py2%+ab% TO x1%,y1%
  ENDIF
  IF auswahl%=3
    DRAW px1%+ba%,py1%-ab% TO mx%-delta.x%,my%-delta.y% TO px1%-ba%,py1%+ab% TO px1%+ba%,py1%-ab%
  ENDIF
RETURN
PROCEDURE lang_5_eck
  DEFMOUSE 5
  LOCAL mx%,my%,px1%,px2%,py1%,py2%,delta.x%,delta.y%,ba%,ab%,x1%,y1%,setzflag!
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  setz_figur1:
  REPEAT
    delta.x%=x1%-mx%
    delta.y%=y1%-my%
    ab%=delta.x%*0.945
    ba%=delta.y%*0.945
    px1%=mx%+delta.x%/3.24
    py1%=my%+delta.y%/3.24
    px2%=mx%-delta.x%*0.81
    py2%=my%-delta.y%*0.81
    DRAW x1%,y1% TO px1%+ba%,py1%-ab% TO px2%+ba%*0.608,py2%-ab%*0.608 TO px2%-ba%*0.608,py2%+ab%*0.608 TO px1%-ba%,py1%+ab% TO x1%,y1%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    VSYNC
    PAUSE 3
    DRAW x1%,y1% TO px1%+ba%,py1%-ab% TO px2%+ba%*0.608,py2%-ab%*0.608 TO px2%-ba%*0.608,py2%+ab%*0.608 TO px1%-ba%,py1%+ab% TO x1%,y1%
    IF setzflag!
      mx%=x%-delta.x%
      my%=y%-delta.y%
    ENDIF
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  IF setzflag!=0
    setzflag!=-1
    GOTO setz_figur1
  ENDIF
  IF k%<2
    DRAW x1%,y1% TO px1%+ba%,py1%-ab% TO px2%+ba%*0.608,py2%-ab%*0.608 TO px2%-ba%*0.608,py2%+ab%*0.608 TO px1%-ba%,py1%+ab% TO x1%,y1%
    GOTO setz_figur1
  ENDIF
RETURN
PROCEDURE lang_kreis_ellips
  LOCAL mx%,my%,x1%,y1%,r%,difx%,dify%,rx%,ry%,ellips%
  ALERT 3,"Was wÅnschen Sie bitte ?",3,"Ellipse|Kreis|ZurÅck",ellipse%
  IF ellipse%<3
    DEFMOUSE 5
    REPEAT
      MOUSE x%,y%,k%
    UNTIL MOUSEK=1
    HIDEM
    GRAPHMODE 3
    REPEAT
      MOUSE mx%,my%,k%
    UNTIL k%=0
    HIDEM
    x1%=mx%
    y1%=my%
    CLR r%
    REPEAT
      IF ellipse%=1
        rx%=(x1%-mx%)*1.42
        ry%=(y1%-my%)*1.42
      ELSE
        r%=SQR((x1%-mx%)^2+(y1%-my%)^2)
      ENDIF
      @set.figur_1
      REPEAT
        MOUSE x%,y%,k%
      UNTIL x1%<>x% OR y1%<>y% OR k%
      @set.figur_1
      x1%=x%
      y1%=y%
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0 OR k%=2
    difx%=x%-mx%
    dify%=y%-my%
    REPEAT
      REPEAT
        @set.figur_1
        REPEAT
          MOUSE x%,y%,k%
        UNTIL x1%<>x% OR y1%<>y% OR k%
        @set.figur_1
        x1%=x%
        y1%=y%
        mx%=x1%-difx%
        my%=y1%-dify%
      UNTIL k%
      IF k%=1
        @set.figur_1
      ENDIF
      REPEAT
      UNTIL MOUSEK=0 OR k%=2
    UNTIL k%=2
  ENDIF
  GRAPHMODE graf%
RETURN
PROCEDURE set.figur_1
  IF ellipse%=1
    IF fu%=2
      PELLIPSE mx%,my%,rx%,ry%
    ENDIF
    ELLIPSE mx%,my%,rx%,ry%
  ELSE
    IF fu%=2
      PCIRCLE mx%,my%,r%
    ENDIF
    CIRCLE mx%,my%,r%
  ENDIF
RETURN
PROCEDURE lang_kreisausschnitt
  DEFMOUSE 5
  LOCAL mx%,my%,x1%,y1%,x0%,y0%,r%,dif.x%,dif.y%,phi0%,phi1%,winkel%
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  CLR r%
  DEFLINE 3
  REPEAT
    phi0%=winkel%
    phi1%=winkel%+3600
    @rechnen1
    CIRCLE mx%,my%,r%,phi0%,phi1%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    CIRCLE mx%,my%,r%,phi0%,phi1%
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0 OR k%=2
  phi0%=winkel%
  r1%=r%
  x0%=dif.x%
  y0%=dif.y%
  DEFLINE kj,bh,anfang,schluss
  REPEAT
    @rechnen1
    fak=r%/r1%
    phi1%=winkel%
    @set.kr.sec
    DEFLINE 3
    CIRCLE mx%,my%,r%,phi1%,phi0%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    CIRCLE mx%,my%,r%,phi1%,phi0%
    DEFLINE kj,bh,anfang,schluss
    @set.kr.sec
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0 OR k%=2
  difx%=x%-mx%
  dify%=y%-my%
  REPEAT
    REPEAT
      @set.kr.sec
      REPEAT
        MOUSE x%,y%,k%
      UNTIL x1%<>x% OR y1%<>y% OR k%
      @set.kr.sec
      x1%=x%
      y1%=y%
      mx%=x1%-difx%
      my%=y1%-dify%
    UNTIL k%
    IF k%=1
      @set.kr.sec
    ENDIF
    REPEAT
    UNTIL MOUSEK=0 OR k%=2
  UNTIL k%=2
  REPEAT
  UNTIL MOUSEK=0
  GRAPHMODE graf%
  DEFLINE kj,bh,anfang,schluss
RETURN
PROCEDURE set.kr.sec
  IF fu%=2
    PCIRCLE mx%,my%,r%,phi0%,phi1%
    DRAW x1%,y1% TO mx%,my% TO mx%+x0%*fak,my%+y0%*fak
  ENDIF
  CIRCLE mx%,my%,r%,phi0%,phi1%
RETURN
PROCEDURE rechnen1
  dif.x%=x1%-mx%
  dif.y%=y1%-my%
  r%=SQR(dif.x%^2+dif.y%^2)
  IF y1%<=my%
    IF x1%=>mx%
      winkel%=ATN(dif.y%/(dif.x%+1.0E-12))*-573
    ELSE
      winkel%=1800-(ATN(dif.y%/(dif.x%+1.0E-12))*573)
    ENDIF
  ELSE
    IF x1%=>mx%
      winkel%=3600-(ATN(dif.y%/(dif.x%+1.0E-12))*573)
    ELSE
      winkel%=ATN(dif.y%/(dif.x%+1.0E-12))*-573+1800
    ENDIF
  ENDIF
RETURN
PROCEDURE lang_prisma
  DEFMOUSE 5
  LOCAL x1%,y1%,x2%,y2%,x3%,y3%,x4%,y4%,br1_3%,br1_2%,br2_3%,ho1_2%,ho1_3%,ho2_3%,var_1,var_2,var_3,var.1,var.2,var.3,var1,var2,var3,k%
  LOCAL x%,y%,h.dif%,br1_3%,br%
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  GRAPHMODE 3
  REPEAT
    MOUSE x1%,y1%,k%
  UNTIL k%=0
  x2%=x1%
  y2%=y1%
  REPEAT
    DRAW x1%,y1% TO x2%,y2%
    REPEAT
      MOUSE x%,y%,k%
      IF x%<x1%
        DPOKE 9952,x1%+1
      ENDIF
    UNTIL x2%<>x% OR y2%<>y% OR k%
    DRAW x1%,y1% TO x2%,y2%
    x2%=x%
    y2%=y%
  UNTIL k%
  IF k%=1
    DRAW x1%,y1% TO x2%,y2%
  ENDIF
  REPEAT
  UNTIL MOUSEK=0 OR k%=2
  x3%=x2%
  y3%=y2%
  REPEAT
    DRAW x2%,y2% TO x3%,y3% TO x1%,y1%
    REPEAT
      MOUSE x%,y%,k%
      IF x%<x1%
        DPOKE 9952,x1%
      ENDIF
      IF y%>y2%
        DPOKE 9954,y2%
      ENDIF
    UNTIL x3%<>x% OR y3%<>y% OR k%
    DRAW x2%,y2% TO x3%,y3% TO x1%,y1%
    x3%=x%
    y3%=y%
  UNTIL k%
  IF k%=1
    DRAW x2%,y2% TO x3%,y3% TO x3%-br%,y3%-h.dif% TO x1%,y1%
  ENDIF
  REPEAT
  UNTIL MOUSEK=0 OR k%=2
  x4%=x3%
  y4%=y3%
  br1_2%=x2%-x1%
  br1_3%=x1%-x3%
  br2_3%=x3%-x2%
  ho1_3%=y1%-y3%
  ho2_3%=y2%-y3%
  ho1_2%=y2%-y1%
  var_1=ho1_2%/(br1_2%+1.0E-12)
  var.1=y1%-var_1*x1%
  var_2=br2_3%/(ho2_3%+1.0E-12)
  var.2=x3%+var_2*y3%
  var_3=ho1_3%/(br1_3%+1.0E-12)
  var.3=y1%-var_3*x1%
  REPEAT
    @set.prisma
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x4%<>x% OR y4%<>y% OR k%
    @set.prisma
    x4%=x%
    y4%=y%
  UNTIL k%
  IF k%=1
    @set.prisma
  ENDIF
  REPEAT
  UNTIL MOUSEK=0 OR k%=2
RETURN
PROCEDURE set.prisma
  var1=(y4%+ho2_3%)-var_1*(x4%-br2_3%)
  var2=x4%+var_2*y4%
  var3=y4%-var_3*x4%
  IF var.1>var1
    IF var.2>var2
      DRAW x3%,y3% TO x4%,y4% TO x4%+br1_3%,y4%+ho1_3% TO x1%,y1%
      DRAW x2%,y2% TO x4%-br2_3%,y4%+ho2_3% TO x4%,y4%
    ELSE
      DRAW x2%,y2% TO x4%-br2_3%,y4%+ho2_3% TO x4%,y4% TO x3%,y3%
      IF var.3>var3
        DRAW x1%,y1% TO x4%+br1_3%,y4%+ho1_3% TO x4%,y4%
      ELSE
        DRAW x1%,y1% TO x4%+br1_3%,y4%+ho1_3% TO x4%,y4%
      ENDIF
    ENDIF
    DRAW x4%+br1_3%,y4%+ho1_3% TO x4%-br2_3%,y4%+ho2_3%
  ELSE
    DRAW x1%,y1% TO x4%+br1_3%,y4%+ho1_3% TO x4%-br2_3%,y4%+ho2_3% TO x2%,y2%
    IF var.3>var3
      DRAW x3%,y3% TO x4%,y4% TO x4%+br1_3%,y4%+ho1_3%
      DRAW x4%-br2_3%,y4%+ho2_3% TO x4%,y4%
    ELSE
      IF var.2>var2
        DRAW x3%,y3% TO x4%,y4% TO x4%-br2_3%,y4%+ho2_3%
      ELSE
        DRAW x3%,y3% TO x4%,y4% TO x4%-br2_3%,y4%+ho2_3%
      ENDIF
      DRAW x4%,y4% TO x4%+br1_3%,y4%+ho1_3%
    ENDIF
  ENDIF
RETURN
PROCEDURE lang_pyramide
  CLR var1%,var2%,var3%,var4%
  DEFMOUSE 5
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  GRAPHMODE 3
  REPEAT
    MOUSE x1%,y1%,k%
  UNTIL k%=0
  x2%=x1%
  y2%=y1%
  REPEAT
    DRAW x1%,y1% TO x2%,y2%
    REPEAT
      MOUSE x%,y%,k%
      IF x%<x1%
        DPOKE 9952,x1%+1
      ENDIF
    UNTIL x2%<>x% OR y2%<>y% OR k%=1
    DRAW x1%,y1% TO x2%,y2%
    x2%=x%
    y2%=y%
  UNTIL k%=1
  REPEAT
  UNTIL MOUSEK=0
  x3%=x2%
  y3%=y2%
  br%=x2%-x1%
  h.dif%=y2%-y1%
  REPEAT
    DRAW x1%,y1% TO x2%,y2% TO x3%,y3% TO x3%-br%,y3%-h.dif% TO x1%,y1%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x3%<>x% OR y3%<>y% OR k%=1
    DRAW x1%,y1% TO x2%,y2% TO x3%,y3% TO x3%-br%,y3%-h.dif% TO x1%,y1%
    x3%=x%
    y3%=y%
  UNTIL k%=1
  REPEAT
  UNTIL MOUSEK=0
  x4%=x3%-br%
  y4%=y3%-h.dif%
  x5%=x3%
  y5%=y3%
  v.dif%=x3%-x2%
  ho%=y2%-y3%
  var_1=INT(v.dif%/(ho%+1.0E-12))
  var1%=(var_1*y4%+x4%)
  var3%=var_1*y3%+x3%
  var_2=h.dif%/(br%+1.0E-12)
  var2%=y3%-INT(var_2*x3%)
  var4%=y1%-INT(var_2*x1%)
  REPEAT
    @set.pyramide
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x5%<>x% OR y5%<>y% OR k%=1
    @set.pyramide
    x5%=x%
    y5%=y%
  UNTIL k%=1
  @set.pyramide
  REPEAT
  UNTIL MOUSEK=0
  GRAPHMODE graf%
RETURN
PROCEDURE set.pyramide
  var.1%=var_1*(y5%+ho%)+x5%-v.dif%
  var.2%=y5%-(var_2*x5%)
  IF y3%<y2%
    IF var2%<var.2%
      DRAW x3%,y3% TO x5%,y5% TO x4%,y4% TO x3%,y3%
      IF var.2%<var4%
        DRAW x1%,y1% TO x2%,y2% TO x5%,y5% TO x1%,y1%
        IF x5%<(x3%+x1%)/2
          DRAW x2%,y2% TO x3%,y3%
          DRAW x1%,y1% TO x4%,y4%
        ELSE
          DRAW x4%,y4% TO x1%,y1%
          DRAW x2%,y2% TO x3%,y3%
        ENDIF
      ELSE
        IF var.1%>var3%
          DRAW x5%,y5% TO x1%,y1% TO x4%,y4%
          DRAW x5%,y5% TO x2%,y2% TO x3%,y3%
        ELSE
          DRAW x5%,y5% TO x2%,y2% TO x3%,y3%
          IF var1%>var.1%
            DRAW x4%,y4% TO x1%,y1% TO x5%,y5%
          ELSE
            DRAW x5%,y5% TO x1%,y1% TO x4%,y4%
          ENDIF
        ENDIF
        DRAW x1%,y1% TO x2%,y2%
      ENDIF
    ELSE
      IF var.1%<var1%
        DRAW x2%,y2% TO x1%,y1% TO x5%,y5% TO x2%,y2% TO x3%,y3% TO x5%,y5%
        DRAW x1%,y1% TO x4%,y4% TO x5%,y5%
      ELSE
        DRAW x5%,y5% TO x4%,y4% TO x1%,y1% TO x2%,y2% TO x5%,y5% TO x1%,y1%
        IF var.1%<var3%
          DRAW x2%,y2% TO x3%,y3% TO x5%,y5%
        ELSE
          DRAW x2%,y2% TO x3%,y3% TO x5%,y5%
        ENDIF
      ENDIF
      DRAW x3%,y3% TO x4%,y4%
    ENDIF
  ELSE
    DRAW x1%,y1% TO x2%,y2% TO x3%,y3% TO x4%,y4% TO x1%,y1%
    IF var1%<var.1%
      IF var2%<var.2%
        DRAW x3%,y3% TO x5%,y5% TO x4%,y4%
        IF var3%>var.1%
          DRAW x5%,y5% TO x2%,y2%
        ELSE
          DRAW x2%,y2% TO x5%,y5%
        ENDIF
        DRAW x1%,y1% TO x5%,y5%
      ELSE
        IF var3%>var.1%
          DRAW x1%,y1% TO x5%,y5% TO x2%,y2%
          DRAW x3%,y3% TO x5%,y5%
        ELSE
          DRAW x2%,y2% TO x5%,y5% TO x3%,y3%
          IF var4%>var.2%
            DRAW x1%,y1% TO x5%,y5%
          ELSE
            DRAW x1%,y1% TO x5%,y5%
          ENDIF
        ENDIF
        DRAW x4%,y4% TO x5%,y5%
      ENDIF
    ELSE
      DRAW x4%,y4% TO x5%,y5% TO x1%,y1%
      IF var4%>var.2%
        DRAW x5%,y5% TO x2%,y2%
        DRAW x3%,y3% TO x5%,y5%
      ELSE
        IF var2%>var.2%
          DRAW x5%,y5% TO x3%,y3%
        ELSE
          DRAW x3%,y3% TO x5%,y5%
        ENDIF
        DRAW x2%,y2% TO x5%,y5%
      ENDIF
    ENDIF
  ENDIF
RETURN
PROCEDURE lang_stern
  DEFMOUSE 5
  LOCAL mx%,my%,ox%,oy%,delta.x%,delta.y%,r%,seite,mauspos,tangens,winkel,d%
  IF zacken%=0
    zacken%=2
  ENDIF
  weiter97:
  IF zacken%=61
    zacken%=2
  ENDIF
  IF zacken%=0 OR zacken%=1
    zacken%=60
  ENDIF
  ALERT 3,"Zeichnen eines Stern ?|Anzahl der Zacken "+STR$(zacken%),2,"+|OK|-",d%
  IF d%=1
    INC zacken%
    GOTO weiter97
  ENDIF
  IF d%=3
    DEC zacken%
    GOTO weiter97
  ENDIF
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  HIDEM
  ERASE x%()
  ERASE y%()
  DIM x%(zacken%*2),y%(zacken%*2)
  mauspos=1-(zacken%*0.25)
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  seite=2*PI/zacken%
  ARRAYFILL x%(),mx%
  ARRAYFILL y%(),my%
  REPEAT
    @rechnen
    FOR i%=0 TO zacken%
      x%(i%*2)=mx%+r%*SIN((i%-winkel)*seite)
      y%(i%*2)=my%+r%*COS((i%-winkel)*seite)
    NEXT i%
    CIRCLE mx%,my%,r%
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    CIRCLE mx%,my%,r%
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  REPEAT
    @rechnen
    FOR i%=0 TO zacken%-1
      x%(i%*2+1)=mx%+r%*SIN((i%-winkel)*seite)
      y%(i%*2+1)=my%+r%*COS((i%-winkel)*seite)
    NEXT i%
    @figur_2
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    @figur_2
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  REPEAT
    REPEAT
      @figur_2
      REPEAT
        MOUSE x%,y%,k%
      UNTIL ox%<>x%-x1% OR oy%<>y%-y1% OR k%
      @figur_2
      ox%=x%-x1%
      oy%=y%-y1%
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0 OR k%=2
    IF k%=1
      @figur_2
    ENDIF
  UNTIL MOUSEK=2
  ERASE x%()
  ERASE y%()
  GRAPHMODE graf%
RETURN
PROCEDURE rechnen
  delta.x%=x1%-mx%
  delta.y%=y1%-my%
  r%=SQR(delta.x%^2+delta.y%^2)
  tangens=delta.y%/(delta.x%+1.0E-12)
  IF x1%=>mx%
    winkel=ATN(tangens)/seite+mauspos
  ELSE
    winkel=ATN(tangens)/seite-mauspos
  ENDIF
RETURN
PROCEDURE figur_2
  POLYLINE zacken%*2+1,x%(),y%() OFFSET ox%,oy%
  IF fu%=2
    POLYFILL zacken%*2,x%(),y%() OFFSET ox%,oy%
  ENDIF
RETURN
PROCEDURE lang_linie
  DEFMOUSE 5
  LOCAL mx%,my%,x1%,y1%,br%,ho%
  ALERT 3,"Was kann ich fÅr Sie tun ?",1,"Linienzug|Strahlen|Linie",linienflag%
  IF linienflag%=3
    linienflag%=0
  ENDIF
  ALERT 3,"Gradeinstellung 15% ? ",3,"Ja|Nein|ZurÅck",grad_15%
  IF grad_15%=3
    GOTO ende
  ENDIF
  REPEAT
  UNTIL MOUSEK=1
  HIDEM
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  start17:
  REPEAT
    DRAW mx%,my% TO x1%,y1%
    REPEAT
      MOUSE x%,y%,k%
      IF grad_15%=1
        @15.grad
      ENDIF
    UNTIL x1%<>x% OR y1%<>y% OR k%
    DRAW mx%,my% TO x1%,y1%
    GRAPHMODE 3
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  IF k%=1
    IF linienflag%=0
      br%=x%-mx%
      ho%=y%-my%
      REPEAT
        REPEAT
          DRAW mx%,my% TO x1%,y1%
          REPEAT
            MOUSE x%,y%,k%
          UNTIL x1%<>x% OR y1%<>y% OR k%
          DRAW mx%,my% TO x1%,y1%
          x1%=x%
          y1%=y%
          mx%=x%-br%
          my%=y%-ho%
        UNTIL k%
        IF k%=1
          DRAW mx%,my% TO x1%,y1%
        ENDIF
        REPEAT
        UNTIL MOUSEK=0
      UNTIL k%=2
      GOTO ende
    ENDIF
    DRAW mx%,my% TO x1%,y1%
    IF linienflag%=1
      mx%=x%
      my%=y%
    ENDIF
    GOTO start17
  ENDIF
  REPEAT
  UNTIL MOUSEK=0
  ende:
  GRAPHMODE graf%
RETURN
PROCEDURE 15.grad
  LOCAL delta.x%,delta.y%,a%
  delta.x%=x%-mx%
  delta.y%=y%-my%
  a%=ATN(delta.y%/(delta.x%+1.0E-12))*4.4
  IF a%>3 OR a%<-3
    x%=mx%+delta.y%/(TAN(a%*PI/12)+1.0E-12)
  ELSE
    y%=my%+delta.x%*TAN(a%*PI/12)
  ENDIF
RETURN
PROCEDURE lang_vieleck
  LOCAL mx%,my%,ox%,oy%,delta.x%,delta.y%,r%,seite,mauspos,tangens,winkel,z%,eck%,zerrflag%,d_flag%
  IF zacken1%=0
    zacken1%=3
  ENDIF
  hammelbein:
  ALERT 3,"Wieviele Ecken mîchten Sie|den bitte zeichnen ?|Anzahl der Ecken eingeben |Eckenzahl "+STR$(zacken1%),2," + |OK| - ",eck%
  IF eck%=1
    INC zacken1%
    GOTO hammelbein
  ENDIF
  IF eck%=3
    DEC zacken1%
    GOTO hammelbein
  ENDIF
  ALERT 3,"Was mîchten Sie Zeichnen ?",3,"Kîrper|FlÑchen|ZurÅck",d_flag%
  IF d_flag%=3
    GOTO end
  ENDIF
  IF d_flag%=2
    d_flag%=0
  ENDIF
  ALERT 3,"FlÑchenform ?             | |gleichseitig|verzerrt",3,"GLEICH|VERZERRT|ZURöCK",zerrflag%
  IF zerrflag%=1
    zerrflag%=0
  ENDIF
  IF zerrflag%=3
    GOTO end
  ENDIF
  DEFMOUSE 5
  REPEAT
  UNTIL MOUSEK=1
  DIM x%(zacken1%),y%(zacken1%)
  mauspos=1-(z%*0.25)
  GRAPHMODE 3
  REPEAT
    MOUSE mx%,my%,k%
  UNTIL k%=0
  x1%=mx%
  y1%=my%
  seite=2*PI/zacken1%
  REPEAT
    delta.x%=x1%-mx%
    delta.y%=y1%-my%
    r%=SQR(delta.x%^2+delta.y%^2)
    tangens=delta.y%/(delta.x%+1.0E-12)
    IF x1%=>mx%
      winkel=ATN(tangens)/seite+mauspos
    ELSE
      winkel=ATN(tangens)/seite-mauspos
    ENDIF
    FOR i%=0 TO zacken1%
      x%(i%)=mx%+r%*SIN((i%-winkel)*seite)
      y%(i%)=my%+r%*COS((i%-winkel)*seite)
    NEXT i%
    @figur_7
    REPEAT
      MOUSE x%,y%,k%
    UNTIL x1%<>x% OR y1%<>y% OR k%
    @figur_7
    x1%=x%
    y1%=y%
  UNTIL k%
  REPEAT
  UNTIL MOUSEK=0
  IF zerrflag%
    REPEAT
      yy=r%+dif.y%/delta.y%*r%
      xx=r%+dif.x%/delta.x%*r%
      FOR i%=0 TO zacken1%
        y%(i%)=my%+yy*COS((i%-winkel)*seite)
        x%(i%)=mx%+xx*SIN((i%-winkel)*seite)
      NEXT i%
      @figur_7
      REPEAT
        MOUSE x%,y%,k%
      UNTIL x1%+dif.x%<>x% OR y1%+dif.y%<>y% OR k%
      @figur_7
      dif.x%=x%-x1%
      dif.y%=y%-y1%
    UNTIL k%
    x1%=x%
    y1%=y%
    REPEAT
    UNTIL MOUSEK=0
  ENDIF
  IF d_flag%
    @figur_7
    REPEAT
      @3d
      REPEAT
        MOUSE x%,y%,k%
      UNTIL ox%<>x%-x1% OR oy%<>y%-y1% OR k%
      @3d
      ox%=x%-x1%
      oy%=y%-y1%
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0 OR k%=2
    IF k%=1
      @3d
    ENDIF
    GOTO end
  ENDIF
  REPEAT
    REPEAT
      @figur_7
      REPEAT
        MOUSE x%,y%,k%
      UNTIL ox%<>x%-x1% OR oy%<>y%-y1% OR k%
      @figur_7
      ox%=x%-x1%
      oy%=y%-y1%
    UNTIL k%
    REPEAT
    UNTIL MOUSEK=0 OR k%=2
    IF k%=1
      @figur_7
    ENDIF
  UNTIL MOUSEK=2
  end:
  REPEAT
  UNTIL MOUSEK=0
  ERASE x%()
  ERASE y%()
  GRAPHMODE graf%
RETURN
PROCEDURE figur_7
  POLYLINE zacken1%+1,x%(),y%() OFFSET ox%,oy%
  IF fu%=2
    POLYFILL zacken1%,x%(),y%() OFFSET ox%,oy%
  ENDIF
RETURN
PROCEDURE 3d
  POLYLINE zacken1%+1,x%(),y%() OFFSET ox%,oy%
  FOR i%=1 TO zacken1%
    DRAW x%(i%),y%(i%) TO x%(i%)+ox%,y%(i%)+oy%
  NEXT i%
RETURN
PROCEDURE spiegel_2
  ALERT 3,"Bildschirmspiegeln ?  ",3,"Klappen|Spiegeln|ZurÅck",spiegeli%
  IF spiegeli%<3
    ERASE smfdb%()
    ERASE dmfdb%()
    ERASE p%()
    DIM smfdb%(5),dmfdb%(5),p%(8)
    GET 0,0,639,399,block$
    @mirrorput1(0,0,*block$)
  ENDIF
  ERASE smfdb%()
  ERASE dmfdb%()
  ERASE p%()
RETURN
PROCEDURE mirrorput1(x%,y%,s.%)
  IF DPEEK(s.%+4)>6
    a%=LPEEK(s.%)
    b%=DPEEK(a%)
    h%=DPEEK(a%+2)
    IF spiegeli%=1
      smfdb%(0)=a%+6
    ENDIF
    smfdb%(1)=(b%+16) AND &HFFF0
    smfdb%(2)=h%+1
    smfdb%(3)=smfdb%(1)/16
    smfdb%(5)=DPEEK(a%+4)
    dmfdb%(0)=XBIOS(3)
    dmfdb%(1)=640
    dmfdb%(2)=400
    dmfdb%(3)=40
    dmfdb%(5)=1
    p%(1)=0
    p%(3)=h%
    p%(5)=y%
    p%(7)=y%+h%
    p%(8)=3
    p%(4)=x%+b%
    p%(6)=x%+b%
    FOR i%=0 TO b%
      p%(0)=i%
      p%(2)=i%
      BITBLT smfdb%(),dmfdb%(),p%()
      DEC p%(4)
      DEC p%(6)
    NEXT i%
  ENDIF
RETURN
PROCEDURE hans
  PRINT AT(29,1);"Bild einladen  Bild Nr ";bild1%
  PRINT CHR$(27)+"p";
  PRINT AT(11,2);" ";STRING$(23,45);" Bild  laden ";STRING$(22,45);" "
  PRINT CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 80,30,559,387
  DEFFILL 1,FALSE,FALSE
  PBOX 87,37,553,381
  BOX 86,36,554,382
  BOX 88,38,552,380
  BOX 90,40,550,378
  BOX 92,42,548,376
  BOX 93,43,547,375
  DRAW 93,64 TO 547,64
  DRAW 93,65 TO 547,65
  DRAW 93,67 TO 547,67
  DRAW 93,69 TO 547,69
  DRAW 93,70 TO 547,70
  DEFTEXT 1,4,8,6
  TEXT 105,55,"Zeichenprogramm    Format    Zeichenprogramm    Format"
  DRAW 317,43 TO 317,65
  DRAW 318,43 TO 318,65
  DRAW 320,43 TO 320,65
  DRAW 322,43 TO 322,65
  DRAW 323,43 TO 323,65
  DRAW 317,70 TO 317,375
  DRAW 318,70 TO 318,375
  DRAW 320,70 TO 320,375
  DRAW 322,70 TO 322,375
  DRAW 323,70 TO 323,375
  DEFTEXT 1,FALSE,8,6
RETURN
PROCEDURE hans1
  GOSUB intro_lade_bild
  GOSUB datei_erfragen("*.PIC")
  GOSUB radio5(f$)
RETURN
PROCEDURE intro_save_block
  GOSUB merge_bild
  ALERT FALSE,"Bitte markieren Sie mit|der Maus den Bereich den|Sie speichern mîchten.",1,"  OK  ",d%
  REPEAT
  UNTIL MOUSEK=1
  REPEAT
  UNTIL MOUSEK=0
  @b_i
  MOUSE x1%,y1%,k%
  @b_s
  REPEAT
    MOUSE x%,y%,k%
    @b_s
    BOX x1%,y1%,x%,y%
  UNTIL k%<>0
  @b_o
  GET x1%,y1%,x%,y%,block$
  GOSUB kind
  DEFTEXT 1,FALSE,3,32
  GRAPHMODE 2
  TEXT 170,45,">>> Save Block <<<<"
  PRINT AT(21,24);CHR$(27)+"p"+"  Zu speichernden Block hier auswÑhlen. ";CHR$(27)+"q"
  DEFFILL 1,2,FALSE
  PBOX 150,360,489,390
RETURN
PROCEDURE radio3
  GOSUB intro_lade_block
  GOSUB datei_erfragen("*.BLK")
  HIDEM
  GOSUB merge_bild
  SGET l$
  IF EXIST(f$)
    OPEN "i",#1,f$
    block$=INPUT$(LOF(#1),#1)
    CLOSE #1
    GOSUB merge_bild
    @kopieren
    GOSUB zeige_bild
  ENDIF
RETURN
PROCEDURE kopieren
  LOCAL a%,x%,y%
  @b_i
  DO
    x%=MOUSEX
    y%=MOUSEY
    EXIT IF MOUSEK=2
    @b_s
    PUT x%,y%,block$,modus%
    IF MOUSEK=1
      GOSUB zeige_bild
    ENDIF
  LOOP
  @b_o
RETURN
PROCEDURE b_i
  VOID FRE(0)
  GRAPHMODE 1
  ERASE bild%()
  DIM bild%(32255/4)
  SGET l$
  a%=XBIOS(3)
  b%=(VARPTR(bild%(0))+255) AND &HFFFF00
RETURN
PROCEDURE b_s
  SWAP a%,b%
  VOID XBIOS(5,L:a%,L:b%,-1)
  GOSUB merge_bild
RETURN
PROCEDURE b_o
  a%=MAX(a%,b%)
  VOID XBIOS(5,L:a%,L:a%,-1)
  GOSUB merge_bild
  ERASE bild%()
RETURN
PROCEDURE kupfer
  GOSUB intro_save_block
  GOSUB datei_erfragen("*.BLK")
  IF f$<>"" AND NOT f$=" "
    v_schon%=0
    IF EXIST(f$)
      ALERT 0,"Block mit diesen|Namen schon vorhanden|soll ich Block|Åberschreiben ?",1," JA |NEIN",v_schon%
    ENDIF
    IF v_schon%<>2
      HIDEM
      BSAVE f$,VARPTR(block$),LEN(block$)
    ENDIF
  ENDIF
RETURN
PROCEDURE k_linie
  REPEAT
    x1%=MOUSEX
    y1%=MOUSEY
  UNTIL MOUSEK=1
  @b_i
  REPEAT
    x%=MOUSEX
    y%=MOUSEY
    @b_s
    DRAW x%,y% TO x1%,y1%
    WHILE MOUSEK=1
      GOSUB zeige_bild
      x1%=x%
      y1%=y%
    WEND
  UNTIL MOUSEK=2
  @b_o
RETURN
PROCEDURE flimm_frei
  LOCAL x%,y%,k%,flag%,xl%,yl%,x1%,y1%
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK
  @b_i
  REPEAT
    x%=MOUSEX
    y%=MOUSEY
    @b_s
    IF flag%=1
      GOSUB krank
    ENDIF
    IF flag%=2
      xl%=x%-x1%
      yl%=y%-y1%
      @b_o
      @b_i
      REPEAT
        x%=MOUSEX
        y%=MOUSEY
        @b_s
        x1%=x%+xl%
        y1%=y%+yl%
        GOSUB krank
        IF MOUSEK=1
          GOSUB zeige_bild
          @b_o
          GOSUB krank
          @b_i
        ENDIF
      UNTIL MOUSEK=2
    ENDIF
    IF MOUSEK=1
      INC flag%
      IF flag%=1
        x1%=x%
        y1%=y%
      ENDIF
      REPEAT
      UNTIL MOUSEK=0
    ENDIF
  UNTIL MOUSEK=2
  @b_o
RETURN
PROCEDURE flimm_frei_2
  LOCAL x%,y%,k%,flag%,xl%,yl%,x1%,y1%,s%,g%,k%
  x1:
  @b_i
  REPEAT
    IF MOUSEK=2
      GOTO y1
    ENDIF
  UNTIL MOUSEK=0
  REPEAT
    IF MOUSEK=2
      GOTO y1
    ENDIF
  UNTIL MOUSEK=1
  MOUSE x%,y%,k%
  @b_s
  GOSUB krank_2
  @b_o
  @b_i
  REPEAT
    @b_s
    MOUSE s%,g%,k%
    GOSUB krank_2
    IF MOUSEK=1
      GOSUB zeige_bild
      @b_o
      @b_i
      IF video$="J"
      ELSE
        GOTO x1
      ENDIF
    ENDIF
  UNTIL MOUSEK=2
  y1:
  @b_o
RETURN
PROCEDURE krank
  IF krank%=1
    IF s_modus_1%=0
      DRAW x%,y% TO x1%+xkord%,y1%+ykord%
    ENDIF
    IF s_modus_1%=1
      DRAW x%,y% TO x1%+xkord%,y1%+ykord%
      DRAW x%,399-y% TO x1%+xkord%,399-y1%+ykord%
    ENDIF
    IF s_modus_1%=2
      DRAW x%,y% TO x1%+xkord%,y1%+ykord%
      DRAW 639-x%,y% TO 639-x1%+xkord%,y1%+ykord%
    ENDIF
    IF s_modus_1%=3
      DRAW x%,y% TO x1%+xkord%,y1%+ykord%
      DRAW 639-x%,y% TO 639-x1%+xkord%,y1%+ykord%
      DRAW x%,399-y% TO x1%+xkord%,399-y1%+ykord%
      DRAW 639-x%,399-y% TO 639-x1%+xkord%,399-y1%+ykord%
    ENDIF
    IF s_modus_1%=4
      DRAW 639-x%,399-y% TO 639-x1%+xkord%,399-y1%+ykord%
      DRAW x%,y% TO x1%+xkord%,y1%+ykord%
    ENDIF
  ENDIF
  IF krank%=2
    IF ka%=1
      IF fu%=1
        IF s_modus_1%=0
          BOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          BOX x%,y%,x1%,y1%
          BOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          BOX x%,y%,x1%,y1%
          BOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          BOX x%,y%,x1%,y1%
          BOX 639-x%,y%,639-x1%,y1%
          BOX x%,399-y%,x1%,399-y1%
          BOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          BOX x%,y%,x1%,y1%
          BOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          PBOX x%,y%,x1%,y1%
          PBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,y%,639-x1%,y1%
          PBOX x%,399-y%,x1%,399-y1%
          PBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
    ENDIF
    IF ka%=2
      IF fu%=1
        IF s_modus_1%=0
          RBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          RBOX x%,y%,x1%,y1%
          RBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,y%,639-x1%,y1%
          RBOX x%,399-y%,x1%,399-y1%
          RBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PRBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          PRBOX x%,y%,x1%,y1%
          PRBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,y%,639-x1%,y1%
          PRBOX x%,399-y%,x1%,399-y1%
          PRBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF krank%=3
    y%=y1%+xl%
    IF ka%=1
      IF fu%=1
        IF s_modus_1%=0
          BOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          BOX x%,y%,x1%,y1%
          BOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          BOX x%,y%,x1%,y1%
          BOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          BOX x%,y%,x1%,y1%
          BOX 639-x%,y%,639-x1%,y1%
          BOX x%,399-y%,x1%,399-y1%
          BOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          BOX x%,y%,x1%,y1%
          BOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          PBOX x%,y%,x1%,y1%
          PBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,y%,639-x1%,y1%
          PBOX x%,399-y%,x1%,399-y1%
          PBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          PBOX x%,y%,x1%,y1%
          PBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
    ENDIF
    IF ka%=2
      IF fu%=1
        IF s_modus_1%=0
          RBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          RBOX x%,y%,x1%,y1%
          RBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,y%,639-x1%,y1%
          RBOX x%,399-y%,x1%,399-y1%
          RBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          RBOX x%,y%,x1%,y1%
          RBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PRBOX x%,y%,x1%,y1%
        ENDIF
        IF s_modus_1%=1
          PRBOX x%,y%,x1%,y1%
          PRBOX x%,399-y%,x1%,399-y1%
        ENDIF
        IF s_modus_1%=2
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,y%,639-x1%,y1%
        ENDIF
        IF s_modus_1%=3
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,y%,639-x1%,y1%
          PRBOX x%,399-y%,x1%,399-y1%
          PRBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
        IF s_modus_1%=4
          PRBOX x%,y%,x1%,y1%
          PRBOX 639-x%,399-y%,639-x1%,399-y1%
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF krank%=4
    IF fu%=1
      IF s_modus_1%=0
        CIRCLE x%,y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=1
        CIRCLE x%,y%,ABS(x%-x1%)
        CIRCLE x%,399-y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=2
        CIRCLE x%,y%,ABS(x%-x1%)
        CIRCLE 639-x%,y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=3
        CIRCLE x%,y%,ABS(x%-x1%)
        CIRCLE 639-x%,y%,ABS(x%-x1%)
        CIRCLE x%,399-y%,ABS(x%-x1%)
        CIRCLE 639-x%,399-y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=4
        CIRCLE x%,y%,ABS(x%-x1%)
        CIRCLE 639-x%,399-y%,ABS(x%-x1%)
      ENDIF
    ENDIF
    IF fu%=2
      IF s_modus_1%=0
        PCIRCLE x%,y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=1
        PCIRCLE x%,y%,ABS(x%-x1%)
        PCIRCLE x%,399-y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=2
        PCIRCLE x%,y%,ABS(x%-x1%)
        PCIRCLE 639-x%,y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=3
        PCIRCLE x%,y%,ABS(x%-x1%)
        PCIRCLE 639-x%,y%,ABS(x%-x1%)
        PCIRCLE x%,399-y%,ABS(x%-x1%)
        PCIRCLE 639-x%,399-y%,ABS(x%-x1%)
      ENDIF
      IF s_modus_1%=4
        PCIRCLE x%,y%,ABS(x%-x1%)
        PCIRCLE 639-x%,399-y%,ABS(x%-x1%)
      ENDIF
    ENDIF
  ENDIF
  IF krank%=5
    IF fu%=1
      IF s_modus_1%=0
        ELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=1
        ELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=2
        ELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE 639-x%,y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=3
        ELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE 639-x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE 639-x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=4
        ELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        ELLIPSE 639-x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
    ENDIF
    IF fu%=2
      IF s_modus_1%=0
        PELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=1
        PELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=2
        PELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE 639-x%,y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=3
        PELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE 639-x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE 639-x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
      IF s_modus_1%=4
        PELLIPSE x%,y%,ABS(x%-x1%),ABS(y%-y1%)
        PELLIPSE 639-x%,399-y%,ABS(x%-x1%),ABS(y%-y1%)
      ENDIF
    ENDIF
  ENDIF
RETURN
PROCEDURE krank_2
  IF krank%=1
    IF s_modus_1%=0
      DRAW x%,y% TO s%+xkord%,g%+ykord%
    ENDIF
    IF s_modus_1%=1
      DRAW x%,y% TO s%+xkord%,g%+ykord%
      DRAW x%,399-y% TO s%+xkord%,399-g%+ykord%
    ENDIF
    IF s_modus_1%=2
      DRAW x%,y% TO s%+xkord%,g%+ykord%
      DRAW 639-x%,y% TO 639-s%+xkord%,g%+ykord%
    ENDIF
    IF s_modus_1%=3
      DRAW x%,y% TO s%+xkord%,g%+ykord%
      DRAW 639-x%,y% TO 639-s%+xkord%,g%+ykord%
      DRAW x%,399-y% TO s%+xkord%,399-g%+ykord%
      DRAW 639-x%,399-y% TO 639-s%+xkord%,399-g%+ykord%
    ENDIF
    IF s_modus_1%=4
      DRAW 639-x%,399-y% TO 639-s%+xkord%,399-g%+ykord%
      DRAW x%,y% TO s%+xkord%,g%+ykord%
    ENDIF
  ENDIF
  IF krank%=2
    IF ka%=1
      IF fu%=1
        IF s_modus_1%=0
          BOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          BOX x%,y%,s%,g%
          BOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          BOX x%,y%,s%,g%
          BOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          BOX x%,y%,s%,g%
          BOX 639-x%,y%,639-s%,g%
          BOX x%,399-y%,s%,399-g%
          BOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          BOX x%,y%,s%,g%
          BOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          PBOX x%,y%,s%,g%
          PBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          PBOX x%,y%,s%,g%
          PBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          PBOX x%,y%,s%,g%
          PBOX 639-x%,y%,639-s%,g%
          PBOX x%,399-y%,s%,399-g%
          PBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          PBOX x%,y%,s%,g%
          PBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
    ENDIF
    IF ka%=2
      IF fu%=1
        IF s_modus_1%=0
          RBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          RBOX x%,y%,s%,g%
          RBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          RBOX x%,y%,s%,g%
          RBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          RBOX x%,y%,s%,g%
          RBOX 639-x%,y%,639-s%,g%
          RBOX x%,399-y%,s%,399-g%
          RBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          RBOX x%,y%,s%,g%
          RBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PRBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          PRBOX x%,y%,s%,g%
          PRBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,y%,639-s%,g%
          PRBOX x%,399-y%,s%,399-g%
          PRBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF krank%=3
    IF ABS(x%-s%)>ABS(y%-g%)
      g%=y%-(ABS(x%-s%)*SGN(y%-g%))
    ELSE
      s%=x%-(ABS(y%-g%)*SGN(x%-s%))
    ENDIF
    IF ka%=1
      IF fu%=1
        IF s_modus_1%=0
          BOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          BOX x%,y%,s%,g%
          BOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          BOX x%,y%,s%,g%
          BOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          BOX x%,y%,s%,g%
          BOX 639-x%,y%,639-s%,g%
          BOX x%,399-y%,s%,399-g%
          BOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          BOX x%,y%,s%,g%
          BOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          PBOX x%,y%,s%,g%
          PBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          PBOX x%,y%,s%,g%
          PBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          PBOX x%,y%,s%,g%
          PBOX 639-x%,y%,639-s%,g%
          PBOX x%,399-y%,s%,399-g%
          PBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          PBOX x%,y%,s%,g%
          PBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
    ENDIF
    IF ka%=2
      IF fu%=1
        IF s_modus_1%=0
          RBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          RBOX x%,y%,s%,g%
          RBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          RBOX x%,y%,s%,g%
          RBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          RBOX x%,y%,s%,g%
          RBOX 639-x%,y%,639-s%,g%
          RBOX x%,399-y%,s%,399-g%
          RBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          RBOX x%,y%,s%,g%
          RBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
      IF fu%=2
        IF s_modus_1%=0
          PRBOX x%,y%,s%,g%
        ENDIF
        IF s_modus_1%=1
          PRBOX x%,y%,s%,g%
          PRBOX x%,399-y%,s%,399-g%
        ENDIF
        IF s_modus_1%=2
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,y%,639-s%,g%
        ENDIF
        IF s_modus_1%=3
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,y%,639-s%,g%
          PRBOX x%,399-y%,s%,399-g%
          PRBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
        IF s_modus_1%=4
          PRBOX x%,y%,s%,g%
          PRBOX 639-x%,399-y%,639-s%,399-g%
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF krank%=4
    IF fu%=1
      IF s_modus_1%=0
        CIRCLE x%,y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=1
        CIRCLE x%,y%,ABS(s%-x%)
        CIRCLE x%,399-y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=2
        CIRCLE x%,y%,ABS(s%-x%)
        CIRCLE 639-x%,y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=3
        CIRCLE x%,y%,ABS(s%-x%)
        CIRCLE 639-x%,y%,ABS(s%-x%)
        CIRCLE x%,399-y%,ABS(s%-x%)
        CIRCLE 639-x%,399-y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=4
        CIRCLE x%,y%,ABS(s%-x%)
        CIRCLE 639-x%,399-y%,ABS(s%-x%)
      ENDIF
    ENDIF
    IF fu%=2
      IF s_modus_1%=0
        PCIRCLE x%,y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=1
        PCIRCLE x%,y%,ABS(s%-x%)
        PCIRCLE x%,399-y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=2
        PCIRCLE x%,y%,ABS(s%-x%)
        PCIRCLE 639-x%,y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=3
        PCIRCLE x%,y%,ABS(s%-x%)
        PCIRCLE 639-x%,y%,ABS(s%-x%)
        PCIRCLE x%,399-y%,ABS(s%-x%)
        PCIRCLE 639-x%,399-y%,ABS(s%-x%)
      ENDIF
      IF s_modus_1%=4
        PCIRCLE x%,y%,ABS(s%-x%)
        PCIRCLE 639-x%,399-y%,ABS(s%-x%)
      ENDIF
    ENDIF
  ENDIF
  IF krank%=5
    IF fu%=1
      IF s_modus_1%=0
        ELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=1
        ELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=2
        ELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE 639-x%,y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=3
        ELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE 639-x%,y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE x%,399-y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE 639-x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=4
        ELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        ELLIPSE 639-x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
    ENDIF
    IF fu%=2
      IF s_modus_1%=0
        PELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=1
        PELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=2
        PELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE 639-x%,y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=3
        PELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE 639-x%,y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE x%,399-y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE 639-x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
      IF s_modus_1%=4
        PELLIPSE x%,y%,ABS(s%-x%),ABS(g%-y%)
        PELLIPSE 639-x%,399-y%,ABS(s%-x%),ABS(g%-y%)
      ENDIF
    ENDIF
  ENDIF
RETURN
PROCEDURE spruhdose_2
  @b_i
  REPEAT
    PRINT AT(2,2);"SprÅhradius festlegen"
    x%=MOUSEX
    @b_s
    CLS
    d%=ABS(x%-319)/2
    CIRCLE 319,199,d%
  UNTIL MOUSEK=1
  @b_o
  MUL d%,2
  REPEAT
    MOUSE x%,y%,k%
    IF MOUSEK=1
      FOR i=1 TO 6
        xx%=-d%/2+RANDOM(d%)
        yy%=-d%/2+RANDOM(d%)
        l%=SQR(xx%*xx%+yy%*yy%)
        IF l%<=d%/2
          DRAW x%+xx%,y%+yy%
        ENDIF
      NEXT i
    ENDIF
  UNTIL MOUSEK=2
RETURN
PROCEDURE lupe_3
  @b_i
  REPEAT
    x%=MOUSEX
    y%=MOUSEY
    @b_s
    GOSUB rahmung(1)
    BOX x%,y%,x%+32,y%+32
    IF MOUSEK=1
      @b_o
      @lupe_darstellen
      @b_i
    ENDIF
  UNTIL MOUSEK=2
  @b_o
RETURN
PROCEDURE lupe_darstellen
  GET x%,y%,x%+31,y%+31,block$
  DEFLINE 1,0,0,0
  DEFFILL 1,0,0
  PBOX 199,98,557,357
  BOX 298,98,297,356
  GET 200,100,206,106,b$
  xa%=231
  ya%=121
  PUT xa%,ya%,block$
  DEFTEXT 1,0,0,13
  TEXT 204,330,"LUPE"
  DEFTEXT 1,0,0,4
  TEXT 204,344,"ESC = ABBRUCH"
  FOR j%=ya% TO ya%+31
    FOR i%=xa% TO xa%+31
      IF POINT(i%,j%)=1
        yy%=(j%-ya%)*8+100
        xx%=(i%-xa%)*8+300
        PUT xx%,yy%,b$,12
      ENDIF
    NEXT i%
  NEXT j%
  DO
    x=MOUSEX
    y=MOUSEY
    k=MOUSEK
    t$=INKEY$
    EXIT IF t$=CHR$(27)
    IF x>300 AND x<554 AND y>100 AND y<354 AND k<>0
      xx%=INT((x-300)/8)
      yy%=INT((y-100)/8)
      IF k=1
        COLOR 1
      ELSE
        COLOR 0
      ENDIF
      DRAW xx%+xa%,yy%+ya%
      xx%=xx%*8+300
      yy%=yy%*8+100
      IF k=1
        PUT xx%,yy%,b$,12
      ELSE
        PUT xx%,yy%,b$
      ENDIF
    ENDIF
  LOOP
  GET xa%,ya%,xa%+31,ya%+31,block$
  COLOR 1
  GOSUB merge_bild
  PUT x%,y%,block$
  GOSUB zeige_bild
  CLR x,y,k,block$,b$,l%,t$,xa%,ya%,xx%,yy%,i%,j%
RETURN
PROCEDURE raster
  CLR x1%,y1%,x2%,y2%,flag%,xl%,yl%
  @b_i
  REPEAT
    MOUSE x1%,y1%,k%
    @b_s
  UNTIL k%<>0
  IF k%=1
    REPEAT
    UNTIL MOUSEK=0
    REPEAT
      MOUSE x%,y%,k%
      MOUSE x2%,y2%,k%
      @b_s
      BOX x1%,y1%,x%,y%
    UNTIL k%<>0
  ENDIF
  IF k%=1
    xl%=ABS(x1%-x2%)
    yl%=ABS(y1%-y2%)
  ENDIF
  @b_o
RETURN
PROCEDURE radierer
  IF rad2%=0
    ALERT 3,"Radiergummi - Form ? ",3,"Eckig|Rund|ZurÅck",rad3%
  ENDIF
  IF rad3%=3
    GOTO rad3
  ENDIF
  REPEAT
    MOUSE x%,y%,k%
  UNTIL MOUSEK=1
  @raster
  @b_i
  DEFFILL 1,0,0
  REPEAT
    x%=MOUSEX
    y%=MOUSEY
    @b_s
    IF MOUSEK=1
      GOSUB rahmung(0)
      IF rad3%=1
        PBOX x%,y%,x%+xl%,y%+yl%
      ENDIF
      IF rad3%=2
        PRBOX x%,y%,x%+xl%,y%+yl%
      ENDIF
      GOSUB rahmung(1)
      GOSUB zeige_bild
      IF rad3%=1
        BOX x%,y%,x%+xl%,y%+yl%
      ENDIF
      IF rad3%=2
        RBOX x%,y%,x%+xl%,y%+yl%
      ENDIF
    ELSE
      IF rad3%=1
        PBOX x%,y%,x%+xl%,y%+yl%
      ENDIF
      IF rad3%=2
        PRBOX x%,y%,x%+xl%,y%+yl%
      ENDIF
    ENDIF
  UNTIL MOUSEK=2
  @b_o
  rad3:
  DEFFILL 1,v%,f%
  GOSUB rahmung(c%)
RETURN
PROCEDURE lasso_2
  ERASE bild$()
  ALERT 3,"Was hÑtten Sie den gern?|1 = Lasso bewegen|2 = Rahmen bewegen",3,"Lasso|Rahmen|ZurÅck",move%
  IF move%=3
    GOTO hammer
  ENDIF
  DIM bild$(4)
  @lasso_umfahren
  @lasso_kopieren
  ERASE x%()
  ERASE y%()
  ERASE bild$()
  GOSUB grund
  hammer:
RETURN
PROCEDURE lasso_umfahren
  CLR i,exo!,n%,n,j,j1%,j2%,i1%,i2%,i1,i2,d%
  fr%=10
  ERASE x%()
  ERASE y%()
  DIM x%(502),y%(502)
  DEFFILL 1,1,1
  GRAPHMODE 3
  REPEAT
    MOUSE x,y,k
    INC d%
    IF MOUSEK=1 AND d%>20
      IF x<>x% OR y<>y%
        CLR d%
        IF i>0
          x1%=x%
          y1%=y%
        ELSE
          x1%=x
          y1%=y
        ENDIF
        x%=x
        y%=y
        INC i
        x%(i)=x%
        y%(i)=y%
        DRAW x%,y%
        DRAW x1%,y1% TO x%,y%
      ENDIF
      IF i>10
        IF INT(x%(1)/fr%)*fr%=INT(x%(i)/fr%)*fr% AND INT(y%(1)/fr%)*fr%=INT(y%(i)/fr%)*fr%
          exo!=TRUE
        ENDIF
      ENDIF
    ENDIF
  UNTIL i>499 OR exo!=TRUE OR MOUSEK=2
  GRAPHMODE 1
  IF i<3
    GOTO abbrechen
  ENDIF
  CLR d%
  n=i+1
  x%(n)=x%(1)
  y%(n)=y%(1)
  CLR k,maxx,maxy
  minx=1000
  miny=1000
  maxx=1
  maxy=1
  n%=i
  FOR j%=1 TO n
    maxx=MAX(maxx,x%(j%))
    maxy=MAX(maxy,y%(j%))
    minx=MIN(minx,x%(j%))
    miny=MIN(miny,y%(j%))
  NEXT j%
  xl%=ABS(maxx-minx)
  yl%=ABS(maxy-miny)
  IF xl%>6 AND yl%>6 AND n>2 AND k<>2
    @lasso_erzeugen
  ENDIF
  abbrechen:
RETURN
PROCEDURE lasso_erzeugen
  IF move%=1
    GET minx,miny,maxx,maxy,bild$(3)
  ENDIF
  CLS
  FOR i=1 TO n-1
    DRAW x%(i),y%(i) TO x%(i+1),y%(i+1)
  NEXT i
  BOX minx-2,miny-2,maxx+2,maxy+2
  IF minx>2
    FILL minx-1,miny-1
  ELSE
    FILL maxx+1,maxy+1
  ENDIF
  GET minx,miny,maxx,maxy,bild$(2)
  PUT minx,miny,bild$(3),2
  GET minx,miny,maxx,maxy,bild$(3)
  IF km%=2
    CLS
    DEFFILL 1,0,0
    BOX minx-2,miny-2,maxx+2,maxy+2
    PUT minx,miny,bild$(3),2
    DEFFILL 1,1,1
    FILL minx-1,miny-1
    PUT minx,miny,bild$(3),4
    GET minx,miny,maxx,maxy,bild$(2)
  ENDIF
RETURN
PROCEDURE lasso_kopieren
  LOCAL x,y,b$,i,k
  IF move%=1
    PUT minx,miny,bild$(3),6
  ENDIF
  @b_i
  REPEAT
  UNTIL MOUSEK=0
  REPEAT
    MOUSE x,y,k
    @b_s
    PUT x,y,bild$(2),1
    PUT x,y,bild$(3),7
    IF k=1
      GOSUB zeige_bild
    ENDIF
  UNTIL k=2
  @b_o
RETURN
PROCEDURE bild_konverter_2
  RESTORE konvert_dat
  screen$=""
  DO
    READ a19%
    EXIT IF a19%<0
    screen$=screen$+MKI$(a19%)
  LOOP
  VOID FRE(0)
  konvert_dat:
  DATA 16188,3,20046,21647,8256,12335,4,12847
  DATA 6,26368,174,21313,26494,21312,27396,26376
  DATA 20085,9800,24866,8267,12348,199,29223,8776
  DATA 13016,16152,20937,65530,29223,8776,13087,20937
  DATA 65532,20936,65512,20085,12348,3999,11288,11800
  DATA 29191,56390,55107,56903,55107,20937,65526,29191
  DATA 56390,56133,56903,56133,20937,65526,18502,18503
  DATA 29191,56390,54594,56903,54594,20937,65526,29191
  DATA 56390,55620,56903,55620,20937,65526,18600,60
  DATA 65528,20936,65464,20085,21312,27564,26402,12348
  DATA 199,29223,17384,80,16161,20937,65532,17384
  DATA 80,29223,12511,12505,20937,65530,20936,65508
  DATA 20085,21312,26376,27474,9800,25042,8267,12348
  DATA 3999,19600,60,29191,54338,56646,54338,57159
  DATA 20937,65526,29191,55364,56646,55364,57159,20937
  DATA 65526,18502,18503,29191,54851,56646,54851,57159
  DATA 20937,65526,29191,55877,56646,55877,57159,20937
  DATA 65526,8390,8391,20936,65466,20085
  DATA -1
  BLOAD f$,XBIOS(2)-34
  HIDEM
  screen%=VARPTR(screen$)
  VOID C:screen%(1,2)
  SHOWM
RETURN
PROCEDURE bild_manipulator
  LOCAL d%,a%,b%,c%,x%,marta_5%,block$,u$
  HIDEM
  startab:
  IF c%=0
    c%=1
  ENDIF
  ALERT 0," ~~~~ Verfremdungseffekt ~~~~ |Nr "+STR$(c%)+"|",2,"Grîûer|OK|Kleiner",d%
  REPEAT
    IF d%=1
      INC c%
      GOTO startab
    ENDIF
    IF d%=3
      DEC c%
      GOTO startab
    ENDIF
  UNTIL d%=2
  marta_5%=7
  startab1:
  ALERT 0," ~~~~~~ Zeichenmodus ~~~~~~ |Modus "+STR$(marta_5%)+"|",2,"Grîûer|OK|Kleiner",d%
  REPEAT
    IF d%=1
      INC marta_5%
      GOTO startab1
    ENDIF
    IF d%=3
      DEC marta_5%
      GOTO startab1
    ENDIF
  UNTIL d%=2
  GOSUB zeige_bild
  REPEAT
    INC y%
    b%=y%+c%
    INC b%
    GET 0,b%,639,b%,block$
    PUT 0,y%,block$,2
  UNTIL y%=399 OR MOUSEK>0
  GET 0,0,639,399,u$
  GOSUB merge_bild
  REPEAT
    INC x%
    a%=x%+c%
    INC a%
    GET a%,0,a%,399,block$
    PUT x%,0,block$,3
  UNTIL x%=639 OR MOUSEK>0
  PUT 0,0,u$,marta_5%
RETURN
PROCEDURE bezier
  GOSUB merge_bild
  LOCAL a$,b$,i%,px,py,qx,qy,rx,ry,j%,delta,m,xold,yold
  ERASE px()
  ERASE py()
  ERASE qx()
  ERASE qy()
  ERASE rx()
  ERASE ry()
  IF bezier_punkte=0
    bezier_punkte=2
  ENDIF
  DIM px(bezier_punkte),py(bezier_punkte),qx(bezier_punkte),qy(bezier_punkte),rx(bezier_punkte),ry(bezier_punkte)
  SHOWM
  i%=TRUE
  REPEAT
    INC i%
    REPEAT
      px(i%)=MOUSEX
      py(i%)=MOUSEY
    UNTIL MOUSEK=1
    REPEAT
    UNTIL MOUSEK=0
    HIDEM
    DRAW px(i%),py(i%)
    IF i%<>0
      DRAW px(i%-1),py(i%-1) TO px(i%),py(i%)
    ENDIF
    SHOWM
  UNTIL i%=bezier_punkte
  bezier1$=UPPER$(bezier1$)
  IF NOT bezier1$="E"
    GOSUB merge_bild
  ENDIF
  delta=0.01
  xold=px(0)
  yold=py(0)
  t=-delta
  WHILE t<1
    ADD t,delta
    m=bezier_punkte
    i%=TRUE
    REPEAT
      INC i%
      qx(i%)=px(i%)
      qy(i%)=py(i%)
    UNTIL i%=m
    WHILE m>0
      j%=TRUE
      REPEAT
        INC j%
        rx(j%)=qx(j%)+t*(qx(j%+1)-qx(j%))
        ry(j%)=qy(j%)+t*(qy(j%+1)-qy(j%))
      UNTIL j%=m-1
      DEC m
      j%=TRUE
      REPEAT
        INC j%
        qx(j%)=rx(j%)
        qy(j%)=ry(j%)
      UNTIL j%=m
    WEND
    DRAW xold,yold TO qx(0),qy(0)
    facher$=UPPER$(facher$)
    IF facher$="S"
      xold=qx(0)
      yold=qy(1)
    ELSE
      IF facher$="E"
        xold=qx(bezier_punkte)
        yold=qy(bezier_punkte)
      ELSE
        xold=qx(0)
        yold=qy(0)
      ENDIF
    ENDIF
  WEND
  ERASE px()
  ERASE py()
  ERASE qx()
  ERASE qy()
  ERASE rx()
  ERASE ry()
RETURN
PROCEDURE bezier_modus
  GOSUB clipping_aus
  GOSUB grund1
  PRINT AT(28,8);"      Bezier Modus       "
  PRINT CHR$(27)+"q";
  PRINT AT(28,9);"-- fÅr Bezier - Kurven --"
  PRINT AT(29,11);"Rahmen Ein/Aus   (E/A)   "
  PRINT AT(29,12);bezier1$
  PRINT AT(47,12);
  FORM INPUT 1,bezier1$
  PRINT AT(29,13);"Anzahl der Punkte       "
  PRINT AT(29,14);bezier2$
  PRINT AT(47,14);
  FORM INPUT 5,bezier2$
  PRINT AT(29,15);"FÑcher Ein/Aus/Spez      "
  PRINT AT(29,16);"                 (E/A/S)"
  PRINT AT(29,17);facher$
  PRINT AT(47,17);
  FORM INPUT 1,facher$
  bezier_punkte=VAL(bezier2$)
  IF bezier_punkte=0
    bezier_punkte=3
  ENDIF
  DEC bezier_punkte
  GOSUB was1
RETURN
PROCEDURE tta
  CHDRIVE lauf%
  GOSUB clipping_aus
  ALERT 3,"Wollen sie dieses schîne|  Grafikprogramm jetzt |wirklich schon verlassen  |?????..............?????",2,"Ja|Nein",dass%
  IF dass%=1
    CLOSE #1
    SLPOKE 1156,TRUE
    IF gitarre%=1
      END
    ENDIF
    erlaufer=BIOS(&HA)
    erlauf%=LEN(BIN$(erlaufer))
    IF erlauf%>2
      IF FRE(FALSE)<&H30D40
        CHDRIVE lauf%
        END
      ELSE
        IF gitarre%=0
          ALERT 3,"---- Automatisches ----| Ramdisk und Harddisk|  Sicherungsprogramm",2," Ein | Aus ",gitarre%
          IF gitarre%=1
            RESERVE FRE(FALSE)-&H30D40
            GRAPHMODE 1
            GOSUB clipping_an
            DIM para$(50)
            CLS
            erlaufer=BIOS(&HA)
            erlauf%=LEN(BIN$(erlaufer))
            CLR eingabe$
            HIDEM
            PRINT AT(1,5);CHR$(27)+"p";" --- (c) 1998 by Siegfried HÅbner, St.-Gundekar-Str. 29 b, 91560 Heilsbronn --- ";CHR$(27)+"q"
            DEFTEXT 1,2,3,32
            TEXT 220,30,"Automatisches"
            TEXT 120,58,"Ramdisk Sicherungsprogramm"
            IF erlauf%=3
              PRINT AT(1,6);"Im Laufwerk C sind ";DFREE(3);" frei."
            ENDIF
            IF erlauf%=4
              PRINT AT(1,6);"Im Laufwerk C sind ";DFREE(3);" frei."
              PRINT AT(1,7);"Im Laufwerk D sind ";DFREE(4);" frei."
            ENDIF
            IF erlauf%=5
              GOSUB hamster
            ENDIF
            IF erlauf%=6
              GOSUB hamster
              PRINT AT(1,9);"Im Laufwerk F sind ";DFREE(6);" frei."
            ENDIF
            IF erlauf%=7
              GOSUB hamster
              PRINT AT(1,9);"Im Laufwerk F sind ";DFREE(6);" frei."
              PRINT AT(1,10);"Im Laufwerk G sind ";DFREE(7);" frei."
            ENDIF
            IF erlauf%=8
              GOSUB hamster
              PRINT AT(1,9);"Im Laufwerk F sind ";DFREE(6);" frei."
              PRINT AT(1,10);"Im Laufwerk G sind ";DFREE(7);" frei."
              PRINT AT(1,11);"Im Laufwerk H sind ";DFREE(8);" frei."
            ENDIF
            IF erlauf%=9
              GOSUB hamster
              PRINT AT(1,9);"Im Laufwerk F sind ";DFREE(6);" frei."
              PRINT AT(1,10);"Im Laufwerk G sind ";DFREE(7);" frei."
              PRINT AT(1,11);"Im Laufwerk H sind ";DFREE(8);" frei."
              PRINT AT(1,12);"Im Laufwerk I sind ";DFREE(9);" frei."
            ENDIF
            IF erlauf%=10
              GOSUB bach
            ENDIF
            IF erlauf%=11
              GOSUB bach
              PRINT AT(1,14);"Im Laufwerk K sind ";DFREE(11);" frei."
            ENDIF
            IF erlauf%=12
              GOSUB bach
              PRINT AT(1,14);"Im Laufwerk K sind ";DFREE(11);" frei."
              PRINT AT(1,15);"Im Laufwerk L sind ";DFREE(12);" frei."
            ENDIF
            IF erlauf%=13
              GOSUB schnecke
            ENDIF
            IF erlauf%=14
              GOSUB schnecke
              PRINT AT(1,17);"Im Laufwerk N sind ";DFREE(14);" frei."
            ENDIF
            IF erlauf%=15
              GOSUB schnecke
              PRINT AT(1,17);"Im Laufwerk N sind ";DFREE(14);" frei."
              PRINT AT(1,18);"Im Laufwerk O sind ";DFREE(15);" frei."
            ENDIF
            IF erlauf%=16
              GOSUB schnecke
              PRINT AT(1,17);"Im Laufwerk N sind ";DFREE(14);" frei."
              PRINT AT(1,18);"Im Laufwerk O sind ";DFREE(15);" frei."
              PRINT AT(1,19);"Im Laufwerk P sind ";DFREE(16);" frei."
            ENDIF
            ' ******* Ermittle Laufwerk *******
            rlaufer=BIOS(&HA)
            rlauf%=LEN(BIN$(rlaufer))
            laufnn:
            IF laufi%=FALSE
              laufi%=1
            ENDIF
            CHDRIVE laufi%
            ALERT 1,"Wohin wollen Sie alle Daten|der Ramdisk's abspeichern|--- welches Laufwerk ? --- |      Laufwerk "+CHR$(64+laufi%)+" ",2,"Grîûer|OK|Kleiner",d%
            IF d%=1
              INC laufi%
              IF laufi%=>rlauf%
                laufi%=rlauf%
              ENDIF
              GOTO laufnn
            ENDIF
            IF d%=3
              IF laufi%=FALSE
                laufi%=1
              ENDIF
              DEC laufi%
              GOTO laufnn
            ELSE
              CHDRIVE laufi%
            ENDIF
            GRAPHMODE 2
            DEFFILL 1,2,3
            PBOX 330,170,600,380
            DEFFILL 1,FALSE,2
            PBOX 335,175,595,375
            GRAPHMODE 2
            PRINT AT(43,12);SPACE$(32)
            PRINT AT(43,13);SPACE$(32)
            PRINT AT(43,12);"   Im Laufwerk "+CHR$(64+laufi%)+" sind noch"
            PRINT AT(43,13);"   ";DFREE(laufi%);" Bytes frei."
            PRINT AT(43,15);"    Was wollen Sie machen ?     "
            PRINT AT(43,17);SPACE$(5);"E = Einzelsicherung        "
            PRINT AT(43,18);SPACE$(5);"A = Automatische Sicherung "
            PRINT AT(43,19);SPACE$(5);"N = Keine Sicherung        "
            startschuss:
            PRINT AT(68,21);"A"
            PRINT AT(43,21);"Ihre Wahl (E,A oder N) ";
            eingabe$=INKEY$
            eingabe$=UPPER$(eingabe$)
            IF eingabe$="N"
              CHDRIVE lauf%
              END
            ENDIF
            IF eingabe$="E" OR eingabe$="A"
              DO
                CLS
                IF laufi%=FALSE
                  laufi%=1
                ENDIF
                tusche:
                IF erlauf%=laufi%
                  DEC erlauf%
                ENDIF
                ALERT 3,"Leere Formatierte Disk|in Laufwerk "+CHR$(64+laufi%)+" einlegen|   zum sichern von   |     Laufwerk "+CHR$(64+erlauf%),1,"Sichern|Inhalt|No Save",d%
                IF d%=3
                  GOTO warmhalte
                ENDIF
                IF d%=2
                  CLS
                  PRINT AT(2,1);"Inhalt von Laufwerk ";CHR$(64+erlauf%)
                  CHDRIVE erlauf%
                  FILES
                  GOTO tusche
                ENDIF
                CLS
                PRINT AT(1,1);"Copy von Ramdisk ";CHR$(64+laufi%)
                CHDRIVE erlauf%
                lin$="copy *.* "+CHR$(64+laufi%)+":"
                lin$=UPPER$(lin$)
                IF INSTR(lin$," ")
                  DO
                    lx%=INSTR(lin$," ")
                    EXIT IF lx%=FALSE
                    para$(para%)=LEFT$(lin$,lx%-1)
                    lin$=RIGHT$(lin$,LEN(lin$)-lx%)
                    INC para%
                  LOOP
                  para$(para%)=lin$
                  INC para%
                ENDIF
                dta$=SPACE$(44)
                VOID GEMDOS(&H1A,L:VARPTR(dta$))
                fehler%=GEMDOS(&H4E,L:VARPTR(para$(1)),&H3F)
                REPEAT
                  quell$=RIGHT$(dta$,14)
                  ziel$=para$(2)+quell$
                  IF eingabe$="A"
                    PRINT "Copy ";quell$;" to  ";ziel$
                  ENDIF
                  IF eingabe$="E"
                    PRINT "Copy ";quell$;" to  ";ziel$;"     ";CHR$(27)+"p";
                    harry_larry:
                    PRINT "Copieren (J/N) ";CHR$(27)+"q";" ";
                    copy$=INKEY$
                    copy$=UPPER$(copy$)
                    IF copy$="J"
                      GOTO weitertuki
                    ENDIF
                    IF copy$="N"
                      GOTO zukkontrol
                    ELSE
                      GOTO harry_larry
                    ENDIF
                    weitertuki:
                  ENDIF
                  ON ERROR GOSUB fehlerio1
                  OPEN "I",#1,quell$
                  ON ERROR GOSUB fehlerio1
                  leng%=LOF(#1)
                  ON ERROR GOSUB fehlerio1
                  BGET #1,HIMEM,leng%
                  ON ERROR GOSUB fehlerio1
                  CLOSE #1
                  ON ERROR GOSUB fehlerio1
                  OPEN "O",#1,ziel$
                  ON ERROR GOSUB fehlerio1
                  BPUT #1,HIMEM,leng%
                  ON ERROR GOSUB fehlerio1
                  zukkontrol:
                  CLOSE #1
                  MID$(dta$,31)=SPACE$(14)
                  fehler%=GEMDOS(&H4F)
                UNTIL fehler%
                warmhalte:
                DEC erlauf%
                IF erlauf%=<2
                  CHDRIVE lauf%
                  END
                ENDIF
              LOOP
            ENDIF
            GOSUB clipping_an
            GOTO startschuss
            ERASE para$()
            GOSUB grund
            RESERVE FRE(FALSE)+&H30D40
            CHDRIVE lauf%
            END
          ENDIF
          END
        ENDIF
        CHDRIVE lauf%
      ENDIF
    ENDIF
    END
  ENDIF
  GOSUB clipping_an
RETURN
PROCEDURE infob
  CLS
  HIDEM
  BOX 10,10,630,390
  BOX 12,12,628,388
  BOX 13,13,627,387
  PRINT AT(4,2);"Benutzerhinweise zum Programm   Sigi Painter Version 98 vom 01.10.1998"
  PRINT AT(4,3);STRING$(75,"=")
  PRINT AT(4,4);"Letzte Bearbeitung 22.01.2022  (FREEWARE)"
  PRINT AT(4,5);STRING$(75,"=")
  PRINT AT(4,6);"Dieses Programm ist frei kopierbar das Listing auch (Freeware)"
  PRINT AT(4,7);"und kann kostenlos weitergegeben verÑndert verbessert,"
  PRINT AT(4,8);"und erweitert werden."
  PRINT AT(4,9);"Diese Programm wurde in GFA Basic 2.0 geschrieben"
  PRINT AT(4,10);"Angefangen hat alles mit einen Atari 520+ mit TOS 1.0 sw-Monitor"
  PRINT AT(4,11);"Diese Programmversion war die letzte Version 98 vom 01.10.1998"
  PRINT AT(4,12);"Am 22.01.2022 wurde die Adresse geÑndert da ich umgezogen bin"
  PRINT AT(4,13);"wird jetzt mit EMUTOS Betriebssystem weiterentwickelt"
  PRINT AT(4,14);"Ein paar Funktionen laufen leider noch nicht unter EMUTOS"
  PRINT AT(4,15);"Wer VerbesserungsvorschlÑge oder GFA 2.0 Routinen hat"
  PRINT AT(4,16);"Die ich noch einbauen kann oder lîschen soll bitte bei mit melden."
  PRINT AT(4,17);STRING$(75,"=")
  PRINT AT(4,18);"Meine Adresse        Siegfried HÅbner"
  PRINT AT(4,19);STRING$(21,32);"St.-Gundekar-Str, 29 b"
  PRINT AT(4,20);STRING$(21,32);"91560 Heilsbronn"
  PRINT AT(4,21);"EMAIL: gott.liebt.dich.auch (at) gmail.com"
  PRINT AT(4,22);STRING$(75,"=")
  PRINT CHR$(27)+"p";
  PRINT AT(4,23);" Bitte eine Taste drÅcken    "
  REPEAT
  UNTIL MOUSEK>0 OR INKEY$>CHR$(0)
  PRINT CHR$(27)+"q";
  SHOWM
  CLS
RETURN