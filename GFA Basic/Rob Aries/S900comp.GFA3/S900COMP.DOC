The S900 Companion is a program for Atari ST/STe computers that allows
easy editing of Akai S900 programs.  It runs in either medium or high ST
resolution and needs at least a one megabyte machine to run.

The S900 Companion doesn't edit samples, the sample parameters, the drum
triggers (if installed), or anything else other than what's shown under
the "edit program" menu button on the S900.  The program has been tested
with versions 1.2 and 2.0 of the sampler's operating system.  The extra
program parameters added with version 2.0 (filter ADSR, etc.) are
supported, however the S900 Companion can't tell which operating system
is installed in the sampler.  Editing the v2.0 parameters with v1.0 or
1.2 software in the S900 will have no audible result.

Sorry, this program won't work with the S950!

Also, this documentation does not deal with the operation of the sampler,
or what the various parameters are and how they work!


DISCLAIMER
----------

This software is offered as is.  Use it at your own risk.  I CANNOT BE
RESPONSIBLE FOR ANY KINDS OF DAMAGES CAUSED OR THOUGHT TO BE CAUSED BY THE
S900 COMPANION.


OVERVIEW
--------

The S900 doesn't support system-exclusive "parameter change" messages,
meaning that it can't be edited from a computer like a typical
synthesizer.  Instead, an S900 program is requested into the S900
Companion; all edits take place there.  When finished, the program is sent
back to the sampler where it should be saved on the S900's own disk.

I call the space where an S900 program is requested to and sent from the
CURRENT program.  In addition, the S900 Companion maintains space for a
second S900 program which I call the COMPOSITE program.  The main page of
the S900 Companion shows two boxes which display the keygroups of these
programs.

One way to create the COMPOSITE program is by copying keygroups from the
Current program.  By requesting different S900 programs to the Current
program and choosing keygroups to copy, a new "composite" program is
formed.  This is similar, but much more convenient, to the "put" and "get"
feature of the S900's v2.0 operating system.

The S900 Companion maintains ten KEYGROUP EDIT BUFFERS, any one of which
is displayed on the KEYGROUP EDIT PAGE.  This is where actual parameter
editing takes place.  When in this page, an S900 program called "*Work
Buf*" is created and sent to the sampler.  This program consists only of
the keygroup you're editing.  With each edit you do, it's re-sent to the
sampler.  Using the right mouse button (or your midi controller), you can
"play" this keygroup to monitor the results of your edits.

I chose this method because a program must be "checksummed" before it's
sent to the S900.  Checksumming a program that consists of only one
keygroup is almost instantaneous; in my opinion, this was the best way to
implement parameter editing on a module that doesn't actually support it!

Keygroup edit buffers can contain keygroups copied from the Current or
Composite program.  They can also be initialized from scratch in order to
create a new S900 program.  When finished editing, the keygroup edit
buffer is copied back to either main page program; if it was originally
copied from a main page program, it can REPLACE the keygroup it was copied
from (the usual editing situation), or it can be ADDED to the main page
program, creating a new keygroup.  This introduces a concept I call
"linking" which is detailed further in this documentation.  In short, I
decided to make things a bit more complex in the interest of flexibility.

In addition to the MAIN and KEYGROUP EDIT page, the S900 Companion has
the OUTPUT MAP PAGE, where a graphic representation of the output routing
of either the Current or Composite program's keygroups is shown.  Output
routing can be edited with simple click & drag operations.

The S900 Companion has on-line help, and the ability to save a "snapshot"
file on exit.  This lets you use the S900 Companion from another program
(such as a sequencer) and retain all its data.

The S900 Companion was originally programmed in GFA Basic 2.0; this
version was re-compiled under version 3.5.  Due to my profound lack of
knowledge regarding GEM, desk accessories are supported in a very "dirty"
way -- they'll work, but the screen will be corrupted.  To restore the
screen after using a DA, move the mouse to very bottom and click. I
apologize for this, but it seemed better than simply disabling desk
accessories completely.


STARTING THE PROGRAM
--------------------

If you use a mono monitor, you'll be treated to a demonstration of my
artistic abilities.  Click on the sampler's "power" switch to get into
the program's main page!

There are a few other minor differences between mono & color operation of
the S900 Companion which will be noted at appropriate points in this doc
file.

Remember, all edit operations take place on data *in the computer*.  When
you're done editing, the Current program *must be sent back to the
sampler and saved on the S900's own disk!*


Message boxes

There are many instances where the S900 Companion puts up a small "message
box" to tell you something, or confirm an operation.  These are similar to
informational alerts, except you don't need to click an "OK" button or hit
the <return> key to clear the box; they disappear after a second or two.
Many of these can also be cleared at any point by pressing any key, which
you may appreciate after using the program a while.

THE MAIN PAGE
-------------

The main page screen shows the two S900 program boxes ("Current" and
"Composite"), some buttons, and a standard GEM menu bar.  The program
boxes will be empty; to edit an existing S900 program you'll need to
request it from the sampler.  What follows applies mostly to editing an
existing program; creating one from scratch involves going into the
keygroup edit page and initializing a keygroup edit buffer.  This process
is described in the section on the keygroup edit page, later in this
documentation.

Before you start, the basic midi channel in your S900 must match the
channel that's check-marked under the "Midi Chan." menu, and there must
be two-way midi communication between the computer and sampler.  The
selected midi channel can be saved in a configuration file that the S900
Companion looks for and loads when it boots.

A midi controller can be used with the S900 Companion; see the last
section of this doc file for details.


Requesting a program from the S900

This is the first step in editing an existing S900 program.  Select "Get
Program" from the File menu; the Current program box should display a
list of all the programs in the sampler.  Click on the program you'd like
to work with, or anywhere *but* on a program name to abort.

(If a Current program already exists, an alert box will confirm your
action, as the existing Current program will be overwritten by the one you
request.  You may also see a small message box stating "Current links
exist" if one or more of the existing Current program's keygroups have
been copied to a keygroup edit buffer for detailed editing; this is simply
a reminder.  The keygroup edit buffers are not affected by requesting or
loading different programs into the Current program space).

When a program has been received by the S900 Companion, its keygroups are
listed in the Current program box.  If there are more than 17 keygroups in
the program, a downward-pointing arrowhead appears at the bottom of the
box; click there to see the remaining keygroups.  The arrowhead changes to
point upwards; click there again to return to the first display, and so
on.


Selecting keygroups for main page edit operations

Clicking on a keygroup selects it (it highlights).  Click on it again to
de-select.  The two buttons under each program box affect selection:
"S.ALL" (select all) does exactly that.  "DESEL" *temporarily* de-selects
any selected keygroups.  When you click there, the keygroups un-highlight,
the button text highlights and changes to "RESEL" (re-select).  Clicking
the button again restores the previous selections and changes the button
text back to "DESEL". <Shift>-clicking on "DESEL" *permanently* de-selects
keygroups.


Main page edit operations

Simple clicks on the three buttons in the middle of the screen affect
*selected* keygroups only.  The "Copy" button with the rightward-pointing
arrow copies all selected keygroups in the Current program to the
Composite program (a Composite program will be created if one doesn't
exist.  Selected keygroups in the Composite program are not affected).
The "Copy" button with the downward-pointing arrow *replicates* selected
keygroups *within* their respective programs.  The "Delete" button trashes
selected keygroups; an alert box will ask for confirmation.  If any of the
selected keygroups have been copied to a keygroup edit buffer for detailed
editing, you'll have the option of excluding them from the delete operation
by clicking "Leave" in the confirming alert box.  Those keygroups will
remain selected after the delete operation.

Two of these buttons have separate shifted functions. <Shift>-clicking on
the upper "Copy" button is a shortcut for copying the *entire* Current
program to the Composite program (keygroup selections are ignored).  If a
Composite program already exists, an alert box asks for confirmation (the
existing Composite program is trashed), otherwize the action is immediate.
<Shift>-clicking on "Delete" is a shortcut for dumping the entire Current
or Composite program.  The confirming alert box will tell you if there are
any links to keygroup edit buffers; unlike the unshifted function, there is
no option to leave the linked keygroups.


Changing a program's name

Click on the name field of either program to copy the other program's
name, or rename it.  The alert & dialog boxes should be self-explanatory.
Unlike the S900, lower-case letters are allowed!


Swapping programs

Oddly enough, that's what the "Swap" button does.  This lets you send the
Composite program to the S900, or save it to disk.  All data dealing with
keygroup selection and link status is swapped as well.


Sending the Current program to the S900

Since the Current and Composite programs exist only in the computer, you
must send them to the sampler when you're finished editing.  Only the
Current program can be sent; to send the Composite program, first click on
the "Swap" button to exchange the two programs.

Pressing the space bar sends the Current program to the sampler
immediately.  An S900 program with the same name will be overwritten; if
no other program in the sampler has the same name, the Current program
will be *added* to those already in the S900, space permitting.

Another method is to select "Send Program" from the file menu.  The
Current program box changes to display a list of all the programs in the
S900.  Click directly on a program name to *replace* that program with the
Current program.  Click anywhere else in the Current program box to *add*
the Current program to those already in the S900 (if it has a different
name from any other program in the sampler).  Click anywhere *outside* the
Current program box to abort.

The first method is intended for straightforward edit operations:  A
program is requested into the S900 Companion, edited, then sent back to
the sampler, replacing the program that was originally requested.  The
second method gives you more flexibility in where your edited program
winds up.

The second method also lets you delete unwanted programs in the sampler;
simply re-send the Current program to the program(s) in the S900 you'd
like to dump.

After the Current program has been sent to the S900, the list of programs
is updated, in order to give visual feedback that the transfer was
successful.  This is useful only if the program you send has a different
name than any already in the sampler, but it's better than nothing!  After
about one second, the Current program box returns to displaying the
keygroup list.


Saving & loading programs to disk

This is done with the corresponding items in the "File" menu, and as with
requesting and sending, affects the *Current program* only.  Files saved
are in midiex (standard system-exclusive) format.  Of course, S900
programs should always be saved with their samples on the S900's own disk,
but this function may be useful if you need temporary storage while
working with other programs, or if you like to archive S900 programs with
your sequence files.

The same conditions apply to loading a program as to requesting one:  If a
Current program already exists, and one or more of its keygroups have been
copied to keygroup edit buffers, you'll see a message box reminding you of
this ("Current links exist!").  Of course, loading a program will
overwrite any existing Current program.  An alert box will confirm this
operation.


Selecting a keygroup for detailed editing

This is done by <shift> or <alt>-clicking on a keygroup, and is explained
in the section describing the keygroup edit page.


Bugs & other things...

The S900 Companion can request and hold a program with up to 34 keygroups.
Unfortunately, the sampler can't handle a program sent via midi with over
29 keygroups.  Because of this, the S900 Companion will limit its copy &
replicate functions to a maximum of 29 keygroups in each program.

The S900 has other space limitations.  The total number of programs,
samples, and keygroups added together can't exceed 66.  It might be
possible to create or edit a program in the S900 Companion that would
exceed this limit when sent to the sampler (depending on what was already
in the S900, of course).  I suggest not loading up the S900 with programs
& samples you won't be needing during a session with the S900 Companion.
(Don't forget that there must also be room for the temporary "*Work Buf*"
program and its samples while on the keygroup edit page).  When in doubt,
give the program you're about to send a unique name, and watch for it when
the program list is updated.  If you see the new name, you can be sure the
transfer was successful.

One more caveat:  The S900 Companion uses program number 32 for the "*Work
Buf*" program while editing keygroups; you should not have an S900 program
at that location or it will be overwritten.


THE OUTPUT MAP PAGE
-------------------

The only way to reach this page is via the corresponding selection in the
Edit menu, on the main page.

The S900 Companion's output map page displays one of three screens,
depending on the type of output assignment the Current or Composite
program uses:  Individual (1-8), stereo (L,R), or mix.  Due to the nature
of the sampler's output routing scheme, it's very unlikely that a single
program would contain keygroups assigned to more than one type of output
(i.e., you wouldn't have some keygroups assigned to individual outputs and
others assigned to the left, right, or mix output).  When you select
"Output Map" (and, if both Current and Composite programs are present,
choose the program you want to work with by answering the alert box), the
S900 Companion examines the output scheme of the program to determine which
of the three screens to use.  If the program finds "mixed types" of output
assignments, you'll get another, custom alert box asking you to choose the
screen to go to.

A program's output *type* can't be changed on this screen--i.e., you
can't change a keygroup from output 6 to the mix output.  You *can* change
outputs *within* a type, of course--say, from output 7 to output 2, or from
the right to the left output.  Changing output types can be done from the
keygroup edit page.

Note that you won't normally hear the effects of changing an output on
this screen, since you're editing the Current or Composite program
directly.  However, if you use a midi controller connected to the Atari,
you'll be able to monitor your edits IF you are editing the outputs in the
*Current* program, AND you press the space bar to send the Current program
to the sampler (as on the main page) after editing the outputs here.  As
described previously, sending the Current program to the S900 this way will
overwrite an existing S900 program with the same name, or create a new
program in the sampler if one with the same name doesn't already exist.
Use caution here, as you could either overwrite a program you didn't mean
to, or exceed the number of allowable keygroups in the S900; in the
latter case, the transfer won't take place and the S900 program you play
with your midi controller will not be "in sync" with the one you're looking
at on the screen!  See the section titled "Using a midi controller to play
the S900" at the end of this documentation, and the previous sections
"Sending the Current program to the S900" and "Bugs & other things..." for
more details.

Copying a keygroup to a keygroup edit buffer, and editing the output
there, will let you hear the result immediately, since it transmits the
updated "*Work Buf*" program to the S900 with each edit.  Of course, the
keygroup edit page only deals with one keygroup at a time, so you lose the
ability to see--and edit--the output routing for the entire program at
once.


The Individual Output Screen

The displayed output routings should be evident; each output has a
corresponding collumn, with room for four "keygroup boxes" that display a
keygroup's sample names and note range.  A small, upward-pointing
arrowhead indicates additional keygroups assigned to that output; click on
the arrowhead to see the next group of keygroups.  A downward-pointing
arrowhead indicates keygroups "below" those currently displayed. <Shift>-
clicking on an arrowhead takes you to the extreme of each range.


The Stereo Output Screen

Each side displays 16 keygroups at a time; you'll see the arrowheads
described in the previous paragraph if there are more keygroups assigned
to a particular side.


The Mix Output Screen

While I can't see much of a reason to display the output routing of a
program whose keygroups are all assigned to *one* output, it's here
nevertheless.  This screen cannot display more than 32 keygroups.


Output Screen Functions

There are three things you can do on an output map page:

1. Change an output assignment (individual and stereo screens only).
   Click on a keygroup box, continue to hold the mouse button, and drag
   the box to the desired collumn (individual screen), or opposite side
   (stereo screen).  While there's no undo, you can abort the output
   change--before releasing the mouse button--by dragging the keygroup
   box back to the *same* output collumn or side that you started from.

   Two keygroups' output assignments can be swapped: <Control>-click on
   the first keygroup box and drag it to the keygroup box you want to
   swap with.

   If a keygroup's output is changed, and it's linked to a keygroup edit
   buffer, the edit buffer keygroup's output will be changed as well.

2. Delete a keygroup by clicking on it with both the <alt> and <control>
   keys held.  This action is *immediate and not undoable*, unless the
   selected keygroup is already linked to a keygroup edit buffer; in this
   case you'll get an alert box to confirm your action (unlike the main
   page, the default choice here is to delete the keygroup).

   You won't be able to delete all the keygroups from this page--at least
   one must remain.

   When a keygroup is deleted from the individual or stereo screen,
   only the corresponding collumn or side is re-drawn; this means that
   other keygroups may now be numbered incorrectly.  Pressing the return
   key will re-draw the entire screen, correctly numbering the keygroups.

3. Select a keygroup for detailed editing:  Similar to the main page,
   you can move to the keygroup edit page from this screen by <shift>-
   clicking on a keygroup box.  This will be covered in more detail in
   the following section.


Exiting the Output Map Page

Press the <Esc> key to leave the output map page and return to the main
page.


THE KEYGROUP EDIT PAGE
----------------------

This page displays any one of ten "keygroup edit buffers", separate areas
of the S900 Companion.  It's used in two ways: editing a keygroup from the
Current or Composite program by copying it to a buffer, or building an
S900 program from scratch by initializing a buffer.


Editing a keygroup from a main page program

From the main screen, <shift>-click on a keygroup to copy it to the first
empty keygroup edit buffer and move to the keygroup edit page, with that
buffer displayed. <Alt>-clicking on a keygroup copies it to the first
empty buffer, *without* moving to the keygroup edit page; this is in case
you'd like to copy more than one keygroup before leaving the main screen.
If all ten buffers are filled, an alert box will give you the option of
aborting the copy or overwriting buffer #10.

The output map page work a bit differently:  <Shift>-clicking on a
keygroup box copies it to a keygroup edit buffer and moves you to the
keygroup edit page with that buffer displayed, *unless the keygroup is
already linked* (i.e., has already been copied) to a buffer.  In this
case, the copy isn't made; you'll simply switch to the keygroup edit page,
with the linked buffer displayed.  Similarly, <alt>-clicking on a keygroup
box copies it to a keygroup edit buffer but leaves you on the output map
page, *unless the keygroup is already linked*, in which case the copy
isn't made (you'll see a message box for about one second telling you
which keygroup edit buffer is already linked to the keygroup you clicked
on).


Moving to the keygroup edit page directly

Select "Keygroup", in the Edit menu on the main page.  You'll go to the
last buffer you were editing, or the last buffer that a Current or
Composite program keygroup was copied into.  If all buffers are empty,
you'll move to buffer #1.  This is the only way to reach the keygroup edit
page when there are no main page programs in the S900 Companion, which
would be the case if you were beginning a session by creating an S900
program from scratch.


Buffer Basics

Ten small boxes at the lower left of the screen represent the buffers:
The highlighted box is the current buffer (the one you're looking at), and
small arrowheads above a box indicate an active buffer (i.e., one that
contains data).  You can move to any buffer by clicking on its box, or
pressing the equivalent function key on the ST's keyboard.

If the current keygroup edit buffer is active, <shift>-clicking on a
different buffer box (or pressing <shift>+function key) copies its data to
it.  The current buffer can be copied to any of the other nine buffers.
Those that are active will have their data overwritten by the keygroup
you're copying (with no warning alert or undo).

<Control>+<alt>-clicking on an active buffer box (or pressing <control>+
<alt>+function key) other than the current one *clears* that buffer
(instantly), erasing its contents.

<Shift>-clicking on the button marked "INIT", at the bottom center of the
screen, brings up an alert box allowing you to clear the *current* buffer,
if it's active. <Alt>+<control>-clicking on that button brings up an
alert box letting you clear *all ten* buffers.  These actions are not
undoable!


"Linked" keygroups and keygroup buffer "ownership"

A buffer whose keygroup was copied from a main page program is considered
"linked" to that main page keygroup.  In addition, the buffer is also
considered "owned" by that main page program.  When you're done editing,
the keygroup buffer data is copied back to the owner program.  If the
keygroup is linked, it can *replace* the keygroup it was copied from, or it
can be *added* to the program, creating a new keygroup.  An unlinked
keygroup can only be added to an owner program.  A keygroup buffer that's
added to a main page program is then considered linked to the newly-formed
keygroup, regardless of its previous link status.  Keygroup linking is
completely automatic; the S900 Companion will keep track of which main
page keygroup a keygroup edit buffer is linked to at all times.

Keygroup buffer ownership, on the other hand, is user-selectable and
changeable (the S900 Companion will initially set the buffer's owner when a
keygroup is copied from a main page program).  Owner selection is done by
clicking in either the "curr" or "comp" box at the upper left of the
keygroup edit screen (the "owner box"); the current owner is highlighted.
An initialized buffer will have no owner; you'll need to choose one when
you're ready to add the keygroup to one of the main page programs.

A few details regarding links and owners:

  * A buffer's owner program need not exist:  You can initialize an
    empty buffer and set its owner to the Current or Composite program
    even if there are no main page programs present.  When you add the
    keygroup, the S900 Companion will create the program, naming it
    "*Untitled*".  This is how S900 programs are created from scratch.

  * If a linked edit buffer's owner is changed, it's considered unlinked-
    i.e., it can only be added to the new owner program.  If the owner is
    changed back to the original program, *without having added it to the
    new owner program*, the link is restored.  Once an edit buffer's
    keygroup has been added to a program, it's considered linked to that
    new main page keygroup.  

  * If the buffer is added more than once, it's considered linked only to
    the *last* main page keygroup created.

  * If keygroups on a main page program are deleted (or the entire
    program is dumped), any links to keygroup edit buffers are trashed.
    Data in the keygroup edit buffers isn't affected.

  * When a keygroup edit buffer is copied to another buffer, the
    copied buffer will have the same link and/or owner.


Copying a keygroup from a main page program

You need not be on the main or output map page to copy a main page
keygroup into a keygroup edit buffer.  The button labeled "get keygroup",
at the upper left of the screen, lets you do this from the keygroup edit
page.  This button works in both active and empty buffers.  Of course, if
the buffer is active, its contents will be overwritten by the keygroup you
select.

If no owner is set or the buffer is empty, an alert box asks you which
main page program you'd like to copy a keygroup from.  A box similar to the
one on the main page appears, listing the keygroups in the owner program.
Click on one to select it, or anywhere else to abort.  As on the main page,
if there are more than 17 keygroups in the program, arrowheads at the
bottom allow access to the remaining keygroups.


Initializing the buffer

A simple click on the "INIT" button, at the bottom center of the screen,
initializes the buffer to the values in the default TONE PRGRM we all
know. (<Shift>-clicking and <control>+<alt>-clicking on this button have
been previously described as ways to *clear* the buffer, or all ten
buffers).

Initializing works in both active and empty buffers.  If the buffer is
active, all parameters *except* its sample assignments will be initialized.

If the buffer is empty, clicking on an owner box initializes the buffer
and sets its owner at the same time.

Initializing an empty buffer is the first step in creating an S900
program from scratch.  You should have the samples you want to use loaded
in the sampler so you'll be able to hear what you're doing!

Note that the "midi channel" parameter is displayed differently than on
the S900.  In the sampler, this figure is the channel *offset* from the
basic midi channel; on the keygroup edit screen, the *actual* midi channel
of the keygroup is displayed (based on the channel check-marked under the
"Midi Chan" menu on the main page).  I think this makes it easier to
deal with "multitimbral-itis" (the inability to remember what midi
channels are used for a particular sound or sample).


Listening to your edits

Whenever you enter an active keygroup edit buffer from the main page or
from another keygroup edit buffer, or initialize a buffer, its contents are
transmitted to the S900 as a one-keygroup program called "*Work Buf*".  The
buffer's contents are also re-transmitted with *every edit* that you do.

The right mouse button is used to "play" the keygroup.  The note sent
depends on the horizontal location of the mouse on the keygroup edit
screen, and the key range parameters.  For example, if both low and high
notes are set to C3, then that note will be sent no matter where the mouse
is; if the note range spans three semitones, then the note sent will depend
on which third of the screen the mouse is in, etc.  Holding a <shift> key
as you right-click causes the note sent to be the midpoint of the key range
no matter where the mouse is.  The velocity value is dependent on the
mouse's vertical position on the screen; higher values are sent with the
mouse nearer the top of the screen.  Holding the <alt> key as you right
click causes the value to be 127 no matter where the mouse is.  Both
modifiers can be used simultaneously.

The right-mouse play function sends both note-on and note-off velocities.
To set a different velocity value for the note-off, continue to hold the
right mouse button after sending the note on; slide the mouse up or down
to set the velocity value for the note-off, which is sent when you release
the mouse button (the displayed value changes to indicate the velocity
value that will be sent).  As with the note-on message, holding <alt>
forces the value to be 127.

On the S900, note-off velocity is used only to control the envelope
release time.  The "velocity sensitivity release" parameter must be a non-
zero value, and the parameter next to it must be set "Off" (when set "On",
the note-*on* velocity affects the release time).  If you don't use
note-off velocities (most controllers don't send them), leave this last
parameter "On", or keep "velocity sensitivity release" set to 0; this
insures that the note-off velocities won't affect the sound as you right-
click.

If things don't sound right, make sure the "*Work Buf*" program exists in
the S900 and is currently selected.  If there are already a lot of
programs, samples, or keygroups present there may not be enough room in
the sampler to hold the "*Work Buf*" program (see "Bugs & Space").  If
this is the case you'll need to delete a few keygroups or samples from the
S900 to make room.

The S900 Companion "remembers" the last note value sent with the right
mouse button.  Pressing the <l> key sets the low key to this note;
pressing the <h> key sets the high key.  The <Undo> key undoes the edit.
Repeated presses of <Undo> alternates between values.

A midi controller can also be used to play the keygroup.  See the
section on "Using a midi controller to play the S900", at the end of this
documentation.  Notes played by a controller are not remembered.


Editing basics

All editing is done with the mouse, by left-clicking on a displayed
parameter's value (referred to from now on simply as "clicking on the
parameter").

Changing outputs and on/off parameters should be obvious.

To change a sample assignment, click directly on the sample name.  A box
should open up listing all the samples in the S900; click on the one you
want, or anywhere other than a sample name to abort.  Keep in mind that you
may not hear what you expect, depending on the vertical mouse position
and the "velocity threshold" and "50% mix" settings.

The remaining parameters are edited as follows:

To decrement, click slightly to the left (or on the hundreth's digit, if
present) of a parameter.  To increment, click slightly to the right (or
on the one's digit).  Single clicks change the value by one unit.  If you
continue to hold the mouse button down, the value will begin scrolling
slowly.  Moving the mouse farther from the parameter (while continuing to
hold the left button) causes the scroll speed to increase.  Moving the
mouse to the opposite side of the parameter causes the scroll direction to
reverse.  Pressing the right button (while keeping the left button pressed)
causes the parameter's value to be set to its minimum or maximum, depending
on whether you're incrementing or decrementing.

With signed parameters, clicking directly on the sign sets its value to 0.


Envelope editing

Editing the envelopes can be done by clicking on the numbers under each
envelope display box as described above, or by click-dragging the small
boxes that form the envelope displays.  Note that you need not click
directly on a box; anywhere in its vertical plane will "grab" it, as long
as the mouse is within the envelope display box.

Since the third small box sets both the decay and sustain values, you may
inadvertently change a parameter you don't want to.  To edit only the decay
or sustain parameter, press the <d> or <s> keys *while the mouse is inside
an envelope display box* (the other parameter's text will gray out).  To
"unlock", press any other key except <a>, <b>, <c>, or <o> (again, with the
mouse inside the envelope display box); these control special editing modes
and are described later.  Locking and unlocking affect *graphic* envelope
editing only; you'll still be able to change the value of a locked
parameter by clicking on the number underneath the envelope display box.


Undoing and <shift>-key editing

The <undo> key undoes the last edit.  Pressing <undo> repeatedly
alternates between the original and edited value, allowing comparisons.

Normally, the keygroup is re-transmitted to the S900 with each individual
edit.  Holding a <shift> key as you edit prevents this transmission, until
it's released.  The <undo> key will now undo and compare *all edits* that
were done while the <shift> key was held, up to a maximum of 30.


The Backup buffer

The S900 Companion has a single backup keygroup buffer.  When you enter
an active buffer, its contents are automatically copied to the backup
buffer.  The current buffer can also be copied to the backup buffer at any
point by <shift>-clicking on the button labeled "BAK" ("BACKUP" on a mono
monitor), in the lower middle of the keygroup edit screen.

A simple click on this button *swaps* the current and backup buffer.
<Alt>-clicking on "BAK" *copies* the backup buffer to the current buffer
(the backup buffer's contents are retained; the current buffer's contents
are overwritten).

Initializing an active buffer doesn't affect the backup buffer.  This
lets you undo an initialization, if you <shift>-click on "BAK" before you
initialize.

Individual parameters from the backup buffer can be recalled.  The <b> key
toggles this function.  When it's active, the mouse cursor will have a
small "B" next to it.  Normal editing is disabled.  Clicking on a parameter
copies the value from the backup buffer.  Clicking inside an envelope
display box copies all envelope values at once.  Clicking on *any* output
copies the output value from the backup buffer.  Note that values aren't
swapped as when clicking on "BAK"; however, the <undo> key and <shift>
editing work as they do in regular editing to recall & compare the
previous values.


The "Add", "Done", and "Exit" buttons

Clicking on "Add" creates a *new* keygroup in the owner program and
copies the buffer data to it.  If the buffer isn't owned, an alert box
asks you to choose the main page program to add the keygroup to, or abort.
Each click on "Add" creates a new keygroup in the main page program, up
to the maximum of 29 that the S900 Companion allows.

A buffer which is added to a main page program is now linked to that new
keygroup, regardless of its previous link status.

Clicking on "Done" copies the data from this keygroup back to the main
page keygroup it's linked with.  This is the usual action in a typical
editing session.  If the keygroup is not linked, you'll get an alert box
letting you add the keygroup to the owner program, or abort.

<Alt>-clicking on "Done" copies ALL LINKED keygroup edit buffers back to
their main page keygroups in one step.  This operation is available in any
active KEB, even if it isn't linked.  Linked keygroup edit buffers whose
owners have been changed, but haven't been added to the new owner program
will NOT be copied.  Also, the two non-keygroup-specific parameters,
"Keyboard Tilt" and "Positional Crossfade" are copied back to the owner
program only from the *current* keygroup edit buffer; if you invoke this
operation from a non-linked keygroup edit buffer, these two parameters
will NOT be copied from any of the other linked KEB's to their respective
owner programs.  An alert box confirms this operation, as it's not
undoable.

Clicking on "Exit" leaves the keygroup edit page and returns you to
either the main or output map page (depending on where you entered the
keygroup edit page from), without doing anything.

<Shift>-clicking on "Add" or "Done" is a shortcut for clicking those
buttons, then clicking on "Exit".

Remember, if you leave the keygroup edit page without having clicked on
"Add" or "Done", your edits will *not* be applied to the main page program.
Don't forget to send the main page program to the S900!


Parameter Edit Buffers

Individual parameters' values from a keygroup edit buffer can be copied
to any of three "parameter edit buffers", and pasted into different
keygroup edit buffers or keygroups in the Current or Composite program.  I
call them the "Copy Parameters", "Conditional Edit", and "All Keygroup"
buffers. Each parameter edit buffer can hold up to 30 parameters' values.

Values copied to the Copy Parameters buffer can be pasted into any active
keygroup edit buffer.

Values copied to the All Keygroups buffer can be pasted into some or all
keygroups of either main page program.

Values copied to the Conditional edit buffer aren't pasted anywhere;
rather, they control pasting from the other two buffers.  If conditional
editing is enabled, the parameter values in its buffer are compared with
the values for the same parameters in the current keygroup edit buffer (for
Copy Parameter pastes) or a Current or Composite program keygroup (for All
Keygroup pastes); the pastes can be made to happen or not depending on
settings you make.  I call this "conditional editing".  Conditional editing
is explained in greater detail in a following section.


Copying values to the Parameter Edit Buffers

There are two methods for copying values to the Copy Parameters or All
Keygroups buffers:  To do it *as you edit*, press the <c> or <a> keys.
The letter "C" or "A" will appear with the mouse cursor.  Normal
operation is not affected, except that the resulting value of any
parameter you edit is placed in the Copy or All Keygroup buffer.
Pressing <c> or <a> a second time turns this feature off.

The second method is to <control>-click ("C"ontrol=Copy Parameter), or
<alt>-click ("A"lt=All Keygroup) directly on a parameter value.  No
editing takes place; the displayed value is simply placed in the respective
buffer.  This method has priority over the first one. <Control> or <alt>-
clicking in an envelope display box places all envelope values in a buffer
at once. <Control> or <alt>-clicking on *any* output icon (even between
them) places the current output value in the respective buffer.

To place values in the Conditional Edit buffer, press the <o> key.  The
mouse cursor now shows the letters "CO" next to it.  Normal editing is
disabled.  Clicking on a parameter places the displayed value in the
Conditional Edit buffer.  Clicking in an envelope display box places all
envelope values in the buffer at once.  Clicking on or between the output
icons places the current output value in the buffer.

Press the <o> key again to return to normal editing.

As you might expect, only one value for any one parameter can exist in a
parameter edit buffer--the last one copied.


Parameter Edit Buffer Controls

At the upper left of the keygroup edit screen, under the box marked "get
keygroup", is a group of three buttons under the label "Param Ed Buf"
("Parameter Ed Buf" on a mono monitor).  They're labeled "COPY", "COND",
and "ALL", corresponding to the three buffers.

A simple click on "COPY" pastes the values in the Copy parameter buffer
into the current keygroup edit buffer.  The pastes can be undone/compared
with <undo>.  If conditional editing is enabled, the pastes may or may
not happen depending on settings you've made.  A message box will display
"*DONE*" if the paste happen, or "*NOT*" if conditional editing is in
effect and your settings prevent the paste.

A simple click on "ALL" pastes values in the All Keygroup buffer into all
keygroups of the main page program that owns the current keygroup edit
buffer.  An alert box confirms this operation, as it can't be undone.  If
conditional editing is enabled, the pastes may not be made to some or all
the main page program keygroups, depending on settings you've made.  A
message box saying "PASTING" pops up; for each edit, a row of "+" or "-"
symbols appear, each representing a keygroup of the main page program.  A
"+" indicates a keygroup that receives the paste, while a "-" indicates a
keygroup that does NOT receive the paste, due to the conditional edit
buffer settings.  If conditional editing is not enabled, you'll only see
"+" symbols.

A simple click on "COND" toggles conditional editing on and off.  "COND"
will highlight when conditional editing is enabled.  This is the "master
switch".  In addition, there are separate switches that enable conditional
editing separately for the Copy Parameter and All Keygroup buffers,
described in the next section.

<Control>+<alt>-clicking on "COPY", "COND", or "ALL" clears those
buffers, with no warning alert or undoing possible.


Parameter Edit Buffer Edit Box

<Shift>-clicking on COPY, COND, or ALL brings up this edit box.  All edits
in the buffer are listed by name, along with their values.  There's room
to list 15 edits; an arrowhead appears at the bottom left of the list if
there are more.  Click there to see the remaining edits, and once again to
go back to the first 15.

Individual parameter edits are selected like selecting keygroups on the
main page; click on one to select it, and on a selected edit to de-
select.  The "select all" and "deselect" buttons' functions should be
obvious.  All operations except EDIT work on selected parameters only.

There are five functions to the Parameter edit buffer edit box:

1.  Selected edits can be copied to the other two buffers.  The four
    buttons at the upper right do this; click on one of the two "Copy to"
    buttons ("A"=*add* the edits to those already in the target buffer,
    "R"=*replace* the edits in the target buffer with those from the
    current buffer), then choose the target buffer by clicking on one of
    the two buttons to the right.  A confirming alert appears in the case
    of a "replace".  If you're adding a parameter that already exists in
    the target buffer, the target buffer's value will be overwritten (an
    alert box asks for confirmation in this case).

2.  Selected edits can be deleted from the buffer by clicking on the
    DELETE button.  An alert box confirms this action.

3.  Selected edits can be saved to and loaded from a disk file, using the
    LOAD and SAVE buttons at the bottom of the edit box.  Files use the
    extention .S9E (S900 edit).  Files saved from any of the three
    buffers can be loaded into any of them.  Loading a file replaces any
    existing edits in the buffer.

4.  The Conditional edit buffer operations are controlled by four buttons.
    Highlighting "All Keygs" or "Copy Parm" enables conditional editing
    for all pastes done from those buffers (the "master switch", described
    previously, must also be highlighted).  "Paste" and "Paste NOT" are
    radio buttons; only one can be active.  These buttons control the
    results of a paste done with conditional editing enabled:  When
    pasting, the values in the conditional edit buffer are compared with
    the values for the same parameters in the current keygroup edit
    buffer (for a "Copy Parameter" buffer paste) or each keygroup of the
    owner program (for an "All Keygroups" paste).  If the values match
    and "Paste" is highlighted, or if the values *don't* match, and
    "Paste NOT" is highlighted, the pastes *will* happen.  If the values
    *don't* match and "Paste" is highlighted, or the values *do* match an
    "Paste NOT" is highlighted, the pastes will *not* happen.  Got it?!

    These settings are saved in a configuration file that the S900
    Companion automatically loads when it boots.

    (Note that two parameters-"key~loudness" and "positional crossfade"-
    are *not* keygroup-specific.  An All Keygroups paste will *always*
    paste these values into the main page program, regardless of the
    settings of the Conditional edit buffer).

5.  The values in the parameter edit buffer can be changed.  Clicking on
    "EDIT" closes the edit box and puts you in what appears to be the
    keygroup edit buffer page.  In this case though, only the parameters
    from the parameter edit buffer will be available for editing.  Note
    that envelope values can't be edited graphically on this sub-page.

    Values are edited the same as a keygroup edit buffer.  Right-mouse
    play and all undo/compare/backup functions are disabled.  The two
    re-labeled exit buttons at the bottom take you back to either the
    current keygroup edit buffer (KEB) or the parameter edit buffer edit
    box (PEB).  As indicated on the screen, <shift>-clicking on either of
    these buttons discards any changes you've made while on this sub-page.

Click on "EXIT" to leave the parameter edit buffer edit box and return to
the current keygroup edit buffer.


Comments

Clicking on this box opens up a message box displaying a line of text.
The S900 Companion will automatically "write its own comments" when
keygroups are copied from a main page program, informing you which
program and keygroup the keygroup edit buffer is linked with.  You can
replace this text with your own if you like; however, if you leave the
default comment alone, the S900 Companion will keep it "in sync" with
whatever you do on the main page (try renaming a main page program,
swapping programs, or deleting the linked keygroup on the main
page...you'll see what I mean).

If the comment line is empty when the message box opens, you can simply
begin typing.  If there's already text on the comment line, click the
mouse somewhere on the line to place the cursor there, or press <Clr/Home>
at any time to erase the line and put the cursor at the beginning.
Existing text is typed over by text you enter.  The <Insert> key inserts a
space at the cursor location; existing text is pushed right, and text at
the end of the line is lost.  <Backspace> and <Delete> are functional.
The left & right arrow keys move the cursor through the line.  The up &
down arrow keys move the cursor to its endpoints.

Press <Return> or click the mouse outside the message box to exit.


OTHER FUNCTIONS
---------------

Paths...

Choosing this option (in the File menu) opens a box letting you specify
the directory paths for four types of S900 Companion files:  Program
(.S9P) and parameter edit buffer (.S9E) files, this doc file, and the
S900C.DAT file, a "snapshot" file, described next.  These paths default
to the same directory that the S900 Companion was run from.  Click on a
path line to open a file selector letting you specify the path (clicking on
"Cancel" leaves the path set as it was).  If the path is more than a few
folders deep you may not see it listed completely.

Clicking on "Save" saves a configuration file with these path
specifications.  When the S900 Companion boots, it looks for this file
and loads it if found.  In addition to the path settings, the
configuration file contains the current basic midi channel (the one
check-marked under the Midi Chan menu), and the conditional edit buffer
settings.


Help

Pressing the <Help> key on the main or keygroup edit page opens up a box
listing various help topics.  Choose one with the mouse, or click outside
the box to abort.

The help feature uses *this* doc file, and the S900 Companion will expect
to see it in the directory specified under the "preferences" option.  If a
file selector appears, it means that this file was not found; you'll have
to tell the S900 Companion where it is.


The S900C.DAT file

When you quit the S900 Companion, the "Are you sure?" dialog has an
additional button marked "Save .DAT".  Clicking on this button saves a
file with the entire contents of the S900 Companion's memory before the
program quits.  When the program is run again, it looks for and loads this
.DAT file if found, restoring things to where they were before you last
quit.  The S900 Companion looks for this file in the directory specified
with the "Preferences" option, described previously.

The main use for this feature is to allow you to use the S900 Companion
from within a sequencer program that allows running external programs.
Normally, returning to the sequencer causes you to lose all data in the
external program (essentially, you're "starting from scratch" each time
you run the external program from the sequencer).  Of course, this works
just as well when the S900 Companion is run stand-alone from the desktop,
and is a convenient way to continue an editing session.

The S900C.DAT file contains both the Current & Composite programs & their
keygroup selection statuses; the contents of all ten keygroup edit
buffers, their owners & link statuses, the contents of the three parameter
edit buffers, comments, the conditional edit buffer settings and the basic
midi channel.

The S900 Companion does some error-trapping here, to help you avoid
losing your data.  An alert box and/or fileselector will appear if the
specified path for saving the .DAT file doesn't exist, or if the disk is
full.  You'll have a chance to switch to another directory or disk to save
the file (clicking "Cancel" in this file selector will exit the program).

The "Load .DAT" file item in the File menu lets you load an S900C.DAT file
manually at any time.  Of course, that trashes everything currently in
memory (there's a confirming alert box).


Using a midi controller to play the S900

As part of my final "touching-up" of the S900 Companion, I've enabled
MIDI THRU; any midi data received at the Atari's midi input is echoed.
Midi thru is active on all three pages of the S900 Companion.  This lets
you use a keyboard or other midi controller to play the S900.  Since the
S900 Companion requires two-way communication between the sampler and the
computer, you'll probably need to use a midi merger or switcher in order to
use a controller.  This may not be necessary if the controller can echo
midi data from its IN to OUT port.  In this case, connect the controller's
midi OUT to the computer's midi IN, the computer's midi OUT to the S900's
midi IN, and the sampler's midi OUT to the controller's midi IN. **The
controller must be able to reliably echo a system-exclusive message
anywhere from 225 to over 5000 bytes long**.

Because the S900 Companion does not edit programs in the sampler
directly, making sure that the program you are editing and the one you're
listening to are "in sync" takes some thought on your part.  I hope the
following makes things a bit more clear:

When on the Keygroup Edit Page, your controller will play the displayed
keygroup *only*.  On the other two pages, the "active" S900 program--the
one your midi controller will play--will be the *most recent* of these:

1.  The last program *requested* from the sampler.
2.  The Current program, if it was sent to the sampler.
3.  The last keygroup you were editing (the *Work Buf* program).

As you can see, requesting or sending a program from the S900 Companion,
or moving to the keygroup edit page, can change the active S900 program.
You can also change the active S900 program manually by sending a program
change command from your keyboard or from the S900 Companion.  To do this,
press the <p> key on the main page:  the Current program box will list the
programs in the S900.  Click on a program name to send the corresponding
program change and make it the active S900 program, or anywhere else to
keep things as they were.

Remember, edits to the Current or Composite program are not reflected in
the sampler until you send the program to the S900!  If you are on the
Main or Output Map page and are deleting/adding keygroups or changing
outputs, you must then send the program to the sampler in order to hear
the results of your edits from your controller.

And, of course, don't forget to save the edited program to the S900's own
disk!!
