Print At(29,3);"Jack and the Beanstalk!"
Print At(23,6);"An adventure game for the Atari ST."
Print At(21,8);"<C>    Steve W. Lucas    September 1984"
Print At(6,10);"My name is Jack and I live in a small cottage with my mother."
Print "   We are very poor and mother is always telling me off for being lasy."
Print "   'Get a job. Get a job', she says. She must be joking........"
Print "   what with unimployment the way it is!"
Print
Print "     I have heard  tell of an evil ogre who is reputed to own a goose"
Print "   that lays golden eggs, a golden harp and a bag of money which"
Print "   he has stolen from the peasants."
Print
Print "     I have desided to try to recover this treasure and take it to mother"
Print "   who will return it to the rightfull owners!"
Dim S%(80,4),X$(40),Q$(80),G$(30),B%(30),N$(30),N%(30),V$(4)
For X=1 To 78
  Read Q$(X)
  For Y=1 To 4
    Read S%(X,Y)
  Next Y
Next X
For X=1 To 23
  Read G$(X),B%(X)
Next X
For X=1 To 27
  Read N$(X),N%(X)
Next X
For X=1 To 34
  Read X$(X)
Next X
Data in a small wardrobe. It is full of tatty old clothes.,0,0,2,0
Data in a small bedroom. There are no covers on the old bed.,0,4,3,1
Data in a small bathroom. There is a rusty hole in the tin bath.,0,0,0,2
Data at the top of a flight of stairs.,2,0,0,0
Data at the bottom of a narrow flight of stairs.,0,8,0,6
Data in a small kitchen. There is a large table covered with dirty pots.,0,7,5,0
Data in an empty dining room.,6,0,8,0
Data in a hallway which is in need of decorating.,5,10,9,7
Data in a lounge. There is a tatty chair  a reading lamp and an old newspaper        here.,0,0,0,8
Data in the doorway.,8,11,12,0
Data by a garden gate. The grass is knee high.,10,15,0,13
Data in a muddy field. It looks as though it has recently been ploughed.,0,0,0,10
Data outside a garden shed.,0,0,11,0
Data inside a garden shed. It's full of cupboards which are covered in cobwebs.,0,0,0,0
Data on the pavement at the side of a narrow road.,11,20,0,0
Data by some market stalls.,24,18,0,0
Data outside an old market hall.,0,0,0,18
Data in the town square. It's very crowded today.,16,0,17,20
Data in a hall full of men trying to sell animals.,0,0,0,0
Data on a road.,15,20,18,21
Data outside the village church.,0,0,20,22
Data inside a very ornate church. Ancient sepulcres cover the walls.,0,23,21,0
Data in front of a large altar.,22,0,0,0
Data on a piece of ground which has obviously been tilled ready for sowing.          Someone has erected some beanpoles here.,0,16,0,0
Data at the top of a large beanstalk. A road stretches out before me.,0,26,0,0
Data on a long straight road.,25,0,34,27
Data lost in a dark forest.,27,30,26,28
Data lost in a dark forest.,28,29,30,28
Data lost in a dark forest.,28,31,30,29
Data lost in a dark forest.,27,32,30,29
Data lost in a dark forest.,29,31,32,31
Data lost in a dark forest.,30,32,33,31
Data lost in a dark forest. There is a woodcutter's hut here.,0,0,0,32
Data on a long straight road.,0,36,35,26
Data on a long road. A landslide has blocked the way East.,0,0,0,34
Data outside a small cottage.,34,0,0,0
Data inside a dimly lit cottage.,0,39,38,0
Data by a small hat stand.,0,41,0,37
Data in a small kitchen. There is a wooden door here.,37,0,0,40
Data by an oil stove.,0,0,39,0
Data in an empty room.,38,0,75,0
Data on an overgrown footpath.,39,43,0,0
Data by a large metal gate.,42,0,46,0
Data on a path at the side of a mountain stream.,0,46,45,0
Data on a dusty road.,0,0,47,44
Data by a farm gate.,44,77,0,43
Data on a dusty road.,0,0,48,45
Data at the end of the road.,0,50,49,47
Data by the entrance to a vast cavern.,0,0,0,48
Data by a deep moat. There's a drawbridge  but it is up at the moment.,48,0,0,0
Data by a closet.,0,56,0,0
Data in a tiny closet full of ladies fashions.,0,0,0,51
Data on a drawbridge.,50,0,54,0
Data outside an ancient castle.,0,0,55,53
Data by the gatekeeper's lodge.,0,57,0,54
Data inside the gatekeeper's lodge.,51,0,0,55
Data by the castle gate. It's locked.,55,0,58,0
Data by the castle walls. They are too high to climb!,0,0,0,57
Data in a courtyard full of people.,57,62,60,0
Data in a cellar which is full of casks of quality wine.,0,0,0,59
Data in a large room. The furniture is covered in cobwebs.,0,0,62,0
Data in an enormous banqueting hall. Velvet curtains line the walls.,59,65,63,61
Data in a small chamber. A pile of bones is strewn in the corner.,0,0,0,62
Data hiding in a dark cupboard.,0,0,0,0
Data in an enormous kitchen. The Ogre's wife is busy putting something               in the large oven.,62,0,0,0
Data hiding in the oven. It is very hot in here !,0,0,0,0
Data hiding in a copper.,0,0,0,0
Data in the entrance to a gloomy cavern.,72,49,69,0
Data in a windy passage.,71,69,69,68
Data in a windy passage.,74,70,70,71
Data in a windy passage.,73,69,70,72
Data in a windy passage.,72,68,71,72
Data in a windy passage.,73,71,74,73
Data in a windy passage.,76,70,74,73
Data by a window. The view from here is very spectacular.,0,0,0,41
Data in a secret cavern.,0,74,0,0
Data in a grassy field.,46,0,0,0
Data in a scruffy woodcutter's hut.,33,0,0,0
Data a sharp axe,14,a cow,12,a small child,23,mother (ill in bed),2
Data an old farmer,19,"",19,a piece of paper,1,a knife,6,some cheese,9
Data a woodcutter's outfit,78,a copper,65,a cupboard,65,"",65,"",65,"",65
Data a large key,56,a lady's dress,52,a large lever,50,a sword,76,some dust,15
Data "",15,a glass of wine,58,an old lady,51,axe,1,cow,2,child,3,mother,4
Data farmer,5,beans,6,paper,7,code,7,knife,8,cheese,9,woodcutter's,10
Data outfit,10,copper,11,cupboard,12,goose,13,bag,14,money,14,harp,15,key,16
Data dress,17,lever,18,sword,19,dust,20,mouse,21,glass,22,wine,22,lady,23
Data   O.K.,  No chance!,  Not likely!,  I see nothing special.,  Nothing happened!
Data   It reads 'Combination 10130127',  Aaaggghhh!,  It's locked!
Data   It's a combination lock!,  I need the axe,  I bleed to death
Data   I climb up,  I climb down,  I need a key!,  Hide somewhere!,  she says
Data   FEE FIE FOE FUM I smell the blood of ....,  It's dark
Data   I wouldn't recommend it!,  HOW DARE YOU SPEAK TO ME LIKE THAT ?
Data   Don't be cruel,  That's not the correct approach!,  She wants something!
Data   It's full of money,  I fell and broke my neck!,  I am dead !
Data   Would you like another game ?,  I don't have a clue!
Data   I'm sorry I don't understand you!,  I'm not hungry
Data   I'm not thirsty!,  Not here!,  Not Yet!,  Don't be stupid!
Print
Print "     Pres a key to start the game."
Key=Inp(2)
Pp$="10130127"
Cls
P%=2
While S%<100
  Print
  Print "  I am :- ";P%
  Print "  ";Q$(P%)
  If P%=64 Then
    @2030
  Else
    If P%=67 Then
      @2060
    Else
      If P%=66 Then
        @1720
      Else
        If P%=65 And Af=1 Then
          Print
          Print "  Be QUIET.The Ogre is asleep in a chair!"
        Endif
      Endif
    Endif
  Endif
  If P%=24 And Ah=3 Then
    Print
    Print "  There is a giant beanstalk here!"
  Else
    If P%=15 And Ax=1 Then
      @2240
    Else
      If P%=62 Then
        @1990
      Else
        If As>0 Then
          @2090
        Endif
      Endif
    Endif
  Endif
  A$=""
  If S%(P%,1)>0 Then
    Let A$="North"
  Endif
  If S%(P%,2)>0 And Len(A$)>0 Then
    Let A$=A$+",South"
  Else
    If S%(P%,2)>0 Then
      Let A$="South"
    Endif
  Endif
  If S%(P%,3)>0 And Len(A$)>0 Then
    Let A$=A$+",East"
  Else
    If S%(P%,3)>0 Then
      Let A$="East"
    Endif
  Endif
  If S%(P%,4)>0 And Len(A$)>0 Then
    Let A$=A$+",West"
  Else
    If S%(P%,4)>0 Then
      Let A$="West"
    Endif
  Endif
  If P%=4 Or P%=25 Then
    Let A$=A$+",Down"
  Else
    If P%=5 Then
      Let A$=A$+",Up"
    Else
      If P%=14 Or P%=19 Or P%=52 Or P%=66 Or P%=67 Or P%=64 Or P%=78 Then
        Let A$="Out"
      Endif
    Endif
  Endif
  If P%=33 Or P%=51 Or P%=55 Or P%=13 Or P%=17 Or P%=36 Then
    Let A$=A$+",In"
  Else
    If P%=37 Then
      Let A$=A$+",Out"
    Endif
  Endif
  If A$="" Then
    Let A$="There must be somewhere!"
  Endif
  Print
  Print "  I can go :-"
  Print "  ";A$
  E=0
  For T=1 To 23
    If B%(T)=P% Then
      If E=0
        Print
        Print "  I can see :-"
        E=E+1
      Endif
      Print "  ";G$(T)
    Endif
  Next T
  Print
  Print "  What do I do now ";
  Input Z$
  Z$=Upper$(Z$)
  B$=Left$(Z$,2)
  C$=Left$(Z$,3)
  D$=Left$(Z$,4)
  Cls
  Print
  Print Chr$(7)
  Let K=0
  If C$="LOO" Then
    Let K=1
    Print ;X$(1)
  Endif
  If C$="SAV" Then
    Let K=1
    Gosub 1370
  Endif
  If C$="QUI" Then
    Let K=1
    Gosub 1480
  Endif
  If C$="SCO" Then
    Let K=1
    Print "  You have scored ";S%;" %"
  Endif
  F=Fre(0)
  If B$="FU" Or B$="PI" Then
    Let K=1
    Print X$(20)
  Endif
  If C$="REA" Then
    Let K=1
    @1540
  Endif
  If C$="SOW" Or C$="PLA" Then
    @1830
  Endif
  If C$="WEA" Then
    @1910
  Endif
  If C$="REM" Then
    @1960
  Endif
  If C$="EAT" Then
    Print X$(30)
    Let K=1
  Endif
  If C$="DRI" Then
    Print X$(31)
    Let K=1
  Endif
  If C$="HEL" Then
    Gosub 1510
  Endif
  If C$="KIL" Or C$="STA" Or C$="ATT" Then
    Gosub 1860
  Endif
  If C$="PUL" Then
    @2210
  Endif
  If C$="LOA" Then
    @2250
  Endif
  If (B$="N" Or D$="GO N") And S%(P%,1)<>0 Then
    Let P%=S%(P%,1)
    Let K=1
    Print X$(1)
  Endif
  If (B$="S" Or D$="GO S") And S%(P%,2)<>0 Then
    Let P%=S%(P%,2)
    Let K=1
    Print X$(1)
  Endif
  If (B$="E" Or D$="GO E") And S%(P%,3)<>0 Then
    Let P%=S%(P%,3)
    Let K=1
    Print X$(1)
  Endif
  If (B$="W" Or D$="GO W") And S%(P%,4)<>0 Then
    Let P%=S%(P%,4)
    Let K=1
    Print X$(1)
  Endif
  If C$="RUB" Or C$="SWI" Then
    Print X$(34)
    Let K=1
  Endif
  If C$="UNL" Then
    @1590
  Endif
  If C$="INV" Then
    @1220
  Endif
  If C$="GET" Or C$="TAK" Or C$="GRA" Then
    @1000
  Endif
  If C$="DRO" Or C$="LEA" Or C$="PUT" Then
    @1140
  Endif
  If B$="U" Or D$="GO U" Or C$="CLI" Or C$="UP" Then
    @850
  Endif
  If C$="DOW" Or D$="GO D" Or B$="D" Then
    @880
  Endif
  If C$="IN" Or D$="GO I" Then
    @900
  Endif
  If C$="OUT" Or D$="GO O" Then
    @960
  Endif
  If C$="HID" Then
    @1630
  Endif
  If C$="GIV" Then
    @1770
  Endif
  If C$="CHO" Or C$="CUT" Then
    @2110
  Endif
  If C$="SEA" Or C$="EXA" Then
    @2170
  Endif
  If C$="OPE" Then
    @2200
  Endif
  If (B$="N" Or B$="S" Or B$="E" Or B$="W") And K=0 Then
    Let K=1
    Print "  I can't go that way."
  Endif
  If K=0 Then
    Print X$(29)
  Endif
Wend
Cls
@1330
End
'
Procedure 850
  Let K=1
  If P%=5 Then
    Let P%=4
    Print X$(1)
  Else
    If P%=24 And Ah=3 Then
      Let P%=25
      Print X$(1)
    Else
      If P%=24 Then
        Print X$(33)
      Else
        Print X$(32)
      Endif
    Endif
  Endif
Return
'
Procedure 880
  Let K=1
  If P%=4 Then
    Let P%=5
    Print X$(1)
  Else
    If P%=25 Then
      Let P%=24
      Print X$(1)
    Else
      Print X$(32)
    Endif
  Endif
Return
'
Procedure 900
  Let K=1
  If P%=13 And Aa<>1 Then
    Print X$(8)
  Else
    If P%=13 Then
      Let P%=14
      Print X$(1)
    Else
      If P%=17 Then
        Let P%=19
        Print X$(1)
      Else
        If P%=33 Then
          Let P%=78
          Print X$(1)
        Else
          If P%=49 Then
            Let P%=68
            Print X$(1)
          Else
            If P%=51 And Ab<>1 Then
              Print X$(23);" first!"
            Else
              If P%=51 Then
                Let P%=52
                Print X$(1)
              Else
                If P%=55 Then
                  Let P%=56
                  Print X$(1)
                Else
                  If P%=57 And Ac<>1 Then
                    Print X$(8)
                  Else
                    If P%=57 Then
                      Let P%=59
                      Print X$(1)
                    Else
                      If P%=36 Then
                        Let P%=37
                        Print X$(1)
                      Else
                        If P%=42 Then
                          Let%=39
                          Print X$(1)
                        Else
                          If P%=65 Then
                            Print "  Please be more specific!"
                          Else
                            Print X$(34)
                          Endif
                        Endif
                      Endif
                    Endif
                  Endif
                Endif
              Endif
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 960
  Let K=1
  If P%=59 Then
    Let P%=57
    Print X$(1)
  Else
    If P%=64 Or P%=67 Or P%=66 Then
      Let P%=65
      Print X$(1)
    Else
      If P%=52 Then
        Let P%=51
        Print X$(1)
      Else
        If P%=68 Then
          Let P%=49
          Print X$(1)
        Else
          If P%=78 Then
            Let P%=33
            Print X$(1)
          Else
            If P%=14 Then
              Let P%=13
              Print X$(1)
            Else
              If P%=19 Then
                Let P%=17
                Print X$(1)
              Else
                If P%=37 Then
                  Let P%=36
                  Print X$(1)
                Else
                  If P%=39 And Ad=0 Then
                    Print "  It's closed!"
                  Else
                    If P%=39 Then
                      Let P%=42
                      Print X$(1)
                    Else
                      Print X$(34)
                    Endif
                  Endif
                Endif
              Endif
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1000
  Let K=1
  @1090
  If L%<>1 Then
    Print "  I don't se any ";L$
    Goto Retur
  Endif
  Let E%=0
  For H=1 To 23
    If B%(H)=P% And B%(N%(R))=P% Then
      Let E%=1
    Endif
  Next H
  If E%=0 Then
    Print "  I don't see it here!"
    Goto Retur
  Endif
  If R=3 Or R=4 Or R=5 Or R=21 Or R=27 Then
    Print X$(34)
    Goto Retur
  Else
    If R=24 And Ax=0 Then
      Print "  It's too fast for me!"
      Goto Retur
    Else
      If R=13 Or R=14 Then
        Print "  It's too heavy to lift!"
        Goto Retur
      Endif
    Endif
  Endif
  If R=2 Then
    Let Ah=1
  Else
    If R=6 And Ah<2 Then
      Print "  They are ";X$(32)
      Goto Retur
    Else
      If R=6 And Ah>2 Then
        Print X$(34)
        Goto Retur
      Else
        If R=24 Then
          Print "  You must be joking!"
          Goto Retur
        Endif
      Endif
    Endif
  Endif
  If R=6 And P%=24 Then
    Let X$="  The beans spurt into rapid growth and in the process knock me off my feet.       I have broken my neck!"
    @1290
  Endif
  Let E%=0
  For D=1 To 4
    If V$(D)="" Then
      Let V$(D)=G$(N%(R))
      Let E%=1
      Let D=6
    Endif
  Next D
  Print X$(1)
  If E%=0 Then
    Print "  My hands are full.. So sorry!"
    Goto Retur
  Endif
  Let B%(N%(R))=0
  Retur:
Return
'
Procedure 1090
  For X=1 To 30
    N$(X)=Upper$(N$(X))
  Next X
  Let L$=""
  For H=1 To Len(Z$)
    If Mid$(Z$,H,1)=" " Then
      Let L$=Right$(Z$,(Len(Z$)-H))
      Let H=80
    Endif
  Next H
  Let R=0
  Let L%=0
  If Len(L$)<2 Then
  Else
    For H=1 To 27
      If Left$(N$(H),Len(L$))=L$ Then
        Let L%=1
        Let R=H
      Endif
    Next H
  Endif
Return
'
Procedure 1140
  Let K=1
  @1090
  If L%<>1 Then
    Print "  I don't have a ";L$
  Else
    E%=0
    For D=1 To 4
      If V$(D)=G$(N%(R)) Then
        Let V$(D)=""
        Let E%=1
        Print X$(1)
      Endif
    Next D
    If E%<>1 Then
      Print "  I haven't got it!"
    Else
      B%(N%(R))=P%
      If R=2 Then
        Let Ah=0
      Else
        If R=6 And P%=24 Then
          @1830
        Else
          If P%=2 And R=15 Then
            Print "  Mother is delighted with this gift and orders me to climb the beanstalk         again."
            Ak=1
            S%=S%+10
            Af=7
            B%(13)=-1
          Else
            If (R=16 Or R=17) And P%=2 Then
              Let S%=S%+10
              Print "  Mother is so pleased with me and begs me to go back just one more time!"
              Ak=2
              Af=3
              B%(14)=-1
            Else
              If R=18 And P%=2 Then
                Print "  Mother is so pleased with me...but I'd better be quick!"
                Ak=3
                S%=80
                B%(15)=-1
              Endif
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1220
  K=1
  Print "  I am carrying :-"
  F%=0
  For H=1 To 4
    If V$(H)<>"" Then
      Print "  ";V$(H)
      F%=1
    Endif
  Next H
  If Ai=1 Then
    Print "  I am in disguise as the woodcutter!"
  Endif
  If Aj=1 Then
    Print "  I am in disguise as an old lady!"
  Endif
  If F%=0 Then
    Print "  Nothing at all."
  Endif
  Print
Return
'
Procedure 1290
  '  ** lose game **
  Cls
  K=1
  Print
  Print "  ";X$
  Print At(5,5);"So Sorry... You have just been killed."
  Print At(20,12);X$(27);" <Y/N>"
  Do
    X$=Input$(1)
    X$=Upper$(X$)
    Exit If X$="Y" Or X$="N"
  Loop
  If X$="Y" Then
    Run
  Endif
  Cls
  Print At(5,15);"Goodbye. Thank you for playing."
  End
Return
'
Procedure 1330
  '  **  game solved  **
  Print
  Print "  Well done. You have completely solved this adventure."
  Print
  Print
  Print "  You have found all the treasure and killed the Ogre!"
  Print
  Print
  Print "  Goodbye.      Thank you for playing!"
  End
Return
'
Procedure 1370
  '  **  save game  **
  Cls
  Print
  Dir "B:*.DAT"
  Print
  Print "  Insert data disc in drive B:"
  Print "  Input name of datafile (no extension!) ";
  Input N$
  N$="B:\"+N$+".DAT"
  Print
  Print "  Saving data now."
  Open "o",#1,N$
  For X=1 To 78
    Write #1,Q$(X)
  Next X
  For X=1 To 78
    For Y=1 To 4
      Write #1,S%(X,Y)
    Next Y
  Next X
  For X=1 To 23
    Write #1,G$(X)
  Next X
  For X=1 To 23
    Write #1,B%(X)
  Next X
  For X=1 To 27
    Write #1,N$(X)
  Next X
  For X=1 To 27
    Write #1,N%(X)
  Next X
  For X=1 To 34
    Write #1,X$(X)
  Next X
  For X=1 To 4
    Write #1,V$(X)
  Next X
  Write #1,Aa,Ab,Ac,Ad,Ae,Af,Ag,Ah,Ai,Aj,Ak,Al,Am,An,Ao,Ap,Aq,Ar,As,At,Au,Av,Aw,Ax,Ay,Az,S%,P%
  Close #1
  Cls
Return
'
Procedure 1480
  '  **  quit game  **
  Cls
  Print
  Print "  Would you like to save the game <Y/N> ?"
  Do
    X$=Input$(1)
    X$=Upper$(X$)
    Exit If X$="Y" Or X$="N"
  Loop
  If X$="Y" Then
    @1370
  Endif
  Cls
  End
Return
'
Procedure 1510
  K=1
  If P%=65 Then
    Print "  I'd hide somewhere quickly!"
  Else
    If P%=51 Then
      Print "  She might let me in if I'm kind."
      Print "  'Please help me, I'm plagued with mice' she says."
    Else
      If P%=49 Then
        Print "  Why not go in ?"
      Else
        If P%=78 Then
          Print "  I bet that would be a good disguise!"
        Else
          If P%=36 Then
            Print "  Be brave..!"
          Else
            If P%=57 Then
              Print "  You need a key!"
            Else
              If P%=13 Then
                Print "  Can you remember the combination?"
              Else
                Print X$(28)
              Endif
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1540
  Q%=0
  If P%=9 Then
    Print "  What a boring paper. No page 3 !"
    Q%=1
  Else
    U%=7
  Endif
  @1570
  If E%=0 And Q%=0 Then
    Print "  I haven't got anything worth reading!"
  Else
    If Q%=0 Then
      Print X$(6)
    Endif
  Endif
Return
'
Procedure 1570
  E%=0
  For X%=1 To 4
    If V$(X%)=G$(U%) Then
      Let E%=1
    Endif
  Next X%
Return
'
Procedure 1590
  K=1
  If P%=13 Then
    @1600
  Else
    If P%=57 Then
      @1620
    Else
      Print X$(34)
    Endif
  Endif
Return
'
Procedure 1600
  Cls
  Print
  Print X$(9)
  Print
  Print "  What's the combination ";
  Input Z$
  If Z$=Pp$ Then
    Print X$(1);
    S%(13,4)=14
    Aa=1
    Print "  The lock opens!"
    S%=S%+5
  Else
    Print "  The wrong combination!"
  Endif
Return
'
Procedure 1620
  U%=16
  @1570
  If E%=0 Then
    Print X$(14)
  Else
    Print X$(1)
    S%(57,2)=59
    Q$(57)=Left$(Q$(57),19)
  Endif
Return
'
Procedure 1630
  K=1
  If P%<>65 Then
    Print X$(32)
  Else
    Print
    Input "  Where should I hide";Z$
    Z$=Upper$(Z$)
    Z$=Left$(Z$,3)
    If Z$="CUP" Or Z$="COP" Or Z$=N$(14) Or Left$(Z$,3)="OVE" Then
      @1660
    Else
      Print X$(29)
    Endif
  Endif
Return
'
Procedure 1660
  If Ae=0 And Left$(Z$,3)="OVE" Then
    Ae=1
    P%=66
    Print X$(1)
  Else
    If Left$(Z$,3)="OVE" Then
      X$="  The Ogre sneaks up behind me and eats me."
      @1290
    Else
      If Ak<1 Then
        Print X$(33)
        Print
        Print "  I must take my treasure back to mother first!!"
      Else
        If Ae=1 And Z$="CUP" Then
          Print X$(1)
          Ae=2
          P%=64
          S%=S%+5
          Ax=1
        Else
          If Z$=N$(14) Then
            X$="  The Ogre catches me and throws me to the snakes!"
            Gosub 1290
          Else
            If Ak<2 Then
              Print X$(33)
              Print
              Print "  I must take my treasure back to mother first!"
            Else
              If Ae=2 And Z$="COP" Then
                Print X$(1)
                P%=67
                Ae=3
                S%=S%+5
              Else
                If Z$=N$(13) Then
                  X$="  'FEE FIE FOE FUM' says the Ogre as he grabs me from behind and casts me to the rats!"
                  @1290
                Else
                  Print X$(19)
                Endif
              Endif
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1720
  Print "  I hear the Ogre come in and say:-"
  Print "  'Fee Fie Foe Fum...I smell the blood of an Englishman'"
  Print "  He keeps on talking to something..."
  Print "  I hear the word 'LAY' over again!"
  G$(13)="a goose that lays golden eggs."
  1730:
  Print
  Print "  What should I do ";
  Input Z$
  Z$=Upper$(Z$)
  If Left$(Z$,3)="OUT" Or Left$(Z$,4)="GO O" And Af<>1 Then
    X$="  He grabs hold of me."
    @1290
  Else
    If Left$(Z$,3)="WAI" Then
      @1760
      Print "  The Ogre falls asleep in a chair!"
      S%=S%+5
    Else
      If Left$(Z$,3)="OUT" Or Left$(Z$,4)="GO O" Then
        P%=65
      Else
        Print X$(29)
        Goto 1730
      Endif
    Endif
  Endif
Return
'
Procedure 1760
  Af=1
  Print X$(1)
  For X=1 To 1000
  Next X
Return
'
Procedure 1770
  K=1
  @1090
  If P%=19 And R=2 And Ah<>1 Then
    Print X$(33)
  Else
    If P%=19 And R=2 Then
      Print
      Print "  He is very grateful and drops something."
      G$(6)="Some strange looking beans."
      S%=S%+5
      Ah=2
      For A=1 To 4
        If V$(A)=G$(2) Then
          V$(A)=""
          If P%=19 And R=2 Then
          Endif
        Endif
      Next A
    Else
      If P%=51 And R=10 Then
        U%=9
        @1570
        If E%<>1 Then
          Print "  I don't have any!"
        Else
          If P%=51 And R=10 Then
            Ab=1
            Print X$(1)
            Print
            Print "  'Help yourself', she says and pushes me into the closet."
            P%=52
          Else
            Print "  I can't do that here!"
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1830
  K=1
  If P%<>24 Then
    Print X$(32)
  Else
    If Ah<2 Then
      Print "  I need some seeds to sow!"
    Else
      Print "  A giant Beanstalk spurts into rapid growth!"
      Ah=3
      S%=S%+5
    Endif
  Endif
Return
'
Procedure 1860
  K=1
  If P%=51 Then
    G$(23)="a poor DEAD little old lady!"
    Print "  She died of fright...you cruel and heartless creature"
  Endif
  If P%=15 And Ax=0 Then
    Print X$(1)
    G$(21)="a dead mouse"
  Endif
  If P%=15 And Ax=1 Then
    U%=19
    Gosub 1570
  Endif
  If E%=0 Then
    Print "  I don't have a sword!"
  Else
    If P%=15 And Ax=1 Then
      Print X$(1)
      Ax=2
      G$(21)="An evil old DEAD witch"
      S%(15,1)=11
    Endif
  Endif
  If P%=65 Then
    X$="  The Ogre's wife cries out and HE hears"
    Gosub 1290
  Else
    If P%=19 Then
      Print X$(34)
    Else
      If P%=23 Then
        Print "  I'm not that heartless!"
      Else
        If P%=2 Then
          Print "  What a silly suggestion. She is my mother you know!"
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1910
  K=1
  Gosub 1090
  If (R=11 Or R=12) Then
    U%=10
    Gosub 1570
  Endif
  If E%<>1 Then
    Print X$(34)
  Else
    If (R=11 Or R=12) And Aj<>1 Then
      Ai=1
      Print X$(1)
    Else
      If (R=11 Or R=12) Then
        Print "  I'm already in disguise!"
      Else
        If R=20 Then
          U%=17
          Gosub 1570
        Endif
        If E%<>1 Then
          Print X$(34)
        Else
          If R=20 And Ai<>1 Then
            Aj=1
            Print X$(1)
          Else
            If R=20 Then
              Print "  I'm already in disguise!"
            Else
              Print "  I can't do that at the moment!"
            Endif
          Endif
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 1960
  K=1
  If Ai=1 Then
    Ai=0
    Print X$(1)
  Else
    If Aj=1 Then
      Aj=0
      Print X$(1)
    Else
      Print X$(34)
    Endif
  Endif
Return
'
Procedure 1990
  If Ak=0 Then
    Goto Retur
  Else
    If Ak=1 And Ai<>1 Then
      X$="  The Ogre's wife rushes over and says  I'll not have you in here again!"
      Gosub 1290
    Else
      If Ak=1 And Ai=1 Then
        Print "  The Ogre's wife greats me saying: 'Hello Mr. Woodcutter. Come in!'"
      Else
        If Ak=2 And Aj<>1 Then
          X$="  The Ogre rushes out and says 'My wife told me about you!'"
          Gosub 1290
        Else
          Print "  The Ogre's wife invites me in!"
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 2030
  Print "  What do I do now ";
  Input Z$
  Z$=Upper$(Z$)
  If Left$(Z$,3)<>"WAI" Then
    X$="  The Ogre opens the door and catches me!"
    Gosub 1290
  Else
    Gosub 1760
    Print "  I hear the Ogre come in and sit in his chair. A few minutes later              I hear snoring!"
    G$(14)="a large bag of money"
  Endif
Return
'
Procedure 2060
  Print
  Print "  What do I do now ";
  Input Z$
  Z$=Upper$(Z$)
  If Left$(Z$,3)<>"WAI" Then
    X$=X$(17)+Chr$(10)+"The Ogre comes in and finds me!"
    Gosub 1290
  Else
    Gosub 1760
    Print "  The Ogre comes in with a golden harp."
    Print "  He says 'PLAY HARP PLAY' and the harp plays"
    Print "  a gentle tune. The Ogre falls asleep!"
    Af=1
    G$(15)="a golden harp"
    As=50
  Endif
Return
'
Procedure 2090
  If As<2 Then
    X$="  The evil Ogre climbs down the beanstalk and kills everyone                      (including mother!)"
    Gosub 1290
  Else
    As=As-1
    Print "  I have only ";As;" moves before the Ogre comes down!"
  Endif
Return
'
Procedure 2110
  U%=1
  Gosub 1570
  K=1
  If E%<>1 Then
    Print X$(10)
  Else
    If P%<>24 Then
      Print X$(22)
    Else
      If Ah<>3 Then
        Print X$(33)
      Else
        If S%<80 Then
          Print "  I must not do that just yet!"
        Else
          Print "  The beanstalk falls to the ground, The evil Ogre tumbles down                    and breaks his neck!"
          Gosub 1330
        Endif
      Endif
    Endif
  Endif
Return
'
Procedure 2170
  K=1
  If P%<>15 Then
    Print X$(4)
  Else
    If At=0 Then
      Print "  Something moved!!"
      G$(21)="A big fat mouse!"
      At=1
    Else
      Print X$(4)
    Endif
  Endif
Return
'
Procedure 2200
  K=1
  If P%=39 Then
    Print X$(1)
    S%(39,2)=42
    Print "  The door is now open."
  Else
    Print X$(32)
  Endif
Return
'
Procedure 2210
  K=1
  Gosub 1090
  If P%<>50 Then
    Print X$(22)
  Else
    If Av<1 Then
      Print X$(1)
      Print "  Something happened!"
      S%(50,2)=53
      Av=1
      Q$(50)="by a drawbridge. It is down."
    Endif
  Endif
Return
'
Procedure 2240
  G$(21)="An evil witch who blocks the path!"
  N$(24)="witch"
  S%(15,1)=0
Return
'
Procedure 2250
  K=1
  Cls
  Print
  Dir "B:*.dat"
  Print
  Print "  Insert data disc into drive B:"
  Print "  Input name of datafile (no extension)!";
  Input N$
  If N$="" Then
    Cls
    Goto Retur
  Endif
  N$="B:\"+N$+".DAT"
  Print
  Print "  Loading data now."
  Open "i",#1,N$
  For X=1 To 78
    Input #1,Q$(X)
  Next X
  For X=1 To 78
    For Y=1 To 4
      Input #1,S%(X,Y)
    Next Y
  Next X
  For X=1 To 23
    Input #1,G$(X)
  Next X
  For X=1 To 23
    Input #1,B%(X)
  Next X
  For X=1 To 27
    Input #1,N$(X)
  Next X
  For X=1 To 27
    Input #1,N%(X)
  Next X
  For X=1 To 34
    Input #1,X$(X)
  Next X
  For X=1 To 4
    Input #1,V$(X)
  Next X
  Input #1,Aa,Ab,Ac,Ad,Ae,Af,Ag,Ah,Ai,Aj,Ak,Al,Am,An
  Input #1,Ao,Ap,Aq,Ar,As,At,Au,Av,Aw,Ax,Ay,Az,S%,P%
  Close #1
  Cls
Return
'         * * * * * * * * * * * * * * * * * *
'         * * * * *                 * * * * *
'         * * * * *     S L U T     * * * * *
'         * * * * *                 * * * * *
'         * * * * * * * * * * * * * * * * * *
