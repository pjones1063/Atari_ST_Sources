PROCEDURE gfa_graf3d__(x__%,y__%,char__$,options__%,miroir__%,angle__%,xfacteur__,yfacteur__,zfacteur__,xpenche__%)
  LOCAL b__%,hauteur__%,quantite__%,aide__%
  IF graf3din__!=FALSE
    lib_rv__%=0
    DIM graf3dal__%(1000,2)
    DIM graf3dko__%(200,2)
    DIM graf3dpo__%(50)
    quantite__%=0
    RESTORE pos3d__
    DO
      READ b__%
      graf3dpo__%(nombre__%)=b__%
      EXIT IF b__%=-1
      INC nombre__%
    LOOP
    RESTORE graf3dhx__
    nombre__%=0
    DO
      READ b__%
      EXIT IF b__%=-999
      graf3dal__%(nombre__%,0)=b__%
      READ b__%
      graf3dal__%(nombre__%,1)=b__%
      INC nombre__%
    LOOP
    graf3din__!=TRUE
  ELSE
    IF ASC(char__$)>64 AND ASC(char__$)<91
      lib_rv__%=0
      hauteur__%=50
      profdr__%=16
      xo__%=x__%
      yo__%=y__%
      offset__%=ASC(char__$)-65
      points__%=((graf3dpo__%(offset__%+1)-graf3dpo__%(offset__%))-2)/2
      start__%=(graf3dpo__%(offset__%)/2)
      i__%=0
      FOR b__%=0 TO points__%-1 STEP 2
        graf3dko__%(i__%,0)=graf3dal__%(start__%,0)
        graf3dko__%(i__%,1)=graf3dal__%(start__%,1)
        graf3dko__%(i__%,2)=0
        INC i__%
        graf3dko__%(i__%,0)=graf3dal__%(start__%+1,0)
        graf3dko__%(i__%,1)=graf3dal__%(start__%+1,1)
        graf3dko__%(i__%,2)=0
        INC i__%
        graf3dko__%(i__%,0)=graf3dal__%(start__%+1,0)
        graf3dko__%(i__%,1)=graf3dal__%(start__%+1,1)
        graf3dko__%(i__%,2)=profdr__%
        INC i__%
        graf3dko__%(i__%,0)=graf3dal__%(start__%,0)
        graf3dko__%(i__%,1)=graf3dal__%(start__%,1)
        graf3dko__%(i__%,2)=profdr__%
        INC i__%
        ADD start__%,2
      NEXT b__%
      '
      IF (options__% AND 1)
        ' -------------------------- ‚chelle
        FOR i__%=0 TO points__%*2-1
          graf3dko__%(i__%,0)=graf3dko__%(i__%,0)*xfacteur__
          graf3dko__%(i__%,1)=graf3dko__%(i__%,1)*yfacteur__
          graf3dko__%(i__%,2)=graf3dko__%(i__%,2)*zfacteur__
        NEXT i__%
      ENDIF
      IF (options__% AND 2)
        ' --------------------------- rotation
        b__=angle__%*PI/180
        var1__=SIN(b__)
        var2__=COS(b__)
        FOR i__%=0 TO points__%*2-1
          xs__%=graf3dko__%(i__%,0)
          ys__%=-graf3dko__%(i__%,1)
          graf3dko__%(i__%,0)=xs__%*var2__+ys__%*var1__
          graf3dko__%(i__%,1)=-(ys__%*var2__-xs__%*var1__)
        NEXT i__%
      ENDIF
      IF (options__% AND 4)
        ' -------------------------- inclinaison
        FOR i__%=0 TO points__%*2-1
          graf3dko__%(i__%,0)=graf3dko__%(i__%,0)+(graf3dko__%(i__%,1)*xpenche__%/hauteur__%)
        NEXT i__%
      ENDIF
      IF (options__% AND 8)
        ' -------------------------- miroir
        IF miroir__%=1
          FOR i__%=0 TO points__%*2-1
            graf3dko__%(i__%,0)=-graf3dko__%(i__%,0)
          NEXT i__%
        ELSE
          FOR i__%=0 TO points__%*2-1
            graf3dko__%(i__%,1)=-graf3dko__%(i__%,1)
          NEXT i__%
        ENDIF
      ENDIF
      i__%=0
      fakt__=SQR(3)/2
      FOR b__%=0 TO points__%-1 STEP 2
        x1nouv__%=graf3dko__%(i__%,0)+fakt__*graf3dko__%(i__%,2)+xo__%
        y1nouv__%=graf3dko__%(i__%,1)-graf3dko__%(i__%,2)+yo__%
        x2nouv__%=graf3dko__%(i__%+1,0)+fakt__*graf3dko__%(i__%+1,2)+xo__%
        y2nouv__%=graf3dko__%(i__%+1,1)-graf3dko__%(i__%+1,2)+yo__%
        x3nouv__%=graf3dko__%(i__%+2,0)+fakt__*graf3dko__%(i__%+2,2)+xo__%
        y3nouv__%=graf3dko__%(i__%+2,1)-graf3dko__%(i__%+2,2)+yo__%
        x4nouv__%=graf3dko__%(i__%+3,0)+fakt__*graf3dko__%(i__%+3,2)+xo__%
        y4nouv__%=graf3dko__%(i__%+3,1)-graf3dko__%(i__%+3,2)+yo__%
        LINE x1nouv__%,y1nouv__%,x2nouv__%,y2nouv__%
        LINE x2nouv__%,y2nouv__%,x3nouv__%,y3nouv__%
        LINE x3nouv__%,y3nouv__%,x4nouv__%,y4nouv__%
        LINE x4nouv__%,y4nouv__%,x1nouv__%,y1nouv__%
        ADD i__%,4
      NEXT b__%
    ELSE
      lib_rv__%=1
    ENDIF
  ENDIF
  '
  pos3d__:
  ' Position
  DATA 000,042,128,210,260,310,352,442,492,510,560,610,636,686
  '         A   B   C   D   E   F   G   H   I   J   K   L   M
  DATA 728,794,852,946,1016,1130,1164,1214,1244,1294,1352,1390,1432,-1
  '     N   O   P   Q   R    S    T    U     V    W   X    Y    Z
  graf3dhx__:
  ' Lettre "A",42
  DATA 000,000,015,-50,015,-50,030,000,030,000,026,000,026,000,022,-14
  DATA 022,-14,008,-14,008,-14,004,000,004,000,000,000,009,-17,021,-17
  DATA 021,-17,015,-37,015,-37,009,-17,002,-02
  ' Lettre "B",86
  DATA 000,000,000,-50,000,-50,020,-50,020,-50,025,-45,025,-45,025,-30
  DATA 025,-30,020,-25,020,-25,025,-20,025,-20,025,-05,025,-05,020,000
  DATA 020,000,000,000,003,-03,003,-24,003,-27,003,-47,003,-47,019,-47
  DATA 019,-47,022,-44,022,-44,022,-31,022,-31,018,-27,018,-27,003,-27
  DATA 003,-24,018,-24,018,-24,022,-20,022,-20,022,-06,022,-06,019,-03
  DATA 019,-03,004,-03,002,-02
  ' Lettre "C",82
  DATA 25,0,5,0,5,0,0,-5,0,-5,0,-45,0,-45,5,-50
  DATA 5,-50,25,-50,25,-50,30,-45,30,-45,30,-40
  DATA 30,-40,27,-40,27,-40,27,-44,27,-44,24,-47
  DATA 24,-47,6,-47,6,-47,3,-44,3,-44,3,-6,3,-6,6,-3
  DATA 6,-3,24,-3,24,-3,27,-6,27,-6,27,-10,27,-10,30,-10
  DATA 30,-10,30,-5,30,-5,25,0,10,-2
  ' Lettre "D",50
  DATA 0,0,0,-50,0,-50,20,-50,20,-50,30,-40,30,-40,30,-10
  DATA 30,-10,20,0,20,0,0,0,3,-3,3,-47,3,-47,19,-47
  DATA 19,-47,27,-39,27,-39,27,-11,27,-11,19,-3,19,-3,3,-3
  DATA 2,-2
  ' Lettre "E",50
  DATA 0,0,0,-50,0,-50,30,-50,30,-50,30,-47,30,-47,3,-47
  DATA 3,-47,3,-27,3,-27,27,-27,27,-27,27,-24,27,-24,3,-24
  DATA 3,-24,3,-3,3,-3,30,-3,30,-3,30,0,30,0,0,0
  DATA 2,-2
  ' Lettre "F",42
  DATA 0,0,0,-50,0,-50,30,-50,30,-50,30,-47,30,-47,3,-47
  DATA 3,-47,3,-27,3,-27,27,-27,27,-27,27,-24,27,-24,3,-24
  DATA 3,-24,3,0,3,0,0,0
  DATA  2,-2
  ' Lettre "G",90
  DATA 0,-5,0,-45,0,-45,5,-50,5,-50,25,-50,25,-50,30,-45
  DATA 30,-45,30,-40,30,-40,27,-40,27,-40,27,-44,27,-44,24,-47
  DATA 24,-47,6,-47,6,-47,3,-44,3,-44,3,-6,3,-6,6,-3
  DATA 6,-3,24,-3,24,-3,27,-6,27,-6,27,-22,27,-22,18,-22
  DATA 18,-22,18,-25,18,-25,30,-25,30,-25,30,-5,30,-5,25,0
  DATA 25,0,5,0,5,0,0,-5,10,-2
  ' Lettre "H",50
  DATA 0,0,0,-50,0,-50,3,-50,3,-50,3,-27,3,-27,27,-27
  DATA 27,-27,27,-50,27,-50,30,-50,30,-50,30,0,30,0,27,0
  DATA 27,0,27,-24,27,-24,3,-24,3,-24,3,0,3,0,0,0
  DATA 2,-2
  ' Lettre "I",18
  DATA 14,0,14,-50,14,-50,17,-50,17,-50,17,0,17,0,14,0
  DATA 15,-2
  ' Lettre "J",50
  DATA 0,-5,0,-10,0,-10,3,-10,3,-10,3,-6,3,-6,6,-3
  DATA 6,-3,24,-3,24,-3,27,-6,27,-6,27,-50,27,-50,30,-50
  DATA 30,-50,30,-5,30,-5,25,0,25,0,5,0,5,0,0,-5
  DATA 10,-2
  ' Lettre "K",50
  DATA 0,0,0,-50,0,-50,3,-50,3,-50,3,-27,3,-27,26,-50
  DATA 26,-50,30,-50,30,-50,7,-27,7,-27,30,0,30,0,27,0
  DATA 27,0,5,-25,5,-25,3,-23,3,-23,3,0,3,0,0,0
  DATA 2,-2
  ' Lettre "L",26
  DATA 0,0,0,-50,0,-50,3,-50,3,-50,3,-3,3,-3,30,-3
  DATA 30,-3,30,0,30,0,0,0,2,-2
  ' Lettre "M",50
  DATA 0,0,0,-50,0,-50,3,-50,3,-50,15,-38,15,-38,27,-50
  DATA 27,-50,30,-50,30,-50,30,0,30,0,27,0,27,0,27,-46
  DATA 27,-46,15,-34,15,-34,3,-46,3,-46,3,0,3,0,0,0
  DATA 2,-2
  ' Lettre "N",42
  DATA 0,0,0,-50,0,-50,4,-50,4,-50,27,-4,27,-4,27,-50
  DATA 27,-50,30,-50,30,-50,30,0,30,0,26,0,26,0,3,-46
  DATA 3,-46,3,0,3,0,0,0,2,-2
  ' Lettre "O",66
  DATA 0,-5,0,-45,0,-45,5,-50,5,-50,25,-50,25,-50,30,-45
  DATA 30,-45,30,-5,30,-5,25,0,25,0,5,0,5,0,0,-5
  DATA 3,-6,3,-44,3,-44,6,-47,6,-47,24,-47,24,-47,27,-44
  DATA 27,-44,27,-6,27,-6,24,-3,24,-3,6,-3,6,-3,3,-6
  DATA 10,-2
  ' Lettre "P",58
  DATA 0,0,0,-50,0,-50,25,-50,25,-50,30,-45,30,-45,30,-30
  DATA 30,-30,25,-25,25,-25,3,-25,3,-25,3,0,3,0,0,0
  DATA 3,-28,3,-47,3,-47,24,-47,24,-47,27,-44,27,-44,27,-31
  DATA 27,-31,24,-28,24,-28,3,-28,2,-2
  ' Lettre "Q",94
  DATA 0,-5,0,-45,0,-45,5,-50,5,-50,25,-50,25,-50,30,-45
  DATA 30,-45,30,-5,30,-5,29,-4,29,-4,30,-3,30,-3,30,0
  DATA 30,0,27,0,27,0,26,-1,26,-1,25,0,25,0,5,0
  DATA 5,0,0,-5,3,-6,3,-44,3,-44,6,-47,6,-47,24,-47
  DATA 24,-47,27,-44,27,-44,27,-6,27,-6,24,-9,24,-9,21,-6
  DATA 21,-6,24,-3,24,-3,6,-3,6,-3,3,-6,10,-2
  ' Lettre "R",70
  DATA 0,0,0,-50,0,-50,25,-50,25,-50,30,-45,30,-45,30,-30
  DATA 30,-30,25,-25,25,-25,30,0,30,0,27,0,27,0,22,-25
  DATA 22,-25,3,-25,3,-25,3,0,3,0,0,0,3,-28,3,-47
  DATA 3,-47,24,-47,24,-47,27,-44,27,-44,27,-31,27,-31,24,-28
  DATA 24,-28,3,-28,2,-2
  ' Lettre "S",114
  DATA 0,-10,3,-10,3,-10,3,-6,3,-6,6,-3,6,-3,24,-3
  DATA 24,-3,27,-6,27,-6,27,-22,27,-22,24,-25,24,-25,5,-25
  DATA 5,-25,0,-30,0,-30,0,-45,0,-45,5,-50,5,-50,25,-50
  DATA 25,-50,30,-45,30,-45,30,-40,30,-40,27,-40,27,-40,27,-44
  DATA 27,-44,24,-47,24,-47,6,-47,6,-47,3,-44,3,-44,3,-31
  DATA 3,-31,6,-28,6,-28,25,-28,25,-28,30,-23,30,-23,30,-5
  DATA 30,-5,25,0,25,0,5,0,5,0,0,-5,0,-5,0,-10
  DATA 10,-2
  ' Lettre "T",34
  DATA 0,-47,0,-50,0,-50,29,-50,29,-50,29,-47,29,-47,16,-47
  DATA 16,-47,16,0,16,0,13,0,13,0,13,-47,13,-47,0,-47
  DATA 15,-48
  ' Lettre "U",50
  DATA 0,-5,0,-50,0,-50,3,-50,3,-50,3,-6,3,-6,6,-3
  DATA 6,-3,24,-3,24,-3,27,-6,27,-6,27,-50,27,-50,30,-50
  DATA 30,-50,30,-5,30,-5,25,0,25,0,5,0,5,0,0,-5
  DATA 10,-2
  ' Lettre "V",30
  DATA 0,-50,4,-50,4,-50,15,-4,15,-4,26,-50,26,-50,30,-50
  DATA 30,-50,16,0,16,0,14,0,14,0,0,-50,2,-48
  ' Lettre "W",50
  DATA 0,0,0,-50,0,-50,3,-50,3,-50,3,-4,3,-4,15,-16
  DATA 15,-16,27,-4,27,-4,27,-50,27,-50,30,-50,30,-50,30,0
  DATA 30,0,27,0,27,0,15,-12,15,-12,3,0,3,0,0,0
  DATA 2,-2
  ' Lettre "X",58
  DATA 0,0,12,-24,12,-24,12,-26,12,-26,0,-50,0,-50,4,-50
  DATA 4,-50,15,-28,15,-28,26,-50,26,-50,30,-50,30,-50,18,-26
  DATA 18,-26,18,-24,18,-24,30,0,30,0,26,0,26,0,15,-22
  DATA 15,-22,4,0,4,0,0,0,2,-2
  ' Lettre "Y",38
  DATA 13,0,13,-24,13,-24,0,-50,0,-50,4,-50,4,-50,15,-28
  DATA 15,-28,26,-50,26,-50,30,-50,30,-50,17,-24,17,-24,17,0
  DATA 17,0,13,0,15,-2
  ' Lettre "Z",42
  DATA 0,0,0,-4,0,-4,26,-47,26,-47,0,-47,0,-47,0,-50
  DATA 0,-50,30,-50,30,-50,30,-47,30,-47,4,-3,4,-3,30,-3
  DATA 30,-3,30,0,30,0,0,0,2,-2
  DATA -999
RETURN
