' ==============================================================================
' ********************
' ***         .GFA ***
' ********************
' *** this program runs in Medium resolution
'
' ------------------------------------------------------------------------------
'                             *** Initiation ***
'
DEFWRD "a-z"                    ! word variables (-32768 to +32767) default !!
@save.palette
@initio.system
@initio
@read.arrays
@read.names
@old.english.poem.read
@old.norse.poem.read
@old.icelandic.poem.read
@meanings.read
@check.exist.runepics
@read.pic.bits("RUNEPICS.GET",68)
'
@title.screen("RUNE CASTER","Ek vitki rist runar"," Wolfmoon 1993",32)
'
' ON BREAK GOSUB break                            ! activate in finished program
' ------------------------------------------------------------------------------
'
' ____________________________________________________________________________
'
'
'                            *** Main Program ***
'
'
'                     ***            Menu            ***
'
CLS
DIM menu$(150)
@menu_setup
MENU menu$()
ON MENU GOSUB choice
DO
  ON MENU
  sel%=MENU(0)
LOOP
> PROCEDURE choice
  SHOWM
  MENU OFF
  sel%=MENU(0)
  IF menu$(sel%)=" About Runecaster "
    @runecaster.info
  ENDIF
  IF menu$(sel%)=" Show old English row "
    @show.old.english.row
  ENDIF
  IF menu$(sel%)=" Show old Norse row "
    @show.old.norse.row
  ENDIF
  IF menu$(sel%)=" Show Northumbrian row "
    @show.northumbrian.row
  ENDIF
  IF menu$(sel%)=" Show extended Northumbrian "
    @show.ext.northumbrian.row
  ENDIF
  IF menu$(sel%)=" Show old English poem "
    @old.english.poem
  ENDIF
  IF menu$(sel%)=" Show old Norse poem "
    @old.norse.poem
  ENDIF
  IF menu$(sel%)=" Show old Icelandic poem "
    @old.icelandic.poem
  ENDIF
  IF menu$(sel%)=" One rune "
    @one.rune
  ENDIF
  IF menu$(sel%)=" Three rune "
    @three.rune
  ENDIF
  IF menu$(sel%)=" Yggdrasil "
    @yggdrasil
  ENDIF
  IF menu$(sel%)=" Eightfold Wheel "
    @eightfold.wheel
  ENDIF
  IF menu$(sel%)=" Cross of Thor "
    @cross.of.thor
  ENDIF
  IF menu$(sel%)=" Hammer of Thor "
    @hammer.of.thor
  ENDIF
  IF menu$(sel%)=" Leave program "
    @exit
  ENDIF
  MENU menu$()
RETURN
> PROCEDURE menu_setup
  menu$(0)="Desk"
  menu$(1)=" About Runecaster "
  menu$(2)="----------------------"
  menu$(3)=" 1 "
  menu$(4)=" 2 "
  menu$(5)=" 3 "
  menu$(6)=" 4 "
  menu$(7)=" 5 "
  menu$(8)=" 6 "
  menu$(9)=""
  menu$(10)="Runerows"
  menu$(11)=" Show old English row "
  menu$(12)=" Show old Norse row "
  menu$(13)=" Show Northumbrian row "
  menu$(14)=" Show extended Northumbrian "
  menu$(15)=""
  menu$(16)="Rune poems"
  menu$(17)=" Show old English poem "
  menu$(18)=" Show old Norse poem "
  menu$(19)=" Show old Icelandic poem "
  menu$(20)=""
  menu$(21)="Cast runes"
  menu$(22)=" One rune "
  menu$(23)=" Three rune "
  menu$(24)=" Cross of Thor "
  menu$(25)=" Hammer of Thor "
  menu$(26)=" Eightfold Wheel "
  menu$(27)=" Yggdrasil "
  menu$(28)=""
  menu$(29)="Quit"
  menu$(30)=" Leave program "
  menu$(31)=""
  menu$(32)=""
RETURN
'
'
' ------------------------------------------------------------------------------
' ------------------------------------------------------------------------------
'
'
'                     *** Standard Globals and Array ***
'
> PROCEDURE initio
  LOCAL w,h,n
  '
  CLS
  @med.mode
  '
  @get.path(default.path$)
  '
  physbase%=XBIOS(2)            ! physical screen
  logbase%=XBIOS(3)             ! logical screen
  '
  IF XBIOS(4)=2
    high.res!=TRUE
    scrn.x.max=WORK_OUT(0)                              ! 639 (regular monitor)
    scrn.y.max=WORK_OUT(1)                              ! 399
    ~GRAF_HANDLE(char.width,char.height,w,h)            ! 8x16 font
    scrn.col.max=DIV(SUCC(scrn.x.max),char.width)       ! 80
    scrn.lin.max=DIV(SUCC(scrn.y.max),char.height)      ! 25
  ELSE
    med.res!=TRUE
    scrn.x.max=WORK_OUT(0)                              ! 639 (regular monitor)
    scrn.y.max=WORK_OUT(1)                              ! 199
    ~GRAF_HANDLE(char.width,char.height,w,h)            ! 8x8 font
    scrn.col.max=DIV(SUCC(scrn.x.max),char.width)       ! 80
    scrn.lin.max=DIV(SUCC(scrn.y.max),char.height)      ! 25
  ENDIF
  '
  IF high.res!
    white=0
    black=1
    red=black           ! change red and green to black if in High resolution
    green=black
    VSETCOLOR 1,0
    DEFTEXT black,0,0,13
  ELSE
    white=0             ! default Medium colors
    black=1
    red=2
    green=3
    DEFTEXT black,0,0,6
  ENDIF
  '
  ' *** create Standard Array color.index()
  ' *** use this array to convert a VDI color-index into a 'SETCOLOR'-index
  DIM color.index(3)
  IF high.res!
    RESTORE col.index.high
  col.index.high:
    DATA 0,1,1,1
  ENDIF
  IF med.res!
    RESTORE col.index.med
  col.index.med:
    DATA 0,3,1,2
  ENDIF
  FOR n=0 TO 3
    READ color.index(n)
  NEXT n
  '
  ' *** default palette
  IF high.res!
    VSETCOLOR 1,0
  ENDIF
  IF med.res!
    @standard.med.colors
  ENDIF
  '
  on!=TRUE
  off!=FALSE
  '
  bel$=CHR$(7)
  '
  return$=CHR$(13)
  esc$=CHR$(27)
  help$=CHR$(0)+CHR$(98)
  undo$=CHR$(0)+CHR$(97)
  '
  interpreter$="\GFABASIC.PRG"  ! change path if necessary
  run.only$="\GFABASRO.PRG"     ! Run-Only Interpreter
  start.gfa$="\START.GFA"       ! 'Shell' for GFA-programs
  start.prg$="\GFASTART.PRG"    ! 'Shell' for compiled GFA-programs
  '
RETURN
' **********
'
' ------------------------------------------------------------------------------
'                          *** Standard Functions ***
'
DEFFN center$(text$)=SPACE$((scrn.col.max-LEN(text$))/2)+text$
DEFFN rev$(txt$)=CHR$(27)+"p"+txt$+CHR$(27)+"q"
'
' ------------------------------------------------------------------------------
'                         *** Standard Procedures ***
'
> PROCEDURE save.palette
  LOCAL i
  ERASE old.palette%()
  DIM old.palette%(4)
  FOR i=0 TO 3
    old.palette%(i)=XBIOS(7,i,-1)
  NEXT i
RETURN
' **********
'
> PROCEDURE med.mode
  ' *** uses Procedure Exit
  LOCAL m$,button
  IF XBIOS(4)<>1
    SOUND 1,10,12,4,25
    SOUND 1,10,6,4,25
    SOUND 1,10,12,4,50
    SOUND 1,0
    m$="Sorry, use|MEDIUM|resolution for|this program"
    ALERT 3,m$,1," OK ",button
    @exit
  ENDIF
RETURN
' **********
'
> PROCEDURE get.path(VAR default.path$)
  ' *** return default path (current drive and folder)
  ' *** example - A:\GAMES\
  ' *** WARNING : Procedure returns path$ only after CHDIR path$, else A:\
  ' ***                          (even if program not in main directory !!)
  LOCAL default.drive,default.drive$
  CLR default.path$
  default.drive=GEMDOS(&H19)
  default.drive$=CHR$(default.drive+65)
  default.path$=DIR$(default.drive+1)
  IF default.path$<>""
    default.path$=default.drive$+":"+default.path$+"\"
  ELSE
    default.path$=default.drive$+":\"
  ENDIF
RETURN
' **********
'
> PROCEDURE standard.med.colors
  ' *** standard-colors for Medium resolution
  LOCAL n,col$,r,g,b
  RESTORE col.data
  FOR n=0 TO 3
    READ col$
    r=VAL(LEFT$(col$))
    g=VAL(MID$(col$,2,1))
    b=VAL(RIGHT$(col$))
    VSETCOLOR n,r,g,b
  NEXT n
  '
col.data:
  DATA 465,288,965,200
RETURN
' **********
'
> PROCEDURE title.screen(title$,datum$,datum2$,height)
  ' *** standard title-screen
  ' *** uses Standard Globals and Standard Procedure Return.key
  CLS
  FOR i%=111 TO 493 STEP 53
    PUT i%,25,pic.bits$((i%-48)/53)
  NEXT i%
  LOCAL x,y,col,lin,name$,x1,y1,x2,y2,i
  HIDEM
  DEFTEXT black,8,0,height
  x=(scrn.x.max-LEN(title$)*height/2)/2
  y=scrn.y.max/2
  TEXT x,y,title$
  LET name$="½ Andy Norfolk"      ! that's me
  col=(scrn.col.max-12)/2
  lin=scrn.lin.max/2+4
  PRINT AT(col,lin);name$
  x1=(col-2)*8
  y1=(lin-1)*char.height-4
  x2=x1+LEN(name$)*8+16
  y2=y1+char.height+8
  BOX x1,y1,x2,y2
  DEFLINE 1,3
  DRAW x1+3,y2+2 TO x2+2,y2+2 TO x2+2,y1+3
  LINE x1+3,y2+1,x2+2,y2+1
  PRINT AT(col-2,lin+4);datum$
  PRINT AT(col,lin+6);datum2$
  @return.key
  COLOR black
  DEFLINE 1,1
  FOR i=0 TO y
    BOX i,i,scrn.x.max-i,scrn.y.max-i
  NEXT i
  COLOR white
  FOR i=y DOWNTO 0
    BOX i,i,scrn.x.max-i,scrn.y.max-i
  NEXT i
  COLOR black
  CLS
RETURN
' **********
'
> PROCEDURE return.key
  ' *** wait for <Return>
  ' *** after pressing any other key, flashing 'RETURN' is turned off
  ' *** uses Standard Globals
  LOCAL w1$,w2$,temp$,in$
  CLR in$
  REPEAT
  UNTIL INKEY$=""
  GET 0,scrn.y.max-char.height,scrn.x.max,scrn.y.max,temp$
  w1$="<RETURN>"
  w2$=SPACE$(8)
  PRINT AT(scrn.col.max/2-3,scrn.lin.max);w1$;
  WHILE in$=""                              ! wait for any key
    PAUSE 30
    SWAP w1$,w2$
    PRINT AT(scrn.col.max/2-3,scrn.lin.max);w1$;
    in$=INKEY$
  WEND
  PUT 0,scrn.y.max-char.height,temp$,3    ! restore screen
  WHILE in$<>return$                      ! wait for <Return>
    in$=INKEY$
  WEND
  REPEAT
  UNTIL INKEY$="" AND MOUSEK=0
RETURN
' **********
'
> PROCEDURE break
  ' *** activate in main program with : ON BREAK GOSUB break
  ' *** do not use while developing program !
  LOCAL m$,k
  ON BREAK CONT
  m$="*** Break ***|Continue,|Run again|or Quit"
  ALERT 3,m$,1,"CONT|RUN|QUIT",k
  SELECT k
  CASE 1
    ON BREAK                            ! true break possible for emergency
    m$="Freeze current|screen (press|any key to|continue)"
    ALERT 2,m$,2,"YES|NO",k
    IF k=1
      REPEAT
      UNTIL LEN(INKEY$) OR MOUSEK
    ENDIF
    ON BREAK GOSUB break
  CASE 2
    RUN
  CASE 3
    @exit
  ENDSELECT
RETURN
' **********
'
> PROCEDURE exit
  ' *** exit program
  CLS
  LOCAL i
  FOR i=0 TO 3
    VOID XBIOS(7,i,old.palette%(i))
  NEXT i
  '
  STOP
RETURN
' **********
'
' ------------------------------------------------------------------------------
'                               *** Procedures ***
> PROCEDURE check.exist.runepics
  IF NOT EXIST("RUNEPICS.GET")
    SOUND 1,10,12,4,25
    SOUND 1,10,6,4,25
    SOUND 1,10,12,4,50
    SOUND 1,0
    check.exist.runepics$="Sorry my friend. Some svartalf |has stolen my pictures! |The file RUNEPICS.GET |must be with RNCASTER.PRG"
    ALERT 3,check.exist.runepics$,1," OK ",check.exist.runepics.button
    @exit
  ENDIF
RETURN
> PROCEDURE read.arrays
  ' arrays to hold index of rune pics
  DIM o.e.array%(41,3)
  RESTORE o.e.array
  FOR i=1 TO 38
    READ o.e.array%(i,1)
    READ o.e.array%(i,2)
    READ o.e.array%(i,3)
    o.e.array%(i,0)=i
  NEXT i
  '
  ' arrays to hold rune spread positions
  '
  DIM row.1%(1,2)
  row.1%(1,1)=257
  row.1%(1,2)=48
  '
  '
  DIM row.3%(4,2)
  RESTORE 3.rune.posn
  FOR i=1 TO 3
    READ row.3%(i,1)
    READ row.3%(i,2)
  NEXT i
  '
  '
  DIM row.5%(6,2)
  RESTORE 5.rune.posn
  FOR i=1 TO 5
    READ row.5%(i,1)
    READ row.5%(i,2)
  NEXT i
  '
  '
  DIM row.6%(7,2)
  RESTORE 6.rune.posn
  FOR i=1 TO 6
    READ row.6%(i,1)
    READ row.6%(i,2)
  NEXT i
  '
  '
  DIM row.8%(9,2)
  RESTORE 8.rune.posn
  FOR i=1 TO 8
    READ row.8%(i,1)
    READ row.8%(i,2)
  NEXT i
  '
  '
  DIM row.9%(10,2)
  RESTORE 9.rune.posn
  FOR i=1 TO 9
    READ row.9%(i,1)
    READ row.9%(i,2)
  NEXT i
  '
  '
  DIM e.n.array%(25,3)
  RESTORE e.n.array
  FOR i=1 TO 24
    READ e.n.array%(i,1)
    READ e.n.array%(i,2)
    READ e.n.array%(i,3)
    e.n.array%(i,0)=i
  NEXT i
  '
  DIM o.n.array%(17,1)
  RESTORE o.n.array
  FOR i=1 TO 16
    READ o.n.array%(i,1)
    o.n.array%(i,0)=i
  NEXT i
  '
  '
  ' array to hold screen positions of rune pics
  DIM posn%(41,1)
  RESTORE posn
  FOR i=1 TO 40
    READ posn%(i,0)
    READ posn%(i,1)
  NEXT i
  '
  ' array to hold index of old norse verses
  DIM old.norse.poem.array%(39)
  RESTORE old.norse.poem.array
  FOR i=1 TO 38
    READ old.norse.poem.array%(i)
  NEXT i
  '
  ' array to hold index of old English verses
  DIM old.english.poem.array%(39)
  RESTORE old.english.poem.array
  FOR i=1 TO 38
    READ old.english.poem.array%(i)
  NEXT i
  '
  ' array to hold randomly selected runes
  DIM chosen.runes(10)
  '
  '
RETURN
> PROCEDURE read.names
  '
  DIM o.e.names$(39)
  RESTORE old.english.names
  FOR i=1 TO 38
    READ o.e.names$(i)
  NEXT i
  '
  DIM e.n.names$(25)
  RESTORE elder.norse.names
  FOR i=1 TO 24
    READ e.n.names$(i)
  NEXT i
  '
  DIM o.n.names$(17)
  RESTORE old.norse.names
  FOR i=1 TO 16
    READ o.n.names$(i)
  NEXT i
  '
  DIM one.rune.disp$(1,1)
  one.rune.disp$(1,0)="Outcome"
  one.rune.disp$(1,1)=""
  '
  DIM three.rune.disp$(3,1)
  RESTORE three.rune.display
  FOR i=1 TO 3
    READ three.rune.disp$(i,0)
    READ three.rune.disp$(i,1)
  NEXT i
  DIM five.rune.disp$(5,1)
  RESTORE five.rune.display
  FOR i=1 TO 5
    READ five.rune.disp$(i,0)
    READ five.rune.disp$(i,1)
  NEXT i
  DIM six.rune.disp$(6,1)
  RESTORE six.rune.display
  FOR i=1 TO 6
    READ six.rune.disp$(i,0)
    READ six.rune.disp$(i,1)
  NEXT i
  DIM eight.rune.disp$(8,1)
  RESTORE eight.rune.display
  FOR i=1 TO 8
    READ eight.rune.disp$(i,0)
    READ eight.rune.disp$(i,1)
  NEXT i
  DIM nine.rune.disp$(9,1)
  RESTORE nine.rune.display
  FOR i=1 TO 9
    READ nine.rune.disp$(i,0)
    READ nine.rune.disp$(i,1)
  NEXT i
RETURN
> PROCEDURE runecaster.info
  SHOWM
  rune.caster.info.alert$="  Runecaster by Andy Norfolk  | |    You are responsible for   |        your own Wyrd !  | "
  ALERT 3,rune.caster.info.alert$,1,"  OK  ",k
  REPEAT
  UNTIL MOUSEK=0
  rune.caster.info.alert2$="This is Runic Post Card Ware | If you like it please send |me a postcard written in runes| "
  ALERT 3,rune.caster.info.alert2$,1," I will ",k
  REPEAT
  UNTIL MOUSEK=0
  address$=" Send your postcard to:    |Andy Norfolk, The Cottage,|Crowan, Camborne, Cornwall|TR14 9NB UK| "
  ALERT 3,address$,1," I will ",k
  REPEAT
  UNTIL MOUSEK=0
RETURN
> PROCEDURE show.old.english.row
  SHOWM
  CLS
  @rune.show.name("Old English rune row")
  DEFTEXT 3,1,0,4
  FOR i=1 TO 29
    PUT posn%(i,0),posn%(i,1),pic.bits$(o.e.array%(i,2))
    TEXT posn%(i,0)+10,posn%(i,1)+35,o.e.names$(i)
  NEXT i
  BOX 580,150,630,180
  DEFTEXT 1,0,0,6
  TEXT 590,170,"Menu"
  REPEAT
  UNTIL MOUSEK AND 1
  WHILE NOT MOUSEX>580 AND NOT MOUSEX<630 AND NOT MOUSEY>150 AND NOT MOUSEY<180 AND NOT MOUSEK AND 1
    x.r=MOUSEX
    y.r=MOUSEY
    EXIT IF x.r>579 AND x.r<631 AND y.r>149 AND y.r<181
    FOR i=1 TO 29
      IF x.r>posn%(i,0) AND x.r<posn%(i,0)+42 AND y.r>posn%(i,1) AND y.r<posn%(i,1)+30 AND MOUSEK=1
        CLS
        PUT posn%(1,0),posn%(1,1),pic.bits$(o.e.array%(1,2))
        DEFTEXT 1,1,0,6
        TEXT 70,6,"Old English rune poem"
        DEFTEXT 3,1,0,4
        PUT 66,10,pic.bits$(o.e.array%(i,2))
        TEXT 76,45,o.e.names$(i)
        DEFTEXT 3,0,0,6
        TEXT 140,18,o.e.poem.temp$(i,0)
        TEXT 140,28,o.e.poem.temp$(i,1)
        TEXT 140,38,o.e.poem.temp$(i,2)
        DEFTEXT 1,1,0,6
        TEXT 66,58,"Old Norse rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,68,o.n.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,78,o.n.poem.temp$((old.norse.poem.array%(i)),1)
        DEFTEXT 1,1,0,6
        TEXT 66,98,"Old Icelandic rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,108,o.i.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,118,o.i.poem.temp$((old.norse.poem.array%(i)),1)
        TEXT 140,128,o.i.poem.temp$((old.norse.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,148,"Rune meanings"
        DEFTEXT 3,0,0,6
        TEXT 66,158,meanings.temp$(i,0)
        TEXT 66,168,meanings.temp$(i,1)
        TEXT 66,178,meanings.temp$(i,2)
        TEXT 66,188,meanings.temp$(i,3)
        DEFTEXT 1,1,0,6
        TEXT 66,198,"left mouse button to return to rune row"
      ENDIF
    NEXT i
    REPEAT
    UNTIL MOUSEK AND 1
    PAUSE 2
    @show.old.english.row
  WEND
  CLS
RETURN
> PROCEDURE show.old.norse.row
  CLS
  @rune.show.name("Elder Norse rune row")
  DEFTEXT 3,1,0,4
  FOR i=1 TO 24
    PUT posn%(i,0),posn%(i,1),pic.bits$(e.n.array%(i,2))
    TEXT posn%(i,0)+5,posn%(i,1)+35,e.n.names$(i)
  NEXT i
  BOX 580,150,630,180
  DEFTEXT 1,1,0,6
  TEXT 590,170,"Menu"
  REPEAT
  UNTIL MOUSEK AND 1
  WHILE NOT MOUSEX>580 AND NOT MOUSEX<630 AND NOT MOUSEY>150 AND NOT MOUSEY<180 AND NOT MOUSEK AND 1
    x.r=MOUSEX
    y.r=MOUSEY
    EXIT IF x.r>579 AND x.r<631 AND y.r>149 AND y.r<181
    FOR i=1 TO 29
      IF x.r>posn%(i,0) AND x.r<posn%(i,0)+42 AND y.r>posn%(i,1) AND y.r<posn%(i,1)+30 AND MOUSEK=1
        CLS
        PUT posn%(1,0),posn%(1,1),pic.bits$(e.n.array%(1,2))
        DEFTEXT 1,1,0,6
        TEXT 70,6,"Old English rune poem"
        DEFTEXT 3,1,0,4
        PUT 66,10,pic.bits$(e.n.array%(i,2))
        TEXT 76,45,e.n.names$(i)
        DEFTEXT 3,0,0,6
        TEXT 140,18,o.e.poem.temp$(i,0)
        TEXT 140,28,o.e.poem.temp$(i,1)
        TEXT 140,38,o.e.poem.temp$(i,2)
        DEFTEXT 1,1,0,6
        TEXT 66,58,"Old Norse rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,68,o.n.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,78,o.n.poem.temp$((old.norse.poem.array%(i)),1)
        DEFTEXT 1,1,0,6
        TEXT 66,98,"Old Icelandic rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,108,o.i.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,118,o.i.poem.temp$((old.norse.poem.array%(i)),1)
        TEXT 140,128,o.i.poem.temp$((old.norse.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,148,"Rune meanings"
        DEFTEXT 3,0,0,6
        TEXT 66,158,meanings.temp$(i,0)
        TEXT 66,168,meanings.temp$(i,1)
        TEXT 66,178,meanings.temp$(i,2)
        TEXT 66,188,meanings.temp$(i,3)
        DEFTEXT 1,1,0,6
        TEXT 66,198,"left mouse button to return to rune row"
      ENDIF
    NEXT i
    REPEAT
    UNTIL MOUSEK AND 1
    PAUSE 2
    @show.old.norse.row
  WEND
  CLS
RETURN
> PROCEDURE show.northumbrian.row
  CLS
  @rune.show.name("Northumbrian rune row")
  DEFTEXT 3,1,0,4
  FOR i=1 TO 33
    PUT posn%(i,0),posn%(i,1),pic.bits$(o.e.array%(i,2))
    TEXT posn%(i,0)+10,posn%(i,1)+35,o.e.names$(i)
  NEXT i
  BOX 580,150,630,180
  DEFTEXT 1,1,0,6
  TEXT 590,170,"Menu"
  REPEAT
  UNTIL MOUSEK AND 1
  WHILE NOT MOUSEX>580 AND NOT MOUSEX<630 AND NOT MOUSEY>150 AND NOT MOUSEY<180 AND NOT MOUSEK AND 1
    x.r=MOUSEX
    y.r=MOUSEY
    EXIT IF x.r>579 AND x.r<631 AND y.r>149 AND y.r<181
    FOR i=1 TO 33
      IF x.r>posn%(i,0) AND x.r<posn%(i,0)+42 AND y.r>posn%(i,1) AND y.r<posn%(i,1)+30 AND MOUSEK=1
        CLS
        PUT posn%(1,0),posn%(1,1),pic.bits$(o.e.array%(1,2))
        DEFTEXT 1,1,0,6
        TEXT 70,6,"Old English rune poem"
        DEFTEXT 3,1,0,4
        PUT 66,10,pic.bits$(o.e.array%(i,2))
        TEXT 76,45,o.e.names$(i)
        DEFTEXT 3,0,0,6
        TEXT 140,18,o.e.poem.temp$((old.english.poem.array%(i)),0)
        TEXT 140,28,o.e.poem.temp$((old.english.poem.array%(i)),1)
        TEXT 140,38,o.e.poem.temp$((old.english.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,58,"Old Norse rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,68,o.n.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,78,o.n.poem.temp$((old.norse.poem.array%(i)),1)
        DEFTEXT 1,1,0,6
        TEXT 66,98,"Old Icelandic rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,108,o.i.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,118,o.i.poem.temp$((old.norse.poem.array%(i)),1)
        TEXT 140,128,o.i.poem.temp$((old.norse.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,148,"Rune meanings"
        DEFTEXT 3,0,0,6
        TEXT 66,158,meanings.temp$(i,0)
        TEXT 66,168,meanings.temp$(i,1)
        TEXT 66,178,meanings.temp$(i,2)
        TEXT 66,188,meanings.temp$(i,3)
        DEFTEXT 1,1,0,6
        TEXT 66,198,"left mouse button to return to rune row"
      ENDIF
    NEXT i
    REPEAT
    UNTIL MOUSEK AND 1
    PAUSE 2
    @show.northumbrian.row
  WEND
  CLS
RETURN
> PROCEDURE show.ext.northumbrian.row
  CLS
  @rune.show.name("Extended Northumbrian runes")
  DEFTEXT 3,1,0,4
  FOR i=1 TO 38
    PUT posn%(i,0),posn%(i,1),pic.bits$(o.e.array%(i,2))
    TEXT posn%(i,0)+10,posn%(i,1)+35,o.e.names$(i)
  NEXT i
  BOX 580,150,630,180
  DEFTEXT 1,1,0,6
  TEXT 590,170,"Menu"
  REPEAT
  UNTIL MOUSEK AND 1
  WHILE NOT MOUSEX>580 AND NOT MOUSEX<630 AND NOT MOUSEY>150 AND NOT MOUSEY<180 AND NOT MOUSEK AND 1
    x.r=MOUSEX
    y.r=MOUSEY
    EXIT IF x.r>579 AND x.r<631 AND y.r>149 AND y.r<181
    FOR i=1 TO 38
      IF x.r>posn%(i,0) AND x.r<posn%(i,0)+42 AND y.r>posn%(i,1) AND y.r<posn%(i,1)+30 AND MOUSEK=1
        CLS
        PUT posn%(1,0),posn%(1,1),pic.bits$(o.e.array%(1,2))
        DEFTEXT 1,1,0,6
        TEXT 70,6,"Old English rune poem"
        DEFTEXT 3,1,0,4
        PUT 66,10,pic.bits$(o.e.array%(i,2))
        TEXT 76,45,o.e.names$(i)
        DEFTEXT 3,0,0,6
        TEXT 140,18,o.e.poem.temp$((old.english.poem.array%(i)),0)
        TEXT 140,28,o.e.poem.temp$((old.english.poem.array%(i)),1)
        TEXT 140,38,o.e.poem.temp$((old.english.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,58,"Old Norse rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,68,o.n.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,78,o.n.poem.temp$((old.norse.poem.array%(i)),1)
        DEFTEXT 1,1,0,6
        TEXT 66,98,"Old Icelandic rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,108,o.i.poem.temp$((old.norse.poem.array%(i)),0)
        TEXT 140,118,o.i.poem.temp$((old.norse.poem.array%(i)),1)
        TEXT 140,128,o.i.poem.temp$((old.norse.poem.array%(i)),2)
        DEFTEXT 1,1,0,6
        TEXT 66,148,"Rune meanings"
        DEFTEXT 3,0,0,6
        TEXT 66,158,meanings.temp$(i,0)
        TEXT 66,168,meanings.temp$(i,1)
        TEXT 66,178,meanings.temp$(i,2)
        TEXT 66,188,meanings.temp$(i,3)
        DEFTEXT 1,1,0,6
        TEXT 66,198,"left mouse button to return to rune row"
      ENDIF
    NEXT i
    REPEAT
    UNTIL MOUSEK AND 1
    PAUSE 2
    @show.ext.northumbrian.row
  WEND
  CLS
RETURN
> PROCEDURE rune.show.name(rune.row.title$)
  DEFTEXT 3,1,0,4
  TEXT 340,6,"Click on rune for poems and meanings"
  DEFTEXT 1,1,0,6
  TEXT 70,6,rune.row.title$
RETURN
> PROCEDURE old.english.poem.read
  RESTORE o.e.poem
  DIM o.e.poem.temp$(31,2)
  FOR i=1 TO 30
    READ o.e.poem.temp$(i,0)
    READ o.e.poem.temp$(i,1)
    READ o.e.poem.temp$(i,2)
  NEXT i
RETURN
> PROCEDURE meanings.read
  RESTORE meanings
  DIM meanings.temp$(40,3)
  FOR i=1 TO 38
    READ meanings.temp$(i,0)
    READ meanings.temp$(i,1)
    READ meanings.temp$(i,2)
    READ meanings.temp$(i,3)
  NEXT i
RETURN
> PROCEDURE old.norse.poem.read
  RESTORE o.n.poem
  DIM o.n.poem.temp$(18,1)
  FOR i=1 TO 17
    READ o.n.poem.temp$(i,0)
    READ o.n.poem.temp$(i,1)
  NEXT i
RETURN
> PROCEDURE old.icelandic.poem.read
  RESTORE o.i.poem
  DIM o.i.poem.temp$(18,2)
  FOR i=1 TO 17
    READ o.i.poem.temp$(i,0)
    READ o.i.poem.temp$(i,1)
    READ o.i.poem.temp$(i,2)
  NEXT i
RETURN
> PROCEDURE old.english.poem
  CLS
  FOR i=1 TO 28 STEP 4
    DEFTEXT 1,1,0,6
    TEXT 70,6,"Old English rune poem"
    DEFTEXT 3,1,0,4
    PUT 66,10,pic.bits$(o.e.array%(i,2))
    TEXT 76,45,o.e.names$(i)
    DEFTEXT 3,0,0,6
    TEXT 140,18,o.e.poem.temp$(i,0)
    TEXT 140,28,o.e.poem.temp$(i,1)
    TEXT 140,38,o.e.poem.temp$(i,2)
    PUT 66,48,pic.bits$(o.e.array%(i+1,2))
    DEFTEXT 3,1,0,4
    TEXT 76,83,o.e.names$(i+1)
    DEFTEXT 3,0,0,6
    TEXT 140,56,o.e.poem.temp$(i+1,0)
    TEXT 140,66,o.e.poem.temp$(i+1,1)
    TEXT 140,76,o.e.poem.temp$(i+1,2)
    PUT 66,86,pic.bits$(o.e.array%(i+2,2))
    DEFTEXT 3,1,0,4
    TEXT 76,121,o.e.names$(i+2)
    DEFTEXT 3,0,0,6
    TEXT 140,94,o.e.poem.temp$(i+2,0)
    TEXT 140,104,o.e.poem.temp$(i+2,1)
    TEXT 140,114,o.e.poem.temp$(i+2,2)
    PUT 66,124,pic.bits$(o.e.array%(i+3,2))
    DEFTEXT 3,1,0,4
    TEXT 76,159,o.e.names$(i+3)
    DEFTEXT 3,0,0,6
    TEXT 140,132,o.e.poem.temp$(i+3,0)
    TEXT 140,142,o.e.poem.temp$(i+3,1)
    TEXT 140,152,o.e.poem.temp$(i+3,2)
    TEXT 140,182,"Left button for next page, right button for previous page"
    REPEAT
    UNTIL MOUSEK=0
    REPEAT
    UNTIL MOUSEK
    IF MOUSEK AND 1
    ENDIF
    IF MOUSEK AND 2
      i=i-8
      IF i<0
        i=-3
      ENDIF
    ENDIF
    CLS
  NEXT i
  DEFTEXT 1,1,0,6
  TEXT 70,6,"Old English rune poem"
  DEFTEXT 3,1,0,4
  PUT 66,10,pic.bits$(o.e.array%(29,2))
  TEXT 76,45,o.e.names$(29)
  DEFTEXT 3,0,0,6
  TEXT 140,18,o.e.poem.temp$(29,0)
  TEXT 140,28,o.e.poem.temp$(29,1)
  TEXT 140,38,o.e.poem.temp$(29,2)
  TEXT 160,182,"Left mouse button to exit, right button to return to start"
  REPEAT
  UNTIL MOUSEK=0
  REPEAT
  UNTIL MOUSEK
  IF MOUSEK AND 1
  ENDIF
  IF MOUSEK AND 2
    i=24
    @old.english.poem
  ENDIF
  CLS
RETURN
> PROCEDURE old.norse.poem
  FOR i=1 TO 16 STEP 4
    CLS
    DEFTEXT 1,1,0,6
    TEXT 70,6,"Old Norse rune poem"
    DEFTEXT 3,1,0,4
    PUT 66,10,pic.bits$(o.n.array%(i,1))
    TEXT 76,45,o.n.names$(i)
    DEFTEXT 3,0,0,6
    TEXT 140,28,o.n.poem.temp$(i,0)
    TEXT 140,38,o.n.poem.temp$(i,1)
    PUT 66,48,pic.bits$(o.n.array%(i+1,1))
    DEFTEXT 3,1,0,4
    TEXT 76,83,o.n.names$(i+1)
    DEFTEXT 3,0,0,6
    TEXT 140,66,o.n.poem.temp$(i+1,0)
    TEXT 140,76,o.n.poem.temp$(i+1,1)
    PUT 66,86,pic.bits$(o.n.array%(i+2,1))
    DEFTEXT 3,1,0,4
    TEXT 76,121,o.n.names$(i+2)
    DEFTEXT 3,0,0,6
    TEXT 140,104,o.n.poem.temp$(i+2,0)
    TEXT 140,114,o.n.poem.temp$(i+2,1)
    PUT 66,124,pic.bits$(o.n.array%(i+3,1))
    DEFTEXT 3,1,0,4
    TEXT 76,159,o.n.names$(i+3)
    DEFTEXT 3,0,0,6
    TEXT 140,142,o.n.poem.temp$(i+3,0)
    TEXT 140,152,o.n.poem.temp$(i+3,1)
    IF i<12
      TEXT 140,182,"Left button for next page, right button for previous page"
    ELSE
      TEXT 140,182,"Left button to exit, right button for previous page"
    ENDIF
    REPEAT
    UNTIL MOUSEK=0
    REPEAT
    UNTIL MOUSEK
    IF MOUSEK AND 1
    ENDIF
    IF MOUSEK AND 2
      i=i-8
      IF i<0
        i=-3
      ENDIF
    ENDIF
  NEXT i
  CLS
RETURN
> PROCEDURE old.icelandic.poem
  FOR i=1 TO 16 STEP 4
    CLS
    DEFTEXT 1,1,0,6
    TEXT 70,6,"Old Icelandic rune poem"
    DEFTEXT 3,1,0,4
    PUT 66,10,pic.bits$(o.n.array%(i,1))
    TEXT 76,45,o.n.names$(i)
    DEFTEXT 3,0,0,6
    TEXT 140,18,o.i.poem.temp$(i,0)
    TEXT 140,28,o.i.poem.temp$(i,1)
    TEXT 140,38,o.i.poem.temp$(i,2)
    PUT 66,48,pic.bits$(o.n.array%(i+1,1))
    DEFTEXT 3,1,0,4
    TEXT 76,83,o.n.names$(i+1)
    DEFTEXT 3,0,0,6
    TEXT 140,56,o.i.poem.temp$(i+1,0)
    TEXT 140,66,o.i.poem.temp$(i+1,1)
    TEXT 140,76,o.i.poem.temp$(i+1,2)
    PUT 66,86,pic.bits$(o.n.array%(i+2,1))
    DEFTEXT 3,1,0,4
    TEXT 76,121,o.n.names$(i+2)
    DEFTEXT 3,0,0,6
    TEXT 140,94,o.i.poem.temp$(i+2,0)
    TEXT 140,104,o.i.poem.temp$(i+2,1)
    TEXT 140,114,o.i.poem.temp$(i+2,2)
    PUT 66,124,pic.bits$(o.n.array%(i+3,1))
    DEFTEXT 3,1,0,4
    TEXT 76,159,o.n.names$(i+3)
    DEFTEXT 3,0,0,6
    TEXT 140,132,o.i.poem.temp$(i+3,0)
    TEXT 140,142,o.i.poem.temp$(i+3,1)
    TEXT 140,152,o.i.poem.temp$(i+3,2)
    IF i<12
      TEXT 140,182,"Left button for next page, right button for previous page"
    ELSE
      TEXT 140,182,"Left button to exit, right button for previous page"
    ENDIF
    REPEAT
    UNTIL MOUSEK=0
    REPEAT
    UNTIL MOUSEK
    IF MOUSEK AND 1
    ENDIF
    IF MOUSEK AND 2
      i=i-8
      IF i<0
        i=-3
      ENDIF
    ENDIF
  NEXT i
  CLS
RETURN
> PROCEDURE way.up(way.up.size)
  ERASE way.up()
  DIM way.up(way.up.size)
  FOR i=1 TO way.up.size
    way.up(i)=RAND(2)+1
  NEXT i
RETURN
> PROCEDURE one.rune
  CLS
  @choose.row
  @way.up(1)
  disp.size%=1
  disp$="One rune spread"
  @rune.disp(disp$,one.rune.disp$(),disp.size%,row.1%())
RETURN
> PROCEDURE three.rune
  CLS
  @choose.row
  @way.up(3)
  disp.size%=3
  disp$="Three rune spread"
  @rune.disp(disp$,three.rune.disp$(),disp.size%,row.3%())
RETURN
> PROCEDURE yggdrasil
  CLS
  @choose.row
  way.up(9)
  disp.size%=9
  disp$="Yggdrasil spread"
  @rune.disp(disp$,nine.rune.disp$(),disp.size%,row.9%())
RETURN
> PROCEDURE eightfold.wheel
  CLS
  @choose.row
  @way.up(8)
  disp.size%=8
  disp$="Eightfold wheel"
  @rune.disp(disp$,eight.rune.disp$(),disp.size%,row.8%())
RETURN
> PROCEDURE cross.of.thor
  CLS
  @choose.row
  @way.up(5)
  disp.size%=5
  disp$="Cross of Thor"
  @rune.disp(disp$,five.rune.disp$(),disp.size%,row.5%())
RETURN
> PROCEDURE hammer.of.thor
  CLS
  @choose.row
  @way.up(6)
  disp.size%=6
  disp$="Hammer of Thor"
  @rune.disp(disp$,six.rune.disp$(),disp.size%,row.6%())
RETURN
> PROCEDURE rune.disp(VAR disp$,disp.part$(),disp.size%,disp.array%())
  @rune.show.name(disp$)
  DEFTEXT 3,1,0,4
  FOR i=1 TO disp.size%
    IF row.size=24
      PUT disp.array%(i,1),disp.array%(i,2),pic.bits$(e.n.array%((chosen.runes(i)),way.up(i)))
      TEXT disp.array%(i,1)+10,disp.array%(i,2)+35,e.n.names$(chosen.runes(i))
      DEFTEXT 1,1,0,4
      TEXT disp.array%(i,1)+55,disp.array%(i,2)+12,disp.part$(i,0)
      TEXT disp.array%(i,1)+55,disp.array%(i,2)+22,disp.part$(i,1)
    ELSE
      PUT disp.array%(i,1),disp.array%(i,2),pic.bits$(o.e.array%((chosen.runes(i)),way.up(i)))
      DEFTEXT 3,1,0,4
      TEXT disp.array%(i,1)+10,disp.array%(i,2)+35,o.e.names$(chosen.runes(i))
      DEFTEXT 1,1,0,4
      TEXT disp.array%(i,1)+55,disp.array%(i,2)+12,disp.part$(i,0)
      TEXT disp.array%(i,1)+55,disp.array%(i,2)+22,disp.part$(i,1)
    ENDIF
    DEFTEXT 3,1,0,4
    IF o.e.array%((chosen.runes(i)),3)=1 AND way.up(i)=1
      TEXT disp.array%(i,1),disp.array%(i,2)+35,CHR$(2)
    ENDIF
  NEXT i
  meaning.upside.down$=CHR$(2)+" = Reversed"
  TEXT 560,130,meaning.upside.down$
  BOX 580,150,630,180
  DEFTEXT 1,1,0,6
  TEXT 590,170,"Menu"
  REPEAT
  UNTIL MOUSEK AND 1
  WHILE NOT MOUSEX>580 AND NOT MOUSEX<630 AND NOT MOUSEY>150 AND NOT MOUSEY<180 AND NOT MOUSEK AND 1
    x.r=MOUSEX
    y.r=MOUSEY
    EXIT IF x.r>579 AND x.r<631 AND y.r>149 AND y.r<181
    FOR i=1 TO disp.size%
      IF x.r>disp.array%(i,1) AND x.r<disp.array%(i,1)+42 AND y.r>disp.array%(i,2) AND y.r<disp.array%(i,2)+30 AND MOUSEK=1
        CLS
        DEFTEXT 3,1,0,4
        IF row.size=24
          PUT posn%(1,0),posn%(1,1),pic.bits$(e.n.array%((chosen.runes(i)),way.up(i)))
          TEXT posn%(1,0)+10,posn%(1,1)+35,e.n.names$(chosen.runes(i))
          IF e.n.array%((chosen.runes(i)),3)=1 AND way.up(i)=1
            TEXT posn%(1,0),posn%(1,1)+35,CHR$(2)
          ENDIF
        ELSE
          PUT posn%(1,0),posn%(1,1),pic.bits$(o.e.array%((chosen.runes(i)),way.up(i)))
          TEXT posn%(1,0)+10,posn%(1,1)+35,o.e.names$(chosen.runes(i))
          IF o.e.array%((chosen.runes(i)),3)=1 AND way.up(i)=1
            TEXT posn%(1,0),posn%(1,1)+35,CHR$(2)
          ENDIF
        ENDIF
        DEFTEXT 1,1,0,6
        meant.name$=disp.part$(i,0)+" "+disp.part$(i,1)
        TEXT 340,6,meant.name$
        DEFTEXT 1,1,0,6
        TEXT 70,6,"Old English rune poem"
        DEFTEXT 3,0,0,6
        IF chosen.runes(i)<=30
          TEXT 140,18,o.e.poem.temp$(chosen.runes(i),0)
          TEXT 140,28,o.e.poem.temp$(chosen.runes(i),1)
          TEXT 140,38,o.e.poem.temp$(chosen.runes(i),2)
        ELSE
          TEXT 140,18,o.e.poem.temp$(30,0)
          TEXT 140,28,o.e.poem.temp$(30,1)
          TEXT 140,38,o.e.poem.temp$(30,2)
        ENDIF
        DEFTEXT 1,1,0,6
        TEXT 66,58,"Old Norse rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,68,o.n.poem.temp$((old.norse.poem.array%(chosen.runes(i))),0)
        TEXT 140,78,o.n.poem.temp$((old.norse.poem.array%(chosen.runes(i))),1)
        DEFTEXT 1,1,0,6
        TEXT 66,98,"Old Icelandic rune poem"
        DEFTEXT 3,0,0,6
        TEXT 140,108,o.i.poem.temp$((old.norse.poem.array%(chosen.runes(i))),0)
        TEXT 140,118,o.i.poem.temp$((old.norse.poem.array%(chosen.runes(i))),1)
        TEXT 140,128,o.i.poem.temp$((old.norse.poem.array%(chosen.runes(i))),2)
        DEFTEXT 1,1,0,6
        TEXT 66,148,"Rune meanings"
        DEFTEXT 3,0,0,6
        TEXT 66,158,meanings.temp$(chosen.runes(i),0)
        TEXT 66,168,meanings.temp$(chosen.runes(i),1)
        TEXT 66,178,meanings.temp$(chosen.runes(i),2)
        TEXT 66,188,meanings.temp$(chosen.runes(i),3)
        DEFTEXT 1,1,0,6
        TEXT 66,198,"left mouse button to return to rune row"
      ENDIF
    NEXT i
    REPEAT
    UNTIL MOUSEK AND 1
    PAUSE 2
    CLS
    @rune.disp(disp$,disp.part$(),disp.size%,disp.array%())
  WEND
  CLS
RETURN
> PROCEDURE choose.row
  REPEAT
  UNTIL MOUSEK=0
  SHOWM
  choose.row.alert$=" Choose which rune row to cast| Old English = Old Eng | Old Norse = Old Nor | Northumbrian = Northum "
  ALERT 2,choose.row.alert$,0," Old Eng| Old Nor| Northum",choose.row
  IF choose.row=3
    REPEAT
    UNTIL MOUSEK=0
    SHOWM
    choose.n.row.alert$=" Choose which Northumbrian row| to cast | Standard = Stan | Extended = Ext"
    ALERT 2,choose.n.row.alert$,0," Stan | Ext ",choose.n.row
    choose.row=choose.row+choose.n.row-1
  ENDIF
  IF choose.row=1
    row.size=29
  ENDIF
  IF choose.row=2
    row.size=24
  ENDIF
  IF choose.row=3
    row.size=33
  ENDIF
  IF choose.row=4
    row.size=38
  ENDIF
  chosen.rune.count=0
  @shuffle
  @concentrate
RETURN
> PROCEDURE shuffle
  REPEAT
    INC chosen.rune.count
    temp.rune.value=RAND(row.size)+1
    @check.chosen.runes
    chosen.runes(chosen.rune.count)=temp.rune.value
  UNTIL chosen.rune.count>=9
RETURN
> PROCEDURE check.chosen.runes
  LOCAL k
  FOR k=1 TO chosen.rune.count
    IF temp.rune.value=chosen.runes(k)
      DEC chosen.rune.count
      @shuffle
    ENDIF
  NEXT k
RETURN
> PROCEDURE concentrate
  REPEAT
  UNTIL MOUSEK=0
  SHOWM
  concentrate.alert$=" Concentrate on the matter| on which you want guidance |  | Click on throw when ready "
  ALERT 1,concentrate.alert$,0," Throw ",concentrate
  REPEAT
  UNTIL MOUSEK=0
RETURN
'
'
'
' ------------------------------------------------------------------------------
'                                *** The End ***
' ==============================================================================
' ******************
' *** INITIO.LST ***
' ******************
'
DEFWRD "a-z"
'
' **********
'
' **********
'
> PROCEDURE initio.system
  ' *** initialise global system-variables
  ' *** global : START.OS%  DISK.TOS!  NORMAL.ST!  MEGA.ST!  DRIVE!()  FLOPS
  ' WRITE.PROTECTED!()  RAM.END%  RAM.520!  RAM.1M!  RAM.2M!  RAM.2.5M!RAM.4M!
  ' ST.512!  ST.1040!  HARD.DISK!  DRIVE  DRIVE$  FREE.BYTES%
  LOCAL d,n,st.type
  '
  start.os%=LPEEK(&H4F2)
  '
  IF PEEK(start.os%)<>&H60
    disk.tos!=TRUE
  ENDIF
  IF DPEEK(start.os%)=&H601E
    normal.st!=TRUE
  ELSE
    mega.st!=TRUE
  ENDIF
  '
  DIM drive!(16)             ! Drive!(1) = drive A, etc.
  SELECT DPEEK(&H4A6)        ! first check if two drives connected
  CASE 1
    drive!(1)=TRUE
  CASE 2
    drive!(1)=TRUE
    drive!(2)=TRUE
  ENDSELECT
  FOR n=2 TO 15
    IF BTST(BIOS(10),n)
      drive!(n+1)=TRUE
    ENDIF
  NEXT n
  '
  flops=PEEK(&H4A6)    ! number of floppy drives (0-2); RAM-disks not counted
  '
  DIM write.protected!(15)             ! (only checked for drive A)
  FOR n=0 TO 15
    IF drive!(n+1)
      IF normal.st!
        LET write.protected!(n)=(PEEK(&H9B2+n)=255)
      ELSE
        LET write.protected!(n)=(PEEK(&H9F8+n)=255)
      ENDIF
    ENDIF
  NEXT n
  '
  ram.end%=LPEEK(&H42E)-1
  IF ram.end%=&H7FFFF
    ram.520!=TRUE
  ENDIF
  IF ram.end%=&HFFFFF
    ram.1m!=TRUE
  ENDIF
  IF ram.end%=&H1FFFFF
    ram.2m!=TRUE
  ENDIF
  IF ram.end%=&H3FFFFF
    ram.4m!=TRUE
  ENDIF
  IF ram.end%=&H24FFFF
    ram.2.5m!=TRUE
  ENDIF
  '
  st.type=PEEK(&H424)
  IF st.type=4
    st.512!=TRUE
  ENDIF
  IF st.type=5
    st.1040!=TRUE
  ENDIF
  '
  IF PEEK(&H472)<>0
    hard.disk!=TRUE
  ENDIF
  '
  drive=GEMDOS(&H19)
  drive$=CHR$(65+drive)
  '
  free.bytes%=FRE(0)
  '
  DEFMOUSE 0
RETURN
' **********
'
'
' ******************
' *** SCREEN.LST ***
' ******************
'
DEFWRD "a-z"
'
> PROCEDURE read.pic.bits(filename.get$,size)
  OPEN "I",#1,filename.get$
  DIM pic.bits$(size+1)
  FOR i=1 TO size
    pic.bits$(i)=INPUT$(CVI(INPUT$(2,#1)),#1)
  NEXT i
  CLOSE #1
RETURN
' ***********
'
'
> PROCEDURE show.degas(degas$)
  ' *** put Degas-picture on screen (and use picture-palette)
  ' *** uses Standard Globals
  ' *** global :   SHOW.DEGAS!
  LOCAL r$,degas.picture$,degas.picture%,degas.palette$,degas.palette%
  r$=UPPER$(RIGHT$(degas$,3))
  IF (high.res! AND r$="PI3") OR (med.res! AND r$="PI2") OR (low.res! AND r$="PI1")
    degas.picture$=SPACE$(32000)
    degas.picture%=VARPTR(degas.picture$)
    degas.palette$=SPACE$(32)
    degas.palette%=VARPTR(degas.palette$)
    OPEN "I",#90,degas$
    SEEK #90,2
    BGET #90,degas.palette%,32            ! load palette of picture
    SEEK #90,34
    BGET #90,degas.picture%,32000         ! load actual picture
    CLOSE #90
    ~XBIOS(6,L:degas.palette%)            ! change palette
    SPUT degas.picture$                   ! show the picture
    show.degas!=TRUE                      ! success
  ELSE
    show.degas!=FALSE                     ! failure
  ENDIF
RETURN
' **********
'
'
'                                *** Data ***
'
3.rune.posn:
DATA 130,48,257,48,384,48
'
'
5.rune.posn:
DATA 257,162,130,86,257,10,384,86,257,86
'
'
6.rune.posn:
DATA 384,10,257,86,130,10,257,124,257,48,257,10
'
'
8.rune.posn:
DATA 130,86,130,10,257,10,384,10,384,86,384,162,257,162,130,162
'
'
9.rune.posn:
DATA 257,162,130,124,257,124,384,124,257,86,130,48,257,48,384,48,257,10
'
'
posn:
DATA 66,10,130,10,194,10,257,10,322,10,384,10,448,10,512,10
DATA 66,48,130,48,194,48,257,48,322,48,384,48,448,48,512,48
DATA 66,86,130,86,194,86,257,86,322,86,384,86,448,86,512,86
DATA 66,124,130,124,194,124,257,124,322,124,384,124,448,124,512,124
DATA 66,162,130,162,194,162,257,162,322,162,384,162,448,162,512,162
'
'
o.e.array:
DATA 68,1,1,67,2,1,66,3,1,65,4,1,64,5,1,63,6,1,7,7,2,61,8,1
DATA 11,11,2,12,12,2,13,13,2,14,14,2,15,15,2,58,16,1,37,17,1,18,18,2
DATA 55,21,1,54,22,1,53,23,1,52,24,1,51,25,1,26,26,2,49,27,1,28,28,2
DATA 46,31,1,45,32,1,44,33,1,34,34,2,42,35,1,36,36,2,17,37,1,38,38,2,39,39,2,9,9,2,60,10,1,57,19,1,56,20,1,47,29,1
'
'
e.n.array:
DATA 68,1,1,67,2,1,66,3,1,45,32,1,64,5,1,62,41,1,7,7,2,61,8,1
DATA 48,48,2,12,12,2,13,13,2,50,50,2,15,15,2,58,16,1,37,17,1,18,18,2
DATA 55,21,1,54,22,1,53,23,1,52,24,1,51,25,1,59,59,2,49,27,1,28,28,2
'
'
o.n.array:
DATA 1,2,3,32,5,6,34,12
DATA 13,14,18,21,22,17,25,37
'
old.english.names:
DATA feoh,ur,thorn,os,rad,cen,gyfu,wyn,haegl,nyd,is,ger,eoh,peorth,eolh,sigel
DATA tir,beorc,eh,man,lagu,ing,ethel,daeg,ac,aesc,yr,iar,ear,cweorth,calc,stan
DATA gar,wolfsangel,erda,ul,ziu,sol
'
'
elder.norse.names:
DATA fehu,uruz,thurisaz,ansuz,raidho,kenaz,gebo,wunjo,hagalaz,naudiz,isa,jera
DATA eihwaz,perdhro,elhaz,sowilo,tiwaz,berkano,ehwaz,mannaz,laguz,ingwaz,othala,dagaz
'
'
old.norse.names:
DATA fe,ur,thurs,ass,reidh,kaun,hagall,naudh
DATA iss,ar,sol,tyr,bjarkan,madhr,logr,yr
'
'
old.norse.poem.array:
DATA 1,2,3,4,5,6,17,17
DATA 7,8,9,10,17,17,17,11
DATA 12,13,17,14,15,17,17,17
DATA 17,17,16,17,17,17,17,17
DATA 17,17,17,17,17,17
'
'
old.english.poem.array:
DATA 1,2,3,4,5,6,7,8
DATA 9,10,11,12,13,14,15,16
DATA 17,18,19,20,21,22,23,24
DATA 25,26,27,28,29,30,30,30
DATA 30,30,30,30,30,30
'
'
' names to display beside cast runes
'
one.rune.display:
DATA "Outcome",""
'
three.rune.display:
DATA "Beginning","","Being","","Completing",""
'
five.rune.display:
DATA "General","influences","Obstacles","","Beneficial","forces","Short-term","outcome","Long-term","outcome"
'
six.rune.display:
DATA "Past","","Present","","Future","","Foundation","","Challenge","","Outcome",""
'
eight.rune.display:
DATA "Past","","Active","past","Super","concious","Active"," future","Future","","Inactive","future","Subconcious","","Inactive","past"
'
nine.rune.display:
DATA "Subconcious","","Future","","Emotions","","Opposing","forces","Material","world","Positive","forces","Intellect","","Past","","Conciousness",""
'
' Old English rune poem
o.e.poem:
DATA "Wealth is a comfort to all,"
DATA "But share it generously,"
DATA "To be judged well by the Lord."
DATA "The aurochs is resolute and long horned,"
DATA "A fierce beast, a horn fighter,"
DATA "Great moor strider, a bold beast."
DATA "Thorn is very sharp, it is evil"
DATA "For any to grasp, extremely cruel"
DATA "For any who falls among them."
DATA "The mouth is the source of all speech,"
DATA "Wisdoms prop and sages comfort,"
DATA "Happiness and hope for every noble."
DATA "Riding is easy for the warrior in the hall,"
DATA "But very hard when astride,"
DATA "A mighty horse on the mile paths."
DATA "The torch is a living flame known to all,"
DATA "Bright and shining, it burns most often"
DATA "Where royalty are at rest within."
DATA "Giving brings praise and splendour to a man,"
DATA "Support and honour, and to outcasts all,"
DATA "With nothing else, kindness and subsistance."
DATA "Joy is the profit of one who knows little woe,"
DATA "Grief or sorrow, and he will have"
DATA "Happiness and bliss and a good house."
DATA "Hail is the whitest corn, it whirls"
DATA "From the sky tumbled by the storm"
DATA "Then turns to water."
DATA "Need constricts the chest,"
DATA "But it turns to help and a good omen,"
DATA "If attended to early."
DATA "Ice is very cold, extremely slippery"
DATA "Glistening glassy, clear and most jewel-like"
DATA "A floor of frost is a beautiful sight."
DATA "The season is the hope of men, when the Lord,"
DATA "Heaven's holy king, lets the earth yield"
DATA "Bright abundance to rich and poor."
DATA "Yew is a rough tree on the outside,"
DATA "Hard, earth-fast, deep-rooted,"
DATA "A joy to the home, the shepherd of fire."
DATA "Music always brings play and laughter."
DATA "Proudly, the brave warriors sit"
DATA "In the hall, happily together."
DATA "Elk-sedge is common in the fen,"
DATA "Thriving in water, it grimly wounds and"
DATA "Brands with blood any who try to gather it."
DATA "The sun is hoped for by seafarers"
DATA "Ferried over the fishes bath,"
DATA "The sea stallion brings them to land."
DATA "The star is a special sign, keeping faith"
DATA "With princes, it journeys"
DATA "Over nights darkness, never failing."
DATA "Birch bears no fruit, it has twigs with no seed,"
DATA "But has fair branches high in the crown"
DATA "Beautifully laden with leaves, touching the sky."
DATA "A horse is a princely joy for nobles,"
DATA "Stepping proudly when talked about by heroes and"
DATA "Rich riders, always a comfort for the restless."
DATA "A man, when he is happy, is loved by his kin"
DATA "But each shall fail the other ere the Lord's doom"
DATA "Sends that miserable flesh to the earth."
DATA "Water seems unending to folk who must venture"
DATA "In an unsteady ship, when huge waves terrify them"
DATA "And the sea stallion ignores his bridle."
DATA "Ing was first seen by folk among the East Danes"
DATA "Until he went east over the waves, his wain behind"
DATA "So the Heardings named this hero."
DATA "Home is dearly loved by every man,"
DATA "If he can properly and rightly"
DATA "Enjoy regular happiness in the hall."
DATA "Day is the Lord's message and dear to man,"
DATA "The great Lord's light, happiness and hope"
DATA "To rich and poor, a blessing to all."
DATA "The oak is on earth for the use of men, as fodder"
DATA "for pigs; it voyages often over the gannet's bath"
DATA "The spear-sharp sea tests if it has worthy timber."
DATA "Ash is very tall, dear to men,"
DATA "Firm and well rooted it holds its rightful place,"
DATA "Although attacked by many foes."
DATA "Bow is for princes and nobles alike"
DATA "A joy and token of worth, is fair on a horse,"
DATA "Steadfast on a journey, an outstanding weapon."
DATA "Beaver is a river fish. Though it always"
DATA "Enjoys food on land, it has a fair home"
DATA "Surrounded by water, where it loves to live."
DATA "Dust is dread to every noble when swiftly the flesh"
DATA "Of the corpse begins to cool, bleak earth as bedfellow,"
DATA "Fruit falls, joy goes, pledges fail."
DATA "No verse for this rune"
DATA ""
DATA ""
'
' Old Norse rune poem
'
o.n.poem:
DATA "Wealth causes strife among kin."
DATA "The wolf lurks in the forest."
DATA "Slag comes from bad iron."
DATA "The reindeer runs longest on hard snow."
DATA "Thurs causes the sickness of women."
DATA "Few are cheerful in misfortune."
DATA "Estuary is the path of most voyages"
DATA "But the sheath is for swords."
DATA "Riding is said to be worst for horses."
DATA "Reginn forged the best sword."
DATA "Sore is the bane of children."
DATA "Sorrow makes a man pale."
DATA "Hail is the coldest of corn."
DATA "Odhinn made the world in the old times."
DATA "Need makes times hard."
DATA "The naked freeze in the frost."
DATA "Ice is called the broad bridge."
DATA "The blind must be led."
DATA "Good harvest blesses men."
DATA "I say Frodhi was generous."
DATA "Sun lights the land."
DATA "I bow to sacredness."
DATA "Tyr is the one handed Aesir."
DATA "The smith must blow often."
DATA "Birch has the branch greenest with leaves."
DATA "Loki brought the luck of lies."
DATA "Man increases dust."
DATA "Mighty is the span of the hawks talons."
DATA "Water flows from the mountains freely."
DATA "But gold things are costly."
DATA "Yew is the greenest tree in winter."
DATA "It usually singes as it burns."
DATA "No verse for this rune"
DATA ""
DATA ""
'
' Old Icelandic rune poem
o.i.poem:
DATA "Wealth is strife among kin,"
DATA "And the fire of flood-tide,"
DATA "And the serpent's path."
DATA "Drizzle is the tears of clouds,"
DATA "And melting of ice edges,"
DATA "And the herdsman's hate."
DATA "Thurs is the torment of women,"
DATA "And the dweller among rocks,"
DATA "And the husband of Vardh-runa."
DATA "Ase is the olden-father,"
DATA "And Asgardhr's chief,"
DATA "And the head of Valholl."
DATA "Riding is a blessed sitting,"
DATA "And a speedy journey,"
DATA "And the horse's toil."
DATA "Sore is the bane of children,"
DATA "And a scourge,"
DATA "And the dwelling of rotten flesh."
DATA "Hail is a cold grain,"
DATA "And a shower of sleet,"
DATA "And the killer of snakes."
DATA "Need is the bondmaid's woe,"
DATA "And a hard state to be in,"
DATA "And arduous work."
DATA "Ice is the skin of the river,"
DATA "And the roof of the waves,"
DATA "And a danger to doomed men."
DATA "Good harvest is the blessing of all,"
DATA "And a good summer,"
DATA "And a ripened field."
DATA "Sun is the defender against clouds,"
DATA "And a shining glory,"
DATA "And takes the life of ice."
DATA "Tyr is the one-handed god,"
DATA "And the wolf's leavings,"
DATA "And the lord of the temple."
DATA "Birch is a leafy branch,"
DATA "And a little tree,"
DATA "And a youthful wood."
DATA "Man is the joy of man,"
DATA "And the increase of dust,"
DATA "And the ornament of ships."
DATA "Wetness is tubulent water,"
DATA "And a large kettle,"
DATA "And the land of fish."
DATA "Yew is a strong bow,"
DATA "And brittle iron,"
DATA "And Farbauti of the arrow."
DATA "No verse for this rune"
DATA ""
DATA ""
'
'
' rune meanings
meanings:
DATA "This rune relates to portable wealth, its creation and its maintenance."
DATA "Wealth and personal success bring responsibilities.
DATA "It also represents the creative cosmic energy and potential fertility."
DATA "Reversed it represents the loss of material wealth and self esteem."
DATA "This refers to physical/psychological strength, vital energy, the ability"
DATA "to succeed, it brings new opportunities and a chance to take a risk"
DATA "It relates to wild power and archetypal energies and the will to form."
DATA "Reversed it is a warning of a position of weakness and to avoid risks"
DATA "A rune of protection, a force for defence or destruction, directed"
DATA "energy, or energy contained. It can be a spur to action or a decision."
DATA "It relates to raw directed cosmic power and regeneration."
DATA "Reversed it represent a rash action or hasty decision."
DATA "A rune of wisdom, intelligence, inspiration and illumination."
DATA "It is also related to good counsel from elders and inheritance."
DATA "It is the medium through which cosmic energy is expressed."
DATA "Reversed it can mean bad advice, rumours and lies."
DATA "This means travel, starting a new venture and working hard to advance."
DATA "It also warns that actions are more productive than words."
DATA "It is right action and order and the cyclical nature of cosmic law."
DATA "Reversed it warns not to proceed, of delays and unproductive journeys."
DATA "This rune is for the ability to to see, to know and to understand."
DATA "It gives guidance from people of high standing and illumination."
DATA "It is controlled energy applied for transformation and generation."
DATA "Reversed it shows you are "in the dark" and a loss of prestige."
DATA "This is for giving and receiving, and the bonds this causes."
DATA "It means agreements, settlements and legal contracts."
DATA "This is the magical balance of forces, of men and gods."
DATA "This rune cannot be reversed."
DATA "This is the rune of joy and happiness and the transformation"
DATA "of life for the better. It requires an act of will power."
DATA "This rune refers to actively willed inner and outer harmony."
DATA "Reversed this represents unhappiness and a loss of affection."
DATA "Hail is a natural destructive force and a precursor to change."
DATA "Plans may be delayed by forces you cannot control.
DATA "Hail is the cosmic blue-print holding the pattern of the universe."
DATA "This rune cannot be reversed."
DATA "This is a warning that care will be required if plans are to succeed."
DATA "Need can give rise to a good outcome. Guard against greed."
DATA "This is the resistance to action which can generate the need-fire."
DATA "This rune cannot be reversed."
DATA "Ice is immobility, resistance to change and frustrations."
DATA "It can be a sign you are in a rut and stagnating."
DATA "It is the absolute stillness of the world ice."
DATA "This rune cannot be inverted."
DATA "This rune means the reward/harvest for past actions carried out in"
DATA "the correct way. It is the end of one cycle and the start of a better."
DATA "This is the cosmic mill of the seasons and the rune of eternal return."
DATA "This rune cannot be inverted."
DATA "This is endurance and persistence and advises you to take action."
DATA "Yew also relates to both life and death and protection."
DATA "The world mill's axle, the point of dynamic balance of opposites."
DATA "This rune cannot be inverted."
DATA "This is birth, fate, ancestral knowledge, unexpected gains."
DATA "It can also be for inititiation and problem solving."
DATA "This rune represents the bringing into physical manifestation of wyrd."
DATA "Reversed this means obstruction, death, ill luck from secrets revealed."
DATA "This means protection and warding off of evil forces, also growth."
DATA "It refers to the hazards of nature which can be avoided with care."
DATA "It relates to the connections between gods and men."
DATA "Reversed it means danger from others and perhaps material loss."
DATA "This rune means a sense of self-worth and intent and the life force."
DATA "It also reflects spiritual guidance and success."
DATA "This is the sun wheel which revolves around the world tree."
DATA "This rune cannot be reversed."
DATA "This means justice, success in a conflict if you are in the right."
DATA "It relates to courage and honour and legal actions."
DATA "It represents the god Tyr dispensing cosmic law and order."
DATA "Reversed it means right is not on your side and you lack courage."
DATA "This rune is for gestation, birth, new beginnings and a caring"
DATA "maternal concern. It relates to growth and becoming."
DATA "This rune is the birch goddess and the moment of becoming."
DATA "Reversed it represents stagnation and a failure to care."
DATA "This is a rune of partnership, cooperation and loyalty."
DATA "The horse also represents travel and a change of lifestyle."
DATA "It is Odhinn's steed Sleipnir a vehicle for otherworld journeys."
DATA "Reversed this means broken relationship, a frustrated journey."
DATA "This rune is for people and kin, cooperation for mutual benefit."
DATA "It can also mean conflict with officials giving a new view of life."
DATA "It is the divine conciousness of man."
DATA "Reversed it is an enemy,isolation from kin and friends."
DATA "This is the fortunate tide of life and love and intuition."
DATA "It relates to concentration and imagination and intuition."
DATA "It is the primal water welling up from Niflheimr"
DATA "Reversed it is the ebbing tide, confusion, loss and muddled thoughts."
DATA "The rune of the completion of a cycle and realization of a dream,"
DATA "it brings the potential energy for transformation."
DATA "This is the energy required for gestation, the nourishment of the year."
DATA "This rune cannot be reversed."
DATA "This represents the influences of ancestral roots and culture."
DATA "It is property and inheritance, the ties of home."
DATA "This is the rune of sacred enclosure and inherited power."
DATA "Reversed it can mean problems with property or inheritance."
DATA "This is the light of day, a catalyst for change for the better."
DATA "It can represent cataclysmic change, or balance between opposites."
DATA "It is illumination that opposites are contained in another form."
DATA "This rune cannot be reversed."
DATA "This means food and security under testing conditions."
DATA "It is also an indication of the potential for great growth."
DATA "This is the cosmic egg through which growth is channelled."
DATA "Reversed it means insecurity and privation."
DATA "This rune is a weapon to use when attacked, shelter for people"
DATA "in trouble, the defence of words of wisdom."
DATA "This is Odhinn's rune as god of eloquence, the divine breath."
DATA "Reversed this rune is wounding words and a lack of shelter."
DATA "This rune means creative skill in crafting tools from nature,"
DATA "and pride in using natural resources to gain a good living."
DATA "It is the three roots of Yggdrasil."
DATA "Reversed it means unwise exploitation of resources."
DATA "This rune means unavoidable hardships that must be accepted."
DATA "It also means the ability to reconcile opposites."
DATA "It is the dual nature of matter and the world serpent."
DATA "This rune cannot be reversed."
DATA "This rune means the irrevocable end of something."
DATA "It shows the acceleration of an inevitable outcome."
DATA "This represents the clay of Middle Earth, man's mortality."
DATA "Reversed this shows an unexpected delay in reaching a conclusion."
DATA "This rune means transformation by dire experience."
DATA "It also means rebirth and spiritual liberation."
DATA "This rune is Loki's ritual cleansing fire."
DATA "This rune cannot be reversed."
DATA "This rune represents a sacrifice to be made in order to reach"
DATA "a natural conclusion. It also means contact with old aquaintances."
DATA "This is a ritual cup, perhaps the Grail?"
DATA "Reversed this rune means an emtpy or unsuccessful gesture."
DATA "This is an obstruction to progress, an alternative way of dealing"
DATA "with a problem must be found. The block may also be warding off danger."
DATA "This is the Bones of the Earth, a megalith in its proper place."
DATA "This rune cannot be inverted."
DATA "This rune is a centre about which events pivot, it is a stable"
DATA "point of reference which draws all things to a conclusion."
DATA "It is Gungnir, Odhinn's spear, a portable world tree/magic wand."
DATA "This rune cannot be reversed."
DATA "This rune represents the binding of forces for destruction"
DATA "and disorder. It shows protection from disruption."
DATA "It represents the wolf hook used to catch and hold wolves."
DATA "It cannot be reversed"
DATA "This rune represents forces for wholeness and stability."
DATA "It shows a need to take a wholistic approach to a situation."
DATA "It is the earth mother and the links between man anmd environment."
DATA "Reversed it shows a failure to take all factors into account."
DATA "This rune is about personal empowerment and healing after a crisis."
DATA "This empowerment may be as a result of severe trials."
DATA "It is the rune of Waldh and Yule."
DATA "Reversed it shows a failure to learn from a crisis."
DATA "This shows the past catching up with you, the truth will out!"
DATA "Justice and order will overcome disorder."
DATA "It is the sky god Ziu's thunderbolt."
DATA "Reversed it shows a cover-up and justice delayed."
DATA "This rune brings healing and illumination from outside."
DATA "It shows gentle growth and nurture at an appropriate time."
DATA "It shows a ray of sunlight descending from the goddess Sol."
DATA "Reversed it shows a lack of help at a crucial time."
