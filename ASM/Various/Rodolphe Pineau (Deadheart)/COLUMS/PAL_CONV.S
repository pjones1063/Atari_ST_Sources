SETBLOCK	MOVE.L	A7,A5
	MOVE.L	#PILE,A7
	MOVE.L	4(A5),A5
	MOVE.L	$C(A5),D0
	ADD.L	$14(A5),D0
	ADD.L	$1C(A5),D0
	ADD.L	#$100,D0
	MOVE.L	D0,-(A7)
	MOVE.L	A5,-(A7)
	MOVE.W	#0,-(A7)
	MOVE.W	#$4A,-(A7)
	TRAP	#1
	ADD.L	#12,A7
	
	PEA	0
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.L	#6,A7
	MOVE.L	D0,OLD_SP
	
	LEA	PAL_FALCON,A1
	LEA	BLOC1,A0
	MOVE.W	#255,D0
LOOP
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	MULU.W	#4,D1
	CMP.W	#0,D1
	BEQ.S	CONT1
	ADDQ.W	#3,D1
CONT1
	MOVE.B	D1,(A1)
	
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	MULU.W	#4,D1
	CMP.W	#0,D1
	BEQ.S	CONT2
	ADDQ.W	#3,D1
CONT2
	MOVE.B	D1,1(A1)
	
	MOVE.B	#0,2(A1)
	
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	MULU.W	#4,D1
	CMP.W	#0,D1
	BEQ	CONT3
	ADDQ.W	#3,D1
CONT3
	MOVE.B	D1,3(A1)
	ADDQ.L	#4,A1
	DBRA	D0,LOOP
	
	MOVE.W	#0,-(A7)
	PEA	FILE_NAME
	MOVE.W	#$3C,-(A7)
	TRAP	#1
	ADDQ.L	#8,A7
	MOVE.W	D0,D7
	
	MOVE.L	#PAL_FALCON,-(A7)
	MOVE.L	#1024,-(A7)
	MOVE.W	D7,-(A7)
	MOVE.W	#$40,-(A7)
	TRAP	#1
	ADD.L	#12,A7
	
	MOVE.W	D7,-(A7)
	MOVE.W	#$3E,-(A7)
	TRAP	#1
	ADDQ.L	#4,A7
	
	
	MOVE.L	OLD_SP,-(A7)
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.L	#6,A7
	
	MOVE.W	#0,-(A7)
	TRAP	#1
	
	
	
	
	
	DATA
	EVEN
FILE_NAME	DC.B	'D:\DEVPAC\SOURCE\COLUMS\PAL_COLU.PAL',0
BLOC1	INCBIN	BLOC1.MCS	
	EVEN
PAL_FALCON
	DCB.L	256,0
	
	
	BSS
	DS.L	100
PILE	DS.L	1
OLD_SP	DS.L	1	