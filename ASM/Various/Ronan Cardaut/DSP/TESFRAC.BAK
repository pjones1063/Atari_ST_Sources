	bsr	INIT
	move.l	#$7fffff,d0
	lea	BUF,a6
	bsr	FRAC_24
	illegal
BUF	ds.l	100

FRAC24
;d0=nb
;a6=buffer result	
	move	#24-1,d7
	lea	TAB_FRAC,a0
LOOP	btst	d1,d0
	beq.s	.NEXT
	lea	RESULT+32,a1
	move	#31,d6
	add	#32,a0
.C	abcd	-(a0),-(a1)
	dbra	d6,.C
	
.NEXT	add.w	#32,a0
	dbra	d7,LOOP
CONVERT
	illegal
	lea	RESULT,a0
	move	#6-1,d7
.C	move.b	(a0)+,d0
	lsl	#8,d0
	add.b	(a0)+,d0
	add	#'00',d0
	move	d0,(a6)+
	dbra	d7,.C
	rts
	

INIT	
	lea	TAB_FRAC,a0
	move	#32*24-1,d7
.C	sub.b	#'0',(a0)+
	dbra	d7,.C
	rts


RESULT	dcb.b	40,0

	
TAB_FRAC
	dc.b	'50000000000000000000000000000000'
	dc.b	'25000000000000000000000000000000'
	dc.b	'12500000000000000000000000000000'
	dc.b	'06125000000000000000000000000000'
	dc.b	'03125000000000000000000000000000'
	dc.b	'01562500000000000000000000000000'
	dc.b	'00781250000000000000000000000000'
	dc.b	'00390625000000000000000000000000'
	dc.b	'00195312500000000000000000000000'
	dc.b	'00097656250000000000000000000000'
	dc.b	'00048828125000000000000000000000'
	dc.b	'00024414062500000000000000000000'
	dc.b	'00012207031250000000000000000000'
	dc.b	'00006103515625000000000000000000'
	dc.b	'00003051757812500000000000000000'
	dc.b	'00001525878906250000000000000000'	;16
	dc.b	'00000762939453125000000000000000'
	dc.b	'00000381469726562500000000000000'
	dc.b	'00000190734863281250000000000000'
	dc.b	'00000000000000000000000000000000'
	dc.b	'00000000000000000000000000000000'
	dc.b	'00000000000000000000000000000000'
	dc.b	'00000000000000000000000000000000'
	dc.b	'00000000000000000000000000000000'
	