*** Boot Seteur Config Falcon
*** ZANAK / ATLANTIDE

;	PEA	0.W
;	MOVE.W	#$20,-(SP)
;	TRAP	#1
;	ADDQ.L	#6,SP

SAVE_PMMU	LEA	YOUR_PMMU(PC),A0
	LEA	$310700,A1
	MOVE.L	A1,D7
	MOVE.W	#$100-1,D0
SAVE	MOVE.B	(A0)+,(A1)+
	DBF	D0,SAVE

	LEA	PMMUREG(PC),A0
	PMOVE.D	CRP,(A0)
	MOVE.L	D7,4(A0)
	PMOVE.D	(A0),CRP

FALCON	MOVE.B	#8,$424.W		; 
	MOVE.B	#8,$FFFF8001.W	; Passage a 2MO 
	MOVE.L	#$200000,$42E.W	; 
		
	CLR.L	-(SP)
	CLR.L	-(SP)		; Mode STE
	CLR.L	-(SP)
	ADDQ.W	#5,(SP)
	TRAP	#14
	LEA	12(SP),SP

;	MOVE.L	#$300000,A3
;	lea	$700+64*4.w,a0	;D‚place l'arborescence PMMU 
;	adda	a0,a3		;hors d'atteinte,en $300700
;	movea.l	a3,a2		;Travaille dessus.
;	moveq	#64-1,d0		;64 mots-longs
;	moveq	#0,d1		;4 pointeurs … reloger
;.copy	move.w	-(a0),-(a2)	;
;	move.w	-(a0),d2		;
;	bne.s	.nxt		;Pointeur $000007xx ?
;	move.w	d1,d2		;
;	moveq	#$30,d1		;
;.nxt	move.w	d2,-(a2)		;
;	dbf	d0,.copy		;Suivant...
;	pmove.d	crp,(a3)		;change le pointeur de PMMU
;	move.l	a2,4(a3)		;sans toucher au contr“leur
;	pmove.d	(a3),crp		;lui-mˆme
	
TEXTE_AFF	PEA	(TEXTE,PC)
	MOVE.W	#9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP

	MOVE.W	#64,-(SP)
	MOVE.W	#$1E,-(SP)
	TRAP	#14
	ADDQ.L	#4,SP
	
	BCLR.B	#5,$FFFF8007.W	; MODE STE
	BSET.B	#0,$FFFF8007.W	; 16 MHZ 030
	BSET.B	#2,$FFFF8007.W	; 16 MHZ BLT
	
;CACHES_OFF	MOVE.W	#$3010,D0		; 3110 INSTUC ONLY
;	MOVEC	D0,CACR
			
	RTS
	
;	CLR	-(SP)
;	TRAP	#1
	
TEXTE	DC.B	27,'E','PC-DITTO BOOT FALCON ',10,13
	DC.B	'(C) ZANAK / ATLANTIDE',10,13,0
	EVEN
	
PMMUREG	DC.L	0
	DC.L	0
	
YOUR_PMMU	DC.L	$0031074A,$10000001
	DC.L	$20000001,$30000001
	DC.L	$40000001,$50000001
	DC.L	$60000001,$70000001
	DC.L	$80000041,$90000041
	DC.L	$A0000041,$B0000041
	DC.L	$C0000041,$D0000041
	DC.L	$E0000041
	DC.L	$0031078A
	DC.L	$003107CA,$01000001
	DC.L	$02000001,$03000001
	DC.L	$04000001,$05000001
	DC.L	$06000001,$07000001
	DC.L	$08000001,$09000001
	DC.L	$0A000001,$0B000001
	DC.L	$0C000001,$0D000001
	DC.L	$0E000001,$0F000001
	DC.L	$F0000041,$F1000041
	DC.L	$F2000041,$F3000041
	DC.L	$F4000041,$F5000041
	DC.L	$F6000041,$F7000041
	DC.L	$F8000041,$F9000041
	DC.L	$FA000041,$FB000041
	DC.L	$FC000041,$FD000041
	DC.L	$FE000041
	DC.L	$003107CA
	DC.L	$00000019,$00100019
	DC.L	$00200019,$00300019
	DC.L	$00400001,$00500001
	DC.L	$00600001,$00700001
	DC.L	$00800001,$00900001
	DC.L	$00A00001,$00B00001
	DC.L	$00C00001,$00D00001
	DC.L	$00E00009,$00F00059
	
	