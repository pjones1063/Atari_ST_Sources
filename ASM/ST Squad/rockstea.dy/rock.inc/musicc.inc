
SetUpMusic:	
*	clr.b	$fffffa09.w		*init interrupts
*	clr.b	$fffffa15.w
	move.w	Module+$90,d0
	lea	mfp_freqs,a0
	move.b	(a0,d0.w),$fffffa1f.w
*	move.b	#2,$fffffa19.w
*	move.b	#32,$fffffa07.w
*	move.b	#32,$fffffa13.w
	move.b	#2,$fffffa19.w
	or.b	#32,$fffffa07.w
	or.b	#32,$fffffa13.w

	bclr	#3,$fffffa17.w
*	move.l	#Player+$8918,$134
 	move.l	#SamplePlayer,$134.w
	rts
mfp_freqs:
	dc.b	24			*10 and 8.3 Khz
	dc.b	29

SetUpPlayer:
	* you can use all registers here
	move.l	$134.w,OldTimerA

	lea	Module,a0		*a0=module start
	moveq	#-1,d0			*-1=the default soundtable 0=the other
	jsr	Init
	
	* don't use d6-d7/a2-a6 from here, thats what you think! (Archie)

	jsr	SetUpMusic		*init. interrupts
	movem.l	d0-a6,ModRegs
	jsr	Play
	movem.l	d0-a6,ModRegs	
	rts
Music:
	movem.l	ModRegs,d0-a6
	jsr	MakeBuffer
	jsr	Play
	movem.l	d0-a6,ModRegs
	rts

* Interrupt handlers:
ModRegs:
	dcb.l	18,0

Module:					*the module
	incbin 	ROCK.INC\TOCCATA.MOD
	even

OldTimerA	DC.l	1


Player:				*the replay routine

L59106	
	dc.w	0
L5910A	
	dc.w	0
Init
	BRA	L59284
Play
	BRA	L59658
	MOVEM.L	D0-D7/A0-A6,-(A7)
	PEA	0
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.L	#6,A7
	MOVE.L	D0,L5919E
	MOVE.L	USP,A0
	MOVE.L	A0,L5919A
	MOVEA.L	L59106(PC),A0
	MOVE.L	L5910A(PC),D0
	JSR	L59284(PC)
	JSR	L591A4(PC)
	JSR	L591E8(PC)
	CLR.W	L591A2
L59150	CMPI.W	#1,L591A2
	BNE	L59150
	CLR.W	L591A2
	JSR	L59658(PC)
	CMPI.B	#$B9,$FFFC02
	BNE	L59150
	JSR	L59232(PC)
	MOVEA.L	L5919A,A0
	MOVE.L	A0,USP
	MOVE.L	L5919E(PC),-(A7)
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.L	#6,A7
	MOVEM.L	(A7)+,D0-D7/A0-A6
	RTS
L59190	MOVE.W	#1,L591A2
	RTE
L5919A	DC.W	0,0
L5919E	DC.W	0,0
L591A2	DC.W	0
L591A4	MOVE.B	$FFFFFA07.W,L59276
	MOVE.B	$FFFFFA09.W,L59277
	MOVE.B	$FFFFFA13.W,L59278
	MOVE.B	$FFFFFA15.W,L59279
	MOVE.B	$FFFFFA19.W,L5927A
	MOVE.B	$FFFFFA1F.W,L5927B
	MOVE.L	$134,L5927C
	MOVE.L	$70.W,L59280
	RTS
L591E8	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA15.W
	MOVEA.L	L59106,A0
	MOVE.W	$90(A0),D0
	LEA	L59230,A0
	MOVE.B	0(A0,D0.W),$FFFFFA1F.W
	MOVE.B	#2,$FFFFFA19.W
	MOVE.B	#$20,$FFFFFA07.W
	MOVE.B	#$20,$FFFFFA13.W
	BCLR	#3,$FFFFFA17.W
	MOVE.L	#SamplePlayer,$134.W
	MOVE.L	#L59190,$70.W
	RTS
L59230	MOVE.B	(A5)+,D4
L59232	MOVE.B	L59276,$FFFFFA07.W
	MOVE.B	L59277,$FFFFFA09.W
	MOVE.B	L59278,$FFFFFA13.W
	MOVE.B	L59279,$FFFFFA15.W
	MOVE.B	L5927A,$FFFFFA19.W
	MOVE.B	L5927B,$FFFFFA1F.W
	MOVE.L	L5927C,$134
	MOVE.L	L59280,$70.W
	RTS
L59276	DC.B	0
L59277	DC.B 	0
L59278	DC.B	0
L59279	DC.B	0
L5927A	DC.B	0
L5927B	DC.B	0
L5927C	DC.W	0
L5927E	DC.W	0
L59280	DC.W	0
L59282	DC.W	0

*********************************
* The Initilisation bit		*
*********************************

L59284	
L592BA
	TST.L	D0		Test Table type
	BEQ	L592DA		If zero fine else copy new table
	LEA	FreqTabs,A2
	LEA	SoundTable,A1
	MOVE.W	#$7FF,D0
L592D4	MOVE.B	(A2)+,(A1)+
	DBF	D0,L592D4

L592DA	MOVEQ	#0,D0
	MOVE.L	8(A0),D0	Number of patterns
	MULU	#$200,D0	512 bytes each

	ADDI.L	#$132,D0	Add 306 therfore start patterns
	ADD.L	A0,D0		Plus absolute pointer
	MOVE.L	D0,L59638	This is where the patterns start
	ADDQ.L	#4,D0
	MOVE.L	D0,L59640
	ADDI.L	#$40,D0
	MOVE.L	D0,L5963C

	MOVE.B	$E(A0),L5964A	Pointer to pattern list
	MOVE.L	A0,L59654	Save that

	JSR	L59394
	JSR	L593EC
	JSR	FormatSoundTable
	JSR	MakeFreqTables
	JSR	ClaerSoundChip

	MOVE.B	#$3D,L59646
	CLR.B	L59644
	MOVE.W	#1,L5A172
	MOVE.W	#1,L5A174
	MOVE.W	#1,L5A176
	MOVE.W	#1,L5A178
	MOVEA.L	#FreqTabs,A2
	LEA	L5A1E6(PC),A3
	MOVE.L	A3,L5A1D6
	LEA	L5A1E6(PC),A4
	MOVE.L	A4,L5A1DA
	LEA	L5A1E6(PC),A5
	MOVE.L	A5,L5A1DE
	LEA	L5A1E6(PC),A6
	MOVE.L	A6,L5A1E2
	JSR	L59710(PC)
	RTS

L59394
	MOVEQ	#$F,D2
.loop	
	MOVE.L	D2,D3
	LSL.L	#3,D3
	MOVEA.L	L5963C,A1
	MOVEA.L	0(A1,D3.W),A0
	ADDA.L	L59638,A0
	MOVE.L	A0,D4
	ADD.L	4(A1,D3.W),D4
	MOVEA.L	L59640,A1
	MOVE.L	D2,D3
	LSL.L	#2,D3
	MOVEQ	#0,D0
	MOVE.B	0(A1,D3.W),D0
	MOVEA.L	D4,A1
	JSR	L593CE
	DBF	D2,.loop

	RTS

L593CE	MOVEQ	#0,D3
	MOVE.B	D0,D3
	NOT.B	D3
	ANDI.B	#$7F,D3
L593D8	MOVEQ	#0,D1
	MOVE.B	(A0),D1
	MULU	D0,D1
	ASR.W	#7,D1
	ADD.B	D3,D1
	MOVE.B	D1,(A0)+
	CMPA.L	A1,A0
	BNE	L593D8
	RTS

L593EC
	MOVEQ	#$F,D7
.loop
	JSR	L593F8(PC)
	DBF	D7,.loop

	RTS

L593F8	MOVEQ	#0,D1
	MOVE.B	D7,D1
	LSL.W	#3,D1
	MOVEA.L	L5963C,A0
	MOVEA.L	0(A0,D1.W),A1
	ADDA.L	4(A0,D1.W),A1
	SUBA.L	#$2BC,A1
	CMPA.L	#$FFFFFFFF,A1
	BLE.S	L59448
	ADDA.L	L59638,A1
	MOVEA.L	A1,A0
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	D7,D0
	LSL.L	#2,D0
	MOVEA.L	L59640,A1
	MOVE.W	2(A1,D0.W),D1
	CMP.W	#0,D1
	BEQ.S	L5944A
	MOVEA.L	A0,A1
	SUBA.L	D1,A1

	MOVE.W	#$2BB,D0
.loop2
	MOVE.B	(A1)+,(A0)+
	DBF	D0,.loop2
L59448	RTS


L5944A	MOVE.W	#$2BB,D0
.loop	MOVE.B	#$7F,(A0)+
	DBF	D0,.loop
	RTS

MakeFreqTables:
	MOVE.W	#$24,D0
	LEA	MiddleC(PC),A0
	LEA	FreqTabs(PC),A1
	LEA	FreqPointers(PC),A2
.loop	MOVE.L	(A0)+,D1
	MOVE.L	A1,(A2)+
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVE.W	#$18F,D7
.loop2	ADD.L	D1,D2
	MOVE.L	D2,D3
	LSR.L	#8,D3
	LSR.L	#8,D3
	SUB.W	D3,D4
	NEG.W	D4
	MOVE.W	D4,(A1)+
	MOVE.W	D3,D4
	DBF	D7,.loop2
	DBF	D0,.loop
	RTS

	DC.W	0,$2000,0,$21E7
	DC.W	0,$23EB,0,$260D
	DC.W	0,$2851,0,$2AB7
	DC.W	0,$2D41,0,$2FF2
	DC.W	0,$32CB,0,$35D1
	DC.W	0,$3904,0,$3C68

	DC.W	0,$4000,0,$43CE
	DC.W	0,$47D6,0,$4C1B
	DC.W	0,$50A2,0,$556E
	DC.W	0,$5A82,0,$5FE4
	DC.W	0,$6597,0,$6BA2
	DC.W	0,$7208,0,$78D0

MiddleC	DC.W	0,$8000,0,$879C
	DC.W	0,$8FAC,0,$9837
	DC.W	0,$A145,0,$AADC
	DC.W	0,$B504,0,$BFC8
	DC.W	0,$CB2F,0,$D744
	DC.W	0,$E411,0,$F1A1

	DC.W	1,$0000,1,$0F38
	DC.W	1,$1F59,1,$306F
	DC.W	1,$428A,1,$55B8
	DC.W	1,$6A09,1,$7F91
	DC.W	1,$965F,1,$AE89
	DC.W	1,$C823,1,$E343

	DC.W	2,$0000,2,$1E71
	DC.W	2,$3EB3,2,$60DF
	DC.W	2,$8514,2,$AB70
	DC.W	2,$D413,2,$FF22
	DC.W	3,$2CBF,3,$5D13
	DC.W	3,$9047,3,$C686

	DC.W	4,$0000,4,$3CE3
	DC.W	4,$7D66,4,$C1BF
	DC.W	5,$0A28,5,$56E0
	DC.W	5,$A827,5,$FE44
	DC.W	6,$597F,6,$BA27
	DC.W	7,$208F,7,$8D0D

	DC.W	8,$0000

ClaerSoundChip
	MOVEQ	#$A,D0

.loop	MOVE.B	D0,$FFFF8800.W
	CLR.B	$FFFF8802.W
	DBF	D0,.loop

	MOVE.B	#7,$FFFF8800
	MOVE.B	#$FF,$FFFF8802

	RTS

FormatSoundTable
	MOVE.W	#$FF,D7
	LEA	SoundTable,A0
	moveq.l	#0,d1
	moveq.l	#0,d2
	moveq.l	#0,d3
.loop
	move.b	1(a0),d1
	move.b	3(a0),d2
	move.b	5(a0),d3
	MOVE.B	D1,0(A0)
	CLR.B	1(a0)
	MOVE.B	D2,2(A0)
	clr.b	3(a0)
	MOVE.B	D3,4(A0)
	clr.b	5(a0)
	clr.w	6(a0)

	LEA	8(A0),A0
	DBF	D7,.loop

	LEA	SoundTable,A0
	LEA	$C00(A0),A1
	MOVE.W	#$FF,D0
.loop2
	MOVE.L	(A0)+,(A1)+
	MOVE.L	(A0)+,(A1)+
	DBF	D0,.loop2

	LEA	SoundTable,A0
	MOVE.W	#$17F,D0
	MOVE.L	(A0),D1
	MOVE.L	4(A0),D2
.loop3
	MOVE.L	D1,(A0)+
	MOVE.L	D2,(A0)+
	DBF	D0,.loop3

	MOVE.W	#$17F,D0
	MOVE.L	-8(A1),D1
	MOVE.L	-4(A1),D2
.loop4	MOVE.L	D1,(A1)+
	MOVE.L	D2,(A1)+
	DBF	D0,.loop4

	lea	Buffer,a0
	move.l	#340-1,d0
.loop5
	move.l	#$08000000,(a0)+
	move.l	#$09000000,(a0)+
	move.l	#$0A000000,(a0)+
	dbf	d0,.loop5
	RTS

L59638	DC.W	0,0
L5963C	DC.W	0,0
L59640	DC.W	0,0

*Here is the tempory channel data
 
L59644	DC.W	0
L59646	DC.W	0
L59648	DC.W	0
L5964A	DC.W	0

L5964C	DC.W	0,0
	DC.W	0,0
L59654	DC.W	0,0
L59658	JSR	L5A08A
	ADDQ.B	#1,L59644
	MOVEA.L	L59654(PC),A0
	MOVE.B	$C(A0),D0
	SUBQ.B	#1,D0
	ANDI.B	#$F,D0
	EORI.B	#$F,D0
	CMP.B	L59644(PC),D0
	BNE.S	L596A2
	CLR.B	L59644
	ADDQ.B	#1,L59646
	MOVE.B	L59646(PC),D0
	ANDI.B	#$3F,D0
	MOVE.B	D0,L59646
	ADDQ.B	#3,D0
	ANDI.B	#$3F,D0
	BEQ.S	L596A4
	JSR	L59710(PC)
L596A2	RTS
L596A4	JSR	L5974A(PC)
	MOVE.B	L59648(PC),D0
	MOVEA.L	L59654(PC),A0
	CMP.B	$8E(A0),D0
	BCS.S	L5970A
	MOVE.W	#1,L5A172
	MOVE.W	#1,L5A174
	MOVE.W	#1,L5A176
	MOVE.W	#1,L5A178
	LEA	L5A1E6(PC),A3
	MOVE.L	A3,L5A1D6
	LEA	L5A1E6(PC),A4
	MOVE.L	A4,L5A1DA
	LEA	L5A1E6(PC),A5
	MOVE.L	A5,L5A1DE
	LEA	L5A1E6(PC),A6
	MOVE.L	A6,L5A1E2
	MOVE.B	#$FF,L59648
	JSR	L5974A(PC)
L5970A	JSR	L59710(PC)
	RTS
L59710	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	L59646(PC),D3
	ADDQ.B	#3,D3
	ANDI.B	#$3F,D3
	MOVEA.L	L59654,A0
	LEA	$132(A0),A0
	MOVE.B	L5964A(PC),D0
	LSL.W	#8,D0
	ADD.L	D0,D0
	MOVE.B	D3,D1
	LSL.W	#3,D1
	ADD.L	D1,D0
	ADDA.L	D0,A0
	LEA	L5964C(PC),A1
	MOVE.W	(A0)+,(A1)+
	MOVE.W	(A0)+,(A1)+
	MOVE.W	(A0)+,(A1)+
	MOVE.W	(A0)+,(A1)+
	JSR	L59776(PC)
	RTS
L5974A	MOVE.B	L59648(PC),D1
	ADDQ.B	#1,D1
	ANDI.B	#$7F,D1
	MOVE.B	D1,L59648
	MOVEQ	#0,D0
	MOVE.B	L59648(PC),D0
	MOVEA.L	L59654,A0
	LEA	$E(A0),A0
	ADDA.L	D0,A0
	MOVE.B	(A0),D1
	MOVE.B	D1,L5964A
	RTS
L59776	MOVE.W	#$2700,SR
	LEA	L5964C(PC),A0
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D0
	MOVE.B	(A0)+,D1
	TST.B	D0
	BEQ	L5981E
	LEA	L5A17A(PC),A1
	MOVE.B	0(A1,D0.W),D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	FreqPointers(PC),A1
	MOVE.L	0(A1,D0.W),L5A1BA
	MOVE.W	D1,D2
	ANDI.W	#$FFF0,D2
	LSR.W	#1,D2
	MOVEA.L	L5963C(PC),A1
	MOVEA.L	0(A1,D2.W),A3
	ADDA.L	L59638(PC),A3
	MOVE.L	4(A1,D2.W),L5A1D6
	MOVE.L	A3,D0
	ADD.L	D0,L5A1D6
	SUBI.L	#$2BC,L5A1D6
	MOVEQ	#0,D0
	MOVEA.L	L59640(PC),A1
	LSR.W	#1,D2
	MOVE.W	2(A1,D2.W),D0
	CMP.W	#0,D0
	BEQ.S	L59802
	MOVE.L	L5A1D6(PC),L5A152
	MOVE.L	L5A1D6(PC),L5A162
	SUB.L	D0,L5A152
	CLR.W	L5A172
	BRA.S	L5981E
L59802	MOVE.W	#1,L5A172
	MOVE.L	#L5A1E6,L5A152
	MOVE.L	#L5A1E6,L5A162
L5981E	ANDI.W	#$F,D1
	MOVE.W	D1,L5A1CE
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D0
	MOVE.B	(A0)+,D1
	TST.B	D0
	BEQ	L598C8
	LEA	L5A17A(PC),A1
	MOVE.B	0(A1,D0.W),D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	FreqPointers(PC),A1
	MOVE.L	0(A1,D0.W),L5A1BE
	MOVE.W	D1,D2
	ANDI.W	#$FFF0,D2
	LSR.W	#1,D2
	MOVEA.L	L5963C(PC),A1
	MOVEA.L	0(A1,D2.W),A4
	ADDA.L	L59638(PC),A4
	MOVE.L	4(A1,D2.W),L5A1DA
	MOVE.L	A4,D0
	ADD.L	D0,L5A1DA
	SUBI.L	#$2BC,L5A1DA
	MOVEQ	#0,D0
	MOVEA.L	L59640(PC),A1
	LSR.W	#1,D2
	MOVE.W	2(A1,D2.W),D0
	CMP.W	#0,D0
	BEQ.S	L598AC
	MOVE.L	L5A1DA(PC),L5A156
	MOVE.L	L5A1DA(PC),L5A166
	SUB.L	D0,L5A156
	CLR.W	L5A174
	BRA.S	L598C8
L598AC	MOVE.W	#1,L5A174
	MOVE.L	#L5A1E6,L5A156
	MOVE.L	#L5A1E6,L5A166
L598C8	ANDI.W	#$F,D1
	MOVE.W	D1,L5A1D0
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D0
	MOVE.B	(A0)+,D1
	TST.B	D0
	BEQ	L59972
	LEA	L5A17A(PC),A1
	MOVE.B	0(A1,D0.W),D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	FreqPointers(PC),A1
	MOVE.L	0(A1,D0.W),L5A1C2
	MOVE.W	D1,D2
	ANDI.W	#$FFF0,D2
	LSR.W	#1,D2
	MOVEA.L	L5963C(PC),A1
	MOVEA.L	0(A1,D2.W),A5
	ADDA.L	L59638(PC),A5
	MOVE.L	4(A1,D2.W),L5A1DE
	MOVE.L	A5,D0
	ADD.L	D0,L5A1DE
	SUBI.L	#$2BC,L5A1DE
	MOVEQ	#0,D0
	MOVEA.L	L59640(PC),A1
	LSR.W	#1,D2
	MOVE.W	2(A1,D2.W),D0
	CMP.W	#0,D0
	BEQ.S	L59956
	MOVE.L	L5A1DE(PC),L5A15A
	MOVE.L	L5A1DE(PC),L5A16A
	SUB.L	D0,L5A15A
	CLR.W	L5A176
	BRA.S	L59972
L59956	MOVE.W	#1,L5A176
	MOVE.L	#L5A1E6,L5A15A
	MOVE.L	#L5A1E6,L5A16A
L59972	ANDI.W	#$F,D1
	MOVE.W	D1,L5A1D2
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D0
	MOVE.B	(A0)+,D1
	TST.B	D0
	BEQ	L59A1C
	LEA	L5A17A(PC),A1
	MOVE.B	0(A1,D0.W),D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	FreqPointers(PC),A1
	MOVE.L	0(A1,D0.W),L5A1C6
	MOVE.W	D1,D2
	ANDI.W	#$FFF0,D2
	LSR.W	#1,D2
	MOVEA.L	L5963C(PC),A1
	MOVEA.L	0(A1,D2.W),A6
	ADDA.L	L59638(PC),A6
	MOVE.L	4(A1,D2.W),L5A1E2
	MOVE.L	A6,D0
	ADD.L	D0,L5A1E2
	SUBI.L	#$2BC,L5A1E2
	MOVEQ	#0,D0
	MOVEA.L	L59640(PC),A1
	LSR.W	#1,D2
	MOVE.W	2(A1,D2.W),D0
	CMP.W	#0,D0
	BEQ.S	L59A00
	MOVE.L	L5A1E2(PC),L5A15E
	MOVE.L	L5A1E2(PC),L5A16E
	SUB.L	D0,L5A15E
	CLR.W	L5A178
	BRA.S	L59A1C
L59A00	MOVE.W	#1,L5A178
	MOVE.L	#L5A1E6,L5A15E
	MOVE.L	#L5A1E6,L5A16E
L59A1C	ANDI.W	#$F,D1
	MOVE.W	D1,L5A1D4
	MOVE.L	L5A1BE(PC),D0
	SUB.L	L5A1BA(PC),D0
	MOVE.L	L5A1C2(PC),D1
	SUB.L	L5A1BA(PC),D1
	MOVE.L	L5A1C6(PC),D2
	SUB.L	L5A1BA(PC),D2
	MOVEA.L	L5A146(PC),A0
	MOVE.W	D0,2(A0)
	MOVEA.L	L5A14A(PC),A0
	MOVE.W	D1,2(A0)
	MOVEA.L	L5A14E(PC),A0
	MOVE.W	D2,2(A0)
	MOVEA.L	L5A1BA(PC),A2
	MOVE.W	#$2300,SR
	RTS
L59A60	MOVE.W	$114(A1),D2
	JMP	(A0)
L59A66	MOVE.W	$116(A1),D2
	JMP	(A0)
L59A6C	MOVE.W	$118(A1),D2
	JMP	(A0)
L59A72	MOVE.W	$11A(A1),D2
	JMP	(A0)
L59A78	MOVE.W	$11C(A1),D2
	JMP	(A0)
L59A7E	MOVE.W	$11E(A1),D2
	JMP	(A0)
L59A84	MOVE.W	$120(A1),D2
	JMP	(A0)
L59A8A	MOVE.W	$122(A1),D2
	JMP	(A0)
L59A90	MOVE.W	$124(A1),D2
	JMP	(A0)
L59A96	MOVE.W	$126(A1),D2
	JMP	(A0)
L59A9C	EXT.L	D2
	MOVE.L	L5A1BA(PC),D1
	SUB.L	D2,D1
	CMP.L	#FreqTabs,D1
	BCS.S	L59AC4
	CMP.L	#L59D36,D1
	BGE	L59ACC
L59AB6	MOVE.L	D1,L5A1BA
	JSR	L59B76(PC)
	BRA	L59F0E
L59AC4	MOVE.L	#FreqTabs,D1
	BRA.S	L59AB6
L59ACC	MOVE.L	#L59D36,D1
	BRA.S	L59AB6
L59AD4	EXT.L	D2
	MOVE.L	L5A1BE(PC),D1
	SUB.L	D2,D1
	CMP.L	#FreqTabs,D1
	BCS.S	L59AFA
	CMP.L	#L59D36,D1
	BGE.S	L59B02
L59AEC	MOVE.L	D1,L5A1BE
	JSR	L59B76(PC)
	BRA	L59F8C
L59AFA	MOVE.L	#FreqTabs,D1
	BRA.S	L59AEC
L59B02	MOVE.L	#L59D36,D1
	BRA.S	L59AEC
L59B0A	EXT.L	D2
	MOVE.L	L5A1C2(PC),D1
	SUB.L	D2,D1
	CMP.L	#FreqTabs,D1
	BCS.S	L59B30
	CMP.L	#L59D36,D1
	BGE.S	L59B38
L59B22	MOVE.L	D1,L5A1C2
	JSR	L59B76(PC)
	BRA	L5A00A
L59B30	MOVE.L	#FreqTabs,D1
	BRA.S	L59B22
L59B38	MOVE.L	#L59D36,D1
	BRA.S	L59B22
L59B40	EXT.L	D2
	MOVE.L	L5A1C6(PC),D1
	SUB.L	D2,D1
	CMP.L	#FreqTabs,D1
	BCS.S	L59B66
	CMP.L	#L59D36,D1
	BGE.S	L59B6E
L59B58	MOVE.L	D1,L5A1C6
	JSR	L59B76(PC)
	BRA	L5A088
L59B66	MOVE.L	#FreqTabs,D1
	BRA.S	L59B58
L59B6E	MOVE.L	#L59D36,D1
	BRA.S	L59B58
L59B76	MOVE.L	L5A1BE(PC),D0
	SUB.L	L5A1BA(PC),D0
	MOVE.L	L5A1C2(PC),D1
	SUB.L	L5A1BA(PC),D1
	MOVE.L	L5A1C6(PC),D2
	SUB.L	L5A1BA(PC),D2
	MOVEA.L	L5A146(PC),A0
	MOVE.W	D0,2(A0)
	MOVEA.L	L5A14A(PC),A0
	MOVE.W	D1,2(A0)
	MOVEA.L	L5A14E(PC),A0
	MOVE.W	D2,2(A0)
	RTS
L59BA8	MOVE.L	A3,L59DF8
	MOVE.L	L5A1D6(PC),L59DFC
	MOVE.L	L5A152(PC),L59E00
	MOVE.L	L5A162(PC),L59E04
	MOVE.W	L5A172(PC),L59E08
	MOVEA.L	L59654(PC),A0
	CMPI.W	#2,$128(A0)
	BEQ	L59F0E
	LEA	L5A1E6(PC),A3
	MOVE.L	#L5A1E6,L5A1D6
	MOVE.W	#1,L5A172
	CLR.W	L5A1CE
	BRA	L59F0E
L59BFC	CMPI.L	#0,L59DF8
	BEQ	L59F0E
	MOVEA.L	L59DF8(PC),A3
	MOVE.L	L59DFC(PC),L5A1D6
	MOVE.L	L59E00(PC),L5A152
	MOVE.L	L59E04(PC),L5A162
	MOVE.W	L59E08(PC),L5A172
	CLR.W	L5A1CE
	JSR	L59B76(PC)
	BRA	L59F0E
L59C3C	MOVE.L	A4,L59E0C
	MOVE.L	L5A1DA(PC),L59E10
	MOVE.L	L5A156(PC),L59E14
	MOVE.L	L5A166(PC),L59E18
	MOVE.W	L5A174(PC),L59E1C
	MOVEA.L	L59654(PC),A0
	CMPI.W	#2,$128(A0)
	BEQ	L59F8C
	LEA	L5A1E6(PC),A4
	MOVE.L	#L5A1E6,L5A1DA
	MOVE.W	#1,L5A174
	CLR.W	L5A1D0
	BRA	L59F8C
L59C90	CMPI.L	#0,L59E0C
	BEQ	L59F8C
	MOVEA.L	L59E0C(PC),A4
	MOVE.L	L59E10(PC),L5A1DA
	MOVE.L	L59E14(PC),L5A156
	MOVE.L	L59E18(PC),L5A166
	MOVE.W	L59E1C(PC),L5A174
	CLR.W	L5A1D0
	JSR	L59B76(PC)
	BRA	L59F8C
L59CD0	MOVE.L	A5,L59E20
	MOVE.L	L5A1DE(PC),L59E24
	MOVE.L	L5A15A(PC),L59E28
	MOVE.L	L5A16A(PC),L59E2C
	MOVE.W	L5A176(PC),L59E30
	MOVEA.L	L59654(PC),A0
	CMPI.W	#2,$128(A0)
	BEQ	L5A00A
	LEA	L5A1E6(PC),A5
	MOVE.L	#L5A1E6,L5A1DE
	MOVE.W	#1,L5A176
	CLR.W	L5A1D2
	BRA	L5A00A
L59D24	CMPI.L	#0,L59E20
	BEQ	L5A00A
	MOVEA.L	L59E20(PC),A5
L59D36	MOVE.L	L59E24(PC),L5A1DE
	MOVE.L	L59E28(PC),L5A15A
	MOVE.L	L59E2C(PC),L5A16A
	MOVE.W	L59E30(PC),L5A176
	CLR.W	L5A1D2
	JSR	L59B76(PC)
	BRA	L5A00A
L59D64	MOVE.L	A6,L59E34
	MOVE.L	L5A1E2(PC),L59E38
	MOVE.L	L5A15E(PC),L59E3C
	MOVE.L	L5A16E(PC),L59E40
	MOVE.W	L5A178(PC),L59E44
	MOVEA.L	L59654(PC),A0
	CMPI.W	#2,$128(A0)
	BEQ	L5A088
	LEA	L5A1E6(PC),A6
	MOVE.L	#L5A1E6,L5A1E2
	MOVE.W	#1,L5A178
	CLR.W	L5A1D4
	BRA	L5A088
L59DB8	CMPI.L	#0,L59E34
	BEQ	L5A088
	MOVEA.L	L59E34(PC),A6
	MOVE.L	L59E38(PC),L5A1E2
	MOVE.L	L59E3C(PC),L5A15E
	MOVE.L	L59E40(PC),L5A16E
	MOVE.W	L59E44(PC),L5A178
	CLR.W	L5A1D4
	JSR	L59B76(PC)
	BRA	L5A088
L59DF8	DC.W	0,0
L59DFC	DC.W	0,0
L59E00	DC.W	0,0
L59E04	DC.W	0,0
L59E08	DC.W	0,0
L59E0C	DC.W	0,0
L59E10	DC.W	0,0
L59E14	DC.W	0,0
L59E18	DC.W	0,0
L59E1C	DC.W	0,0
L59E20	DC.W	0,0
L59E24	DC.W	0,0
L59E28	DC.W	0,0
L59E2C	DC.W	0,0
L59E30	DC.W	0,0
L59E34	DC.W	0,0
L59E38	DC.W	0,0
L59E3C	DC.W	0,0
L59E40	DC.W	0,0
L59E44	DC.W	0,0
L59E48	MOVE.B	#$3C,L59646
	CLR.W	L5A1CE
	BRA	L59F0E
L59E5A	MOVE.B	#$3C,L59646
	CLR.W	L5A1D0
	BRA	L59F8C
L59E6C	MOVE.B	#$3C,L59646
	CLR.W	L5A1D2
	BRA	L5A00A
L59E7E	MOVE.B	#$3C,L59646
	CLR.W	L5A1D4
	BRA	L5A088
L59E90	MOVEA.L	L59654(PC),A1
	TST.W	L5A1CE
	BEQ	L59F0E
	LEA	L59A9C(PC),A0
	MOVE.W	L5A1CE(PC),D0
	CMP.W	#1,D0
	BEQ	L59A60
	CMP.W	#2,D0
	BEQ	L59A66
	CMP.W	#3,D0
	BEQ	L59A6C
	CMP.W	#4,D0
	BEQ	L59A72
	CMP.W	#5,D0
	BEQ	L59A78
	CMP.W	#6,D0
	BEQ	L59A7E
	CMP.W	#7,D0
	BEQ	L59A84
	CMP.W	#8,D0
	BEQ	L59A8A
	CMP.W	#9,D0
	BEQ	L59A90
	CMP.W	#$A,D0
	BEQ	L59A96
	CMP.W	#$B,D0
	BEQ	L59BA8
	CMP.W	#$C,D0
	BEQ	L59BFC
	CMP.W	#$D,D0
	BEQ	L59E48
L59F0E	MOVEA.L	L59654(PC),A1
	TST.W	L5A1D0
	BEQ	L59F8C
	LEA	L59AD4(PC),A0
	MOVE.W	L5A1D0(PC),D0
	CMP.W	#1,D0
	BEQ	L59A60
	CMP.W	#2,D0
	BEQ	L59A66
	CMP.W	#3,D0
	BEQ	L59A6C
	CMP.W	#4,D0
	BEQ	L59A72
	CMP.W	#5,D0
	BEQ	L59A78
	CMP.W	#6,D0
	BEQ	L59A7E
	CMP.W	#7,D0
	BEQ	L59A84
	CMP.W	#8,D0
	BEQ	L59A8A
	CMP.W	#9,D0
	BEQ	L59A90
	CMP.W	#$A,D0
	BEQ	L59A96
	CMP.W	#$B,D0
	BEQ	L59C3C
	CMP.W	#$C,D0
	BEQ	L59C90
	CMP.W	#$D,D0
	BEQ	L59E5A
L59F8C	MOVEA.L	L59654(PC),A1
	TST.W	L5A1D2
	BEQ	L5A00A
	LEA	L59B0A(PC),A0
	MOVE.W	L5A1D2(PC),D0
	CMP.W	#1,D0
	BEQ	L59A60
	CMP.W	#2,D0
	BEQ	L59A66
	CMP.W	#3,D0
	BEQ	L59A6C
	CMP.W	#4,D0
	BEQ	L59A72
	CMP.W	#5,D0
	BEQ	L59A78
	CMP.W	#6,D0
	BEQ	L59A7E
	CMP.W	#7,D0
	BEQ	L59A84
	CMP.W	#8,D0
	BEQ	L59A8A
	CMP.W	#9,D0
	BEQ	L59A90
	CMP.W	#$A,D0
	BEQ	L59A96
	CMP.W	#$B,D0
	BEQ	L59CD0
	CMP.W	#$C,D0
	BEQ	L59D24
	CMP.W	#$D,D0
	BEQ	L59E6C
L5A00A	MOVEA.L	L59654(PC),A1
	TST.W	L5A1D4
	BEQ	L5A088
	LEA	L59B40(PC),A0
	MOVE.W	L5A1D4(PC),D0
	CMP.W	#1,D0
	BEQ	L59A60
	CMP.W	#2,D0
	BEQ	L59A66
	CMP.W	#3,D0
	BEQ	L59A6C
	CMP.W	#4,D0
	BEQ	L59A72
	CMP.W	#5,D0
	BEQ	L59A78
	CMP.W	#6,D0
	BEQ	L59A7E
	CMP.W	#7,D0
	BEQ	L59A84
	CMP.W	#8,D0
	BEQ	L59A8A
	CMP.W	#9,D0
	BEQ	L59A90
	CMP.W	#$A,D0
	BEQ	L59A96
	CMP.W	#$B,D0
	BEQ	L59D64
	CMP.W	#$C,D0
	BEQ	L59DB8
	CMP.W	#$D,D0
	BEQ	L59E7E
L5A088	RTS
L5A08A	JSR	L59E90
	MOVEA.L	L5A1BA(PC),A2
	CMPA.L	L5A1D6(PC),A3
	BLT.S	L5A0C0
	CMPI.W	#1,L5A172
	BEQ.S	L5A0B6
	SUBA.L	L5A1D6(PC),A3
	ADDA.L	L5A152(PC),A3
	MOVE.L	L5A162(PC),L5A1D6
	BRA.S	L5A0C0
L5A0B6	LEA	L5A1E6(PC),A3
	MOVE.L	A3,L5A1D6
L5A0C0	CMPA.L	L5A1DA(PC),A4
	BLT.S	L5A0EC
	CMPI.W	#1,L5A174
	BEQ.S	L5A0E2
	SUBA.L	L5A1DA(PC),A4
	ADDA.L	L5A156(PC),A4
	MOVE.L	L5A166(PC),L5A1DA
	BRA.S	L5A0EC
L5A0E2	LEA	L5A1E6(PC),A4
	MOVE.L	A4,L5A1DA
L5A0EC	CMPA.L	L5A1DE(PC),A5
	BLT.S	L5A118
	CMPI.W	#1,L5A176
	BEQ.S	L5A10E
	SUBA.L	L5A1DE(PC),A5
	ADDA.L	L5A15A(PC),A5
	MOVE.L	L5A16A(PC),L5A1DE
	BRA.S	L5A118
L5A10E	LEA	L5A1E6(PC),A5
	MOVE.L	A5,L5A1DE
L5A118	CMPA.L	L5A1E2(PC),A6
	BLT.S	L5A144
	CMPI.W	#1,L5A178
	BEQ.S	L5A13A
	SUBA.L	L5A1E2(PC),A6
	ADDA.L	L5A15E(PC),A6
	MOVE.L	L5A16E(PC),L5A1E2
	BRA.S	L5A144
L5A13A	LEA	L5A1E6(PC),A6
	MOVE.L	A6,L5A1E2
L5A144	RTS
L5A146	DC.l	mod1
L5A14A	DC.l	mod2
L5A14E	DC.l	mod3
L5A152	DC.L	L5A1E6
L5A156	DC.L	L5A1E6
L5A15A	DC.L	L5A1E6
L5A15E	DC.L	L5A1E6
L5A162	DC.L	L5A1E6
L5A166	DC.L	L5A1E6
L5A16A	DC.L	L5A1E6
L5A16E	DC.L	L5A1E6
L5A172	DC.W	1
L5A174	DC.W	1
L5A176	DC.W	1
L5A178	DC.W	1
L5A17A	DC.W	0,0
L5A17E	DC.W	0,0,0,0
L5A186	DC.W	$0000,$0000,$0001,$0203
L5A18E	DC.W	$0405,$0607,$0809,$0A0B
L5A196	DC.W	$0000,$0000,$0C0D,$0E0F
L5A19E	DC.W	$1011,$1213,$1415,$1617
L5A1A6	DC.W	$0000,$0000,$1819,$1A1B
L5A1AA	DC.W	$1C1D,$1E1F,$2021,$2223
	DC.W	0,0

L5A1BA	DC.L	L5A662
L5A1BE	DC.L	L5A662
L5A1C2	DC.L	L5A662
L5A1C6	DC.L	L5A662,L5A662
L5A1CE	DC.W	0
L5A1D0	DC.W	0
L5A1D2	DC.W	0
L5A1D4	DC.W	0
L5A1D6	DC.L	L5A1E6
L5A1DA	DC.L	L5A1E6
L5A1DE	DC.L	L5A1E6
L5A1E2	DC.L	L5A1E6
L5A1E6	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
	DC.W	$8080,$8080,$8080,$8080
FreqPointers:
	DC.W	0,0,0,0
L5A5D6	DC.W	0,0,0,0
L5A5DE	DC.W	0,0,0,0
L5A5E6	DC.W	0,0,0,0
L5A5EE	DC.W	0,0,0,0
L5A5F6	DC.W	0,0,0,0

L5A5FE	DC.W	0,0,0,0
L5A606	DC.W	0,0,0,0
L5A60E	DC.W	0,0,0,0
L5A616	DC.W	0,0,0,0
L5A61E	DC.W	0,0,0,0
L5A626	DC.W	0,0,0,0

L5A62E	DC.W	0,0,0,0
L5A636	DC.W	0,0,0,0
L5A63E	DC.W	0,0,0,0
L5A646	DC.W	0,0,0,0
L5A64E	DC.W	0,0,0,0
L5A656	DC.W	0,0,0,0

L5A65E	DC.W	0,0

FreqTabs:
	DC.W	$801
L5A662	dc.w	$900
	DC.W	$A00,0,$801,$900
	DC.W	$A00,0,$801,$901
	DC.W	$A00,0,$801,$901
	DC.W	$A00,0,$801,$901
	DC.W	$A01,0,$801,$901
	DC.W	$A01,0,$801,$901
	DC.W	$A02,0,$801,$901
	DC.W	$A02,0,$801,$902
	DC.W	$A02,0,$801,$902
	DC.W	$A02,0,$802,$902
	DC.W	$A02,0,$802,$902
	DC.W	$A02,0,$801,$903
	DC.W	$A03,0,$801,$903
	DC.W	$A03,0,$802,$903
	DC.W	$A03,0,$802,$903
	DC.W	$A03,0,$803,$903
	DC.W	$A03,0,$803,$903
	DC.W	$A03,0,$802,$903
	DC.W	$A04,0,$802,$903
	DC.W	$A04,0,$803,$903
	DC.W	$A04,0,$803,$903
	DC.W	$A04,0,$802,$904
	DC.W	$A04,0,$802,$904
	DC.W	$A04,0,$803,$904
	DC.W	$A04,0,$803,$904
	DC.W	$A04,0,$802,$904
	DC.W	$A05,0,$802,$904
	DC.W	$A05,0,$803,$904
	DC.W	$A05,0,$803,$904
	DC.W	$A05,0,$802,$905
	DC.W	$A05,0,$802,$905
	DC.W	$A05,0,$803,$905
	DC.W	$A05,0,$803,$905
	DC.W	$A05,0,$801,$905
	DC.W	$A06,0,$801,$905
	DC.W	$A06,0,$802,$905
	DC.W	$A06,0,$802,$905
	DC.W	$A06,0,$803,$905
	DC.W	$A06,0,$803,$905
	DC.W	$A06,0,$801,$906
	DC.W	$A06,0,$801,$906
	DC.W	$A06,0,$802,$906
	DC.W	$A06,0,$802,$906
	DC.W	$A06,0,$803,$906
	DC.W	$A06,0,$803,$906
	DC.W	$A06,0,$801,$906
	DC.W	$A07,0,$801,$906
	DC.W	$A07,0,$802,$906
	DC.W	$A07,0,$802,$906
	DC.W	$A07,0,$803,$906
	DC.W	$A07,0,$803,$906
	DC.W	$A07,0,$800,$907
	DC.W	$A07,0,$800,$907
	DC.W	$A07,0,$801,$907
	DC.W	$A07,0,$801,$907
	DC.W	$A07,0,$802,$907
	DC.W	$A07,0,$802,$907
	DC.W	$A07,0,$803,$907
	DC.W	$A07,0,$803,$907
	DC.W	$A07,0,$801,$906
	DC.W	$A08,0,$801,$906
	DC.W	$A08,0,$802,$906
	DC.W	$A08,0,$802,$906
	DC.W	$A08,0,$803,$906
	DC.W	$A08,0,$803,$906
	DC.W	$A08,0,$800,$907
	DC.W	$A08,0,$800,$907
	DC.W	$A08,0,$801,$907
	DC.W	$A08,0,$801,$907
	DC.W	$A08,0,$802,$907
	DC.W	$A08,0,$802,$907
	DC.W	$A08,0,$803,$907
	DC.W	$A08,0,$803,$907
	DC.W	$A08,0,$800,$906
	DC.W	$A09,0,$800,$906
	DC.W	$A09,0,$801,$906
	DC.W	$A09,0,$801,$906
	DC.W	$A09,0,$802,$906
	DC.W	$A09,0,$802,$906
	DC.W	$A09,0,$803,$906
	DC.W	$A09,0,$803,$906
	DC.W	$A09,0,$801,$907
	DC.W	$A09,0,$801,$907
	DC.W	$A09,0,$802,$907
	DC.W	$A09,0,$802,$907
	DC.W	$A09,0,$803,$907
	DC.W	$A09,0,$803,$907
	DC.W	$A09,0,$804,$907
	DC.W	$A09,0,$804,$907
	DC.W	$A09,0,$800,$908
	DC.W	$A09,0,$800,$908
	DC.W	$A09,0,$801,$908
	DC.W	$A09,0,$801,$908
	DC.W	$A09,0,$802,$908
	DC.W	$A09,0,$802,$908
	DC.W	$A09,0,$803,$908
	DC.W	$A09,0,$803,$908
	DC.W	$A09,0,$804,$908
	DC.W	$A09,0,$804,$908
	DC.W	$A09,0,$800,$907
	DC.W	$A0A,0,$800,$907
	DC.W	$A0A,0,$801,$907
	DC.W	$A0A,0,$801,$907
	DC.W	$A0A,0,$802,$907
	DC.W	$A0A,0,$802,$907
	DC.W	$A0A,0,$803,$907
	DC.W	$A0A,0,$803,$907
	DC.W	$A0A,0,$804,$907
	DC.W	$A0A,0,$804,$907
	DC.W	$A0A,0,$800,$908
	DC.W	$A0A,0,$800,$908
	DC.W	$A0A,0,$801,$908
	DC.W	$A0A,0,$801,$908
	DC.W	$A0A,0,$802,$908
	DC.W	$A0A,0,$802,$908
	DC.W	$A0A,0,$803,$908
	DC.W	$A0A,0,$803,$908
	DC.W	$A0A,0,$804,$908
	DC.W	$A0A,0,$804,$908
	DC.W	$A0A,0,$800,$906
	DC.W	$A0B,0,$800,$906
	DC.W	$A0B,0,$801,$906
	DC.W	$A0B,0,$801,$906
	DC.W	$A0B,0,$802,$906
	DC.W	$A0B,0,$802,$906
	DC.W	$A0B,0,$803,$906
	DC.W	$A0B,0,$803,$906
	DC.W	$A0B,0,$804,$906
	DC.W	$A0B,0,$804,$906
	DC.W	$A0B,0,$802,$907
	DC.W	$A0B,0,$802,$907
	DC.W	$A0B,0,$803,$907
	DC.W	$A0B,0,$803,$907
	DC.W	$A0B,0,$804,$907
	DC.W	$A0B,0,$804,$907
	DC.W	$A0B,0,$800,$908
	DC.W	$A0B,0,$800,$908
	DC.W	$A0B,0,$801,$908
	DC.W	$A0B,0,$801,$908
	DC.W	$A0B,0,$802,$908
	DC.W	$A0B,0,$802,$908
	DC.W	$A0B,0,$803,$908
	DC.W	$A0B,0,$803,$908
	DC.W	$A0B,0,$804,$908
	DC.W	$A0B,0,$804,$908
	DC.W	$A0B,0,$801,$90A
	DC.W	$A0A,0,$801,$90A
	DC.W	$A0A,0,$802,$90A
	DC.W	$A0A,0,$802,$90A
	DC.W	$A0A,0,$803,$90A
	DC.W	$A0A,0,$803,$90A
	DC.W	$A0A,0,$804,$90A
	DC.W	$A0A,0,$804,$90A
	DC.W	$A0A,0,$805,$90A
	DC.W	$A0A,0,$805,$90A
	DC.W	$A0A,0,$804,$909
	DC.W	$A0B,0,$804,$909
	DC.W	$A0B,0,$805,$909
	DC.W	$A0B,0,$805,$909
	DC.W	$A0B,0,$800,$904
	DC.W	$A0C,0,$800,$904
	DC.W	$A0C,0,$801,$904
	DC.W	$A0C,0,$801,$904
	DC.W	$A0C,0,$802,$904
	DC.W	$A0C,0,$802,$904
	DC.W	$A0C,0,$803,$904
	DC.W	$A0C,0,$803,$904
	DC.W	$A0C,0,$804,$904
	DC.W	$A0C,0,$804,$904
	DC.W	$A0C,0,$804,$905
	DC.W	$A0C,0,$804,$905
	DC.W	$A0C,0,$805,$905
	DC.W	$A0C,0,$805,$905
	DC.W	$A0C,0,$801,$907
	DC.W	$A0C,0,$801,$907
	DC.W	$A0C,0,$802,$907
	DC.W	$A0C,0,$802,$907
	DC.W	$A0C,0,$803,$907
	DC.W	$A0C,0,$803,$907
	DC.W	$A0C,0,$804,$907
	DC.W	$A0C,0,$804,$907
	DC.W	$A0C,0,$805,$907
	DC.W	$A0C,0,$805,$907
	DC.W	$A0C,0,$801,$908
	DC.W	$A0C,0,$801,$908
	DC.W	$A0C,0,$802,$908
	DC.W	$A0C,0,$802,$908
	DC.W	$A0C,0,$803,$908
	DC.W	$A0C,0,$803,$908
	DC.W	$A0C,0,$804,$908
	DC.W	$A0C,0,$804,$908
	DC.W	$A0C,0,$805,$908
	DC.W	$A0C,0,$805,$908
	DC.W	$A0C,0,$800,$909
	DC.W	$A0C,0,$800,$909
	DC.W	$A0C,0,$801,$909
	DC.W	$A0C,0,$801,$909
	DC.W	$A0C,0,$802,$909
	DC.W	$A0C,0,$802,$909
	DC.W	$A0C,0,$803,$909
	DC.W	$A0C,0,$803,$909
	DC.W	$A0C,0,$804,$909
	DC.W	$A0C,0,$804,$909
	DC.W	$A0C,0,$805,$909
	DC.W	$A0C,0,$805,$909
	DC.W	$A0C,0,$806,$90B
	DC.W	$A0B,0,$806,$90B
	DC.W	$A0B,0,$807,$90B
	DC.W	$A0B,0,$807,$90B
	DC.W	$A0B,0,$800,$90A
	DC.W	$A0C,0,$800,$90A
	DC.W	$A0C,0,$801,$90A
	DC.W	$A0C,0,$801,$90A
	DC.W	$A0C,0,$802,$90A
	DC.W	$A0C,0,$802,$90A
	DC.W	$A0C,0,$803,$90A
	DC.W	$A0C,0,$803,$90A
	DC.W	$A0C,0,$804,$90A
	DC.W	$A0C,0,$804,$90A
	DC.W	$A0C,0,$805,$90A
	DC.W	$A0C,0,$801,$905
	DC.W	$A0D,0,$802,$905
	DC.W	$A0D,0,$803,$905
	DC.W	$A0D,0,$801,$906
	DC.W	$A0D,0,$801,$906
	DC.W	$A0D,0,$802,$906
	DC.W	$A0D,0,$802,$906
	DC.W	$A0D,0,$803,$906
	DC.W	$A0D,0,$803,$906
	DC.W	$A0D,0,$804,$906
	DC.W	$A0D,0,$804,$906
	DC.W	$A0D,0,$805,$906
	DC.W	$A0D,0,$805,$906
	DC.W	$A0D,0,$804,$907
	DC.W	$A0D,0,$804,$907
	DC.W	$A0D,0,$805,$907
	DC.W	$A0D,0,$805,$907
	DC.W	$A0D,0,$801,$908
	DC.W	$A0D,0,$801,$908
	DC.W	$A0D,0,$802,$908
	DC.W	$A0D,0,$802,$908
	DC.W	$A0D,0,$803,$908
	DC.W	$A0D,0,$803,$908
	DC.W	$A0D,0,$804,$908
	DC.W	$A0D,0,$804,$908
	DC.W	$A0D,0,$805,$908
	DC.W	$A0D,0,$805,$908
	DC.W	$A0D,0,$800,$909
	DC.W	$A0D,0,$800,$909
	DC.W	$A0D,0,$801,$909
	DC.W	$A0D,0,$801,$909
	DC.W	$A0D,0,$802,$909
	DC.W	$A0D,0,$802,$909
	DC.W	$A0D,0,$803,$909
	DC.W	$A0D,0,$803,$909
	DC.W	$A0D,0,0,0
	DCB.W	13772,0
	DC.W	0,0

RasterSamplePlayer:
*	BCLR.B	#6,$FFFFFA15.W
	MOVE.W	#$2500,SR
SamplePlayer:
	MOVE.L	A0,-(SP)
MyMod	lea	Buffer,a0
*	add.l	#12,MyMod+2
	move.l	(a0)+,$ffff8800.w
	move.l	(a0)+,$ffff8800.w
	move.l	(a0)+,$ffff8800.w
	move.l	a0,MyMod+2
	MOVE.L	(sp)+,A0
*	BSET.B	#6,$FFFFFA15.W
	RTE

BufferLength	equ	172

MakeBuffer:
	move.l	a2,-(sp)
	lea	Buffer,a1
	lea	EndBuffer,a2
	moveq.l	#0,d4
	move.l	d4,d6
	move.l	#BufferLength-1,d0
	move.l	MyMod+2(PC),a0
	move.l	a0,d7
	sub.l	a1,d7
	cmp	a0,a2
	beq.s	.Skip
.loop
	move.l	(a0)+,(a1)+
	move.l	(a0)+,(a1)+
	move.l	(a0)+,(a1)+
	addq.l	#1,d4
	cmp.l	a0,a2
	bgt.s	.loop
	sub.l	d4,d0
.Skip
	sub.l	d7,MyMod+2
	move.l	(sp)+,a2
	ADDQ.L	#2,A1
CopyLoop:
	MOVEQ	#0,D7
	MOVE.B	(A6),D7
	MOVE.B	(A5),D6
	ADD.W	D6,D7
	MOVE.B	(A4),D6
	ADD.W	D6,D7
	MOVE.B	(A3),D6
	ADD.W	D6,D7
	ASL.W	#3,D7
	lea	SoundTable(pc,d7.w),a0
	move.w	(a0)+,(a1)
	move.w	(a0)+,4(a1)
	move.w	(a0)+,8(a1)
	lea	12(a1),a1
mod1	ADDA.W	2(A2),A4
mod2	ADDA.W	2(A2),A5
mod3	ADDA.W	2(A2),A6
	ADDA.W	(A2)+,A3

	dbra	d0,CopyLoop
	rts

SoundTable:
	DC.L	$80E090D
	DC.L	$A0C0000
	DC.L	$80F0903,$A000000
	DC.L	$80F0903,$A000000
	DC.L	$80F0903,$A000000
	DC.L	$80F0903,$A000000
	DC.L	$80F0903,$A000000
	DC.L	$80F0903,$A000000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0B0000
	DC.L	$80E090D,$A0A0000
	DC.L	$80E090D,$A0A0000
	DC.L	$80E090D,$A0A0000
	DC.L	$80E090D,$A0A0000
	DC.L	$80E090C,$A0C0000
	DC.L	$80E090D,$A000000
	DC.L	$80D090D,$A0D0000
	DC.L	$80D090D,$A0D0000
	DC.L	$80D090D,$A0D0000
	DC.L	$80D090D,$A0D0000
	DC.L	$80D090D,$A0D0000
	DC.L	$80D090D,$A0D0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0B0000
	DC.L	$80E090C,$A0A0000
	DC.L	$80E090C,$A0A0000
	DC.L	$80E090C,$A0A0000
	DC.L	$80E090C,$A0A0000
	DC.L	$80D090D,$A0C0000
	DC.L	$80D090D,$A0C0000
	DC.L	$80E090C,$A090000
	DC.L	$80E090C,$A090000
	DC.L	$80E090C,$A050000
	DC.L	$80E090C,$A000000
	DC.L	$80E090C,$A000000
	DC.L	$80E090B,$A0B0000
	DC.L	$80E090B,$A0B0000
	DC.L	$80E090B,$A0B0000
	DC.L	$80E090B,$A0B0000
	DC.L	$80E090B,$A0A0000
	DC.L	$80E090B,$A0A0000
	DC.L	$80E090B,$A0A0000
	DC.L	$80D090D,$A0B0000
	DC.L	$80D090D,$A0B0000
	DC.L	$80D090D,$A0B0000
	DC.L	$80E090B,$A090000
	DC.L	$80E090B,$A090000
	DC.L	$80E090B,$A090000
	DC.L	$80D090C,$A0C0000
	DC.L	$80D090D,$A0A0000
	DC.L	$80E090B,$A070000
	DC.L	$80E090B,$A000000
	DC.L	$80E090B,$A000000
	DC.L	$80D090D,$A090000
	DC.L	$80D090D,$A090000
	DC.L	$80E090A,$A090000
	DC.L	$80D090D,$A080000
	DC.L	$80D090D,$A070000
	DC.L	$80D090D,$A040000
	DC.L	$80D090D,$A000000
	DC.L	$80E090A,$A040000
	DC.L	$80E0909,$A090000
	DC.L	$80E0909,$A090000
	DC.L	$80D090C,$A0B0000
	DC.L	$80E0909,$A080000
	DC.L	$80E0909,$A080000
	DC.L	$80E0909,$A070000
	DC.L	$80E0908,$A080000
	DC.L	$80E0909,$A010000
	DC.L	$80C090C,$A0C0000
	DC.L	$80D090C,$A0A0000
	DC.L	$80E0908,$A060000
	DC.L	$80E0907,$A070000
	DC.L	$80E0908,$A000000
	DC.L	$80E0907,$A050000
	DC.L	$80E0906,$A060000
	DC.L	$80D090C,$A090000
	DC.L	$80E0905,$A050000
	DC.L	$80E0904,$A040000
	DC.L	$80D090C,$A080000
	DC.L	$80D090B,$A0B0000
	DC.L	$80E0900,$A000000
	DC.L	$80D090C,$A060000
	DC.L	$80D090C,$A050000
	DC.L	$80D090C,$A020000
	DC.L	$80C090C,$A0B0000
	DC.L	$80C090C,$A0B0000
	DC.L	$80D090B,$A0A0000
	DC.L	$80D090B,$A0A0000
	DC.L	$80D090B,$A0A0000
	DC.L	$80D090B,$A0A0000
	DC.L	$80C090C,$A0A0000
	DC.L	$80C090C,$A0A0000
	DC.L	$80C090C,$A0A0000
	DC.L	$80D090B,$A090000
	DC.L	$80D090B,$A090000
	DC.L	$80D090A,$A0A0000
	DC.L	$80D090A,$A0A0000
	DC.L	$80D090A,$A0A0000
	DC.L	$80C090C,$A090000
	DC.L	$80C090C,$A090000
	DC.L	$80C090C,$A090000
	DC.L	$80D090B,$A060000
	DC.L	$80C090B,$A0B0000
	DC.L	$80C090C,$A080000
	DC.L	$80D090B,$A000000
	DC.L	$80D090B,$A000000
	DC.L	$80C090C,$A070000
	DC.L	$80C090C,$A060000
	DC.L	$80C090C,$A050000
	DC.L	$80C090C,$A030000
	DC.L	$80C090C,$A010000
	DC.L	$80C090B,$A0A0000
	DC.L	$80D090A,$A050000
	DC.L	$80D090A,$A040000
	DC.L	$80D090A,$A020000
	DC.L	$80D0909,$A080000
	DC.L	$80D0909,$A080000
	DC.L	$80C090B,$A090000
	DC.L	$80C090B,$A090000
	DC.L	$80D0908,$A080000
	DC.L	$80B090B,$A0B0000
	DC.L	$80D0909,$A050000
	DC.L	$80C090B,$A080000
	DC.L	$80D0909,$A020000
	DC.L	$80D0908,$A060000
	DC.L	$80C090B,$A070000
	DC.L	$80D0907,$A070000
	DC.L	$80C090B,$A060000
	DC.L	$80C090A,$A090000
	DC.L	$80B090B,$A0A0000
	DC.L	$80C090B,$A020000
	DC.L	$80C090B,$A000000
	DC.L	$80C090A,$A080000
	DC.L	$80D0906,$A040000
	DC.L	$80D0905,$A050000
	DC.L	$80D0905,$A040000
	DC.L	$80C0909,$A090000
	DC.L	$80D0904,$A030000
	DC.L	$80B090B,$A090000
	DC.L	$80C090A,$A050000
	DC.L	$80B090A,$A0A0000
	DC.L	$80C0909,$A080000
	DC.L	$80B090B,$A080000
	DC.L	$80C090A,$A000000
	DC.L	$80C090A,$A000000
	DC.L	$80C0909,$A070000
	DC.L	$80B090B,$A070000
	DC.L	$80C0909,$A060000
	DC.L	$80B090B,$A060000
	DC.L	$80B090A,$A090000
	DC.L	$80B090B,$A050000
	DC.L	$80A090A,$A0A0000
	DC.L	$80B090B,$A020000
	DC.L	$80B090A,$A080000
	DC.L	$80C0907,$A070000
	DC.L	$80C0908,$A040000
	DC.L	$80C0907,$A060000
	DC.L	$80B0909,$A090000
	DC.L	$80C0906,$A060000
	DC.L	$80A090A,$A090000
	DC.L	$80C0907,$A030000
	DC.L	$80B090A,$A050000
	DC.L	$80B0909,$A080000
	DC.L	$80B090A,$A030000
	DC.L	$80A090A,$A080000
	DC.L	$80B090A,$A000000
	DC.L	$80B0909,$A070000
	DC.L	$80B0908,$A080000
	DC.L	$80A090A,$A070000
	DC.L	$80A0909,$A090000
	DC.L	$80C0901,$A010000
	DC.L	$80A090A,$A060000
	DC.L	$80B0908,$A070000
	DC.L	$80A090A,$A050000
	DC.L	$80A0909,$A080000
	DC.L	$80A090A,$A020000
	DC.L	$80A090A,$A010000
	DC.L	$80A090A,$A000000
	DC.L	$8090909,$A090000
	DC.L	$80A0908,$A080000
	DC.L	$80B0908,$A010000
	DC.L	$80A0909,$A060000
	DC.L	$80B0907,$A040000
	DC.L	$80A0909,$A050000
	DC.L	$8090909,$A080000
	DC.L	$80A0909,$A030000
	DC.L	$80A0908,$A060000
	DC.L	$80A0909,$A000000
	DC.L	$8090909,$A070000
	DC.L	$8090908,$A080000
	DC.L	$80A0908,$A040000
	DC.L	$8090909,$A060000
	DC.L	$80A0908,$A010000
	DC.L	$8090909,$A050000
	DC.L	$8090908,$A070000
	DC.L	$8080908,$A080000
	DC.L	$8090909,$A020000
	DC.L	$8090908,$A060000
	DC.L	$8090909,$A000000
	DC.L	$8090907,$A070000
	DC.L	$8080908,$A070000
	DC.L	$8090907,$A060000
	DC.L	$8090908,$A020000
	DC.L	$8080908,$A060000
	DC.L	$8090906,$A060000
	DC.L	$8080907,$A070000
	DC.L	$8080908,$A040000
	DC.L	$8080907,$A060000
	DC.L	$8080908,$A020000
	DC.L	$8070907,$A070000
	DC.L	$8080906,$A060000
	DC.L	$8080907,$A040000
	DC.L	$8070907,$A060000
	DC.L	$8080906,$A050000
	DC.L	$8080906,$A040000
	DC.L	$8070906,$A060000
	DC.L	$8070907,$A040000
	DC.L	$8080905,$A040000
	DC.L	$8060906,$A060000
	DC.L	$8070906,$A040000
	DC.L	$8070905,$A050000
	DC.L	$8060906,$A050000
	DC.L	$8060906,$A040000
	DC.L	$8060905,$A050000
	DC.L	$8060906,$A020000
	DC.L	$8060905,$A040000
	DC.L	$8050905,$A050000
	DC.L	$8060905,$A020000
	DC.L	$8050905,$A040000
	DC.L	$8050904,$A040000
	DC.L	$8050905,$A020000
	DC.L	$8040904,$A040000
	DC.L	$8040904,$A030000
	DC.L	$8040904,$A020000
	DC.L	$8040903,$A030000
	DC.L	$8030903,$A030000
	DC.L	$8030903,$A020000
	DC.L	$8030902,$A020000
	DC.L	$8020902,$A020000
	DC.L	$8020902,$A010000
	DC.L	$8010901,$A010000
	DC.L	$8020901,$A000000
	DC.L	$8010901,$A000000
	DC.L	$8010900,$A000000
	DC.L	$8000900,$A000000
	DCB.L	1537,0
*	ORI.B	#$24,D0


Buffer:
	dcb.l	BufferLength*3,0
EndBuffer:
	dcb.l	6,0
	dcb.b	(4*1024)
SECTION TEXT
