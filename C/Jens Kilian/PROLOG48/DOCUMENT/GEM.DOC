0720103030566
1TOY Prolog Version 4Seite #
2(c) JJK 1987
9[....................................................]
ÄÅ5.âGEM-FunktionenÄ

5.1DatenstrukturenauûerhalbvonProlog

PrologkenntnureineeinzigeDatenart,nÑmlichdenÅTermÄ.
VieleGEM-FunktionenbenîtigenaberspezielleDatenstrukturen
(z.B.ObjektbÑume).SolcheDatenstrukturenkînntenzwar
prinzipiellalsProlog-TermereprÑsentiertwerden,mÅûten
aberbeijederBenutzungindieinterneFormÅbersetzt
werden.AuûerdemwÑrez.B.dieReprÑsentationeines
RasterobjektswegendesgroûenSpeicherbedarfsunmîglich.
EsbleibtdahernurdieMîglichkeit,ein'fremdes'
DatenobjektÅauûerhalbÄdesProlog-Systemszudefinierenund
ÅberseineÅSpeicheradresseÄdaraufzuzugreifen.Dadieses
VerfahrensehrunsicheristunddemProgrammiererzusÑtzliche
ArbeitaufbÅrdet(dieVerwaltungderAdressen),wurdeinTOY
PrologSTeinSchemaimplementiert,dasdenUmgangmit
derartigenAdressensehrvereinfacht.

InAbschnitt4.1warbereitsdavondieRede,daûFunktorenin
TOYPrologSTverschiedenenKlassenangehîren.Diedort
genannteObjektklasse(c)istdie,umdieesjetztgeht.
DieÅAdresseÄeinesauûerhalbdefiniertenDatenobjektswird
durchspezielleFunktionenaneinÅLiteralÄgebunden.DieGEM-
FunktionenerhaltendiesesLiteralalsParameterunderkennen
selbsttÑtig,obessichumdierichtigeDatenarthandelt.
Wirdz.B.einerRasterfunktionstatteinesRasterobjektsein
ObjektbaumÅbergeben,sowirdsichdieRasterfunktiondarÅber
beschweren.

DasLiteral,dasdieAdressedesDatenobjektszugÑnglich
macht,wirdÅhandleÄgenannt.'handle'istdasenglischeWort
fÅr'Handhabe','Griff'oder'TÅrklinke'.DieseMetapher
trifftdenSachverhaltrechtgenau.

UmdieProgrammierungderGEM-Funktionenmîglichstkonsistent
undeinfachzugestalten,wurdederhandle-Begriffauchauf
ÅabstrakteÄObjekteausgedehnt,diezwarimSpeichervorhanden,
aberdemProgrammierernichtdirektzugÑnglichsind.Solche
Objektesind:

ArbeitsstationendesVDI
Fenster
Programme(Desk-Accessories)

InProgrammen,dieinCundÑhnlichenSprachengeschrieben
sind,wirdaufsolcheObjektemitIntegerzahlenzugegriffen.
DieGEM-FunktionenimBetriebssystemverwaltenentsprechende
Datenstrukturen,dieabervordemProgrammiererversteckt
sind.InTOYPrologSTkînnendieseObjektegenauwiedie
obengenannten'realen'Datenobjektebehandeltwerden(unter
BeachtunggewisserEinschrÑnkungen;abstrakteObjektekînnen
z.B.nichtdirektmodifiziertwerden.

5.1.1FunktionenzumErzeugenvonhandles

DieFunktionen,dienachfolgenderlÑutertwerden,benîtigen
einProlog-LiteralalsParameter(zusÑtzlichzusonstigen
Informationen).DiesesLiteraldarfnichtFunktoreiner
Systemfunktionsein,undesdÅrfenkeineKlauselndafÅr
definiertsein.WenndieFunktionnichtausgefÅhrtwerden
kann(z.B.wennesnichtgelingt,einhandlezuerzeugen),
dannschlÑgtsiefehl.BeierfolgreicherAusfÅhrungkanndas
andieFunktionÅbergebeneLiteralabsofortalshandlefÅr
dasenstprechendeDatenobjektbenutztwerden.Dashandle
bleibtsolangeerhalten,bisesexplizitgelîschtwird(siehe
dennÑchstenAbschnitt).

Ñrsrc_handleÄ(ZAHL,ZAHL,LITERAL)

DieseFunktionentsprichtderAES-Funktionàrsrc_gaddr()Ä.Sie
kannnurerfÅlltwerden,wenneineResource-Dateigeladen
wurde(mitrsrc_load/1).PAR1isteinCodefÅrverschiedene
ArtenvonDatenstruktureninderResource-Datei:

àCodeÄàDatenstrukturÄ

0TREEEinObjektbaum(MenÅ,Dialogboxetc.)
1OBJECTEineinzelnesObjekt
2TEDINFOEinTextobjekt(formatier-&editierbar)
3ICONBLKEinPiktogrammmitDaten,MaskeundText
4BITBLKEinPiktogrammohneText
5StringEin'roher'Text
6ImData'Rohe'Piktogrammdaten
7ObSpecObjektspezifischeInformation
8TePTextTextineinemTEDINFO
9TePTempSchabloneineinemTEDINFO
10TePValidPrÅfzeichenineinemTEDINFO
11IbPMaskMaskeineinemICONBLK
12IbPDataDatenineinemICONBLK
13IbPTextTextineinemICONBLK
14BiPDataDatenineinemBITBLK

(DieObjektarten15und16sindAdressenvonAdressenundmit
demimplementiertenSchemanichtzugebrauchen)

PAR2istderIndexdesgewÅnschtenDatenobjekts.PAR3istdas
Literal,daszumhandledesDatenobjektswerdensoll.

ÅBeispielÄ:EsseieineResource-Dateigeladen,diezwei
ObjektbÑumeenthÑlt:EinMenÅundeineDialogbox.
Dannwerdenmit

rsrc_handle(0,0,menu),rsrc_handle(0,1,dialog)

dieLiteraleÅmenuÄundÅdialogÄzuhandlesfÅrdie
beidenObjektbÑume.

Ñmfdb_handleÄ(ZAHL,ZAHL,ZAHL,LITERAL)

DieseFunktionerzeugteinRasterobjektmitPAR1Pixeln
Breite,PAR2PixelnHîheundPAR3Ebenen.PAR4wirdzum
handledesRasterobjekts.DaserzeugteRasterobjektwird
ÅnichtÄinitialisiert,eskannalsozufÑlligeDatenenthalten.
RasterobjektewerdenimÅgerÑtespezifischenÄFormaterzeugtund
mÅssenbeiBedarfmitvr_trnfm/3umgewandeltwerden.

ÅBeispielÄ:UmeinRasterobjektzuerzeugen,mitdemeine
BildschirmseiteimMonochrommodusgespeichert
werdenkann,benutztman

mfdb_handle(640,400,1,raster_objekt)

Ñv_opnwkÄ(LISTE,LITERAL)

PAR1muûausgenau11Zahlenbestehen.DieFunktionîffnet
eineArbeitsstationdesVDIundmachtPAR2zuderenhandle.

ÅAchtungÄ:DieseFunktionfunktioniertnur,wenndasGDOSim
Speichervorhandenist.DazumuûeinProgramm
namensGDOS.PRG(wirdz.B.zusammenmitGEMDraw
geliefert)imAUTO-Ordnerinstalliertwerden.
ImROMdesATARISTbefindetsichnormalerweisenur
einGrafiktreiberfÅrdenBildschirm.Dieser
TreiberkannnureineeinzigeArbeitsstation
verwalten,dieautomatischvomAESgeîffnetwird.
DaherfÅhrteinAufrufvonv_opnwk/2ohnedasGDOS
zumÅAbsturzÄdesRechners.

Die11ZahleninPAR1gebendiezuîffnendeArbeitsstationan
(ersteZahl),initialisierendieArbeitsstation(2.-10.
Zahl)undgebenan,welchesKoordinatensystemverwendet
werdensoll(11.Zahl).DasôffneneinerArbeitsstationfÅhrt
dazu,daûeinGerÑtetreibervonDiskettegeladenwird(auûer
erbefindetsichschonimSpeicher).

Ñv_opnvwkÄ(VDIHandle,LISTE,LITERAL)

PAR1muûhandleeinerVDI-Arbeitsstationsein,PAR2eine
Listevongenau11Zahlen.DieFunktionîffneteinevirtuelle
BildschirmarbeitsstationundmachtPAR3zuderenhandle.

Ñappl_findÄ(LITERAL,LITERAL)

PAR1muûausgenau8Zeichenbestehen.AESsuchtnachAufruf
dieserFunktioneinProgramm(Desk-Accessoryetc.)im
SpeicherundmachtPAR2zumhandlederProgrammkennziffer.
Mankanndannz.B.mitappl_write/2Nachrichtenandas
Programmschicken.

Ñwind_createÄ(ZAHL,LISTE,LITERAL)

DieseFunktionerzeugteinFenster(Fehlschlag,fallskeine
FenstermehrÅbrigsind)undmachtPAR3zumhandledes
Fensters.DieeinzelnenBitsvonPAR1gebenverschiedene
ElementeeinesFenstersan;wenneinBitgesetztist,dann
enthÑltdaserzeugteFensterdasentsprechendeElement.

àBitÄàWertÄàFensterelementÄ
01NAMETitelzeile
12CLOSER'Knopf'zumSchlieûendesFensters
24FULLERKnopfzumVergrîûernaufBildschirmgrîûe
38MOVERBalkenzumVerschiebendesFensters
416INFOInformationszeile
532SIZERKnopfzuméndernderFenstergrîûe
664UPARROWPfeilnachoben
7128DNARROWPfeilnachunten
8256VSLIDESenkrechterScrollbalken
9512LFARROWPfeilnachlinks
101024RTARROWPfeilnachrechts
112048HSLIDEWaagerechterScrollbalken

PAR2muûausgenau4Zahlenbestehen,diediePosition
(X, Y),BreiteundHîheangeben,diedasFenstermaximal
erreichenkann.

5.1.2FunktionenzumLîschenvonhandles

Ñforget_handleÄ(Handle)

PAR1muûeinhandlesein,darfjedochwederhandleeinerVDI-
ArbeitsstationnocheinesFensterssein.PAR1wirdwiederzum
normalenLiteralgemacht;fallsdaszugehîrigeDatenobjekt
einRasterobjektwar,wirdesgelîscht.

Ñv_clswkÄ(VDIHandle)

PAR1muûhandleeinerVDI-Arbeitsstationsein.Die
Arbeitsstationwirdgeschlossen,undPAR1wirdeinnormales
Literal.

Ñv_clsvwkÄ(VDIHandle)

PAR1muûhandleeinervirtuellenVDI-Arbeitsstationsein.Die
Arbeitsstationwirdgeschlossen,undPAR1wirdeinnormales
Literal.

Ñwind_deleteÄ(WindowHandle)

PAR1muûhandleeinesFensterssein.DasFensterwird
gelîscht,undPAR1wirdeinnormalesLiteral.

5.1.3FunktionenzumUmwandelnvonhandles

DienachfolgendgenanntenFunktionendienendazu,eindurch
einhandlebezeichnetesDatenobjektineinenProlog-Term
umzuwandeln.EssindnursehrbegrenzteUmwandlungenmîglich.

Ñhandle_valueÄ(Handle,VARINT)

PAR1muûhandleeinerVDI-Arbeitsstation,einesProgramms
odereinesFensterssein.DieseDatenobjektewerdenintern
durcheineZahlreprÑsentiert;eswirdversucht,dieZahlmit
PAR2zuunifizieren.

Ñrsrc_nameÄ(StringHandle,TERM)

PAR1muûhandleeinesStringsineinerResource-Dateisein.
FolgendeResource-ObjektesindStrings:

5StringEin'roher'Text
8TePTextTextineinemTEDINFO
9TePTempSchabloneineinemTEDINFO
10TePValidPrÅfzeichenineinemTEDINFO
13IbPTextTextineinemICONBLK

DerString,denPAR1bezeichnet,wirdineinProlog-Literal
umgewandelt;eswirdversucht,diesesLiteralmitPAR2zu
unifizieren.

5.1.4FunktionenzumModifizierenvonDatenobjekten

MitdenfolgendenFunktionenkînnenDatenobjektedirekt
modifiziertwerden.DieseFunktionenmÅssenmitÅgrîûter
VorsichtÄangewendetwerden,dasiedemInterpreterdie
KontrolleÅberdasDatenobjektentziehenunddenRechnerzum
Absturzbringenkînnen.

DieFunktionenkînnennuraufResource-Datenobjekte
angewendetwerden.

Ñbyte_atÄ(Handle,ZAHL,VARINT)

FragtdasByteNr.PAR2imdurchPAR1bezeichneten
Datenobjektabundversucht,dengefundenenWertmitPAR3zu
unifizieren.FallsPAR2kleinerals0odergrîûeralsdie
AnzahlderBytesimObjektist,schlÑgtbyte_at/3fehl.

Ñword_atÄ(Handle,ZAHL,VARINT)

Wiebyte_at/3,aberarbeitetmitWorten(2Bytes).PAR2wird
mit2multipliziert,umAdressfehlerzuverhindern.

Ñbyte_putÄ(Handle,ZAHL,ZAHL)

SchreibtPAR3indasByteNr.PAR2desdurchPAR1
bezeichnetenDatenobjekts.SchlÑgtfehl,fallsPAR2zuklein
oderzugroûist.

Ñword_putÄ(Handle,ZAHL,ZAHL)

Wiebyte_put/3,aberarbeitetmitWorten.PAR2wirdmit2
multipliziert,umAdressfehlerzuverhindern.

Ñhandle_putÄ(Handle1,ZAHL,Handle2)

PAR3muûeinResource-Datenobjektbezeichnen,daswederein
Objektbaum(TREE)nocheinEinzelobjekt(OBJECT)ist.Die
AdressediesesObjektswirdalsLangwort(4Bytes-2Worte)
inzweiaufeinanderfolgendeWortedesdurchPAR1angegebenen
Datenobjektsgeschrieben.PAR2gibtdieNummerdesersten
Wortesan(wirdwiedermit2multipliziert).

Ñname_putÄ(Handle,ZAHL,LITERAL)

Wiehandle_put/3,aberanstellederAdresseeines
DatenobjektswirddieAdresseeinesStringsgespeichert,der
durchPAR3angegebenwird.

5.1.5Vordefiniertehandles

FolgendeLiteralesindalshandlesvordefiniertundkînnen
nichtgelîschtwerden:

Ñphys_handleÄ

IsthandlederphysikalischenBildschirmarbeitsstation,die
vonAESgeîffnetwurde.

Ñscreen_handleÄ

IsthandledesphysikalischenBildschirms(alsRasterobjekt).

Ñappl_handleÄ

IsthandledeslaufendenProgramms(kannz.B.beiappl_read
verwendetwerden).

Ñdesk_handleÄ

IsthandledesDesktop-Fensters(Bildschirmhintergrund).

AuûerdemistÑvdi_handleÄeininSYSFILE.TOYerzeugteshandle
fÅreinevirtuelleVDI-Arbeitsstation.

5.2ÅVDI-FunktionenÄ

AlleVDI-FunktionenbenîtigenalserstenParameterdashandle
einerArbeitsstation.DerersteParameteristdeshalbÅberall
mit'VH'(VDI-Handle)bezeichnetworden.

5.2.1Kontrollfunktionen

DieKontrollfunktionendienendazu,Arbeitsstationenzu
verwaltenundbestimmteglobaleParametereiner
ArbeitsstationzuverÑndern.

5.2.1.1KontrollfunktionenfÅrArbeitsstationen

Ñv_opnwkÄ(LISTE,LITERAL)

SieheAbschnitt5.1.1.

Ñv_clswkÄ(VH)

SieheAbschnitt5.1.2.

Ñv_clrwkÄ(VH)

InitialisiertdiedurchPAR1angegebeneArbeitsstation.Wird
beimAufrufvonv_opnwk/2automatischaufgerufen.

Ñv_updwkÄ(VH)

WennPAR1z.B.eineDrucker-oderPlotter-Arbeitsstation
bezeichnet,dannwirdbeimAufrufvonv_updwk/1mitdem
Ausdruckenbegonnen.BeiArbeitsstationen,diedie
GrafikoperationensofortdurchfÅhren(z.B.Bildschirm),wird
dieseFunktionignoriert.

Ñv_opnvwkÄ(VH,LISTE,LITERAL)

SieheAbschnitt5.1.1.

Ñv_clsvwkÄ(VH)

SieheAbschnitt5.1.2.

Ñvst_load_fontsÄ(VH)

LÑdtZeichensÑtzefÅrdiedurchPAR1angegebene
Arbeitsstationnach.FunktioniertnurzusammenmitdemGDOS!

Ñvst_unload_fontsÄ(VH)

EntferntnachgeladeneZeichensÑtzeausdemSpeicher.Auch
dieseFunktionkannnurzusammenmitdemGDOSbenutztwerden.

5.2.1.2Kontrollfunktionenallgemein

Ñvs_colorÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

VerÑndertdieFarbzusammensetzungfÅrdieFarbemitder
NummerPAR2.PAR3bisPAR5gebendenRot-,GrÅn-und
Blauanteilan(erlaubteWerteliegenimBereich0-1000).

Ñvswr_modeÄ(VH,ZAHL)

StelltdenSchreibmodusfÅr(fast)alleAusgabefunktionen
ein.ErlaubteWertefÅrPAR2:

àWertÄàSchreibmodusÄ
1REPLACEVorder-undHintergrundwerdenverÑndert
2TRANSPARENTnurVordergrundwirdverÑndert
3XORlogischeXOR-VerknÅpfung
4REVRS.TRANSP.Ñhnlich2,aberNegativdarstellung

Ñvsc_formÄ(VH,LISTE)

VerÑndertdieFormdesMauscursors.PAR2muûausgenau37
Zahlenbestehen,undzwarderReihenachaus:

-derX-KoordinatedesaktivenPunktes('hotspot')
-derY-KoordinatedesaktivenPunktes
-einerreserviertenZahl(muûauf1gesetztwerden)
-derVordergrundfarbe
-derHintergrundfarbe
-derMaskeninformation(16Zahlen)
-denDaten(16Zahlen)

WenndieFormdesCursorsspÑtermitgraf_mouse/1geÑndert
wurde(sieheAES-Dokumentation),dannkanndieÅzuletztÄmit
vsc_form/2festgelegteFormmit

graf_mouse(255)

wiedereingestelltwerden.

Ñv_show_cÄ(VH,ZAHL)

MachtdenMauscursorsichtbar.IstPAR2gleich0,dannwird
derCursorÅsofortÄsichtbar;ansonstenwirdderCursorerst
dannwiederangezeigt,wennv_show_c/2genausooftaufgerufen
wurdewiev_hide_c/1.

Ñv_hide_cÄ(VH)

MachtdenMauscursorunsichtbar.

Ñvs_clipÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL)

IstPAR2gleich0,dannwirddasClippingausgeschaltet,
sonsteingeschaltet.PAR3undPAR4gebendieKoordinatender
linkenoberen,PAR5undPAR6diederrechtenunterenEckedes
Clipping-Rechtecksan.

5.2.2Attributfunktionen

DieAttributfunktionendienendazu,dieMerkmaleder
grafischenGrundelemente(Markierungen,Linien,FlÑchenund
Text)zuverÑndern.Merkmalesindz.B.Grîûe,Farbeund
Aussehen.

5.2.2.1Markierungen

Ñvsm_typeÄ(VH,ZAHL)

StelltdenMarkierungstypein.ErlaubteWertefÅrPAR2sind
Zahlengrîûerals0.FolgendeMarkierungstypensind
vordefiniert:

àWertÄàMarkierungstypÄ
1Punkt
2Kreuz
3Stern
4Quadrat
5SchrÑgesKreuz(X)
6Raute

EshÑngtvonderjeweiligenArbeitsstationab,obmehrals
diese6TypenverfÅgbarsind.

Ñvsm_heightÄ(VH,ZAHL)

SetztdieGrîûederMarkierungenfest.Essindmeistensnicht
beliebigeWertefÅrPAR2erlaubt.

Ñvsm_colorÄ(VH,ZAHL)

SetztdieMarkierungsfarbefest.PAR2gibtdenFarbindexan.

5.2.2.2Linien

Ñvsl_typeÄ(VH,ZAHL)

StelltdenLinientypein.PAR2kannfolgendeWerteannehmen:

àWertÄàLinientypÄ
1durchgezogen
275%gestrichelt
337%gestrichelt
462%strichpunktiert
550%gestrichelt
637%doppeltstrichpunktiert
7vomBenutzer(Funktionvsl_udstyle/1)einstellbar

WievieledieserMusterverfÅgbarsind,hÑngtvonder
Arbeitsstationab.

Ñvsl_widthÄ(VH,ZAHL)

SetztdieBreitederLinienfest.PAR2sollteungeradesein.
NichtaufallenArbeitsstationenistesmîglich,gestrichelte
Linienzuverbreitern.

Ñvsl_colorÄ(VH,ZAHL)

SetztdieFarbederLinienfest.PAR2istderIndexder
ausgewÑhltenFarbe.

Ñvsl_endsÄ(VH,ZAHL,ZAHL)

MitdieserFunktionkînnendieLinienendenverÑndertwerden.
PAR2wirktaufdenAnfangeinerLinie,PAR3aufderenEnde.
ErlaubteWertefÅrPAR2undPAR3sind:

àWertÄàAussehenÄ
0KantigesLinienende
1Pfeilspitze(z.B.fÅrBemaûungspfeile)
2AbgerundetesEnde

Ñvsl_udstyleÄ(VH,ZAHL)

WennmitderFunktionvsl_type/2derWert7fÅrdenLinientyp
gewÑhltwurde,kannmitdieserFunktiondasLinienaussehen
beliebigverÑndertwerden.DieZahlwirdalsBitmuster(16
Bit)interpretiert.

5.2.2.3AusgefÅllteFlÑchen

Ñvsf_interiorÄ(VH,ZAHL)

StelltdenTypdesFÅllmustersein,dasbenutztwird,um
FlÑchenauszufÅllen.ErlaubteWertefÅrPAR2sind:

àWertÄàFÅllmustertypÄ
0FlÑchewirdmitweiûerFarbegefÅllt
1FlÑchewirdmitFÅllfarbegefÅllt
2FlÑchewirdmitvordefiniertemMustergefÅllt
3FlÑchewirdschraffiert
4FlÑchewirdmitfreidefinierbaremMustergefÅllt

Ñvsf_styleÄ(VH,ZAHL)

Wirdmitvsf_interior/2derFÅlltyp2oder3gewÑhlt,dann
kannmitdieserFunktioneinesvon24vordefiniertenMustern
bzw.einevon12SchraffurartenausgewÑhltwerden.Erlaubte
WertefÅrPAR2beginnenbei1.

Ñvsf_colorÄ(VH,ZAHL)

StelltdieFarbeein,inderFlÑchenausgefÅlltwerden.

Ñvsf_perimeterÄ(VH,ZAHL)

NormalerweisewerdenausgefÅllteFlÑchenmiteinerRandlinie
umgeben.DaskannmitdieserFunktionverhindertwerden.Ist
PAR2gleich0,sounterbleibtdasUmrandenvonausgefÅllten
FlÑchen.

Ñvsf_udpatÄ(VH,LISTE)

DieseFunktionerlaubtes,beliebigeFÅllmusterzu
definieren.DasbenutzerdefinierteMusterkanndannmit

vsf_style(VDIHandle,4)

benutztwerden.DieAnzahlderElementeinPAR2muûein
(ganzzahliges)Vielfachesvon16sein.JedeGruppevon16
ZahleninPAR2definierteineFarbebene;essindalsoauch
mehrfarbigeFÅllmustermîglich.DieZahlenwerdenals
Bitmusterinterpretiert;je16ZahlenbestimmeneinQuadrat
von16x16Bildpunkten.

5.2.2.4Text

Ñvst_heightÄ(VH,ZAHL)

StelltdieHîhederausgegebenenZeichenein.PAR2bezeichnet
denAbstandvonderZeichengrundliniezurObergrenzeder
ZeichenboxinÅBildpunktenÄ.

Ñvst_rotationÄ(VH,ZAHL)

StelltdenWinkelein,unterdemausgegebenerText
dargestelltwird(RichtungderZeichengrundlinie).PAR2gibt
denWinkelinZehntelgradan;erlaubteWertestammenausdem
Bereich0-3600.NichtalleArbeitsstationenerlaubendie
DrehungumbeliebigeWinkel;derBildschirmz.B.erlaubtnur
dieWerte0,900,1800und2700(alsoDrehungenumVielfache
von90¯).

Ñvst_fontÄ(VH,ZAHL)

SetztdenZeichensatzfÅrdieTextausgabefest.PAR2gibtdie
KennummerdesZeichensatzesan.DerSystemzeichensatzhatdie
Nummer1.AndereZeichensÑtzemÅssenmitdemGDOSgeladen
werden;ihreNummernkînnenggf.mitderFunktionvqt_name/4
erfragtwerden.

Ñvst_colorÄ(VH,ZAHL)

StelltdieTextfarbeein.

Ñvst_alignmentÄ(VH,ZAHL,ZAHL)

MitdieserFunktionkanndieAusrichtungdesTextsbeeinfluût
werden.PAR2gibtdiehorizontaleAusrichtungan;erlaubte
Wertesind:

àWertÄàHorizontaleAusrichtungÄ
0LinksbÅndig
1Zentriert
2RechtsbÅndig

(weiteraufnÑchsterSeite)

PAR3gibtdievertikaleAusrichtungan.ErlaubteWertesind:

àWertÄàVertikaleAusrichtungÄ
0Zeichengrundlinie
1ObergrenzeKleinbuchstaben
2ObergrenzeBuchstaben
3UntergrenzeZeichenbox
4UntergrenzeUnterlÑngen
5ObergrenzeZeichenbox

Ñvst_effectsÄ(VH,ZAHL)

StelltspezielleAttributefÅrdasAussehenderausgegebenen
Zeichenein.DieBitsvonPAR2werdenals'Schalter'
interpretiert:wenneinBitgesetztist,wirddas
entsprechendeAttributbenutzt(Mischungistmîglich).

àBitÄàWertÄàAttributÄ
01FetteSchrift
12AufgehellteSchrift
24Kursivschrift
38Unterstreichung
416UmrandungderBuchstaben
532Schattenschrift

NichtalleArbeitsstationenbeherrschenalledieseAttribute;
derBildschirmkannz.B.keineSchattenschriftausgeben.

Ñvst_pointÄ(VH,ZAHL)

StelltdieHîhederZeichenboxinÅpointÄein(angegebendurch
PAR2).DieHîheentsprichtdabeinichtdemdeutschen'Punkt';
einem'point'entsprechen1/72inch.

5.2.3Anfragefunktionen

MitdenAnfragefunktionenkînnenWertevonAttributenetc.
ermitteltwerden.AuûerdemkînnenInformationenÅberdie
benutzteArbeitsstation,dieMausetc.abgefragtwerden.

5.2.3.1Anfragefunktionenallgemein

Ñvq_colorÄ(VH,ZAHL,ZAHL,TERM,TERM,TERM)

PAR2gibtdenIndexeinerFarbean.PAR3gibtan,obdieser
Index(PAR3=0)oderder"aktuelle"Farbindex(PAR3=1)
benutztwerdensoll.IstPAR3=1,sowirdPAR2ignoriert.
DieFunktionermitteltdieZusammensetzungderausgewÑhlten
Farbeundversucht,PAR4bisPAR6mitdemRot-,GrÅn-bzw.
Blauanteilzuunifizieren(Wertevon0bis1000).

Ñvq_extndÄ(VH,ZAHL,ZAHL,ZAHL,TERM)

DieseFunktiondientdazu,InformationenÅbereine
Arbeitsstationzuermitteln.PAR2gibtan,ob'normale'(0)
oder'erweiterte'(1)Informationenabgefragtwerdensollen.
InbeidenFÑllenstehenje57ZahlenzurVerfÅgung.PAR3und
PAR4gebenan,welchedieserZahlenabgefragtwerden:PAR3
bezeichnetdenIndex(0bis56)dererstenundPAR4dender
letztenZahl(PAR4ÚPAR3).DieausgewÑhltenZahlenwerdenzu
einerListezusammengefaût,dieanschlieûendmitPAR5
unifiziertwird.

DieBedeutungdereinzelnenZahlenentnehmemander
DokumentationzumGEM;fÅrPAR2=0findetsiesichunterden
ErlÑuterungenzu'v_opnwk',fÅrPAR2=1unter'vq_extnd'.
EineeingehendeBeschreibungwÅrdedenRahmendieser
Dokumentationsprengen.

ÅBeispielÄ:Essollfestgestelltwerden,welchegrafischen
GrundfunktioneneineArbeitsstationnamens'plot'
beherrscht.DieseInformationstehtinder16.bis
25.Zahl(fÅrPAR2=0).Manbenutzt

vq_extnd(plot,0,15,24,LISTE)

underhÑltz.B.

LISTE=[1,2,3,4,5,6,7,8,9,-1],

wasbedeutet,daûkeinjustierterTextbenutzt
werdenkann,aberalleanderenGrundfunktionenzur
VerfÅgungstehen.

Ñvq_mouseÄ(VH,TERM,TERM,TERM)

FragtdieMausabundversucht,PAR2mitdemZustandder
Mausknîpfe(Bit0=linker,Bit1=rechterKnopf),PAR3und
PAR4mitdenKoordinatenderMauszuunifizieren.

Ñvq_key_sÄ(VH,TERM)

Versucht,PAR2mitdemTastaturstatuszuunifizieren.Die
einzelnenBitshabenfolgendeBedeutungen:

àBitÄàWertÄàBedeutungÄ
01SHIFTrechts
12SHIFTlinks
24CONTROL
38ALTERNATE

DabeibedeuteteingesetztesBit,daûdieentsprechendeTaste
gedrÅcktwird.

Ñv_get_pixelÄ(VH,ZAHL,ZAHL,TERM,TERM)

PAR2undPAR3gebendieKoordinateneinesBildpunktesan.Es
wirdversucht,PAR4mitdemWertdesPunktes(0-gelîscht,
1 - gesetzt)undPAR5mitseinemFarbindexzuunifizieren.

5.2.3.2Markierungen

Ñvqm_attributesÄ(VH,TERM)

FragtdiemomentaneingestelltenMarkierungsattributeabund
versucht,PAR2miteinerListezuunifizieren,dieaus
folgendenWertenbesteht:

-Markierungstyp(siehevsm_type/2)
-Markierungsfarbe(siehevsm_color/2)
-Zeichenmodus(siehevswr_mode/2)
-Markierungsbreite
-Markierungshîhe(siehevsm_height/2)

5.2.3.3Linien

Ñvql_attributesÄ(VH,TERM)

FragtdiemomentaneingestelltenLinienattributeabund
versucht,PAR2miteinerListezuunifizieren,dieaus
folgendenWertenbesteht:

-Linientyp(siehevsl_type/2)
-Linienfarbe(siehevsl_color/2)
-Zeichenmodus(siehevswr_mode/2)
-AussehendesLinienanfangs(siehevsl_ends/3)
-AussehendesLinienendes(dito)
-Linienbreite(siehevsl_width/2)

5.2.3.4FÅllflÑchen

Ñvqf_attributesÄ(VH,TERM)

FragtdiemomentaneingestelltenFÅllattributeabund
versucht,PAR2miteinerListezuunifizieren,dieaus
folgendenWertenbesteht:

-FÅlltyp(siehevsf_interior/2)
-FÅllfarbe(siehevsf_color/2)
-FÅllmuster(siehevsf_style/2)
-Zeichenmodus(siehevswr_mode/2)
-Umrahmung(siehevsf_perimeter/2)

5.2.3.5Text

Ñvqt_attributesÄ(VH,TERM)

FragtdiemomentaneingestelltenTextattributeabund
versucht,PAR2miteinerListezuunifizieren,dieaus
folgenden10Wertenbesteht:

-Zeichensatz(siehevst_font/2)
-Textfarbe(siehevst_color/2)
-WinkelderGrundlinie(siehevst_rotation/2)
-Ausrichtunghorizontal,vertikal(siehevst_alignment/3)
-Zeichenmodus(siehevswr_mode/2)
-Zeichenbreite,Zeichenhîhe(vst_height/2,vst_point/2)
-Breite,HîhederZeichenbox(dito)

Ñvqt_extentÄ(VH,LITERAL,TERM)

BerechnetdieAusdehnungeinesStrings,deralsGrafiktext
ausgegebenwerdensoll;eswerdenalleTextattribute
berÅcksichtigt.DieFunktionerrechnetausPAR2(derString
wirdalsProlog-Literalangegeben)einRechteck,dasdenText
umfaût.DieKoordinatendervierEckenwerdenzueinerListe
von8Zahlenzusammengefaût,diedannmitPAR3unifiziert
wird.DieEckenwerdendabei-linksuntenbeginnend-gegen
denUhrzeigersinngezÑhlt.DiebeidenEckenlinksvomText
werdenaufdieX-undY-Achsengelegt.

Ñvqt_widthÄ(VH,ZEICHEN,TERM,TERM,TERM)

BerechnetdieBreitederdemZeichenPAR2zugeordneten
Zeichenbox,sowiedenAbstanddesZeichenszumlinkenbzw.
rechtenRandderZeichenbox.DiedreigefundenenZahlen
werden(indieserReihenfolge)mitPAR3bisPAR5unifiziert.

Ñvqt_nameÄ(VH,ZAHL,TERM,TERM)

DurchsuchtdieListederZeichensÑtzederangegebenen
Arbeitsstation.PAR2gibtdiePositiondesgesuchten
ZeichensatzesindieserListean.Wirddergesuchte
Zeichensatzgefunden,sowirdseineKennziffer(siehe
vst_font/2)mitPAR3undseinName(alsProlog-Literal)mit
PAR4unifiziert.WirdkeinZeichensatzgefunden,sowirdder
Systemzeichensatzbenutzt.

Ñvqt_fontinfoÄ(VH,TERM)

ErzeugteineListemit12Informationenzumaktiven
ZeichensatzderangegebenenArbeitsstation,undunifiziert
dieseListemitPAR2.DieZahlengebennacheinanderfolgende
Parameteran:

-ASCII-WertdeserstenZeichensimZeichensatz
-ASCII-WertdesletztenZeichensimZeichensatz
-BreitedesbreitestenZeichens
-AbstandZeichengrundlinie-UntergrenzeZeichenbox
-Wert,derzumFettdruckvonZeichenverwendetwird
-AbstandZeichengrundlinie-UntergrenzeUnterlÑngen
-LinkerOffsetbeiAusgabevonSchrÑgschrift
-AbstandZeichengrundlinie-ObergrenzeKleinbuchstaben
-RechterOffsetbeiAusgabevonSchrÑgschrift
-AbstandZeichengrundlinie-ObergrenzeBuchstaben
-0
-AbstandZeichengrundlinie-ObergrenzeZeichenbox

5.2.4Ausgabefunktionen

DieseFunktionendienenzurAusgabegrafischerObjekte.Es
steheneineReiheprimitiverOperationen(Markierungen,
Linien,Polygoneetc.)undeinigegrafischeGrundfunktionen
(Kreis,Rechteck,Ellipse...)zurVerfÅgung.Dasgenaue
AussehenderAusgabekannmitdenAttributfunktionen
beeinfluûtwerden.

5.2.4.1Markierungen

Ñv_pmarkerÄ(VH,LISTE)

PAR2muûauseinergeradenAnzahlvonZahlenbestehen.Jedes
ZahlenpaarbildeteinenKoordinatenpunkt.Anjedemsolchen
PunktwirdeineMarkierungausgegeben.

5.2.4.2Linien

Ñv_plineÄ(VH,LISTE)

PAR2muûauseinergeradenAnzahlvonZahlenbestehen
(mindestens4).JedesZahlenpaardefinierteinen
Koordinatenpunkt;eswirdeinÅLinienzugÄausgegeben,deralle
PunktederReihenachverbindet.

5.2.4.3FÅllflÑchen

Ñv_fillareaÄ(VH,LISTE)

PAR2muûauseinergeradenAnzahlvonZahlenbestehen.Jedes
ZahlenpaardefinierteinenEckpunkteinesPolygons.Das
Polygonwird(ausgefÅllt)ausgegeben.

Ñv_contrfÄ(VH,ZAHL,ZAHL,ZAHL)

PAR2undPAR3legeneinenKoordinatenpunktfest.DieFlÑche,
inderderPunktliegt(begrenztdurchdenBildschirmrand
odereineFlÑchemitFarbePAR4),wirdausgefÅllt.

5.2.4.4Text

Ñv_gtextÄ(VH,ZAHL,ZAHL,LITERAL)

GibtPAR4(alsStringbetrachtet)alsGrafiktextander
Positionaus,diedurchPAR2undPAR3definiertwird.

Ñv_justifiedÄ(VH,ZAHL,ZAHL,LITERAL,ZAHL,ZAHL,ZAHL)

GibtPAR4(alsStringbetrachtet)alsGrafiktextander
Positionaus,diedurchPAR2undPAR3definiertwird.Der
TextwirdaufeineLÑngevonPAR5gedehnt(durchEinfÅgenvon
Leerraum).DabeiwerdenWortzwischenrÑumegedehnt,wennPAR6
ungleich0ist,ZeichenzwischenrÑume,wennPAR7ungleich0
ist.

5.2.4.5VerschiedeneGrafikobjekte

Ñvr_recflÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

PAR2undPAR3gebendieKoordinatenderlinkenoberenEcke
einesRechtecksan,PAR4undPAR5diederrechtenunteren
Ecke.DassobestimmteRechteckwirdalsausgefÅllteFlÑche
ausgegeben.

Ñv_barÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

BedeutungderParameterwiebeivr_recfl/5.DasRechteckwird
alsumrandeteausgefÅllteFlÑcheausgegeben.

Ñv_rboxÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

BedeutungderParameterwiebeivr_recfl/5.Eswirdein
RechteckmitabgerundetenEckenausgegeben(nurdie
Umrandung,nichtausgefÅllt).

Ñv_rfboxÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

Wiev_rbox/5,aberdasRechteckwirdausgefÅllt.

Ñv_arcÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL)

EswirdeinnichtausgefÅllterKreisbogenausgegeben.PAR2
undPAR3sinddieKoordinatendesMittelpunktes,PAR4istder
Radius,PAR5derStartwinkel(inZehntelgrad,0-3600)und
PAR6derEndwinkel.

Ñv_piesliceÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL)

EswirdeinausgefÅllterKreisbogenausgegeben.Parameterwie
beiv_arc/6.

Ñv_circleÄ(VH,ZAHL,ZAHL,ZAHL)

EswirdeinausgefÅllterKreisausgegeben.PAR2undPAR3
bestimmendenMittelpunkt,PAR4denRadius.

Ñv_ellarcÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL)

EswirdeinnichtausgefÅllterEllipsenbogenausgegeben.PAR2
undPAR3sinddieKoordinatendesMittelpunktes,PAR4und
PAR5sinddieRadieninX-bzw.Y-Richtung,PAR5der
Startwinkel(inZehntelgrad,0-3600)undPAR6der
Endwinkel.EssindnurachsenparalleleEllipsenmîglich.

Ñv_ellpieÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL,ZAHL)

EswirdeinausgefÅllterEllipsenbogenausgegeben.Parameter
wiebeiv_ellarc/7.

Ñv_ellipseÄ(VH,ZAHL,ZAHL,ZAHL,ZAHL)

EswirdeineausgefÅllteEllipseausgegeben.PAR2undPAR3
bestimmendenMittelpunkt,PAR4undPAR5dieRadieninX-
bzw.Y-Richtung.

5.2.5Rasterfunktionen

Ñvro_cpyfmÄ(VH,ZAHL,LISTE,LITERAL,LITERAL)

PAR3muûausgenau8Zahlenbestehen.Je4Zahlenlegenein
Rechteckfest(siehevr_recfl/5).Dieersten4Zahlen
beziehensichdabeiaufdasQuell-,dieletztenaufdas
Zielraster.PAR4undPAR5mÅssenhandlesvonRasterobjekten
sein;PAR4gibtdasQuell-undPAR5dasZielrasteran.Die
RasterobjektemÅssendasselbeFormatbesitzen(kînnenaber
unterschiedlichgroûsein).PAR2gibtdenModusan,indem
diebeidenRastermiteinanderverknÅpftwerden;dieerlaubten
Wertesind:

àWertÄàAbkÅrzungÄàBedeutungÄ
0ALL_WHITEAllePunktewerdengelîscht
1S_AND_DUND-VerknÅpfungQuelle/Ziel
2S_AND_NOTDUND-VerknÅpfungQuelle/(NOTZiel)
3S_ONLY1:1öbertragung
4NOTS_AND_DUND-VerknÅpfung(NOTQuelle)/Ziel
5D_ONLYKeineVerÑnderung
6S_XOR_DXOR-VerknÅpfungQuelle/Ziel
7S_OR_DODER-VerknÅpfungQuelle/Ziel
8NOT_SORDnegierteODER-VerknÅpfung
9NOT_SXORDnegierteXOR-VerknÅpfung
10NOT_DZielwirdinvertiert
11S_OR_NOTDODER-VerknÅpfungQuelle/(NOTZiel)
12NOT_SQuelleinvertiert->Ziel
13NOTS_OR_DODER-VerknÅpfung(NOTQuelle)/Ziel
14NOT_SANDDnegierteUND-VerknÅpfung
15ALL_BLACKAllePunktewerdengesetzt

DieseZuordnungistkeinesfallswillkÅrlich.DasBitmuster
desZahlenwertes(4Bits)ergibtdieErgebnisspalteeiner
binÑrenWahrheitstabelle,inderenersterSpaltemandas
Quell-undinderenzweiterSpaltemanZielbiteintrÑgt.
Beispiel:

àQuelleÄàZielÄàErgebnisÄ
001
010
101
111

WennmaninderSpalteErgebnisdemoberstenBitdie
Wertigkeit8,demunterstendieWertigkeit1gibt,erhÑltman

1011†2Ä=11†10Ä

wasinderobigenTabelledemWertS_OR_NOTDentspricht.Das
istabergeradedieFunktion,diedurchdieWahrheitstabelle
definiertwird:

ERGEBNIS=QUELLEoder(nichtZIEL)

AufdieseWeiseergebensichgeradedieobenangegebenen16
Funktionen.


Ñvrt_cpyfmÄ(VH,ZAHL,LISTE,LITERAL,LITERAL,ZAHL,ZAHL)

PAR3,PAR4undPAR5habendieselbeBedeutungwiebei
vro_cpyfm/5.AllerdingsmuûhierdasQuellrastereinfarbig
sein(nurgenaueineRasterebeneerlaubt).PAR2gibtden
Modusan,indemdiebeidenRastermiteinanderverknÅpft
werden;dieerlaubtenWertesindbeivswr_mode/2angegeben
(nurWertevon1bis4!!!).DasQuellrasterwirdmitdem
ZielrasterverknÅpft,wobeigelîschtePunktedesQuellrasters
alsPunktemitderFarbePAR6,gesetztePunktealssolchemit
derFarbePAR7interpretiertwerden.

Ñvr_trnfmÄ(VH,LITERAL,LITERAL)

PAR2undPAR3mÅssenhandlesvonRasterobjektensein(beide
dÅrfendasselbeObjektbezeichnen).DasRasterobjektvonPAR2
wirdinsObjektvonPAR3kopiert(beidesolltengleichgroû
sein),wobeidasÅFormatÄderDatenumgewandeltwird:Wenn
PAR2vorhereingerÑtespezifischesObjektbezeichnet,dann
wirdesineinStandardobjektumgewandelt(undumgekehrt).

5.2.6Erweiterungsfunktionen(Escapes)

Erweiterungsfunktionendienendazu,fÅrbestimmte
ArbeitsstationenspezielleFunktionenbereitzustellen.Bis
jetztsindnurzweiErweiterungsfunktionenimplementiert.

Ñv_exit_curÄ(VH)

SchaltetdenTextmodusderBildschirmarbeitsstationausund
denGrafikmodusein.

Ñv_enter_curÄ(VH)

SchaltetdenGrafikmodusausunddenTextmodusein.

5.3ÅAES-FunktionenÄ

5.3.1Funktionender'ApplicationLibrary'

DieseFunktionendienenzurKommunikationzwischen
verschiedenenProgrammen(z.B.Accessories).

Ñappl_findÄ(LITERAL,LITERAL)

SieheAbschnitt5.1.1.

Ñappl_readÄ(LITERAL,ZAHL,TERM)

PAR1muûhandleeinesProgrammssein.Eswirdaufeine
NachrichtvondiesemProgrammgewartet(fallskeinekommt,
fÅhrtdieseFunktionineineEndlosschleife!).Sobaldeine
Nachrichtvorliegt,werden2*PAR2Bytesausdem
NachrichtenpuffergelesenundzueinerListevonPAR2Zahlen
zusammengefaût(je2ByteproZahl).Eswirdversucht,PAR3
mitderListezuunifizieren.PAR2ÅmuûÄgrîûerodergleich8
sein.

Ñappl_writeÄ(LITERAL,LISTE)

PAR1muûhandleeinesProgrammssein,PAR2darfnuraus
Zahlenbestehen(mindestens8).EswirdeineNachrichtandas
durchPAR1bezeichneteProgrammgesendet,dieaus2*(LÑnge
vonPAR2)Bytesbesteht(proZahlzweiByte).

5.3.2Funktionender'EventLibrary'

AlleFunktionenindiesemAbschnitt-mitAusnahmevon
evnt_dclick/2-wartenaufbestimmteEreignisseoder
Kombinationendavon.DadiemeistendieserFunktionenviele
ParameterbenîtigenundmehrereErgebnisseliefern,wurden
zusammengehîrigeParameterbzw.ErgebnissezuListen
zusammengefaût.

Ñevnt_keybdÄ(TERM)

WartetaufeinTastaturereignis(Tastendruck).PAR1wirdmit
demÅCodeÄdergedrÅcktenTasteunifiziert(imhîherwertigen
Bytebefindetsichder'Scancode').

Ñevnt_buttonÄ(LISTE,TERM)

PAR1muûausgenau3Zahlenbestehen,undzwarderReihenach
aus:

-derAnzahl'Klicks',aufdiegewartetwerdensoll
-einerMaskefÅrdieMausknîpfe(Bit0=linker,Bit1=
rechterKnopf)
-demDatenwort,dasdengewÅnschtenZustandderKnîpfe
angibt(ZuordnungwiebeizweiterZahl)

(weiteraufnÑchsterSeite)

DieFunktionwartetdarauf,daûdasgewÅnschteEreignis
eintritt,undversucht,PAR2miteinerListeaus5Zahlenzu
unifizieren,diefolgendeErgebnisseenthÑlt:

-dieAnzahl'Klicks',dieerkanntwurden
-dieX-KoordinatedesMauscursors
-dieY-KoordinatedesMauscursors
-denZustandderMausknîpfe(Zuordnungwieoben)
-denZustandderShift-,Ctrl-,...-Tasten(siehe
graf_mkstate/4)

Ñevnt_mouseÄ(LISTE,TERM)

PAR1muûausgenau5Zahlenbestehen,undzwarderReihenach
aus:

-einerZahl,dieangibt,obaufdasBetreten(=0)oderdas
Verlassen(=1)einesRechtecksgewartetwerdensoll
-derX-KoordinatederlinkenoberenEckedesRechtecks
-derY-KoordinatederlinkenoberenEckedesRechtecks
-derBreitedesRechtecks
-derHîhedesRechtecks

DieFunktionwartetdarauf,daûderMauscursordasangegebene
Rechteckbetrittbzw.verlÑût,undversucht,PAR2miteiner
Listeaus4Zahlenzuunifizieren,diefolgendeErgebnisse
enthÑlt:

-dieX-KoordinatedesMauscursors
-dieY-KoordinatedesMauscursors
-denZustandderMausknîpfe(Zuordnungwieoben)
-denZustandderShift-,Ctrl-,...-Tasten(siehe
graf_mkstate/4)

Ñevnt_mesagÄ(TERM)

WartetaufeineNachrichtvonAES(z.B.MenÅauswahl)und
versucht,PAR1miteinerListevon8Zahlenzuunifizieren,
dieden16BytesderNachrichtentsprechen.

Ñevnt_timerÄ(ZAHL,ZAHL)

WarteteinebestimmteZeitab.PAR1gibtdenniederwertigen,
PAR2denhîherwertigenAnteildesabzuwartendenZeitraumsan
(inMillisekunden).

Ñevnt_multiÄ(ZAHL,LISTE,LISTE,LISTE,TERM,ZAHL,ZAHL,TERM)

DieseFunktionwartetaufeineKombinationderobigen
Ereignisse.EskannmaximalaufjeeinTastatur-,Mausknopf-,
Nachrichten-undZeitgeberereignisundaufzwei
Mausereignissegleichzeitiggewartetwerden.Dabeiwerdendie
auftretendenEreignissedurchODERverknÅpft;daserste
erkannteEreignisbeendetdieFunktion.
AuûerdenErgebnissendesaufgetretenenEreignissesliefert
dieFunktioneineZahlzurÅck,diedaseingetreteneEreignis
identifiziert.

(weiteraufnÑchsterSeite)

PAR1gibtan,aufwelcheEreignissegewartetwerdensoll.Die
einzelnenBitswerdenwiefolgtinterpretiert:

àBitÄàWertÄàNameÄàBedeutungÄ
01MU_KEYBDTastaturereignis
12MU_BUTTONMausknopfereignis
24MU_M1ErstesMausereignis
38MU_M2ZweitesMausereignis
416MU_MESAGNachrichtenereignis
532MU_TIMERZeitgeberereignis

DiefolgendenParameterwerdenignoriert,wenndas
entsprechendeBitinPAR1gelîschtist;ansonstenmÅssendie
Parameterwiefolgtangegebenwerden:

àBitÄàParameterÄàErlaubteWerteÄ
1PAR2Sieheevnt_button/2,PAR1
2PAR3Sieheevnt_mouse/2,PAR1
3PAR4dito
5PAR6,7Sieheevnt_timer/2

IstBit4vonPAR1gesetzt,sowirddieempfangeneNachricht
mitPAR5unifiziert(sieheevnt_mesag/1).

PAR8wirdmiteinerListevonErgebnissenunifiziert,dieder
ReihenachausfolgendenWertenbesteht:

-einerZahlzurIdentifikationdesaufgetretenenEreignisses
(ZuordnungderBitswiebeiPAR1)
-derX-KoordinatedesMauscursors
-derY-KoordinatedesMauscursors
-demZustandderMausknîpfe
-demTastaturzustand(Shiftetc.)
-demWert,dervonevnt_keybdgeliefertwird
-derAnzahlderaufgetretenenMausklicks

FallseinedieserZahleneinemnichtÅberwachtenEreignis
zugeordnetist,istdergelieferteWertÅundefiniertÄ.

Ñevnt_dclickÄ(VARINT)

FallsPAR1eineZahlist,sowirddieGeschwindigkeit,mit
deraufMausklicksreagiertwird,verÑndert;istPAR1eine
Variable,sowirdsiemitdermomentanenGeschwindigkeit
unifiziert.ErlaubteWertesind0(langsam)bis4(schnell).

5.3.3Funktionender'FormLibrary'

DieFunktionenindiesemAbschnittverwaltendenDialogmit
demBenutzerÅberDialog-undAlarmboxen.

Ñform_doÄ(LITERAL,ZAHL,TERM)

PAR1muûhandleeinesObjektbaumssein.PAR2gibtan,welches
vondenTextfelderninderDialogbox(fallswelche
existieren)alsersteseditiertwird.DieFunktionverwaltet
dengesamtenDialogmitdemBenutzer.WenndieDialogbox
verlassenwird,wirdPAR3mitdemIndexdesjenigenObjekts
unifiziert,daszumVerlassenbenutztwurde(beieinem
DoppelklickaufdiesesObjektwirdBit7vonPAR3gesetzt).
Ñform_dialÄ(ZAHL,LISTE,LISTE)

DieseFunktionbereitetdieBenutzungeinerDialogboxvorund
rÑumtnachbeendetemDialogdenBildschirmauf.PAR2undPAR3
mÅssenausje4Zahlenbestehen,diezweiRechteckeaufdem
Bildschirmdefinieren(X-,Y-Koordinate,BreiteundHîhe).
PAR1kannfolgendeWerteannehmen:

àWertÄàBedeutungÄàBenutzungÄ
0FMD_STARTÅMuûÄvordemAufrufvonform_do/3benutzt
werden;reserviertPlatzaufdem
Bildschirm.
1FMD_GROWÅKannÄvordemAufrufvonform_do/3benutzt
werden;zeichneteingrîûerwerdendes
Rechteck.
2FMD_SHRINKÅKannÄnachdemAufrufvonform_do/3
benutztwerden;zeichneteinkleiner
werdendesRechteck.
3FMD_FINISHÅMuûÄnachdemAufrufvonform_do/3benutzt
werden;rÑumtdenBildschirmaufund
veranlaûtdasNeuzeichnendereventuell
offenenFenster.

FÅrdieWerte1und2gibtPAR2daskleinere,PAR3das
grîûereRechteckan;fÅr0und3bezeichnetPAR3den
reserviertenBildschirmbereich.

Ñform_alertÄ(ZAHL,LITERAL,TERM)

ZeichneteineAlarmboxundwartetaufeineEingabedes
Benutzers.PAR2definiertdasAussehenderAlarmboxundÅmuûÄ
folgendermaûenaufgebautsein:

PAR2='[x][t][b]'

Dabeiist'x'eineZiffer,diedasPiktogrammderAlarmbox
auswÑhlt:

àZifferÄàPiktogrammÄ
'0'Keines
'1'NOTE-Piktogramm(Ausrufungszeichen)
'2'WAIT-Piktogramm(Fragezeichen)
'3'STOP-Piktogramm(Stopschild)

't'istderTextinderAlarmbox.DerTextkannausmehreren
Zeilenbestehen,diedanndurchdasZeichen'|'getrennt
werden.EsdÅrfenmaximal5Zeilenmitmaximalje40Zeichen
angegebenwerden.
'b'definiertdieAuswahlknîpfezumVerlassenderAlarmbox.
DerTextderKnîpfewirdwiebei't'angegeben;essind
maximal3Knîpfemitmaximalje20Zeichenerlaubt.

WenndieseRegelnnichteingehaltenwerden,kannessein,daû
dieGEM-eigenenDatenstrukturenÅirreparabelÄzerstîrtwerden.

PAR1gibtan,welcherderAuswahlknîpfedurch'Return'
betÑtigtwerdenkann.ErlaubteWertesind0(keinKnopf)bis
3.PAR3wirdmitderNummerdesbenutztenKnopfes(1bis3)
unifiziert.

Ñform_errorÄ(ZAHL)

ErzeugteinespezielleAlarmbox,dieFehlermeldungendes
Betriebssystemsanzeigt.BeidenmeistenWertenvonPAR1wird
eineMeldungderForm'TOSFehler#XXXX'erzeugt;einige
spezielleWertevonPAR1fÅhrenjedochzuspezifischen
Fehlermeldungen(z.B.SpeicherÅberlaufetc.).

Ñform_centerÄ(LITERAL,TERM)

PAR1muûhandleeinesObjektbaumssein.DerObjektbaumwird
aufdemBildschirmzentriertundeswirdeineListevon4
Zahlenerzeugt,diedasumfassendeRechteckangibt(X-,Y-
Koordinate,BreiteundHîhe).DieListewirdmitPAR2
unifiziert.DieseFunktionwirdvorderBenutzungvon
form_dial/3aufgerufen,umeineDialogboxrichtigzu
plazieren.


form_keybd/7undform_button/5sindzweisehrkomplexeund
unhandlicheFunktionen,diedieVerwaltungsarbeitbeim
Verarbeiten'selbstgemachter'DialogboxenÅbernehmenkînnen.

Ñform_keybdÄ(LITERAL,ZAHL,ZAHL,ZAHL,TERM,TERM,TERM)

PAR1muûhandleeinesObjektbaumssein,PAR2undPAR3die
IndizeszweierTextobjekteimBaum;PAR4derCodeeines
eingegebenenZeichens(wieervonevnt_keybd/1geliefert
wird).form_keybd/7ÅberprÅft,obPAR4einespezielle
Funktionstasteistunderledigtggf.dieVerwaltungder
Textobjekte.NachBeendigungwirdversucht,PAR5,PAR6und
PAR7mitZahlenzuunifizieren.PAR5wirddabeimitdemIndex
desaktiven(Text-)Objektsunifiziert.PAR6wirdmit0
unifiziert,wennPAR4derCodeeinerSpezialtastewar,sonst
mitdemWertvonPAR4.PAR7wirdmit0unifiziert,wennPAR4
derCodevon'Return'oder'Enter'warundimObjektbaumein
DEFAULT-Objektgefundenwurde(dessenIndexbefindetsichin
diesemFallinPAR5).

Ñform_buttonÄ(LITERAL,ZAHL,ZAHL,TERM,TERM)

PAR1muûhandleeinesObjektbaumssein,PAR2derIndexeines
gerademitderMausangeklicktenObjekts.PAR3enthÑltdie
Anzahlder'Klicks'.DieFunktionerledigtdiezurVerwaltung
vonButtons,RadioButtonsundÑhnlichenNettigkeitenund
versucht,PAR4mitdemIndexeinesObjektsundPAR5mit0
oder1zuunifizieren.WiedieseWerteimDetailzuverwenden
sind,habeichnochnichtherausgefunden.

5.3.4DieeinzigeFunktionder'FileSelectorLibrary'

Ñfsel_inputÄ(LITERAL,LITERAL,TERM,TERM,TERM)

DieseFunktionerzeugtdiewohlbekannteDialogboxzur
Dateiauswahl.PAR1gibtdenerstenPfadnamen,PAR2denersten
Dateinamenan.NachdenAuswÑhleneinerDatei(undeventuell
einesneuenPfades)wirdversucht,PAR3mitdemneuenPfad-
undPAR4mitdemneuenDateinamenzuunifizieren.PAR5wird
miteinerZahlunifiziert,dieangibt,welcherderbeiden
Auswahlknîpfebenutztwurde(0:'Abbruch',1:'OK'bzw.
DoppelklickaufDateinamen).

5.3.5Funktionender'GraphicsLibrary'

DieFunktionendiesesAbschnittsdienendazu,grafische
EffektezuerzeugenundbestimmteFormenderEingabe(z.B.
VerschiebeneinesObjekts)zuermîglichen.

Ñgraf_rubboxÄ(LISTE,TERM,TERM)

PAR1muûausgenau4ZahlenbestehenundgibteinRechteck
an.DerReihenachbedeutendieZahlen:

-X-KoordinatedesRechtecks
-Y-KoordinatedesRechtecks
-BreitedesRechtecks
-HîhedesRechtecks

BeimAufrufderFunktionmuûdielinkeMaustastegedrÅckt
sein.DieFunktionzeichnetein'Gummiband-Rechteck',dessen
rechteuntereEckedenBewegungenderMausfolgt.Beim
LoslassenderMaustastewirddieFunktionbeendet;PAR2wird
mitderBreiteundPAR3mitderHîhedesausgewÑhlten
Rechtecksunifiziert.

Ñgraf_dragboxÄ(LISTE,LISTE,TERM,TERM)

PAR1undPAR2mÅssenzweiRechteckebestimmen,vondenendas
ersteÅinnerhalbÄdeszweitenliegt.BeimAufrufderFunktion
muûdielinkeMaustastegedrÅcktsein.DieFunktionzeichnet
einRechteck(wiedurchPAR1angegeben),dasmitderMaus
innerhalbdeszweitenRechtecksverschobenwerdenkann.Nach
demLoslassenderMaustastewirddieFunktionbeendet;PAR3
undPAR4werdenmitdenKoordinatenderletztenPositiondes
verschobenenRechtecksunifiziert.

Ñgraf_mboxÄ(LISTE)

PAR1muûausgenau6Zahlenbestehen,derReihenachaus:

-BreiteeinesRechtecks
-HîhedesRechtecks
-X-KoordinatedesAnfangspunktes
-Y-KoordinatedesAnfangspunktes
-X-KoordinatedesEndpunktes
-Y-KoordinatedesEndpunktes

EswirdeinRechteckgezeichnet,dassichvomAnfangs-zum
Endpunktbewegt.

Ñgraf_growboxÄ(LISTE,LISTE)

PAR1undPAR2bestimmenzweiRechtecke(PAR1daskleinereund
PAR2dasgrîûere).EswirdeinRechteckgezeichnet,dassich
vergrîûert.

Ñgraf_shrinkboxÄ(LISTE,LISTE)

DieZuordnungderParameteristwiebeigraf_growbox/2(Å!Ä).
EswirdeinsichverkleinerndesRechteckgezeichnet.

Ñgraf_watchboxÄ(LITERAL,ZAHL,ZAHL,ZAHL,TERM)

PAR1muûhandleeinesObjektbaumssein.BeiAufrufder
FunktionmuûdielinkeMaustastegedrÅcktsein.PAR2gibtden
IndexeinesObjektsindemdurchPAR1bestimmtenBauman;die
FunktionÅberwachtdieMausbewegung.WenndieMaussich
ÅinnerhalbÄdesObjektsbefindet,erhÑltdasObjektdenWert
vonPAR3alsStatus,ÅauûerhalbÄdesObjektsdenWertvonPAR4.
DieBitsinPAR3undPAR4habendabeifolgendeBedeutung:

àBitÄàWertÄàBedeutungÄ
01SELECTEDObjektwirdinversdargestellt
12CROSSEDDurchdasObjektwirdein(weiûes)Kreuz
gezeichnet
24CHECKEDImObjektwirdeinHÑkchengezeichnet
38DISABLEDDasObjektwirdaufgehellt
416OUTLINEDDasObjektwirdumrandet
532SHADOWEDDasObjekterhÑlteinenSchatten

DieFunktionwirdbeendet,wenndieMaustastelosgelassen
wird.PAR5wirdmiteinerZahlunifiziert,dieangibt,ob
sichderMauscursorbeimBeendenauûerhalb(0)oderinnerhalb
(1)desObjektsbefand.

Ñgraf_slideboxÄ(LITERAL,ZAHL,ZAHL,ZAHL,TERM)

DieseFunktiondientdazu,einen'Schieber'darzustellen(wie
z.B.dieScrollbalkenaneinemFenster).PAR1muûhandle
einesObjektbaumssein.PAR3gibtdenIndexdesObjektsan,
dasalsSchieberbenutztwerdensoll,PAR2denIndexdes
direktÅbergeordneten(Mutter-)Objekts.PAR4gibtan,obder
Schiebersichwaagerecht(0)odersenkrecht(1)bewegensoll.
BeimAufrufderFunktionmuûdielinkeMaustastegedrÅckt
sein;beimLoslassenderTastewirddieFunktionbeendet.
PAR5wirdmiteinerZahlunifiziert,diediePositiondes
Schiebersangibt.DerWertliegtzwischen0(ganzlinks/oben)
und1000(ganzrechts/unten).

Ñgraf_mouseÄ(ZAHL)

DieseFunktionverÑndertdasAussehendesMauscursors.
ErlaubteWertefÅrPAR1sind:

àWertÄàBedeutungÄ
0Pfeil
1Text-Cursor
2Biene
3ZeigendeHand
4FlacheHand
5DÅnnesKreuz
6DickesKreuz
7Umriûkreuz
255Letztemitvsc_form/2definierteCursorform
256Mausabschalten
257Mauseinschalten

Ñgraf_mkstateÄ(TERM,TERM,TERM,TERM)

DieMausunddieTastaturwerdenabgefragt.PAR1wirdmitder
X-undPAR2mitderY-Koordinateunifiziert,PAR3mitdem
ZustandderMaustasten.PAR4wirdmiteinerZahlunifiziert,
derenBitsfolgendeTastenzustÑndeangeben:

àBitÄàWertÄàTasteÄ
01Shiftrechts
12Shiftlinks
24Control
38Alternate

5.3.6Funktionender'MenuLibrary'

DieFunktionenindiesemAbschnittdienenzumDarstellenund
Verwaltenvon'DropDown'-MenÅs.

Ñmenu_barÄ(LITERAL,ZAHL)

PAR1muûhandledesObjektbaumseinerMenÅ-Datenstruktur
sein.WennPAR2ungleich0ist,wirddieserObjektbaum
benutzt,umdenMenÅbalkendarzustellen;danachistdie
BenutzungderMenÅsmîglich.IstPAR2gleich0,dannwirdder
MenÅbalkenabgeschaltetunddieMenÅskînnennichtmehr
benutztwerden.

Ñmenu_icheckÄ(LITERAL,ZAHL,ZAHL)

PAR1muûhandledesMenÅbalkenssein.IndemMenÅpunktmit
IndexPAR2wirdeinHÑkchenein-(PAR3ungleich0)oder
ausgeschaltet(PAR3gleich0).

Ñmenu_ienableÄ(LITERAL,ZAHL,ZAHL)

PAR1muûhandledesMenÅbalkenssein.DerMenÅpunktmitIndex
PAR2wirdein-(PAR3ungleich0)oderausgeschaltet(hell
dargestellt;PAR3gleich0).

Ñmenu_tnormalÄ(LITERAL,ZAHL,ZAHL)

PAR1muûhandledesMenÅbalkenssein,PAR2derIndexeines
MenÅtitels.DerMenÅtitelwirdnormalisiert(PAR3ungleich
0)oderinversdargestellt(PAR3gleich0).

Ñmenu_textÄ(LITERAL,ZAHL,LITERAL)

PAR1muûhandledesMenÅbalkenssein,PAR2Indexeines
MenÅpunktes.DerTextdiesesMenÅpunkteswirddurchdenNamen
vonPAR3ersetzt(solltenichtlÑngerseinalsdas
entsprechendeRechteckinderMenÅ-Datenstruktur,dasonst
Problemeauftreten).

5.3.7Funktionender'ObjectLibrary'

DieFunktionenindiesemAbschnittdienenzurBearbeitungund
AusgabevonObjektbÑumen.AlledieseFunktionenbenîtigenals
erstenParameterdashandleeinesObjektbaums;deswegenwurde
derersteParameterÅberallmit'TH'(TreeHandle)
bezeichnet.

Ñobjc_addÄ(TH,ZAHL,ZAHL)

PAR2muûIndexeinesObjektsausdemdurchPAR1bezeichneten
Baumsein.DasObjektmitIndexPAR3wirdalsKinddesdurch
PAR2angegebenenObjektsindenBaumeingefÅgt.

Ñobjc_deleteÄ(TH,ZAHL)

DasObjektmitIndexPAR2wirdausdemdurchPAR1angegebenen
Baumentfernt.

Ñobjc_drawÄ(TH,ZAHL,ZAHL,LISTE)

DieseFunktionzeichneteinenObjektbaum.PAR2gibtdas
Objektan,mitdembegonnenwerdensoll,PAR3diemaximale
Schachtelungstiefe(ObjekteabTiefePAR3+1werdennichtmehr
gezeichnet).PAR4muûausgenau4Zahlenbestehenundein
Rechteckbezeichnen(siehegraf_rubbox/3);diesesRechteck
wirdfÅrdasClipping(BegrenzendesAusgabebereichs)
benutzt.

Ñobjc_findÄ(TH,ZAHL,ZAHL,ZAHL,ZAHL,TERM)

DieseFunktionsuchteinObjekt(ineinemBaum),dasaneiner
bestimmtenBildschirmstelleliegt.PAR2gibtan,beiwelchem
ObjektdieSuchebeginnensoll,PAR3bestimmtdiemaximale
Suchtiefe.PAR4undPAR5gebendieKoordinatendes
Bildschirmpunktesan,unterdemdasObjektliegensoll.Wird
dasObjektgefunden,sowirdPAR6mitdessenIndex,sonstmit
derZahl-1unifiziert.

Ñobjc_offsetÄ(TH,ZAHL,TERM,TERM)

DieseFunktionbestimmtdieKoordinateneinesObjekts
(KoordinatenderlinkenoberenEcke).PAR2gibtdenIndexdes
Objektsan.PAR3undPAR4werdenmitderX-bzw.Y-Koordinate
unifiziert.

Ñobjc_orderÄ(TH,ZAHL,ZAHL)

DieseFunktionverÑndertdieReihenfolgederObjekteimBaum
PAR1.DasObjektmitIndexPAR2wirdunterallenKinderndes
ihmÅbergeordnetenObjektsaufdenPlatzgebracht,derdurch
PAR3angegebenwird.(DieseBeschreibungerfolgtohne
GewÑhr !).

Ñobjc_editÄ(TH,ZAHL,ZAHL,ZAHL,ZAHL,TERM)

MitdieserFunktionkannTextineinemTEDINFO-Objekt
verÑndertwerden.PAR2muûderIndexeinesTEDINFO-Objekts
sein.PAR5wÑhlteineUnterfunktionaus;erlaubteWerte
sind :

àWertÄàBedeutungÄ
0EDSTARTreserviert
1EDINITvorbereiten-ÅmuûÄvordemEditierenaufgerufen
werden
2EDCHARObjektverÑndern-sooftaufrufenwienîtig
3EDENDnachbereiten-ÅmuûÄnachdemEditieren
aufgerufenwerden

FÅrdieUnterfunktion2gibtPAR3daseingegebeneZeichenan
(alsZahlkodiert-wievonevnt_keybd/1geliefert!);PAR4
bestimmtdiePositiondesTextcursors.BeimVerlassender
FunktionwirdPAR6mitderneuenCursorpositionunifiziert.

Ñobjc_changeÄ(TH,ZAHL,ZAHL,LISTE,ZAHL,ZAHL)

DieseFunktionverÑndertdenStatuseinesObjektsund
zeichnetdasObjektneu(fallsgewÅnscht).PAR1bisPAR4
habendieselbeBedeutungwiebeiobjc_draw/4.PAR5istder
neueStatusdesObjekts(ZuordnungdereinzelnenBitssiehe
graf_watchbox/5).PAR6gibtan,obdasObjektneugezeichnet
werdensoll(PAR6ungleich0)odernicht(PAR6gleich0).

5.3.8Funktionender'ResourceLibrary'

Ñrsrc_loadÄ(NAME)

LÑdtdieResource-DateimitdemangegebenenDateinamenund
richtetalledarinenthaltenenDatenstrukturenein.

Ñrsrc_freeÄ

EntfernteinegeladeneResource-DateiausdemSpeicher.

Ñrsrc_obfixÄ(LITERAL,ZAHL)

PAR1muûhandleeinesObjektbaumssein,PAR2derIndexeines
Objekts.DieFunktionberechnetdieKoordinatendesObjekts.
NormalerweisewirddieseArbeitvonderFunktionrsrc_load/1
Åbernommen;dieFunktionistvorhanden,um(spÑter...)den
AufbaueigenerObjektbÑumezuunterstÅtzen.

Ñrsrc_handleÄ(ZAHL,ZAHL,LITERAL)

SieheAbschnitt5.1.1.

5.3.9Funktionender'ScrapLibrary'

DasAESbietetzweiFunktionenan,umdenDatenaustausch
zwischenverschiedenenProgrammenÅberein'Clipboard'zu
ermîglichen.DieFunktionendienendazu,einenPfadnamenin
einenPufferzuschreiben,derallenProgrammenzugÑnglich
ist,sowieihnwiederzulesen.

Ñscrp_readÄ(TERM)

LiesteinenPfadnamenausdemglobalenPufferundversucht,
ihnmitPAR1zuunifizieren.

Ñscrp_writeÄ(NAME)

SchreibtPAR1indenglobalenPuffer.

5.3.10Funktionender'ShellLibrary'

DieFunktionender'ShellLibrary'dienenderKommunikation
mitdemBetriebssystem.DadieseFunktionensehrmaschinennah
sind,wurdenureinevonihnenimplementiert.

Ñshel_findÄ(NAME)

PAR1isteinDateiname,derimaktuellenDateiverzeichnis
gesuchtwird.DieFunktionschlÑgtfehl,wenndieDateinicht
gefundenwurde.

Obwohlnurshel_find/1alsFunktionimplementiertwurde,ist
esdochmîglich,eineweitereFunktionder'ShellLibrary'zu
verwenden,nÑmlich'shel_write'.DieseFunktiondientzum
NachladenvonProgrammenohneRÅckkehrzum'Desktop'.
MankanndieseFunktionÅberdieOption'C'inderDatei
'CONFIG.TOY'erreichen;siehedazuKapitel3.2.

5.3.11Funktionender'WindowLibrary'

DieFunktionenindiesemAbschnittdienemdemAufbauundder
VerwaltungvonFenstern.FastalleFunktionenindiesem
AbschnittbenîtigendashandleeinesFenstersalsParameter;
derentsprechendeParameterwirdals'WH'(WindowHandle)
bezeichnet.

Ñwind_createÄ(ZAHL,LISTE,LITERAL)

SieheAbschnitt5.1.1.

Ñwind_openÄ(WH,LISTE)

PAR2muûeinRechteckdefinieren(siehegraf_rubbox/3).Das
durchPAR1bestimmteFensterwirdgeîffnet;seinePosition
undGrîûewirddurchPAR2bestimmt.

Ñwind_closeÄ(WH)

SchlieûtdasFenster,dasdurchPAR1bestimmtwird(ÅohneÄes
zulîschen!).

Ñwind_deleteÄ(WH)

SieheAbschnitt5.1.2.

Ñwind_getÄ(WH,ZAHL,TERM)

ErfragtbestimmteInformationen(abhÑngigvonPAR2)Åberdas
FensterPAR1undversucht,dasErgebnismitPAR3zu
unifizieren.DieFormdesErgebnisseshÑngtvonPAR2ab.
ErlaubteWertefÅrPAR2sind:

àWertÄàBedeutungÄàErgebnisÄ
4WF_WORKXYWHArbeitsflÑchedesFenstersalsRechteck
(Listemit4Zahlen)
5WF_CURRXYWHPositionundGrîûedesFensterals
Rechteck
6WF_PREVXYWHPositionundGrîûedesFenstersvorder
letztenVerÑnderung(alsRechteck)
7WF_FULLXYWHPositionundGrîûedesFenstersbei
maximalerAusdehnung(wiemit
wind_create/3festgelegt)
8WF_HSLIDEPositiondeshorizontalenSchiebers(Zahl
von0bis1000)
9WF_VSLIDEPositiondesvertikalenSchiebers
10WF_TOPPAR3wirdignoriert;eswirdgeprÅft,ob
PAR1dasoberste(aktive)Fensterist
11WF_FIRSTXYWHerstesRechteckinderListeder
sichtbarenFensterbereiche
12WF_NEXTXYWHnÑchstesRechteckinderListe(Ende
gekennzeichnetdurchBreite=Hîhe=0)
15WF_HSLSIZEGrîûedeshorizontalenSchiebers(Zahl
von0bis1000)
16WF_VSLIZEGrîûedesvertikalenSchiebers

Ñwind_setÄ(WH,ZAHL,TERM)

StelltbestimmteParameter(abhÑngigvonPAR2)desFensters
PAR1ein.DieFormvonPAR3hÑngtvonPAR2ab.ErlaubteWerte
fÅrPAR2sind:

àWertÄàBedeutungÄàFÅrPAR3erlaubtÄ
1WF_KINDArtdesFensters(Zahl,Bitzuordnung
siehewind_create/3)
2WF_NAMETiteldesFensters(Literal)
3WF_INFOTextderInfozeile(Literal)
5WF_CURRXYWHPositionundGrîûedesFensterals
Rechteck(Listemit4Zahlen)
8WF_HSLIDEPositiondeshorizontalenSchiebers(Zahl
von0bis1000)
9WF_VSLIDEPositiondesvertikalenSchiebers
10WF_TOPPAR3wirdignoriert;dasFensterPAR1
wirdzumaktivenFenster
14WF_NEWDESKObjektbaumfÅreinneuesDesktop;PAR3
muûhandledesObjektbaumssein
15WF_HSLSIZEGrîûedeshorizontalenSchiebers(Zahl
von0bis1000)
16WF_VSLIZEGrîûedesvertikalenSchiebers

Ñwind_findÄ(ZAHL,ZAHL,WH)

DieseFunktionsuchteinFenster,dasaneinerbestimmten
Bildschirmstelleliegt.PAR1undPAR2gebendieKoordinaten
desBildschirmpunktesan,unterdemdasFensterliegensoll.
WirddasFenster,dasdurchPAR3bestimmtwird,andieser
Stellegefunden,sowirddasPrÑdikaterfÅllt,sonstschlÑgt
esfehl.

Ñwind_updateÄ(ZAHL)

MitdieserFunktionwirddemAESmitgeteilt,daûder
BildschirminhaltverÑndertwird.AbhÑngigvonPAR1werden
danachdieAktivitÑtendesAES(z.B.MenÅauswahl,Interaktion
mitFenstern)eingeschrÑnkt.ErlaubteWertefÅrPAR1sind:

àWertÄàBedeutungÄ
0END_UPDATEEndederEinschrÑnkungen
1BEG_UPDATEBeginnderEinschrÑnkungen
2END_MCTRLAESÅbernimmtwiederKontrollederMaus
3BEG_MCTRLBenutzerprogrammÅbernimmtKontrolleder
Maus(AESerzeugtkeineMausereignisse
mehr)

Ñwind_calcÄ(ZAHL,ZAHL,LISTE,TERM)

AusgehendvomTypeinesFensters(PAR2,ZuordnungderBits
siehewind_create/3)undvonseinerPositionundGrîûe(PAR3,
gegebenalsRechteck)wirddiePositionundGrîûedes
Arbeitsbereichesberechnet,wennPAR1ungleich0ist.Ist
PAR1gleich0,danngibtPAR3PositionundGrîûedes
Arbeitsbereichsan;eswerdendanndiegesamteFenstergrîûe
und-positionberechnet.DasErgebnis(eineListemit4
Zahlen)wirdmitPAR4unifiziert.

5.4Hilfsfunktionen

Ñtxt_modeÄ

SchaltetdenMauscursoraus,lîschtdenBildschirmund
schaltetdenTextmodusein.

Ñgrf_modeÄ

LîschtdenBildschirm,aktiviertdenGrafikmodusundschaltet
denMauscursorein.

ÑintersectionÄ(LISTE,LISTE,TERM)

DieseFunktiondientzumBerechnenderSchnittflÑchezweier
Rechtecke(z.B.beimNeuzeichneneinesFensters).PAR1und
PAR2mÅssenausjegenau4Zahlenbestehenundbestimmenzwei
Rechtecke.DasPrÑdikatschlÑgtfehl,wennbeideRechtecke
sichnichtÅberlappen;andernfallswirddieSchnittflÑche
berechnet(wiedereinRechteck)unddieentstehendeListemit
PAR3unifiziert.

